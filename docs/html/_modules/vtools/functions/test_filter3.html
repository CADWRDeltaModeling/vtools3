
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>vtools.functions.test_filter3 &#8212; vtools 3.6.3+5.g9078183.dirty documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../../../index.html"><img src="../../../_static/logo.png" border="0" alt="py4sci"/></a>
</div>



      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/dwrsmall.jpg" alt="Logo"/>
            </a></p>
<p class="logo">
  <a href="../../../index.html">
    <img class="logo" src="../../../_static/dwrsmall.jpg" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<p><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../concepts.html">Introduction and concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interpolation.html">Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/filters.html">Averging, Filtering and Low Passing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/filters.html#Filters">Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../download.html">Downloading scripts (standalone)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../history.html">History</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for vtools.functions.test_filter3</h1><div class="highlight"><pre>
<span></span>

<span class="kn">import</span> <span class="nn">unittest</span><span class="o">,</span><span class="nn">random</span><span class="o">,</span><span class="nn">pdb</span>

<span class="c1">## Datetime import</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="c1">## vtools import.</span>
<span class="kn">from</span> <span class="nn">vtools.data.timeseries</span> <span class="kn">import</span> <span class="n">rts</span>
<span class="kn">from</span> <span class="nn">vtools.data.vtime</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">vtools.data.sample_series</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1">## numpy testing suite import.</span>
<span class="kn">from</span> <span class="nn">numpy.testing</span> <span class="kn">import</span> <span class="n">assert_array_equal</span><span class="p">,</span> <span class="n">assert_equal</span>
<span class="kn">from</span> <span class="nn">numpy.testing</span> <span class="kn">import</span> <span class="n">assert_almost_equal</span><span class="p">,</span> <span class="n">assert_array_almost_equal</span><span class="p">,</span>\
                          <span class="n">assert_array_equal</span>
<span class="c1">## numpy import.</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1">## Local import </span>
<span class="kn">from</span> <span class="nn">vtools.functions.filter</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">lfilter</span><span class="p">,</span><span class="n">filtfilt</span>
<span class="kn">from</span> <span class="nn">scipy.signal.filter_design</span> <span class="kn">import</span> <span class="n">butter</span>
 

<div class="viewcode-block" id="TestFilter"><a class="viewcode-back" href="../../../vtools.functions.html#vtools.functions.test_filter3.TestFilter">[docs]</a><span class="k">class</span> <span class="nc">TestFilter</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot; test functionality of shift operations &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">methodName</span><span class="o">=</span><span class="s2">&quot;runTest&quot;</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">TestFilter</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">methodName</span><span class="p">)</span>
                         
        <span class="c1"># Number of data in a time series.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_ts</span><span class="o">=</span><span class="mi">1000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_val</span><span class="o">=</span><span class="mi">1000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_val</span><span class="o">=</span><span class="mf">0.01</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">large_data_size</span><span class="o">=</span><span class="mi">100000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">two_to_ten</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_interval</span><span class="o">=</span><span class="p">[</span><span class="n">minutes</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span><span class="n">hours</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">days</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
   
<div class="viewcode-block" id="TestFilter.setUp"><a class="viewcode-back" href="../../../vtools.functions.html#vtools.functions.test_filter3.TestFilter.setUp">[docs]</a>    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>        </div>
        <span class="c1">#self.out_file=open(&quot;result.txt&quot;,&quot;a&quot;)</span>
                 
<div class="viewcode-block" id="TestFilter.tearDown"><a class="viewcode-back" href="../../../vtools.functions.html#vtools.functions.test_filter3.TestFilter.tearDown">[docs]</a>    <span class="k">def</span> <span class="nf">tearDown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div>
        <span class="c1">#self.out_file.close()    </span>
                
            
<div class="viewcode-block" id="TestFilter.test_butterworth"><a class="viewcode-back" href="../../../vtools.functions.html#vtools.functions.test_filter3.TestFilter.test_butterworth">[docs]</a>    <span class="k">def</span> <span class="nf">test_butterworth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Butterworth filter on isa series of 1hour interval with four</span>
<span class="sd">            frequencies.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Test operations on ts of varied values.</span>
        <span class="n">test_ts</span><span class="o">=</span><span class="p">[(</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span>\
                  <span class="bp">self</span><span class="o">.</span><span class="n">two_to_ten</span><span class="p">,</span><span class="n">hours</span><span class="p">(</span><span class="mi">1</span><span class="p">))]</span>

        <span class="n">f1</span><span class="o">=</span><span class="mf">0.76</span>
        <span class="n">f2</span><span class="o">=</span><span class="mf">0.44</span>
        <span class="n">f3</span><span class="o">=</span><span class="mf">0.95</span>
        <span class="n">f4</span><span class="o">=</span><span class="mf">1.23</span>
        <span class="n">pi</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="n">av1</span><span class="o">=</span><span class="n">f1</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mf">12.</span>
        <span class="n">av2</span><span class="o">=</span><span class="n">f2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mf">12.</span>
        <span class="n">av3</span><span class="o">=</span><span class="n">f3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mf">12.</span>
        <span class="n">av4</span><span class="o">=</span><span class="n">f4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mf">12.</span>
      
        <span class="k">for</span> <span class="p">(</span><span class="n">st</span><span class="p">,</span><span class="n">num</span><span class="p">,</span><span class="n">delta</span><span class="p">)</span> <span class="ow">in</span> <span class="n">test_ts</span><span class="p">:</span>
            <span class="c1">## this day contains components of with frequecies of 0.76/day,</span>
            <span class="c1">## 0.44/day, 0.95/day, 1.23/day            </span>
            <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">av1</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="mf">0.7</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">av2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="mf">2.4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">av3</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> 
                  <span class="o">+</span><span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">av4</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num</span><span class="p">)]</span> 
                                
            <span class="c1"># This ts is the orignial one.           </span>
            <span class="n">ts0</span><span class="o">=</span><span class="n">rts</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">delta</span><span class="p">)</span>   
            <span class="n">ts</span><span class="o">=</span><span class="n">butterworth</span><span class="p">(</span><span class="n">ts0</span><span class="p">,</span><span class="n">cutoff_period</span><span class="o">=</span><span class="n">hours</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="o">==</span> <span class="n">ts0</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="TestFilter.test_butterworth_noevenorder"><a class="viewcode-back" href="../../../vtools.functions.html#vtools.functions.test_filter3.TestFilter.test_butterworth_noevenorder">[docs]</a>    <span class="k">def</span> <span class="nf">test_butterworth_noevenorder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; test a butterworth with non even order input</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">freq</span><span class="o">=</span><span class="n">hours</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">order</span><span class="o">=</span><span class="mi">7</span>
        <span class="n">ts0</span><span class="o">=</span><span class="n">rts</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">start</span><span class="p">,</span><span class="n">freq</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span><span class="n">butterworth</span><span class="p">,</span><span class="n">ts0</span><span class="p">,</span><span class="n">order</span><span class="p">)</span></div>

    <span class="c1"># def test_boxcar_nan(self):</span>
        
        <span class="c1"># &quot;&quot;&quot; test boxcar performance with a nan in data&quot;&quot;&quot;</span>
                
        <span class="c1"># data=[1.0]*200+[2.0]*100+[1.0]*100</span>
        <span class="c1"># data=np.array(data)</span>
        <span class="c1"># data[201]=np.nan</span>
        <span class="c1"># st=pd.Timestamp(1990,2,3,11, 15)</span>
        <span class="c1"># delta=hours(1)</span>
        <span class="c1"># test_ts=rts(data,st,delta)</span>
        <span class="c1"># nt=boxcar(test_ts,11,12)</span>
        
        <span class="c1"># ## besides the leading and trailing nan, there will be</span>
        <span class="c1"># ## 24 nan in the middle </span>
        <span class="c1"># self.assert_(np.alltrue(np.isnan(nt.to_numpy()[190:213])))</span>
        
        
    <span class="c1"># def test_boxcar(self):</span>
        
        <span class="c1"># &quot;&quot;&quot; test boxcar performance in each steps of a godin filter&quot;&quot;&quot;</span>
                
        <span class="c1"># data=[1.0]*200+[2.0]*100+[1.0]*100</span>
        <span class="c1"># data=np.array(data)</span>
        <span class="c1"># st=pd.Timestamp(1990,2,3,11, 15)</span>
        <span class="c1"># delta=hours(1)</span>
        <span class="c1"># test_ts=rts(data,st,delta)</span>
        
        
        <span class="c1"># ## first round of boxcar in 24 (11,12).</span>
        <span class="c1"># nt=boxcar(test_ts,11,12)</span>
        <span class="c1"># self.assert_(np.alltrue(np.isnan(nt.to_numpy()[0:11])))</span>
        <span class="c1"># assert_array_almost_equal(nt.to_numpy()[11:188],[1]*177,12)</span>
        <span class="c1"># self.assert_(np.alltrue(np.greater(nt.to_numpy()[188:211],1)))</span>
        <span class="c1"># self.assertAlmostEqual(nt.to_numpy()[196],1.375)</span>
        <span class="c1"># assert_array_almost_equal(nt.to_numpy()[211:288],[2]*77,12)</span>
        <span class="c1"># self.assert_(np.alltrue(np.greater(nt.to_numpy()[288:311],1)))</span>
        <span class="c1"># self.assertAlmostEqual(nt.to_numpy()[301],1.4166666667)</span>
        <span class="c1"># assert_array_almost_equal(nt.to_numpy()[311:388],[1]*77,12)</span>
        <span class="c1"># self.assert_(np.alltrue(np.isnan(nt.to_numpy()[388:400])))</span>
    
        <span class="c1"># ## second round of boxcar in 24 (12,11)</span>
        <span class="c1"># nt2=boxcar(nt,12,11)</span>
        <span class="c1"># self.assert_(np.alltrue(np.isnan(nt2.to_numpy()[0:23])))</span>
        <span class="c1"># assert_array_almost_equal(nt2.to_numpy()[23:177],[1]*154,12)</span>
        <span class="c1"># self.assert_(np.alltrue(np.greater(nt2.to_numpy()[177:223],1)))</span>
        <span class="c1"># self.assertAlmostEqual(nt2.to_numpy()[196],1.364583333)</span>
        <span class="c1"># assert_array_almost_equal(nt2.to_numpy()[223:277],[2]*54,12)</span>
        <span class="c1"># self.assert_(np.alltrue(np.greater(nt2.to_numpy()[277:323],1)))</span>
        <span class="c1"># self.assertAlmostEqual(nt2.to_numpy()[301],1.439236111)</span>
        <span class="c1"># assert_array_almost_equal(nt2.to_numpy()[323:377],[1]*54,12)</span>
        <span class="c1"># self.assert_(np.alltrue(np.isnan(nt2.to_numpy()[377:400])))</span>
        
        <span class="c1"># ## third round of boxcar.   </span>
        <span class="c1"># nt3=boxcar(nt2,12,12)</span>
        <span class="c1"># self.assert_(np.alltrue(np.isnan(nt3.to_numpy()[0:35])))</span>
        <span class="c1"># assert_array_almost_equal(nt3.to_numpy()[35:165],[1]*130,12)</span>
        <span class="c1"># self.assert_(np.alltrue(np.greater(nt3.to_numpy()[165:235],1)))</span>
        <span class="c1"># self.assertAlmostEqual(nt3.to_numpy()[196],1.393055556)</span>
        <span class="c1"># assert_array_almost_equal(nt3.to_numpy()[235:265],[2]*30,12)</span>
        <span class="c1"># self.assert_(np.alltrue(np.greater(nt3.to_numpy()[265:335],1)))</span>
        <span class="c1"># self.assertAlmostEqual(nt3.to_numpy()[301],1.453819444)</span>
        <span class="c1"># assert_array_almost_equal(nt3.to_numpy()[335:365],[1]*30,12)</span>
        <span class="c1"># self.assert_(np.alltrue(np.isnan(nt3.to_numpy()[365:400])))</span>

    <span class="c1"># Daily ave not implemented. Very similar to df.resample(&#39;D&quot;).mean()</span>
    <span class="c1"># def test_daily_average(self):</span>
        
        <span class="c1"># &quot;&quot;&quot; Test godin filter on 2-dimensional data set.&quot;&quot;&quot;</span>
        
        <span class="c1"># d1=[1.0]*800+[2.0]*400+[1.0]*400</span>
        <span class="c1"># d2=[1.0]*800+[2.0]*400+[1.0]*400</span>
        <span class="c1"># data=np.array([d1,d2])</span>
        <span class="c1"># data=np.transpose(data)</span>
        <span class="c1"># data[336,:]=np.nan</span>
        <span class="c1"># st=pd.Timestamp(1990,2,3,11, 15)</span>
        <span class="c1"># delta=minutes(15)</span>
        <span class="c1"># test_ts=rts(data,st,delta)</span>
        <span class="c1"># nt3=daily_average(test_ts)</span>
        
<div class="viewcode-block" id="TestFilter.test_godin"><a class="viewcode-back" href="../../../vtools.functions.html#vtools.functions.test_filter3.TestFilter.test_godin">[docs]</a>    <span class="k">def</span> <span class="nf">test_godin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; test a godin filter on a series of 1hour interval with four</span>
<span class="sd">            frequencies.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Test operations on ts of varied values.</span>
        <span class="n">test_ts</span><span class="o">=</span><span class="p">[(</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>\
                  <span class="bp">self</span><span class="o">.</span><span class="n">two_to_ten</span><span class="p">,</span><span class="n">hours</span><span class="p">(</span><span class="mi">1</span><span class="p">))]</span>

        <span class="n">f1</span><span class="o">=</span><span class="mf">0.76</span>
        <span class="n">f2</span><span class="o">=</span><span class="mf">0.44</span>
        <span class="n">f3</span><span class="o">=</span><span class="mf">0.95</span>
        <span class="n">f4</span><span class="o">=</span><span class="mf">1.23</span>
        <span class="n">av1</span><span class="o">=</span><span class="n">f1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">12</span>
        <span class="n">av2</span><span class="o">=</span><span class="n">f2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">12</span>
        <span class="n">av3</span><span class="o">=</span><span class="n">f3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">12</span>
        <span class="n">av4</span><span class="o">=</span><span class="n">f4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">12</span>
                 
        <span class="k">for</span> <span class="p">(</span><span class="n">st</span><span class="p">,</span><span class="n">num</span><span class="p">,</span><span class="n">delta</span><span class="p">)</span> <span class="ow">in</span> <span class="n">test_ts</span><span class="p">:</span>
            <span class="c1">## this day contains components of with frequecies of 0.76/day,</span>
            <span class="c1">## 0.44/day, 0.95/day, 1.23/day            </span>
            <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">av1</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="mf">0.7</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">av2</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="mf">2.4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">av3</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> 
                  <span class="o">+</span><span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">av4</span><span class="o">*</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">)]</span> 
                                
            <span class="c1"># This ts is the orignial one.           </span>
            <span class="n">ts0</span><span class="o">=</span><span class="n">rts</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">delta</span><span class="p">)</span>   
            <span class="n">ts</span><span class="o">=</span><span class="n">godin</span><span class="p">(</span><span class="n">ts0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="o">==</span> <span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="TestFilter.test_godin_15min"><a class="viewcode-back" href="../../../vtools.functions.html#vtools.functions.test_filter3.TestFilter.test_godin_15min">[docs]</a>    <span class="k">def</span> <span class="nf">test_godin_15min</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>        
        <span class="sd">&quot;&quot;&quot; test godin filtering on a 15min constant values </span>
<span class="sd">            data series with a nan.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">]</span><span class="o">*</span><span class="mi">800</span><span class="o">+</span><span class="p">[</span><span class="mf">2.0</span><span class="p">]</span><span class="o">*</span><span class="mi">400</span><span class="o">+</span><span class="p">[</span><span class="mf">1.0</span><span class="p">]</span><span class="o">*</span><span class="mi">400</span>
        <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="mi">336</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">st</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">delta</span><span class="o">=</span><span class="n">minutes</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">test_ts</span><span class="o">=</span><span class="n">rts</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">delta</span><span class="p">)</span>
        <span class="n">nt3</span><span class="o">=</span><span class="n">godin</span><span class="p">(</span><span class="n">test_ts</span><span class="p">)</span>
        <span class="n">nt3</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;godin.csv&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">nt3</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">144</span><span class="p">])))</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">nt3</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">144</span><span class="p">:</span><span class="mi">192</span><span class="p">],[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">48</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">nt3</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">192</span><span class="p">:</span><span class="mi">481</span><span class="p">])))</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">nt3</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">481</span><span class="p">:</span><span class="mi">656</span><span class="p">],[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">175</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">greater</span><span class="p">(</span><span class="n">nt3</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">656</span><span class="p">:</span><span class="mi">944</span><span class="p">],</span><span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">nt3</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">868</span><span class="p">],</span><span class="mf">1.916618441</span><span class="p">)</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">nt3</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">944</span><span class="p">:</span><span class="mi">1056</span><span class="p">],[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">112</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">greater</span><span class="p">(</span><span class="n">nt3</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">1056</span><span class="p">:</span><span class="mi">1344</span><span class="p">],</span><span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">nt3</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">1284</span><span class="p">],</span><span class="mf">1.041451845</span><span class="p">)</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">nt3</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">1344</span><span class="p">:</span><span class="mi">1456</span><span class="p">],[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">112</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">nt3</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[</span><span class="mi">1456</span><span class="p">:</span><span class="mi">1600</span><span class="p">])))</span>   </div>
                                   
<div class="viewcode-block" id="TestFilter.test_godin_2d"><a class="viewcode-back" href="../../../vtools.functions.html#vtools.functions.test_filter3.TestFilter.test_godin_2d">[docs]</a>    <span class="k">def</span> <span class="nf">test_godin_2d</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="sd">&quot;&quot;&quot; Test godin filter on 2-dimensional data set.&quot;&quot;&quot;</span>
        
        <span class="n">d1</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">]</span><span class="o">*</span><span class="mi">800</span><span class="o">+</span><span class="p">[</span><span class="mf">2.0</span><span class="p">]</span><span class="o">*</span><span class="mi">400</span><span class="o">+</span><span class="p">[</span><span class="mf">1.0</span><span class="p">]</span><span class="o">*</span><span class="mi">400</span>
        <span class="n">d2</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">]</span><span class="o">*</span><span class="mi">800</span><span class="o">+</span><span class="p">[</span><span class="mf">2.0</span><span class="p">]</span><span class="o">*</span><span class="mi">400</span><span class="o">+</span><span class="p">[</span><span class="mf">1.0</span><span class="p">]</span><span class="o">*</span><span class="mi">400</span>
        <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">d1</span><span class="p">,</span><span class="n">d2</span><span class="p">])</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">T</span>
        <span class="n">data</span><span class="p">[</span><span class="mi">336</span><span class="p">,:]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">st</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">delta</span><span class="o">=</span><span class="n">minutes</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">test_ts</span><span class="o">=</span><span class="n">rts</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">delta</span><span class="p">)</span>
        
        <span class="n">nt3</span><span class="o">=</span><span class="n">godin</span><span class="p">(</span><span class="n">test_ts</span><span class="p">)</span>
        <span class="n">d1</span><span class="o">=</span><span class="n">nt3</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">d2</span><span class="o">=</span><span class="n">nt3</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">d1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">144</span><span class="p">])))</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">d1</span><span class="p">[</span><span class="mi">144</span><span class="p">:</span><span class="mi">192</span><span class="p">],[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">48</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">d1</span><span class="p">[</span><span class="mi">192</span><span class="p">:</span><span class="mi">481</span><span class="p">])))</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">d1</span><span class="p">[</span><span class="mi">481</span><span class="p">:</span><span class="mi">656</span><span class="p">],[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">175</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">greater</span><span class="p">(</span><span class="n">d1</span><span class="p">[</span><span class="mi">656</span><span class="p">:</span><span class="mi">944</span><span class="p">],</span><span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">[</span><span class="mi">868</span><span class="p">],</span><span class="mf">1.916618441</span><span class="p">)</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">d1</span><span class="p">[</span><span class="mi">944</span><span class="p">:</span><span class="mi">1056</span><span class="p">],[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">112</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">greater</span><span class="p">(</span><span class="n">d1</span><span class="p">[</span><span class="mi">1056</span><span class="p">:</span><span class="mi">1344</span><span class="p">],</span><span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">d1</span><span class="p">[</span><span class="mi">1284</span><span class="p">],</span><span class="mf">1.041451845</span><span class="p">)</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">d1</span><span class="p">[</span><span class="mi">1344</span><span class="p">:</span><span class="mi">1456</span><span class="p">],[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">112</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">d1</span><span class="p">[</span><span class="mi">1456</span><span class="p">:</span><span class="mi">1600</span><span class="p">])))</span> 
        
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">d2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">144</span><span class="p">])))</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">d2</span><span class="p">[</span><span class="mi">144</span><span class="p">:</span><span class="mi">192</span><span class="p">],[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">48</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">d2</span><span class="p">[</span><span class="mi">192</span><span class="p">:</span><span class="mi">481</span><span class="p">])))</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">d2</span><span class="p">[</span><span class="mi">481</span><span class="p">:</span><span class="mi">656</span><span class="p">],[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">175</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">greater</span><span class="p">(</span><span class="n">d2</span><span class="p">[</span><span class="mi">656</span><span class="p">:</span><span class="mi">944</span><span class="p">],</span><span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">d2</span><span class="p">[</span><span class="mi">868</span><span class="p">],</span><span class="mf">1.916618441</span><span class="p">)</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">d2</span><span class="p">[</span><span class="mi">944</span><span class="p">:</span><span class="mi">1056</span><span class="p">],[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">112</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">greater</span><span class="p">(</span><span class="n">d2</span><span class="p">[</span><span class="mi">1056</span><span class="p">:</span><span class="mi">1344</span><span class="p">],</span><span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">d2</span><span class="p">[</span><span class="mi">1284</span><span class="p">],</span><span class="mf">1.041451845</span><span class="p">)</span>
        <span class="n">assert_array_almost_equal</span><span class="p">(</span><span class="n">d2</span><span class="p">[</span><span class="mi">1344</span><span class="p">:</span><span class="mi">1456</span><span class="p">],[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">112</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assert_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">d2</span><span class="p">[</span><span class="mi">1456</span><span class="p">:</span><span class="mi">1600</span><span class="p">])))</span> </div>
    
<div class="viewcode-block" id="TestFilter.test_lanczos_cos_filter_coef"><a class="viewcode-back" href="../../../vtools.functions.html#vtools.functions.test_filter3.TestFilter.test_lanczos_cos_filter_coef">[docs]</a>    <span class="k">def</span> <span class="nf">test_lanczos_cos_filter_coef</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Test the sum of lanczos filter coefficients&quot;&quot;&quot;</span>    
        <span class="n">cf</span><span class="o">=</span><span class="mf">0.2</span>
        <span class="n">m</span><span class="o">=</span><span class="mi">10</span>
        <span class="n">coef</span><span class="o">=</span><span class="n">lowpass_cosine_lanczos_filter_coef</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">coef</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span>
        <span class="n">coefsum</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">coefsum</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">places</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">m</span><span class="o">=</span><span class="mi">40</span>
        <span class="n">coef</span><span class="o">=</span><span class="n">lowpass_cosine_lanczos_filter_coef</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">coef</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span>
        <span class="n">coefsum</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">coefsum</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">places</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="TestFilter.test_lanczos_cos_filter_phase_neutral"><a class="viewcode-back" href="../../../vtools.functions.html#vtools.functions.test_filter3.TestFilter.test_lanczos_cos_filter_phase_neutral">[docs]</a>    <span class="k">def</span> <span class="nf">test_lanczos_cos_filter_phase_neutral</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Test the phase neutriality of cosine lanczos filter&quot;&quot;&quot;</span>
        
        <span class="c1">## a signal that is sum of two sine waves with periods of </span>
        <span class="c1">#  4d and 0.25d</span>
        <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">2001</span><span class="p">)</span>
        <span class="n">xlow</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="mf">24.</span><span class="p">))</span>
        <span class="n">xhigh</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="mf">6.</span><span class="p">)</span>
        <span class="n">x</span><span class="o">=</span><span class="n">xlow</span><span class="o">+</span><span class="n">xhigh</span>
        <span class="n">st</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">delta</span><span class="o">=</span><span class="n">hours</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ts</span><span class="o">=</span><span class="n">rts</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">delta</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
        <span class="c1">## cutoff period is 30 hours, filterd result should be xlow</span>
        <span class="c1">## approximately</span>
        <span class="n">nt1</span><span class="o">=</span><span class="n">cosine_lanczos</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">cutoff_period</span><span class="o">=</span><span class="n">hours</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span><span class="n">filter_len</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
        <span class="n">nt1</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;nt1&quot;</span><span class="p">]</span>
        <span class="n">nt1</span><span class="p">[</span><span class="s2">&quot;nt2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xlow</span>
        <span class="n">absdiff</span> <span class="o">=</span> <span class="p">(</span><span class="n">nt1</span><span class="o">.</span><span class="n">nt1</span> <span class="o">-</span> <span class="n">nt1</span><span class="o">.</span><span class="n">nt2</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">absdiff</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">places</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></div>
        
    
<div class="viewcode-block" id="TestFilter.test_lanczos_cos_filter_period_freq_api"><a class="viewcode-back" href="../../../vtools.functions.html#vtools.functions.test_filter3.TestFilter.test_lanczos_cos_filter_period_freq_api">[docs]</a>    <span class="k">def</span> <span class="nf">test_lanczos_cos_filter_period_freq_api</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Test the cutoff period and frequency of filter&quot;&quot;&quot;</span>
        
        <span class="c1">## a signal that is sum of two sine waves with frequency of</span>
        <span class="c1">## 5 and 250HZ, sampled at 2000HZ</span>
        <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">2001</span><span class="p">)</span>
        <span class="n">xlow</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
        <span class="n">xhigh</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">250</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
        <span class="n">x</span><span class="o">=</span><span class="n">xlow</span><span class="o">+</span><span class="n">xhigh</span>
        <span class="n">st</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">delta</span><span class="o">=</span><span class="n">hours</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ts</span><span class="o">=</span><span class="n">rts</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">delta</span><span class="p">)</span>
        
    
        <span class="n">nt1</span><span class="o">=</span><span class="n">cosine_lanczos</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">cutoff_period</span><span class="o">=</span><span class="n">hours</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span><span class="n">filter_len</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>\
                          <span class="n">padtype</span><span class="o">=</span><span class="s2">&quot;even&quot;</span><span class="p">)</span>
        
        <span class="c1">## cutoff_frequency is expressed as ratio of nyquist frequency</span>
        <span class="c1">## ,which is 1/0.5/hours</span>
        <span class="n">cutoff_frequency</span><span class="o">=</span><span class="mf">2.0</span><span class="o">/</span><span class="mi">30</span>
        <span class="n">nt2</span><span class="o">=</span><span class="n">cosine_lanczos</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">cutoff_frequency</span><span class="o">=</span><span class="n">cutoff_frequency</span><span class="p">,</span><span class="n">filter_len</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>\
                           <span class="n">padtype</span><span class="o">=</span><span class="s2">&quot;even&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">nt1</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">-</span><span class="n">nt2</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="TestFilter.test_lanczos_cos_filter_len_api"><a class="viewcode-back" href="../../../vtools.functions.html#vtools.functions.test_filter3.TestFilter.test_lanczos_cos_filter_len_api">[docs]</a>    <span class="k">def</span> <span class="nf">test_lanczos_cos_filter_len_api</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Test the filter len api of the cosine filter&quot;&quot;&quot;</span>
        
        <span class="c1">## a signal that is sum of two sine waves with frequency of</span>
        <span class="c1">## 5 and 250HZ, sampled at 2000HZ</span>
        <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">2001</span><span class="p">)</span>
        <span class="n">xlow</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
        <span class="n">xhigh</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">250</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
        <span class="n">x</span><span class="o">=</span><span class="n">xlow</span><span class="o">+</span><span class="n">xhigh</span>
        <span class="n">st</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">delta</span><span class="o">=</span><span class="n">hours</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ts</span><span class="o">=</span><span class="n">rts</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">delta</span><span class="p">)</span>
        
        <span class="c1">## filter len is none</span>
        <span class="n">nt1</span><span class="o">=</span><span class="n">cosine_lanczos</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">cutoff_period</span><span class="o">=</span><span class="n">hours</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span><span class="n">padtype</span><span class="o">=</span><span class="s2">&quot;even&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">nt1</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="o">==</span> <span class="n">ts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>
        <span class="c1">## filter len by defaut lis 40*1.25=50, use it explicitly and</span>
        <span class="c1">## see if the result is the same as the nt1</span>
        <span class="n">nt2</span><span class="o">=</span><span class="n">cosine_lanczos</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">cutoff_period</span><span class="o">=</span><span class="n">hours</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span><span class="n">filter_len</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">padtype</span><span class="o">=</span><span class="s2">&quot;even&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">nt1</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">-</span><span class="n">nt2</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span></div>
   
<div class="viewcode-block" id="TestFilter.test_lanczos_cos_filter_len"><a class="viewcode-back" href="../../../vtools.functions.html#vtools.functions.test_filter3.TestFilter.test_lanczos_cos_filter_len">[docs]</a>    <span class="k">def</span> <span class="nf">test_lanczos_cos_filter_len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; test cosine lanczos input filter length api&quot;&quot;&quot;</span>
        
        <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="o">+</span><span class="mf">0.8</span><span class="p">)</span><span class="o">+</span><span class="mf">3.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mi">45</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span>\
             <span class="o">+</span><span class="mf">7.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mi">55</span><span class="o">+</span><span class="mf">0.3</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>
        <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">st</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">delta</span><span class="o">=</span><span class="n">hours</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ts</span><span class="o">=</span><span class="n">rts</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">delta</span><span class="p">)</span>
        
        <span class="n">filter_len</span><span class="o">=</span><span class="mi">24</span>
        <span class="n">t1</span><span class="o">=</span><span class="n">cosine_lanczos</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">cutoff_period</span><span class="o">=</span><span class="n">hours</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span><span class="n">filter_len</span><span class="o">=</span><span class="n">filter_len</span><span class="p">)</span>
        
        <span class="n">filter_len</span><span class="o">=</span><span class="n">days</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">t2</span><span class="o">=</span><span class="n">cosine_lanczos</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">cutoff_period</span><span class="o">=</span><span class="n">hours</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span><span class="n">filter_len</span><span class="o">=</span><span class="n">filter_len</span><span class="p">)</span>
        
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span><span class="n">t2</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>
        
        
        <span class="n">filter_len</span><span class="o">=</span><span class="s2">&quot;invalid&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span><span class="n">cosine_lanczos</span><span class="p">,</span><span class="n">ts</span><span class="p">,</span><span class="n">cutoff_period</span><span class="o">=</span><span class="n">hours</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span>\
                          <span class="n">filter_len</span><span class="o">=</span><span class="n">filter_len</span><span class="p">)</span></div>
   

<div class="viewcode-block" id="TestFilter.test_lanczos_cos_filter_nan"><a class="viewcode-back" href="../../../vtools.functions.html#vtools.functions.test_filter3.TestFilter.test_lanczos_cos_filter_nan">[docs]</a>    <span class="k">def</span> <span class="nf">test_lanczos_cos_filter_nan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Test the data with a nan filtered by cosine lanczos filter&quot;&quot;&quot;</span>
        <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="o">+</span><span class="mf">0.8</span><span class="p">)</span><span class="o">+</span><span class="mf">3.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mi">45</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span>\
             <span class="o">+</span><span class="mf">7.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mi">55</span><span class="o">+</span><span class="mf">0.3</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>
        <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">nanloc</span><span class="o">=</span><span class="mi">336</span>
        <span class="n">data</span><span class="p">[</span><span class="n">nanloc</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">st</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">delta</span><span class="o">=</span><span class="n">hours</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ts</span><span class="o">=</span><span class="n">rts</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">delta</span><span class="p">)</span>
        <span class="n">m</span><span class="o">=</span><span class="mi">20</span>
     
        <span class="n">nt1</span><span class="o">=</span><span class="n">cosine_lanczos</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">cutoff_period</span><span class="o">=</span><span class="n">hours</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span><span class="n">filter_len</span><span class="o">=</span><span class="n">m</span><span class="p">,</span><span class="n">padtype</span><span class="o">=</span><span class="s2">&quot;even&quot;</span><span class="p">)</span>
        <span class="c1">## result should have nan from nanidx-2*m+2 to nanidx+2*m-1</span>
        <span class="n">nanidx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">nt1</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nanidx_should_be</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nanloc</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">,</span><span class="n">nanloc</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">assert_array_equal</span><span class="p">(</span><span class="n">nanidx</span><span class="p">,</span><span class="n">nanidx_should_be</span><span class="p">)</span></div>
        


<div class="viewcode-block" id="TestFilter.test_gaussian_filter"><a class="viewcode-back" href="../../../vtools.functions.html#vtools.functions.test_filter3.TestFilter.test_gaussian_filter">[docs]</a>    <span class="k">def</span> <span class="nf">test_gaussian_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="sd">&quot;&quot;&quot; Test the nan data with gaussian filter&quot;&quot;&quot;</span>
       <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mi">5</span><span class="o">+</span><span class="mf">0.8</span><span class="p">)</span><span class="o">+</span><span class="mf">3.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mi">45</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span>\
             <span class="o">+</span><span class="mf">7.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mi">55</span><span class="o">+</span><span class="mf">0.3</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>
       <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
       <span class="n">nanloc</span><span class="o">=</span><span class="mi">336</span>
       <span class="n">data</span><span class="p">[</span><span class="n">nanloc</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
       <span class="n">st</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
       <span class="n">delta</span><span class="o">=</span><span class="n">hours</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
       <span class="n">ts</span><span class="o">=</span><span class="n">rts</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">delta</span><span class="p">)</span>
       <span class="n">sigma</span><span class="o">=</span><span class="mi">2</span>
     
       <span class="n">nts</span><span class="o">=</span><span class="p">[]</span>
       <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
           <span class="n">nts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts_gaussian_filter</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">))</span></div></div>
  
         
              
<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>       

   

    

            

        
        

        
            


        
        

        
        

        

        


        

             



            
        
    
        
        

 

        

        
        

    
                    




        

                 

    
    
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, California Department of Water Resources.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>