<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Merging and Splicing Time Series &#8212; vtools 0.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=12dfc556" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="../_static/documentation_options.js?v=7026087e"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Extrapolation Method Demonstrations" href="extrapolation.html" />
    <link rel="prev" title="Climatology" href="climatology.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../index.html"><img src="../_static/logo.png" border="0" alt="py4sci"/></a>
</div>



      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/dwrsmall.jpg" alt="Logo"/>
            </a></p>
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/dwrsmall.jpg" alt="Logo" />
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../concepts.html">Introduction and concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interpolation.html">Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="filters.html">Averging, Filtering and Low Passing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="filters.html#Filters">Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="tidal_envelope.html">Tidal Envelope Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="climatology.html">Fitting and using a climatology</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Merging and Splicing Time Series</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Prioritized-filling-on-regular-series">Prioritized filling on regular series</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Splicing">Splicing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Irregular-series">Irregular series</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Names-argument"><code class="docutils literal notranslate"><span class="pre">Names</span></code> argument</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#ts_merge:-strict-priority-option"><code class="docutils literal notranslate"><span class="pre">ts_merge</span></code>: strict priority option</a></li>
<li class="toctree-l1"><a class="reference internal" href="extrapolation.html">Extrapolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="transition.html">Transitioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="climatology.html" title="previous chapter">Climatology</a></li>
      <li>Next: <a href="extrapolation.html" title="next chapter">Extrapolation Method Demonstrations</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="Merging-and-Splicing-Time-Series">
<h1>Merging and Splicing Time Series<a class="headerlink" href="#Merging-and-Splicing-Time-Series" title="Link to this heading">¶</a></h1>
<p>This tutorial demonstrates the usage and difference between <code class="docutils literal notranslate"><span class="pre">ts_merge</span></code> and <code class="docutils literal notranslate"><span class="pre">ts_splice</span></code>, two methods for folding together time series into a combined data structure.</p>
<ul class="simple">
<li><p><strong>``ts_merge``</strong> blends multiple time series together based on priority, optionally filling missing values in higher priority series with entries from lower priority. It potentially uses all the input series at all timestamps. See the <code class="docutils literal notranslate"><span class="pre">`strict_priority</span></code> &lt;#ts_merge-strict-priority-option&gt;`__ option below for advanced control over nan-filling between priorities.</p></li>
<li><p><strong>``ts_splice``</strong> stitches together time series in sequential time <strong>blocks</strong> without mixing values.</p></li>
</ul>
<p>We will describe the effect on regularly sampled series (which have the <code class="docutils literal notranslate"><span class="pre">freq</span></code> attribute) and on irregular. We will also explore the <strong>``names``</strong> argument, which controls how columns are selected or renamed in the merging/splicing process. There is a file-level command line tools for this as well in the <code class="docutils literal notranslate"><span class="pre">dms_datastore</span></code> package.</p>
<section id="Prioritized-filling-on-regular-series">
<h2>Prioritized filling on regular series<a class="headerlink" href="#Prioritized-filling-on-regular-series" title="Link to this heading">¶</a></h2>
<p>Let’s begin by showing how <code class="docutils literal notranslate"><span class="pre">ts_merge</span></code> and <code class="docutils literal notranslate"><span class="pre">ts_splice</span></code> fold together two regular series but gappy series on a prioritized basis.</p>
<p>Here are the sample series:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ========================================</span>
<span class="c1"># 1️⃣ Creating Regular Time Series (1D Frequency with Missing Data)</span>
<span class="c1"># ========================================</span>
<span class="n">idx1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;1D&quot;</span><span class="p">)</span>
<span class="n">idx2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;1D&quot;</span><span class="p">)</span>
<span class="n">idx3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2022-12-31&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;1D&quot;</span><span class="p">)</span>

<span class="n">series1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="n">series2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">4.</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="n">series3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">1000.</span><span class="p">,</span><span class="mf">1001.</span><span class="p">,</span> <span class="mf">1002.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">1004.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">1007.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mf">1005.</span><span class="p">,</span><span class="mf">1006.</span><span class="p">,</span><span class="mf">1007.</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Series 1 (Primary):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">series1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Series 2 (Secondary - Fills Gaps):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">series2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Series 3 (Tertiary - Fills Gaps):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">series3</span><span class="p">)</span>
<br/><br/><br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">NameError</span>                                 Traceback (most recent call last)
Cell <span class="ansi-green-intense-fg ansi-bold">In[1], line 4</span>
<span class="ansi-green-fg">      1</span> <span style="color: rgb(95,135,135)"># ========================================</span>
<span class="ansi-green-fg">      2</span> <span style="color: rgb(95,135,135)"># 1️⃣ Creating Regular Time Series (1D Frequency with Missing Data)</span>
<span class="ansi-green-fg">      3</span> <span style="color: rgb(95,135,135)"># ========================================</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 4</span> idx1 <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">pd</span><span style="color: rgb(98,98,98)">.</span>date_range(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">2023-01-01</span><span style="color: rgb(175,0,0)">&#34;</span>, periods<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">10</span>, freq<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">1D</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-fg">      5</span> idx2 <span style="color: rgb(98,98,98)">=</span> pd<span style="color: rgb(98,98,98)">.</span>date_range(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">2023-01-01</span><span style="color: rgb(175,0,0)">&#34;</span>, periods<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">12</span>, freq<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">1D</span><span style="color: rgb(175,0,0)">&#34;</span>)
<span class="ansi-green-fg">      6</span> idx3 <span style="color: rgb(98,98,98)">=</span> pd<span style="color: rgb(98,98,98)">.</span>date_range(<span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">2022-12-31</span><span style="color: rgb(175,0,0)">&#34;</span>, periods<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">14</span>, freq<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#34;</span><span style="color: rgb(175,0,0)">1D</span><span style="color: rgb(175,0,0)">&#34;</span>)

<span class="ansi-red-intense-fg ansi-bold">NameError</span>: name &#39;pd&#39; is not defined
</pre></div></div>
</div>
<p>And here is what it looks like spliced instead of merged.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ========================================</span>
<span class="c1"># 2️⃣ Using `ts_merge()` with Prioritization</span>
<span class="c1"># ========================================</span>
<span class="n">merged_series</span> <span class="o">=</span> <span class="n">ts_merge</span><span class="p">((</span><span class="n">series1</span><span class="p">,</span> <span class="n">series2</span><span class="p">,</span> <span class="n">series3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Merged Series with Prioritization:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">merged_series</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Merged Series with Prioritization:
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2022-12-31    1000.0
2023-01-01       1.0
2023-01-02       2.0
2023-01-03       3.0
2023-01-04       4.0
2023-01-05       5.0
2023-01-06       6.0
2023-01-07       7.0
2023-01-08       8.0
2023-01-09       9.0
2023-01-10      10.0
2023-01-11       3.0
2023-01-12       4.0
2023-01-13    1007.0
Freq: D, Name: A, dtype: float64
</pre></div></div>
</div>
</section>
<section id="Splicing">
<h2>Splicing<a class="headerlink" href="#Splicing" title="Link to this heading">¶</a></h2>
<p>Splicing marches through the prioritized list of input time series and exclusively uses values for the higher priority series one during the entire span of that series.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spliced_series</span> <span class="o">=</span> <span class="n">ts_splice</span><span class="p">((</span><span class="n">series1</span><span class="p">,</span> <span class="n">series2</span><span class="p">,</span> <span class="n">series3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Spliced Series with Prioritization and default `prefer last`:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">spliced_series</span><span class="p">)</span>
<span class="n">spliced_first</span> <span class="o">=</span> <span class="n">ts_splice</span><span class="p">((</span><span class="n">series1</span><span class="p">,</span> <span class="n">series2</span><span class="p">,</span> <span class="n">series3</span><span class="p">),</span><span class="n">transition</span><span class="o">=</span><span class="s2">&quot;prefer_first&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Spliced Series with Prioritization, Prefer first:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">spliced_first</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Spliced Series with Prioritization:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2022-12-31    1000.0
2023-01-01    1001.0
2023-01-02    1002.0
2023-01-03       NaN
2023-01-04    1004.0
2023-01-05       NaN
2023-01-06       NaN
2023-01-07    1007.0
2023-01-08       NaN
2023-01-09       NaN
2023-01-10       NaN
2023-01-11    1005.0
2023-01-12    1006.0
2023-01-13    1007.0
Freq: D, Name: A, dtype: float64
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Spliced Series with Prioritization, Prefer first:
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-01-01       1.0
2023-01-02       NaN
2023-01-03       3.0
2023-01-04       NaN
2023-01-05       5.0
2023-01-06       6.0
2023-01-07       NaN
2023-01-08       8.0
2023-01-09       9.0
2023-01-10      10.0
2023-01-11       3.0
2023-01-12       4.0
2023-01-13    1007.0
Freq: D, Name: A, dtype: float64
</pre></div></div>
</div>
</section>
<section id="Irregular-series">
<h2>Irregular series<a class="headerlink" href="#Irregular-series" title="Link to this heading">¶</a></h2>
<p>Now we will look at some irregular series and see the difference in output from ts_merge (which shuffles) and ts_splice (which exclusively uses values from one series at a time based on the span of the series and its priority)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><br/><span></span><span class="c1"># ========================================</span>
<span class="c1"># 3️⃣ Creating Irregular Time Series (No Freq Attribute)</span>
<span class="c1"># ========================================</span>
<span class="n">idx_irreg1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-01-03&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-01-07&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-01-10&quot;</span><span class="p">])</span>
<span class="n">idx_irreg2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="s2">&quot;2023-01-02&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-01-04&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-01-08&quot;</span><span class="p">,</span> <span class="s2">&quot;2023-01-11&quot;</span><span class="p">])</span>

<span class="n">series_irreg1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx_irreg1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="n">series_irreg2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx_irreg2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Irregular Series 1:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">series_irreg1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Irregular Series 2:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">series_irreg2</span><span class="p">)</span>

<span class="c1"># ========================================</span>
<span class="c1"># 4️⃣ Using `ts_merge()` with Irregular Time Series</span>
<span class="c1"># ========================================</span>
<span class="n">merged_irregular</span> <span class="o">=</span> <span class="n">ts_merge</span><span class="p">((</span><span class="n">series_irreg1</span><span class="p">,</span> <span class="n">series_irreg2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Merged Irregular Series (May Shuffle Timestamps):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">merged_irregular</span><span class="p">)</span>

<span class="c1"># ========================================</span>
<span class="c1"># 5️⃣ Using `ts_splice()` with Irregular Time Series</span>
<span class="c1"># ========================================</span>
<span class="n">spliced_irregular</span> <span class="o">=</span> <span class="n">ts_splice</span><span class="p">((</span><span class="n">series_irreg1</span><span class="p">,</span> <span class="n">series_irreg2</span><span class="p">),</span> <span class="n">transition</span><span class="o">=</span><span class="s2">&quot;prefer_last&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Spliced Irregular Series (prefer_last):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">spliced_irregular</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Irregular Series 1:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-01-01    1.0
2023-01-03    NaN
2023-01-07    3.0
2023-01-10    4.0
Name: A, dtype: float64
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Irregular Series 2:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-01-02    10.0
2023-01-04    20.0
2023-01-08     NaN
2023-01-11    40.0
Name: A, dtype: float64
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Merged Irregular Series (May Shuffle Timestamps):
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-01-01     1.0
2023-01-02    10.0
2023-01-03     NaN
2023-01-04    20.0
2023-01-07     3.0
2023-01-08     NaN
2023-01-10     4.0
2023-01-11    40.0
Name: A, dtype: float64
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Spliced Irregular Series (prefer_last):
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-01-01     1.0
2023-01-02    10.0
2023-01-04    20.0
2023-01-08     NaN
2023-01-11    40.0
Name: A, dtype: float64
</pre></div></div>
</div>
</section>
<section id="Names-argument">
<h2><code class="docutils literal notranslate"><span class="pre">Names</span></code> argument<a class="headerlink" href="#Names-argument" title="Link to this heading">¶</a></h2>
<p>Finally let’s look at some more intricate examples with mixed series and dataframes with differing numbers of columns and see how <code class="docutils literal notranslate"><span class="pre">names</span></code> can be used to make selections or unify poorly coordinated labels. Here are the series:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">vtools</span> <span class="kn">import</span> <span class="n">ts_merge</span><span class="p">,</span> <span class="n">ts_splice</span>  <span class="c1"># Assuming these functions are in merge.py</span>

<span class="c1"># Create irregular time series</span>
<span class="n">idx1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">)</span>
<span class="n">idx2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2023-01-02&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;2D&quot;</span><span class="p">)</span>

<span class="n">series1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="n">series2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>

<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="n">idx1</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="n">idx2</span><span class="p">)</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">310</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">340</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
                    <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
                    <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3100</span><span class="p">,</span> <span class="mi">3200</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3400</span><span class="p">,</span> <span class="mi">3500</span><span class="p">]</span>
                    <span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">idx2</span><span class="p">)</span>

<span class="c1"># Display Data</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Series 1:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">series1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Series 2:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">series2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DataFrame 1:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DataFrame 2:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DataFrame 3:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Series 1:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-01-01    1.0
2023-01-03    NaN
2023-01-05    3.0
2023-01-07    4.0
2023-01-09    5.0
Freq: 2D, Name: A, dtype: float64
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Series 2:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-01-02    10.0
2023-01-04    20.0
2023-01-06    30.0
2023-01-08     NaN
2023-01-10    50.0
Freq: 2D, Name: B, dtype: float64
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame 1:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2023-01-01</th>
      <td>1.0</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2023-01-03</th>
      <td>NaN</td>
      <td>20</td>
    </tr>
    <tr>
      <th>2023-01-05</th>
      <td>3.0</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2023-01-07</th>
      <td>4.0</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2023-01-09</th>
      <td>5.0</td>
      <td>50</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame 2:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2023-01-02</th>
      <td>10.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2023-01-04</th>
      <td>20.0</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>2023-01-06</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2023-01-08</th>
      <td>40.0</td>
      <td>400.0</td>
    </tr>
    <tr>
      <th>2023-01-10</th>
      <td>50.0</td>
      <td>500.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DataFrame 3:
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2023-01-02</th>
      <td>310.0</td>
      <td>100.0</td>
      <td>3100.0</td>
    </tr>
    <tr>
      <th>2023-01-04</th>
      <td>320.0</td>
      <td>200.0</td>
      <td>3200.0</td>
    </tr>
    <tr>
      <th>2023-01-06</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2023-01-08</th>
      <td>340.0</td>
      <td>400.0</td>
      <td>3400.0</td>
    </tr>
    <tr>
      <th>2023-01-10</th>
      <td>NaN</td>
      <td>500.0</td>
      <td>3500.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Here are some example usage:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example: Using `names` to rename output columns</span>

<span class="c1"># Merging without a rename</span>
<span class="n">merged_series_named</span> <span class="o">=</span> <span class="n">ts_merge</span><span class="p">((</span><span class="n">series1</span><span class="p">,</span> <span class="n">series2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Merged Series not renamed:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">merged_series_named</span><span class="p">)</span>

<span class="c1"># Rename a single column</span>
<span class="n">merged_series_named</span> <span class="o">=</span> <span class="n">ts_merge</span><span class="p">((</span><span class="n">series1</span><span class="p">,</span> <span class="n">series2</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="s2">&quot;Renamed_A&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Merged Series renamed:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">merged_series_named</span><span class="p">)</span>

<span class="c1"># Select specific columns in DataFrame</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">merged_df_named</span> <span class="o">=</span> <span class="n">ts_merge</span><span class="p">((</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Merged DataFrame without Selected Columns (names=None) results in an error if the columns don&#39;t match&quot;</span><span class="p">)</span>
<span class="c1">#display(merged_df_named)</span>

<span class="c1"># Select specific columns in DataFrame</span>
<span class="n">merged_df_named</span> <span class="o">=</span> <span class="n">ts_merge</span><span class="p">((</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Merged DataFrame without selected columns (names=None) for input DataFrames with matched columns:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">merged_df_named</span><span class="p">)</span>


<span class="c1"># Select specific columns in DataFrame</span>
<span class="n">merged_df_named</span> <span class="o">=</span> <span class="n">ts_merge</span><span class="p">((</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Merged DataFrame with Selected Columns A merges that column ([A,B] would have been OK too)&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">merged_df_named</span><span class="p">)</span>


<span class="c1"># Rename column in splicing</span>
<span class="n">spliced_series_named</span> <span class="o">=</span> <span class="n">ts_splice</span><span class="p">((</span><span class="n">series1</span><span class="p">,</span> <span class="n">series2</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="s2">&quot;Renamed_A&quot;</span><span class="p">,</span> <span class="n">transition</span><span class="o">=</span><span class="s2">&quot;prefer_last&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Spliced Series with Renamed Column:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">spliced_series_named</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Merged Series not renamed:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-01-01     1.0
2023-01-02     2.0
2023-01-03     3.0
2023-01-04     4.0
2023-01-05     5.0
2023-01-06     6.0
2023-01-07     7.0
2023-01-08     8.0
2023-01-09     9.0
2023-01-10    10.0
2023-01-11     3.0
2023-01-12     4.0
Freq: D, Name: A, dtype: float64
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Merged Series renamed:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-01-01     1.0
2023-01-02     2.0
2023-01-03     3.0
2023-01-04     4.0
2023-01-05     5.0
2023-01-06     6.0
2023-01-07     7.0
2023-01-08     8.0
2023-01-09     9.0
2023-01-10    10.0
2023-01-11     3.0
2023-01-12     4.0
Freq: D, Name: Renamed_A, dtype: float64
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Merged DataFrame without Selected Columns (names=None) results in an error if the columns don&#39;t match
Merged DataFrame without selected columns (names=None) for input DataFrames with matched columns:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2023-01-01</th>
      <td>1.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>2023-01-02</th>
      <td>10.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>2023-01-03</th>
      <td>NaN</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2023-01-04</th>
      <td>20.0</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>2023-01-05</th>
      <td>3.0</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>2023-01-06</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2023-01-07</th>
      <td>4.0</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>2023-01-08</th>
      <td>40.0</td>
      <td>400.0</td>
    </tr>
    <tr>
      <th>2023-01-09</th>
      <td>5.0</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>2023-01-10</th>
      <td>50.0</td>
      <td>500.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Merged DataFrame with Selected Columns A merges that column ([A,B] would have been OK too)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2023-01-01</th>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2023-01-02</th>
      <td>10.0</td>
    </tr>
    <tr>
      <th>2023-01-03</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2023-01-04</th>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2023-01-05</th>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2023-01-06</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2023-01-07</th>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2023-01-08</th>
      <td>40.0</td>
    </tr>
    <tr>
      <th>2023-01-09</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2023-01-10</th>
      <td>50.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Spliced Series with Renamed Column:
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2023-01-01    1.0
2023-01-02    2.0
2023-01-03    NaN
2023-01-04    4.0
2023-01-05    NaN
2023-01-06    NaN
2023-01-07    7.0
2023-01-08    NaN
2023-01-09    NaN
2023-01-10    NaN
2023-01-11    3.0
2023-01-12    4.0
Freq: D, Name: Renamed_A, dtype: float64
</pre></div></div>
</div>
</section>
<section id="Summary">
<h2>Summary<a class="headerlink" href="#Summary" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><strong>Use ``ts_merge``</strong> when you want to blend time series together, filling missing values in order of priority.</p></li>
<li><p><strong>Use ``ts_splice``</strong> when you want to keep each time series separate and transition from one to another based on time.</p></li>
<li><p><strong>The ``names`` argument</strong> allows you to rename output columns or select specific columns when merging/splicing DataFrames.</p></li>
</ul>
<p>This notebook provides a clear comparison to help you decide which method best suits your use case.</p>
</section>
</section>
<section id="ts_merge:-strict-priority-option">
<h1><code class="docutils literal notranslate"><span class="pre">ts_merge</span></code>: strict priority option<a class="headerlink" href="#ts_merge:-strict-priority-option" title="Link to this heading">¶</a></h1>
<p><strong>New option</strong>: <code class="docutils literal notranslate"><span class="pre">strict_priority</span></code> (default <code class="docutils literal notranslate"><span class="pre">False</span></code>) enforces that a higher‑priority series dominates between its <code class="docutils literal notranslate"><span class="pre">first_valid_index</span></code> and <code class="docutils literal notranslate"><span class="pre">last_valid_index</span></code>.</p>
<p><strong>Semantics</strong> - Per <strong>column</strong>, define the dominance window as <code class="docutils literal notranslate"><span class="pre">[first_valid_index,</span> <span class="pre">last_valid_index]</span></code>. - Within that window, lower‑priority series are <strong>masked</strong>, even if the higher‑priority value is <code class="docutils literal notranslate"><span class="pre">NaN</span></code>. - Outside those windows, merging is unchanged and lower priority may contribute. - With irregular inputs, timestamps that exist <strong>only</strong> in lower‑priority series <strong>and</strong> are fully masked inside a dominance window are dropped; timestamps from the top series’ index are preserved even if
all‑<code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
<p><strong>``names`` behavior</strong> is unchanged. ### Example 1 — Series with interior <code class="docutils literal notranslate"><span class="pre">NaN</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">vtools.functions.merge</span> <span class="kn">import</span> <span class="n">ts_merge</span>

<span class="n">idx1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
<span class="n">idx2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2023-01-03&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>

<span class="n">ts_merge</span><span class="p">((</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">))</span>                      <span class="c1"># default</span>
<span class="n">ts_merge</span><span class="p">((</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">),</span> <span class="n">strict_priority</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">idx1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
<span class="n">idx2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2023-01-03&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:[</span><span class="mf">1.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="n">idx1</span><span class="p">)</span>
<span class="n">df1</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span>
<span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>  <span class="c1"># interior NaN in high‑priority B</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:[</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="n">idx2</span><span class="p">)</span>
<span class="n">df2</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span>

<span class="n">ts_merge</span><span class="p">((</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">),</span> <span class="n">strict_priority</span><span class="o">=</span><span class="kc">True</span><span class="p">)[[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">idx1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span><span class="s2">&quot;2023-01-03&quot;</span><span class="p">,</span><span class="s2">&quot;2023-01-07&quot;</span><span class="p">,</span><span class="s2">&quot;2023-01-10&quot;</span><span class="p">])</span>
<span class="n">idx2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="s2">&quot;2023-01-02&quot;</span><span class="p">,</span><span class="s2">&quot;2023-01-04&quot;</span><span class="p">,</span><span class="s2">&quot;2023-01-08&quot;</span><span class="p">,</span><span class="s2">&quot;2023-01-11&quot;</span><span class="p">])</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">4.</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">10.</span><span class="p">,</span><span class="mf">20.</span><span class="p">,</span><span class="mf">30.</span><span class="p">,</span><span class="mf">40.</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>

<span class="n">ts_merge</span><span class="p">((</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">),</span> <span class="n">strict_priority</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">vtools.functions.merge</span> <span class="kn">import</span> <span class="n">ts_merge</span>

<span class="c1"># Example 1</span>
<span class="n">idx1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
<span class="n">idx2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2023-01-03&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Example 1 strict=False:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ts_merge</span><span class="p">((</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Example 1 strict=True:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ts_merge</span><span class="p">((</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">),</span> <span class="n">strict_priority</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="c1"># Example 2</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:[</span><span class="mf">1.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="n">idx1</span><span class="p">)</span>
<span class="n">df1</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">];</span> <span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:[</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="n">idx2</span><span class="p">)</span>
<span class="n">df2</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Example 2 strict=True:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ts_merge</span><span class="p">((</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">),</span> <span class="n">strict_priority</span><span class="o">=</span><span class="kc">True</span><span class="p">)[[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">]])</span>

<span class="c1"># Example 3</span>
<span class="n">idx1i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">,</span><span class="s2">&quot;2023-01-03&quot;</span><span class="p">,</span><span class="s2">&quot;2023-01-07&quot;</span><span class="p">,</span><span class="s2">&quot;2023-01-10&quot;</span><span class="p">])</span>
<span class="n">idx2i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="s2">&quot;2023-01-02&quot;</span><span class="p">,</span><span class="s2">&quot;2023-01-04&quot;</span><span class="p">,</span><span class="s2">&quot;2023-01-08&quot;</span><span class="p">,</span><span class="s2">&quot;2023-01-11&quot;</span><span class="p">])</span>
<span class="n">s1i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">4.</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx1i</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="n">s2i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">10.</span><span class="p">,</span><span class="mf">20.</span><span class="p">,</span><span class="mf">30.</span><span class="p">,</span><span class="mf">40.</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">idx2i</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Example 3 strict=True:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ts_merge</span><span class="p">((</span><span class="n">s1i</span><span class="p">,</span> <span class="n">s2i</span><span class="p">),</span> <span class="n">strict_priority</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<br/></pre></div>
</div>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2019, California Department of Water Resources.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/notebooks/merge_splice.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>