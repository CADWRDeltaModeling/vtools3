
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>vtools.functions package &#8212; vtools 3.6.6+1.g092ced5.dirty documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing" href="contributing.html" />
    <link rel="prev" title="vtools.datastore package" href="vtools.datastore.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.png" border="0" alt="py4sci"/></a>
</div>



      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/dwrsmall.jpg" alt="Logo"/>
            </a></p>
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/dwrsmall.jpg" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Introduction and concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolation.html">Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/filters.html">Averging, Filtering and Low Passing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/filters.html#Filters">Filters</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="vtools.html">vtools package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">vtools</a><ul>
  <li><a href="vtools.html">vtools package</a><ul>
      <li>Previous: <a href="vtools.datastore.html" title="previous chapter">vtools.datastore package</a></li>
      <li>Next: <a href="contributing.html" title="next chapter">Contributing</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="vtools-functions-package">
<h1>vtools.functions package<a class="headerlink" href="#vtools-functions-package" title="Permalink to this heading">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</div>
<div class="section" id="module-vtools.functions.climatology">
<span id="vtools-functions-climatology-module"></span><h2>vtools.functions.climatology module<a class="headerlink" href="#module-vtools.functions.climatology" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.climatology.apply_climatology">
<span class="sig-name descname"><span class="pre">apply_climatology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">climate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/climatology.html#apply_climatology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.climatology.apply_climatology" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply daily or monthly climatology to a new index</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>climate: DataFrame with integer index representing month of year (Jan=1) or day of year. Must be of size 12 365,366. Day 366 will be inferred from day 365 value</strong></dt><dd></dd>
<dt><strong>index: DatetimeIndex representing locations to be inferred</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>DataFrame or Series as given by climate with values extracted from climatology for the month or day</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.climatology.climatology">
<span class="sig-name descname"><span class="pre">climatology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsmooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/climatology.html#climatology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.climatology.climatology" title="Permalink to this definition">¶</a></dt>
<dd><p>” Create a climatology on the columns of ts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts: DataFrame or Series</strong></dt><dd></dd>
<dt><strong>DataStructure to be analyzed. Must have a length of at least 2*freq</strong></dt><dd></dd>
<dt><strong>freq: period [“day”,”month”]</strong></dt><dd></dd>
<dt><strong>Period over which the climatology is analyzed</strong></dt><dd></dd>
<dt><strong>nsmooth: int</strong></dt><dd><p>window size (number of values) of pre-smoothing. This may not make sense for series that are not approximately regular.</p>
</dd>
<dt><strong>Returns:</strong></dt><dd><p>out: DataFrame or Series
Data structure of the same type as ts, with Integer index representing month (Jan=1) or day of year (1:365).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.climatology.climatology_quantiles">
<span class="sig-name descname"><span class="pre">climatology_quantiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_day_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_day_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.05,</span> <span class="pre">0.25,</span> <span class="pre">0.5,</span> <span class="pre">0.75,</span> <span class="pre">0.95]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/climatology.html#climatology_quantiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.climatology.climatology_quantiles" title="Permalink to this definition">¶</a></dt>
<dd><p>” Create windowed quantiles across years on a time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts: DataFrame or Series</strong></dt><dd></dd>
<dt><strong>DataStructure to be analyzed.</strong></dt><dd></dd>
<dt><strong>min_day_year: int</strong></dt><dd></dd>
<dt><strong>Minimum Julian day to be considered</strong></dt><dd></dd>
<dt><strong>freq: period [“day”,”month”]</strong></dt><dd></dd>
<dt><strong>Maximum Julian day to be considered</strong></dt><dd></dd>
<dt><strong>window_width: int</strong></dt><dd></dd>
<dt><strong>Number of days to include, including the central day and days on each side. So for instance window_width=15 would span the central date and 7 days on each side</strong></dt><dd></dd>
<dt><strong>quantiles: array-like</strong></dt><dd><p>quantiles requested</p>
</dd>
<dt><strong>Returns:</strong></dt><dd><p>out: DataFrame or Series
Data structure with Julian day as the index and quantiles as columns.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-vtools.functions.error_detect">
<span id="vtools-functions-error-detect-module"></span><h2>vtools.functions.error_detect module<a class="headerlink" href="#module-vtools.functions.error_detect" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect._nrepeat">
<span class="sig-name descname"><span class="pre">_nrepeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#_nrepeat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect._nrepeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Series-only version</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.despike">
<span class="sig-name descname"><span class="pre">despike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#despike"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.despike" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.example">
<span class="sig-name descname"><span class="pre">example</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#example"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.example" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.example2">
<span class="sig-name descname"><span class="pre">example2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#example2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.example2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.med_outliers">
<span class="sig-name descname"><span class="pre">med_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.01,</span> <span class="pre">0.99)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_anomaly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#med_outliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.med_outliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect outliers by running a median filter, subtracting it
from the original series and comparing the resulting residuals
to a global robust range of scale (the interquartile range).
Individual time points are rejected if the residual at that time point is more than level times the range of scale.</p>
<p>The original concept comes from Basu &amp; Meckesheimer (2007)
Automatic outlier detection for time series: an application to sensor data
although they didn’t use the interquartile range but rather
expert judgment. To use this function effectively, you need to
be thoughtful about what the interquartile range will be. For instance,
for a strongly tidal flow station it is likely to</p>
<dl class="simple">
<dt>level: Number of times the scale or interquantile range the data has to be</dt><dd><p>to be rejected.d</p>
</dd>
<dt>scale: Expert judgment of the scale of maximum variation over a time step.</dt><dd><p>If None, the interquartile range will be used. Note that for a 
strongly tidal station the interquartile range may substantially overestimate the reasonable variation over a single time step, in which case the filter will work fine, but level should be set to 
a number (less than one) accordingly.</p>
</dd>
</dl>
<p>filt_len: length of median filter, default is 5</p>
<dl class="simple">
<dt>quantiles<span class="classifier">tuple of quantiles defining the measure of scale. Ignored</span></dt><dd><p>if scale is given directly. Default is interquartile range, and
this is almost always a reasonable choice.</p>
</dd>
</dl>
<p>copy: if True, a copy is made leaving original series intact</p>
<p>You can also specify rejection of  values based on a simple range</p>
<p>Returns: copy of series with outliers replaced by nan</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.med_outliers2">
<span class="sig-name descname"><span class="pre">med_outliers2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secfilt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(25,</span> <span class="pre">75)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seclevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secfilt_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">241</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secquantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(25,</span> <span class="pre">75)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#med_outliers2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.med_outliers2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.median_test">
<span class="sig-name descname"><span class="pre">median_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.005,</span> <span class="pre">0.095)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#median_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.median_test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.nrepeat">
<span class="sig-name descname"><span class="pre">nrepeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#nrepeat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.nrepeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the length of consecutive runs of repeated values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts:  DataFrame or series</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>Like-indexed series with lengths of runs. Nans will be mapped to 0</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.rolling_window">
<span class="sig-name descname"><span class="pre">rolling_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#rolling_window"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.rolling_window" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.steep_then_nan">
<span class="sig-name descname"><span class="pre">steep_then_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.01,</span> <span class="pre">0.99)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_anomaly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#steep_then_nan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.steep_then_nan" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect outliers by running a median filter, subtracting it
from the original series and comparing the resulting residuals
to a global robust range of scale (the interquartile range).
Individual time points are rejected if the residual at that time point is more than level times the range of scale.</p>
<p>The original concept comes from Basu &amp; Meckesheimer (2007)
although they didn’t use the interquartile range but rather
expert judgment. To use this function effectively, you need to
be thoughtful about what the interquartile range will be. For instance,
for a strongly tidal flow station it is likely to</p>
<dl class="simple">
<dt>level: Number of times the scale or interquantile range the data has to be</dt><dd><p>to be rejected.d</p>
</dd>
<dt>scale: Expert judgment of the scale of maximum variation over a time step.</dt><dd><p>If None, the interquartile range will be used. Note that for a 
strongly tidal station the interquartile range may substantially overestimate the reasonable variation over a single time step, in which case the filter will work fine, but level should be set to 
a number (less than one) accordingly.</p>
</dd>
</dl>
<p>filt_len: length of median filter, default is 5</p>
<dl class="simple">
<dt>quantiles<span class="classifier">tuple of quantiles defining the measure of scale. Ignored</span></dt><dd><p>if scale is given directly. Default is interquartile range, and
this is almost always a reasonable choice.</p>
</dd>
</dl>
<p>copy: if True, a copy is made leaving original series intact</p>
<p>You can also specify rejection of  values based on a simple range</p>
<p>Returns: copy of series with outliers replaced by nan</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.threshold">
<span class="sig-name descname"><span class="pre">threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#threshold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.threshold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtools.functions.example2">
<span id="vtools-functions-example2-module"></span><h2>vtools.functions.example2 module<a class="headerlink" href="#module-vtools.functions.example2" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.example2.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/example2.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.example2.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtools.functions.filter">
<span id="vtools-functions-filter-module"></span><h2>vtools.functions.filter module<a class="headerlink" href="#module-vtools.functions.filter" title="Permalink to this heading">¶</a></h2>
<p>Module contains filter used in tidal time series analysis.</p>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter._gf1d">
<span class="sig-name descname"><span class="pre">_gf1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#_gf1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter._gf1d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.butter">
<span class="sig-name descname"><span class="pre">butter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Wn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">btype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'low'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ba'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/filter_design.html#butter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.butter" title="Permalink to this definition">¶</a></dt>
<dd><p>Butterworth digital and analog filter design.</p>
<p>Design an Nth-order digital or analog Butterworth filter and return
the filter coefficients.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>N</strong><span class="classifier">int</span></dt><dd><p>The order of the filter.</p>
</dd>
<dt><strong>Wn</strong><span class="classifier">array_like</span></dt><dd><p>The critical frequency or frequencies. For lowpass and highpass
filters, Wn is a scalar; for bandpass and bandstop filters,
Wn is a length-2 sequence.</p>
<p>For a Butterworth filter, this is the point at which the gain
drops to 1/sqrt(2) that of the passband (the “-3 dB point”).</p>
<p>For digital filters, <cite>Wn</cite> are in the same units as <cite>fs</cite>.  By default,
<cite>fs</cite> is 2 half-cycles/sample, so these are normalized from 0 to 1,
where 1 is the Nyquist frequency. (<cite>Wn</cite> is thus in
half-cycles / sample.)</p>
<p>For analog filters, <cite>Wn</cite> is an angular frequency (e.g. rad/s).</p>
</dd>
<dt><strong>btype</strong><span class="classifier">{‘lowpass’, ‘highpass’, ‘bandpass’, ‘bandstop’}, optional</span></dt><dd><p>The type of filter.  Default is ‘lowpass’.</p>
</dd>
<dt><strong>analog</strong><span class="classifier">bool, optional</span></dt><dd><p>When True, return an analog filter, otherwise a digital filter is
returned.</p>
</dd>
<dt><strong>output</strong><span class="classifier">{‘ba’, ‘zpk’, ‘sos’}, optional</span></dt><dd><p>Type of output:  numerator/denominator (‘ba’), pole-zero (‘zpk’), or
second-order sections (‘sos’). Default is ‘ba’ for backwards
compatibility, but ‘sos’ should be used for general-purpose filtering.</p>
</dd>
<dt><strong>fs</strong><span class="classifier">float, optional</span></dt><dd><p>The sampling frequency of the digital system.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.0.</span></p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>b, a</strong><span class="classifier">ndarray, ndarray</span></dt><dd><p>Numerator (<cite>b</cite>) and denominator (<cite>a</cite>) polynomials of the IIR filter.
Only returned if <code class="docutils literal notranslate"><span class="pre">output='ba'</span></code>.</p>
</dd>
<dt><strong>z, p, k</strong><span class="classifier">ndarray, ndarray, float</span></dt><dd><p>Zeros, poles, and system gain of the IIR filter transfer
function.  Only returned if <code class="docutils literal notranslate"><span class="pre">output='zpk'</span></code>.</p>
</dd>
<dt><strong>sos</strong><span class="classifier">ndarray</span></dt><dd><p>Second-order sections representation of the IIR filter.
Only returned if <code class="docutils literal notranslate"><span class="pre">output=='sos'</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">buttord</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">buttap</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The Butterworth filter has maximally flat frequency response in the
passband.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'sos'</span></code> output parameter was added in 0.16.0.</p>
<p>If the transfer function form <code class="docutils literal notranslate"><span class="pre">[b,</span> <span class="pre">a]</span></code> is requested, numerical
problems can occur since the conversion between roots and
the polynomial coefficients is a numerically sensitive operation,
even for N &gt;= 4. It is recommended to work with the SOS
representation.</p>
<p class="rubric">Examples</p>
<p>Design an analog filter and plot its frequency response, showing the
critical points:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Butterworth filter frequency response&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [radians / second]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude [dB]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span> <span class="c1"># cutoff frequency</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Generate a signal made up of 10 Hz and 20 Hz, sampled at 1 kHz</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># 1 second</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">20</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;10 Hz and 20 Hz sinusoids&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Design a digital high-pass filter at 15 Hz to remove the 10 Hz tone, and
apply it to the signal. (It’s recommended to use second-order sections
format when filtering, to avoid numerical error with transfer function
(<code class="docutils literal notranslate"><span class="pre">ba</span></code>) format):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;hp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">filtered</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;After 15 Hz high-pass filter&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [seconds]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.butterworth">
<span class="sig-name descname"><span class="pre">butterworth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#butterworth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.butterworth" title="Permalink to this definition">¶</a></dt>
<dd><p>low-pass butterworth-squared filter on a regular time series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>Must be one or two dimensional, and regular.</p>
</dd>
<dt><strong>order: int ,optional</strong></dt><dd><p>The default is 4.</p>
</dd>
<dt><strong>cutoff_frequency: float,optional</strong></dt><dd><p>Cutoff frequency expressed as a ratio with Nyquist frequency,
should within the range (0,1). For a discretely sampled system,
the Nyquist frequency is the fastest frequency that can be resolved by that 
sampling, which is half the sampling frequency. For example, if the sampling frequency
is 1 sample/1 hour, the Nyquist frequency is 1 sample/2 hours. If we want a
36 hour cutoff period, the frequency is 1/36 or 0.0278 cycles per hour. 
Hence the cutoff frequency argument used here would be
0.0278/0.5 = 0.056.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">string  or  _time_interval</span></dt><dd><p>Period corresponding to cutoff frequency. If input as a string, it must 
be  convertible to a regular interval using the same rules as a pandas frequency..
cutoff_frequency and cutoff_period can’t be specified at the same time.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>result</strong><span class="classifier"></span></dt><dd><p>A new regular time series with the same interval as ts.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If input order is not even, or input timeseries is not regular, 
or neither cutoff_period and cutoff_frequency is given while input
time series interval is not 15min or 1 hour, or  cutoff_period and cutoff_frequency 
are given at the same time.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.convert_span_to_nstep">
<span class="sig-name descname"><span class="pre">convert_span_to_nstep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#convert_span_to_nstep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.convert_span_to_nstep" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.cosine_lanczos">
<span class="sig-name descname"><span class="pre">cosine_lanczos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#cosine_lanczos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.cosine_lanczos" title="Permalink to this definition">¶</a></dt>
<dd><p>squared low-pass cosine lanczos  filter on a regular time series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd></dd>
<dt><strong>filter_len</strong><span class="classifier">int, time_interval</span></dt><dd><p>Size of lanczos window, default is to number of samples within filter_period*1.25.</p>
</dd>
<dt><strong>cutoff_frequency: float,optional</strong></dt><dd><p>Cutoff frequency expressed as a ratio of a Nyquist frequency,
should within the range (0,1). For example, if the sampling frequency
is 1 hour, the Nyquist frequency is 1 sample/2 hours. If we want a
36 hour cutoff period, the frequency is 1/36 or 0.0278 cycles per hour. 
Hence the cutoff frequency argument used here would be
0.0278/0.5 = 0.056.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">string  or  _time_interval</span></dt><dd><blockquote>
<div><p>Period of cutting off frequency. If input as a string, it must 
be  convertible to a _time_interval (Pandas freq).
cutoff_frequency and cutoff_period can’t be specified at the same time.</p>
</div></blockquote>
<dl class="simple">
<dt>padtype<span class="classifier">str or None, optional</span></dt><dd><p>Must be ‘odd’, ‘even’, ‘constant’, or None. This determines the type
of extension to use for the padded signal to which the filter is applied. 
If padtype is None, no padding is used. The default is None.</p>
</dd>
<dt>padlen<span class="classifier">int or None, optional</span></dt><dd><p>The number of elements by which to extend x at both ends of axis 
before applying the filter. This value must be less than x.shape[axis]-1. 
padlen=0 implies no padding. If padtye is not None and padlen is not
given, padlen is be set to 6*m.</p>
</dd>
<dt>fill_edge_nan: bool,optional</dt><dd><p>If pading is not used and fill_edge_nan is true, resulting data on 
the both ends are filled with nan to account for edge effect. This is
2*m on the either end of the result. Default is true.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></span></dt><dd><p>A new regular time series with the same interval of ts. If no pading 
is used the beigning and ending 4*m resulting data will be set to nan
to remove edge effect.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If input timeseries is not regular, 
or, cutoff_period and cutoff_frequency are given at the same time,
or, neither cutoff_period nor curoff_frequence is given,
or, padtype is not “odd”,”even”,”constant”,or None,
or, padlen is larger than data size</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.filtfilt">
<span class="sig-name descname"><span class="pre">filtfilt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'odd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pad'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/signaltools.html#filtfilt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.filtfilt" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a digital filter forward and backward to a signal.</p>
<p>This function applies a linear digital filter twice, once forward and
once backwards.  The combined filter has zero phase and a filter order
twice that of the original.</p>
<p>The function provides options for handling the edges of the signal.</p>
<p>The function <cite>sosfiltfilt</cite> (and filter design using <code class="docutils literal notranslate"><span class="pre">output='sos'</span></code>)
should be preferred over <cite>filtfilt</cite> for most filtering tasks, as
second-order sections have fewer numerical problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>b</strong><span class="classifier">(N,) array_like</span></dt><dd><p>The numerator coefficient vector of the filter.</p>
</dd>
<dt><strong>a</strong><span class="classifier">(N,) array_like</span></dt><dd><p>The denominator coefficient vector of the filter.  If <code class="docutils literal notranslate"><span class="pre">a[0]</span></code>
is not 1, then both <cite>a</cite> and <cite>b</cite> are normalized by <code class="docutils literal notranslate"><span class="pre">a[0]</span></code>.</p>
</dd>
<dt><strong>x</strong><span class="classifier">array_like</span></dt><dd><p>The array of data to be filtered.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>The axis of <cite>x</cite> to which the filter is applied.
Default is -1.</p>
</dd>
<dt><strong>padtype</strong><span class="classifier">str or None, optional</span></dt><dd><p>Must be ‘odd’, ‘even’, ‘constant’, or None.  This determines the
type of extension to use for the padded signal to which the filter
is applied.  If <cite>padtype</cite> is None, no padding is used.  The default
is ‘odd’.</p>
</dd>
<dt><strong>padlen</strong><span class="classifier">int or None, optional</span></dt><dd><p>The number of elements by which to extend <cite>x</cite> at both ends of
<cite>axis</cite> before applying the filter.  This value must be less than
<code class="docutils literal notranslate"><span class="pre">x.shape[axis]</span> <span class="pre">-</span> <span class="pre">1</span></code>.  <code class="docutils literal notranslate"><span class="pre">padlen=0</span></code> implies no padding.
The default value is <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">*</span> <span class="pre">max(len(a),</span> <span class="pre">len(b))</span></code>.</p>
</dd>
<dt><strong>method</strong><span class="classifier">str, optional</span></dt><dd><p>Determines the method for handling the edges of the signal, either
“pad” or “gust”.  When <cite>method</cite> is “pad”, the signal is padded; the
type of padding is determined by <cite>padtype</cite> and <cite>padlen</cite>, and <cite>irlen</cite>
is ignored.  When <cite>method</cite> is “gust”, Gustafsson’s method is used,
and <cite>padtype</cite> and <cite>padlen</cite> are ignored.</p>
</dd>
<dt><strong>irlen</strong><span class="classifier">int or None, optional</span></dt><dd><p>When <cite>method</cite> is “gust”, <cite>irlen</cite> specifies the length of the
impulse response of the filter.  If <cite>irlen</cite> is None, no part
of the impulse response is ignored.  For a long signal, specifying
<cite>irlen</cite> can significantly improve the performance of the filter.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y</strong><span class="classifier">ndarray</span></dt><dd><p>The filtered output with the same shape as <cite>x</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">sosfiltfilt</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">lfilter_zi</span></code>, <a class="reference internal" href="#vtools.functions.filter.lfilter" title="vtools.functions.filter.lfilter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lfilter</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">lfiltic</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">savgol_filter</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">sosfilt</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>When <cite>method</cite> is “pad”, the function pads the data along the given axis
in one of three ways: odd, even or constant.  The odd and even extensions
have the corresponding symmetry about the end point of the data.  The
constant extension extends the data with the values at the end points. On
both the forward and backward passes, the initial condition of the
filter is found by using <cite>lfilter_zi</cite> and scaling it by the end point of
the extended data.</p>
<p>When <cite>method</cite> is “gust”, Gustafsson’s method <a class="reference internal" href="#rf9ecd08cd80f-1" id="id1">[1]</a> is used.  Initial
conditions are chosen for the forward and backward passes so that the
forward-backward filter gives the same result as the backward-forward
filter.</p>
<p>The option to use Gustaffson’s method was added in scipy version 0.16.0.</p>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="rf9ecd08cd80f-1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>F. Gustaffson, “Determining the initial states in forward-backward
filtering”, Transactions on Signal Processing, Vol. 46, pp. 988-992,
1996.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>The examples will use several functions from <cite>scipy.signal</cite>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>First we create a one second signal that is the sum of two pure sine
waves, with frequencies 5 Hz and 250 Hz, sampled at 2000 Hz.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">2001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xlow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xhigh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">250</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">xlow</span> <span class="o">+</span> <span class="n">xhigh</span>
</pre></div>
</div>
<p>Now create a lowpass Butterworth filter with a cutoff of 0.125 times
the Nyquist frequency, or 125 Hz, and apply it to <code class="docutils literal notranslate"><span class="pre">x</span></code> with <cite>filtfilt</cite>.
The result should be approximately <code class="docutils literal notranslate"><span class="pre">xlow</span></code>, with no phase shift.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">padlen</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">xlow</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="go">9.1086182074789912e-06</span>
</pre></div>
</div>
<p>We get a fairly clean result for this artificial example because
the odd extension is exact, and with the moderately long padding,
the filter’s transients have dissipated by the time the actual data
is reached.  In general, transient effects at the edges are
unavoidable.</p>
<p>The following example demonstrates the option <code class="docutils literal notranslate"><span class="pre">method=&quot;gust&quot;</span></code>.</p>
<p>First, create a filter.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellip</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">)</span>  <span class="c1"># Filter to be applied.</span>
</pre></div>
</div>
<p><cite>sig</cite> is a random input signal to be filtered.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</pre></div>
</div>
<p>Apply <cite>filtfilt</cite> to <cite>sig</cite>, once using the Gustafsson method, and
once using padding, and plot the results for comparison.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fgust</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;gust&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpad</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">padlen</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fgust</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;gust&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpad</span><span class="p">,</span> <span class="s1">&#39;c-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pad&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The <cite>irlen</cite> argument can be used to improve the performance
of Gustafsson’s method.</p>
<p>Estimate the impulse response length of the filter.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">tf2zpk</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">approx_impulse_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">r</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">approx_impulse_len</span>
<span class="go">137</span>
</pre></div>
</div>
<p>Apply the filter to a longer signal, with and without the <cite>irlen</cite>
argument.  The difference between <cite>y1</cite> and <cite>y2</cite> is small.  For long
signals, using <cite>irlen</cite> gives a significant performance improvement.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">5000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y1</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;gust&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y2</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;gust&#39;</span><span class="p">,</span> <span class="n">irlen</span><span class="o">=</span><span class="n">approx_impulse_len</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)))</span>
<span class="go">1.80056858312e-10</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.firwin">
<span class="sig-name descname"><span class="pre">firwin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">numtaps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hamming'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nyq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/fir_filter_design.html#firwin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.firwin" title="Permalink to this definition">¶</a></dt>
<dd><p>FIR filter design using the window method.</p>
<p>This function computes the coefficients of a finite impulse response
filter. The filter will have linear phase; it will be Type I if
<cite>numtaps</cite> is odd and Type II if <cite>numtaps</cite> is even.</p>
<p>Type II filters always have zero response at the Nyquist frequency, so a
ValueError exception is raised if firwin is called with <cite>numtaps</cite> even and
having a passband whose right end is at the Nyquist frequency.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>numtaps</strong><span class="classifier">int</span></dt><dd><p>Length of the filter (number of coefficients, i.e. the filter
order + 1).  <cite>numtaps</cite> must be odd if a passband includes the
Nyquist frequency.</p>
</dd>
<dt><strong>cutoff</strong><span class="classifier">float or 1-D array_like</span></dt><dd><p>Cutoff frequency of filter (expressed in the same units as <cite>fs</cite>)
OR an array of cutoff frequencies (that is, band edges). In the
latter case, the frequencies in <cite>cutoff</cite> should be positive and
monotonically increasing between 0 and <cite>fs/2</cite>. The values 0 and
<cite>fs/2</cite> must not be included in <cite>cutoff</cite>.</p>
</dd>
<dt><strong>width</strong><span class="classifier">float or None, optional</span></dt><dd><p>If <cite>width</cite> is not None, then assume it is the approximate width
of the transition region (expressed in the same units as <cite>fs</cite>)
for use in Kaiser FIR filter design. In this case, the <cite>window</cite>
argument is ignored.</p>
</dd>
<dt><strong>window</strong><span class="classifier">string or tuple of string and parameter values, optional</span></dt><dd><p>Desired window to use. See <cite>scipy.signal.get_window</cite> for a list
of windows and required parameters.</p>
</dd>
<dt><strong>pass_zero</strong><span class="classifier">{True, False, ‘bandpass’, ‘lowpass’, ‘highpass’, ‘bandstop’}, optional</span></dt><dd><p>If True, the gain at the frequency 0 (i.e., the “DC gain”) is 1.
If False, the DC gain is 0. Can also be a string argument for the
desired filter type (equivalent to <code class="docutils literal notranslate"><span class="pre">btype</span></code> in IIR design functions).</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3.0: </span>Support for string arguments.</p>
</div>
</dd>
<dt><strong>scale</strong><span class="classifier">bool, optional</span></dt><dd><p>Set to True to scale the coefficients so that the frequency
response is exactly unity at a certain frequency.
That frequency is either:</p>
<ul class="simple">
<li><p>0 (DC) if the first passband starts at 0 (i.e. pass_zero
is True)</p></li>
<li><p><cite>fs/2</cite> (the Nyquist frequency) if the first passband ends at
<cite>fs/2</cite> (i.e the filter is a single band highpass filter);
center of first passband otherwise</p></li>
</ul>
</dd>
<dt><strong>nyq</strong><span class="classifier">float, optional</span></dt><dd><p><em>Deprecated. Use `fs` instead.</em> This is the Nyquist frequency.
Each frequency in <cite>cutoff</cite> must be between 0 and <cite>nyq</cite>. Default
is 1.</p>
</dd>
<dt><strong>fs</strong><span class="classifier">float, optional</span></dt><dd><p>The sampling frequency of the signal. Each frequency in <cite>cutoff</cite>
must be between 0 and <code class="docutils literal notranslate"><span class="pre">fs/2</span></code>.  Default is 2.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>h</strong><span class="classifier">(numtaps,) ndarray</span></dt><dd><p>Coefficients of length <cite>numtaps</cite> FIR filter.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If any value in <cite>cutoff</cite> is less than or equal to 0 or greater
than or equal to <code class="docutils literal notranslate"><span class="pre">fs/2</span></code>, if the values in <cite>cutoff</cite> are not strictly
monotonically increasing, or if <cite>numtaps</cite> is even but a passband
includes the Nyquist frequency.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">firwin2</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">firls</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">minimum_phase</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">remez</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Low-pass from 0 to f:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numtaps</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="go">array([ 0.06799017,  0.86401967,  0.06799017])</span>
</pre></div>
</div>
<p>Use a specific window function:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;nuttall&#39;</span><span class="p">)</span>
<span class="go">array([  3.56607041e-04,   9.99286786e-01,   3.56607041e-04])</span>
</pre></div>
</div>
<p>High-pass (‘stop’ from 0 to f):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">pass_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">array([-0.00859313,  0.98281375, -0.00859313])</span>
</pre></div>
</div>
<p>Band-pass:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="p">[</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">],</span> <span class="n">pass_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">array([ 0.06301614,  0.88770441,  0.06301614])</span>
</pre></div>
</div>
<p>Band-stop:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="p">[</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">])</span>
<span class="go">array([-0.00801395,  1.0160279 , -0.00801395])</span>
</pre></div>
</div>
<p>Multi-band (passbands are [0, f1], [f2, f3] and [f4, 1]):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f3</span><span class="p">,</span> <span class="n">f4</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="p">[</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">,</span> <span class="n">f4</span><span class="p">])</span>
<span class="go">array([-0.01376344,  1.02752689, -0.01376344])</span>
</pre></div>
</div>
<p>Multi-band (passbands are [f1, f2] and [f3,f4]):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="p">[</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">,</span> <span class="n">f4</span><span class="p">],</span> <span class="n">pass_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">array([ 0.04890915,  0.91284326,  0.04890915])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.gaussian_filter1d">
<span class="sig-name descname"><span class="pre">gaussian_filter1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/ndimage/filters.html#gaussian_filter1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.gaussian_filter1d" title="Permalink to this definition">¶</a></dt>
<dd><p>1-D Gaussian filter.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>input</strong><span class="classifier">array_like</span></dt><dd><p>The input array.</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">scalar</span></dt><dd><p>standard deviation for Gaussian kernel</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>The axis of <cite>input</cite> along which to calculate. Default is -1.</p>
</dd>
<dt><strong>order</strong><span class="classifier">int, optional</span></dt><dd><p>An order of 0 corresponds to convolution with a Gaussian
kernel. A positive order corresponds to convolution with
that derivative of a Gaussian.</p>
</dd>
<dt><strong>output</strong><span class="classifier">array or dtype, optional</span></dt><dd><p>The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p>
</dd>
<dt><strong>mode</strong><span class="classifier">{‘reflect’, ‘constant’, ‘nearest’, ‘mirror’, ‘wrap’}, optional</span></dt><dd><p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘reflect’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>‘reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel. This mode is also sometimes referred to as half-sample
symmetric.</p>
</dd>
<dt>‘constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>‘nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>‘mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel. This mode is also sometimes referred to as whole-sample
symmetric.</p>
</dd>
<dt>‘wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
<p>For consistency with the interpolation functions, the following mode
names can also be used:</p>
<dl class="simple">
<dt>‘grid-mirror’</dt><dd><p>This is a synonym for ‘reflect’.</p>
</dd>
<dt>‘grid-constant’</dt><dd><p>This is a synonym for ‘constant’.</p>
</dd>
<dt>‘grid-wrap’</dt><dd><p>This is a synonym for ‘wrap’.</p>
</dd>
</dl>
</dd>
<dt><strong>cval</strong><span class="classifier">scalar, optional</span></dt><dd><p>Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p>
</dd>
<dt><strong>truncate</strong><span class="classifier">float, optional</span></dt><dd><p>Truncate the filter at this many standard deviations.
Default is 4.0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>gaussian_filter1d</strong><span class="classifier">ndarray</span></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">gaussian_filter1d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussian_filter1d</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">array([ 1.42704095,  2.06782203,  3.        ,  3.93217797,  4.57295905])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussian_filter1d</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">array([ 2.91948343,  2.95023502,  3.        ,  3.04976498,  3.08051657])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y3</span> <span class="o">=</span> <span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y6</span> <span class="o">=</span> <span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original data&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y3</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;filtered, sigma=3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y6</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;filtered, sigma=6&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.generate_godin_fir">
<span class="sig-name descname"><span class="pre">generate_godin_fir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#generate_godin_fir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.generate_godin_fir" title="Permalink to this definition">¶</a></dt>
<dd><p>generate godin filter impulse response for given freq
freq is a pandas freq</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.godin">
<span class="sig-name descname"><span class="pre">godin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#godin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.godin" title="Permalink to this definition">¶</a></dt>
<dd><p>Low-pass Godin filter a regular time series.
Applies the <span class="math notranslate nohighlight">\(\mathcal{A_{24}^{2}A_{25}}\)</span> Godin filter <a class="reference internal" href="#r1d48320053b8-1" id="id3">[1]</a>
The filter is generalized to be the equivalent of one
boxcar of the length of the lunar diurnal (~25 hours)
constituent and two of the solar diurnal (~24 hours), though the
implementation combines these steps.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>A new regular time series with the same interval of ts.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>NotImplementedError</dt><dd><p>If input time series is not univariate</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r1d48320053b8-1"><span class="brackets"><a class="fn-backref" href="#id3">1</a></span></dt>
<dd><p>Godin (1972) Analysis of Tides</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.hours">
<span class="sig-name descname"><span class="pre">hours</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/data/vtime.html#hours"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.hours" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a time interval representing h hours</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.lfilter">
<span class="sig-name descname"><span class="pre">lfilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/signaltools.html#lfilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.lfilter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter data along one-dimension with an IIR or FIR filter.</p>
<p>Filter a data sequence, <cite>x</cite>, using a digital filter.  This works for many
fundamental data types (including Object type).  The filter is a direct
form II transposed implementation of the standard difference equation
(see Notes).</p>
<p>The function <cite>sosfilt</cite> (and filter design using <code class="docutils literal notranslate"><span class="pre">output='sos'</span></code>) should be
preferred over <cite>lfilter</cite> for most filtering tasks, as second-order sections
have fewer numerical problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>b</strong><span class="classifier">array_like</span></dt><dd><p>The numerator coefficient vector in a 1-D sequence.</p>
</dd>
<dt><strong>a</strong><span class="classifier">array_like</span></dt><dd><p>The denominator coefficient vector in a 1-D sequence.  If <code class="docutils literal notranslate"><span class="pre">a[0]</span></code>
is not 1, then both <cite>a</cite> and <cite>b</cite> are normalized by <code class="docutils literal notranslate"><span class="pre">a[0]</span></code>.</p>
</dd>
<dt><strong>x</strong><span class="classifier">array_like</span></dt><dd><p>An N-dimensional input array.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>The axis of the input data array along which to apply the
linear filter. The filter is applied to each subarray along
this axis.  Default is -1.</p>
</dd>
<dt><strong>zi</strong><span class="classifier">array_like, optional</span></dt><dd><p>Initial conditions for the filter delays.  It is a vector
(or array of vectors for an N-dimensional input) of length
<code class="docutils literal notranslate"><span class="pre">max(len(a),</span> <span class="pre">len(b))</span> <span class="pre">-</span> <span class="pre">1</span></code>.  If <cite>zi</cite> is None or is not given then
initial rest is assumed.  See <cite>lfiltic</cite> for more information.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y</strong><span class="classifier">array</span></dt><dd><p>The output of the digital filter.</p>
</dd>
<dt><strong>zf</strong><span class="classifier">array, optional</span></dt><dd><p>If <cite>zi</cite> is None, this is not returned, otherwise, <cite>zf</cite> holds the
final filter delay values.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">lfiltic</span></code></dt><dd><p>Construct initial conditions for <cite>lfilter</cite>.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">lfilter_zi</span></code></dt><dd><p>Compute initial state (steady state of step response) for <cite>lfilter</cite>.</p>
</dd>
<dt><a class="reference internal" href="#vtools.functions.filter.filtfilt" title="vtools.functions.filter.filtfilt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filtfilt</span></code></a></dt><dd><p>A forward-backward filter, to obtain a filter with linear phase.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">savgol_filter</span></code></dt><dd><p>A Savitzky-Golay filter.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">sosfilt</span></code></dt><dd><p>Filter data using cascaded second-order sections.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">sosfiltfilt</span></code></dt><dd><p>A forward-backward filter using second-order sections.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The filter function is implemented as a direct II transposed structure.
This means that the filter implements:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">M</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">M</span><span class="p">]</span>
                      <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="o">...</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">N</span><span class="p">]</span>
</pre></div>
</div>
<p>where <cite>M</cite> is the degree of the numerator, <cite>N</cite> is the degree of the
denominator, and <cite>n</cite> is the sample number.  It is implemented using
the following difference equations (assuming M = N):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>               <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="o">...</span>
<span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</pre></div>
</div>
<p>where <cite>d</cite> are the state variables.</p>
<p>The rational transfer function describing this filter in the
z-transform domain is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                    <span class="o">-</span><span class="mi">1</span>              <span class="o">-</span><span class="n">M</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">z</span>  <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">M</span><span class="p">]</span> <span class="n">z</span>
<span class="n">Y</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="o">--------------------------------</span> <span class="n">X</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                    <span class="o">-</span><span class="mi">1</span>              <span class="o">-</span><span class="n">N</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">z</span>  <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="n">z</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<p>Generate a noisy signal to be filtered:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">0.75</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.1</span><span class="p">)</span> <span class="o">+</span>
<span class="gp">... </span>     <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1.25</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
<span class="gp">... </span>     <span class="mf">0.18</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">3.85</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xn</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.08</span>
</pre></div>
</div>
<p>Create an order 3 lowpass butterworth filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
<p>Apply the filter to xn.  Use lfilter_zi to choose the initial condition of
the filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">zi</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">lfilter_zi</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">xn</span><span class="p">,</span> <span class="n">zi</span><span class="o">=</span><span class="n">zi</span><span class="o">*</span><span class="n">xn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Apply the filter again, to have a result filtered at an order the same as
filtfilt:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">zi</span><span class="o">=</span><span class="n">zi</span><span class="o">*</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Use filtfilt to apply the filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">xn</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the original signal and the various filtered versions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">xn</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;noisy signal&#39;</span><span class="p">,</span> <span class="s1">&#39;lfilter, once&#39;</span><span class="p">,</span> <span class="s1">&#39;lfilter, twice&#39;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s1">&#39;filtfilt&#39;</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.lowpass_cosine_lanczos_filter_coef">
<span class="sig-name descname"><span class="pre">lowpass_cosine_lanczos_filter_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#lowpass_cosine_lanczos_filter_coef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.lowpass_cosine_lanczos_filter_coef" title="Permalink to this definition">¶</a></dt>
<dd><p>return the convolution coefficients for low pass lanczos filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cf: float</strong></dt><dd><p>Cutoff frequency expressed as a ratio of a Nyquist frequency.</p>
</dd>
<dt><strong>m: int</strong></dt><dd><p>Size of filtering window size.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>results: list</dt><dd><p>Coefficients of filtering window.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.minutes">
<span class="sig-name descname"><span class="pre">minutes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/data/vtime.html#minutes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.minutes" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a time interval representing m minutes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.process_cutoff">
<span class="sig-name descname"><span class="pre">process_cutoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#process_cutoff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.process_cutoff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.sciarray">
<span class="sig-name descname"><span class="pre">sciarray</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vtools.functions.filter.sciarray" title="Permalink to this definition">¶</a></dt>
<dd><p>scipy.array is deprecated and will be removed in SciPy 2.0.0, use numpy.array instead</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.seconds">
<span class="sig-name descname"><span class="pre">seconds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/data/vtime.html#seconds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.seconds" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a time interval representing s seconds</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.ts_gaussian_filter">
<span class="sig-name descname"><span class="pre">ts_gaussian_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#ts_gaussian_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.ts_gaussian_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Column-wise Gaussian smoothing of regular time series. 
Missing/irregular values are not handled, which means this function is not much different from
a rolling window gaussian average in pandas which may be preferable in the case of 
missing data (ts.rolling(window=5,win_type=’gaussian’).mean. 
This function has been kept around awaiting irreg as an aspiration but yet to be implemented.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>The series to be smoothed</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">int or freq</span></dt><dd><p>The sigma scale of the smoothing (analogous to std. deviation), given as a number of steps 
or freq</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>A new regular time series with the same interval of ts.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-vtools.functions.frequency_response">
<span id="vtools-functions-frequency-response-module"></span><h2>vtools.functions.frequency_response module<a class="headerlink" href="#module-vtools.functions.frequency_response" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.butterworth">
<span class="sig-name descname"><span class="pre">butterworth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#butterworth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.butterworth" title="Permalink to this definition">¶</a></dt>
<dd><p>low-pass butterworth-squared filter on a regular time series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>Must be one or two dimensional, and regular.</p>
</dd>
<dt><strong>order: int ,optional</strong></dt><dd><p>The default is 4.</p>
</dd>
<dt><strong>cutoff_frequency: float,optional</strong></dt><dd><p>Cutoff frequency expressed as a ratio with Nyquist frequency,
should within the range (0,1). For a discretely sampled system,
the Nyquist frequency is the fastest frequency that can be resolved by that 
sampling, which is half the sampling frequency. For example, if the sampling frequency
is 1 sample/1 hour, the Nyquist frequency is 1 sample/2 hours. If we want a
36 hour cutoff period, the frequency is 1/36 or 0.0278 cycles per hour. 
Hence the cutoff frequency argument used here would be
0.0278/0.5 = 0.056.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">string  or  _time_interval</span></dt><dd><p>Period corresponding to cutoff frequency. If input as a string, it must 
be  convertible to a regular interval using the same rules as a pandas frequency..
cutoff_frequency and cutoff_period can’t be specified at the same time.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>result</strong><span class="classifier"></span></dt><dd><p>A new regular time series with the same interval as ts.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If input order is not even, or input timeseries is not regular, 
or neither cutoff_period and cutoff_frequency is given while input
time series interval is not 15min or 1 hour, or  cutoff_period and cutoff_frequency 
are given at the same time.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.compare_response">
<span class="sig-name descname"><span class="pre">compare_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/frequency_response.html#compare_response"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.compare_response" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a comparison plot of the frequency response of filters used in tidal work
The comparison includes, squared cosine-Lanczos, Godin and boxcar.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.compare_response2">
<span class="sig-name descname"><span class="pre">compare_response2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit_impulse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/frequency_response.html#compare_response2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.compare_response2" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate frequency response plot of low pass filter consine_lanczos, boxcar 24h, boxcar 25h, and godin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>unit_impulse</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>a pandas time series with one at the middle.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">int</span></dt><dd><p>low pass filter cuttoff period in number of hours.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.cosine_lanczos">
<span class="sig-name descname"><span class="pre">cosine_lanczos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#cosine_lanczos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.cosine_lanczos" title="Permalink to this definition">¶</a></dt>
<dd><p>squared low-pass cosine lanczos  filter on a regular time series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd></dd>
<dt><strong>filter_len</strong><span class="classifier">int, time_interval</span></dt><dd><p>Size of lanczos window, default is to number of samples within filter_period*1.25.</p>
</dd>
<dt><strong>cutoff_frequency: float,optional</strong></dt><dd><p>Cutoff frequency expressed as a ratio of a Nyquist frequency,
should within the range (0,1). For example, if the sampling frequency
is 1 hour, the Nyquist frequency is 1 sample/2 hours. If we want a
36 hour cutoff period, the frequency is 1/36 or 0.0278 cycles per hour. 
Hence the cutoff frequency argument used here would be
0.0278/0.5 = 0.056.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">string  or  _time_interval</span></dt><dd><blockquote>
<div><p>Period of cutting off frequency. If input as a string, it must 
be  convertible to a _time_interval (Pandas freq).
cutoff_frequency and cutoff_period can’t be specified at the same time.</p>
</div></blockquote>
<dl class="simple">
<dt>padtype<span class="classifier">str or None, optional</span></dt><dd><p>Must be ‘odd’, ‘even’, ‘constant’, or None. This determines the type
of extension to use for the padded signal to which the filter is applied. 
If padtype is None, no padding is used. The default is None.</p>
</dd>
<dt>padlen<span class="classifier">int or None, optional</span></dt><dd><p>The number of elements by which to extend x at both ends of axis 
before applying the filter. This value must be less than x.shape[axis]-1. 
padlen=0 implies no padding. If padtye is not None and padlen is not
given, padlen is be set to 6*m.</p>
</dd>
<dt>fill_edge_nan: bool,optional</dt><dd><p>If pading is not used and fill_edge_nan is true, resulting data on 
the both ends are filled with nan to account for edge effect. This is
2*m on the either end of the result. Default is true.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></span></dt><dd><p>A new regular time series with the same interval of ts. If no pading 
is used the beigning and ending 4*m resulting data will be set to nan
to remove edge effect.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If input timeseries is not regular, 
or, cutoff_period and cutoff_frequency are given at the same time,
or, neither cutoff_period nor curoff_frequence is given,
or, padtype is not “odd”,”even”,”constant”,or None,
or, padlen is larger than data size</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.freqz">
<span class="sig-name descname"><span class="pre">freqz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.283185307179586</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_nyquist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/filter_design.html#freqz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.freqz" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the frequency response of a digital filter.</p>
<p>Given the M-order numerator <cite>b</cite> and N-order denominator <cite>a</cite> of a digital
filter, compute its frequency response:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>            <span class="n">jw</span>                 <span class="o">-</span><span class="n">jw</span>              <span class="o">-</span><span class="n">jwM</span>
   <span class="n">jw</span>    <span class="n">B</span><span class="p">(</span><span class="n">e</span>  <span class="p">)</span>    <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">e</span>    <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">M</span><span class="p">]</span><span class="n">e</span>
<span class="n">H</span><span class="p">(</span><span class="n">e</span>  <span class="p">)</span> <span class="o">=</span> <span class="o">------</span> <span class="o">=</span> <span class="o">-----------------------------------</span>
            <span class="n">jw</span>                 <span class="o">-</span><span class="n">jw</span>              <span class="o">-</span><span class="n">jwN</span>
         <span class="n">A</span><span class="p">(</span><span class="n">e</span>  <span class="p">)</span>    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">e</span>    <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">]</span><span class="n">e</span>
</pre></div>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>b</strong><span class="classifier">array_like</span></dt><dd><p>Numerator of a linear filter. If <cite>b</cite> has dimension greater than 1,
it is assumed that the coefficients are stored in the first dimension,
and <code class="docutils literal notranslate"><span class="pre">b.shape[1:]</span></code>, <code class="docutils literal notranslate"><span class="pre">a.shape[1:]</span></code>, and the shape of the frequencies
array must be compatible for broadcasting.</p>
</dd>
<dt><strong>a</strong><span class="classifier">array_like</span></dt><dd><p>Denominator of a linear filter. If <cite>b</cite> has dimension greater than 1,
it is assumed that the coefficients are stored in the first dimension,
and <code class="docutils literal notranslate"><span class="pre">b.shape[1:]</span></code>, <code class="docutils literal notranslate"><span class="pre">a.shape[1:]</span></code>, and the shape of the frequencies
array must be compatible for broadcasting.</p>
</dd>
<dt><strong>worN</strong><span class="classifier">{None, int, array_like}, optional</span></dt><dd><p>If a single integer, then compute at that many frequencies (default is
N=512). This is a convenient alternative to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span> <span class="k">if</span> <span class="n">whole</span> <span class="k">else</span> <span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">include_nyquist</span><span class="p">)</span>
</pre></div>
</div>
<p>Using a number that is fast for FFT computations can result in
faster computations (see Notes).</p>
<p>If an array_like, compute the response at the frequencies given.
These are in the same units as <cite>fs</cite>.</p>
</dd>
<dt><strong>whole</strong><span class="classifier">bool, optional</span></dt><dd><p>Normally, frequencies are computed from 0 to the Nyquist frequency,
fs/2 (upper-half of unit-circle). If <cite>whole</cite> is True, compute
frequencies from 0 to fs. Ignored if worN is array_like.</p>
</dd>
<dt><strong>plot</strong><span class="classifier">callable</span></dt><dd><p>A callable that takes two arguments. If given, the return parameters
<cite>w</cite> and <cite>h</cite> are passed to plot. Useful for plotting the frequency
response inside <cite>freqz</cite>.</p>
</dd>
<dt><strong>fs</strong><span class="classifier">float, optional</span></dt><dd><p>The sampling frequency of the digital system. Defaults to 2*pi
radians/sample (so w is from 0 to pi).</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.0.</span></p>
</div>
</dd>
<dt><strong>include_nyquist</strong><span class="classifier">bool, optional</span></dt><dd><p>If <cite>whole</cite> is False and <cite>worN</cite> is an integer, setting <cite>include_nyquist</cite> to True
will include the last frequency (Nyquist frequency) and is otherwise ignored.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.5.0.</span></p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>w</strong><span class="classifier">ndarray</span></dt><dd><p>The frequencies at which <cite>h</cite> was computed, in the same units as <cite>fs</cite>.
By default, <cite>w</cite> is normalized to the range [0, pi) (radians/sample).</p>
</dd>
<dt><strong>h</strong><span class="classifier">ndarray</span></dt><dd><p>The frequency response, as complex numbers.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">freqz_zpk</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">sosfreqz</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Using Matplotlib’s <code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.plot()</span></code> function as the callable
for <cite>plot</cite> produces unexpected results, as this plots the real part of the
complex transfer function, not the magnitude.
Try <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">w,</span> <span class="pre">h:</span> <span class="pre">plot(w,</span> <span class="pre">np.abs(h))</span></code>.</p>
<p>A direct computation via (R)FFT is used to compute the frequency response
when the following conditions are met:</p>
<ol class="arabic simple">
<li><p>An integer value is given for <cite>worN</cite>.</p></li>
<li><p><cite>worN</cite> is fast to compute via FFT (i.e.,
<cite>next_fast_len(worN) &lt;scipy.fft.next_fast_len&gt;</cite> equals <cite>worN</cite>).</p></li>
<li><p>The denominator coefficients are a single value (<code class="docutils literal notranslate"><span class="pre">a.shape[0]</span> <span class="pre">==</span> <span class="pre">1</span></code>).</p></li>
<li><p><cite>worN</cite> is at least as long as the numerator coefficients
(<code class="docutils literal notranslate"><span class="pre">worN</span> <span class="pre">&gt;=</span> <span class="pre">b.shape[0]</span></code>).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">b.ndim</span> <span class="pre">&gt;</span> <span class="pre">1</span></code>, then <code class="docutils literal notranslate"><span class="pre">b.shape[-1]</span> <span class="pre">==</span> <span class="pre">1</span></code>.</p></li>
</ol>
<p>For long FIR filters, the FFT approach can have lower error and be much
faster than the equivalent direct polynomial calculation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;kaiser&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Digital filter frequency response&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude [dB]&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [rad/sample]&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">angles</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Angle (radians)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Broadcasting Examples</p>
<p>Suppose we have two FIR filters whose coefficients are stored in the
rows of an array with shape (2, 25). For this demonstration, we’ll
use random data:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
</pre></div>
</div>
<p>To compute the frequency response for these two filters with one call
to <cite>freqz</cite>, we must pass in <code class="docutils literal notranslate"><span class="pre">b.T</span></code>, because <cite>freqz</cite> expects the first
axis to hold the coefficients. We must then extend the shape with a
trivial dimension of length 1 to allow broadcasting with the array
of frequencies.  That is, we pass in <code class="docutils literal notranslate"><span class="pre">b.T[...,</span> <span class="pre">np.newaxis]</span></code>, which has
shape (25, 2, 1):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">worN</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1024,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 1024)</span>
</pre></div>
</div>
<p>Now, suppose we have two transfer functions, with the same numerator
coefficients <code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">=</span> <span class="pre">[0.5,</span> <span class="pre">0.5]</span></code>. The coefficients for the two denominators
are stored in the first dimension of the 2-D array  <cite>a</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span>   <span class="mi">1</span>      <span class="mi">1</span>  <span class="p">]</span>
    <span class="p">[</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span> <span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]])</span>
</pre></div>
</div>
<p>Only <cite>a</cite> is more than 1-D. To make it compatible for
broadcasting with the frequencies, we extend it with a trivial dimension
in the call to <cite>freqz</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">worN</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1024,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 1024)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.godin">
<span class="sig-name descname"><span class="pre">godin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#godin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.godin" title="Permalink to this definition">¶</a></dt>
<dd><p>Low-pass Godin filter a regular time series.
Applies the <span class="math notranslate nohighlight">\(\mathcal{A_{24}^{2}A_{25}}\)</span> Godin filter <a class="reference internal" href="#ra2b1b86d9761-1" id="id5">[1]</a>
The filter is generalized to be the equivalent of one
boxcar of the length of the lunar diurnal (~25 hours)
constituent and two of the solar diurnal (~24 hours), though the
implementation combines these steps.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>A new regular time series with the same interval of ts.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>NotImplementedError</dt><dd><p>If input time series is not univariate</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="ra2b1b86d9761-1"><span class="brackets"><a class="fn-backref" href="#id5">1</a></span></dt>
<dd><p>Godin (1972) Analysis of Tides</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.lowpass_cosine_lanczos_filter_coef">
<span class="sig-name descname"><span class="pre">lowpass_cosine_lanczos_filter_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#lowpass_cosine_lanczos_filter_coef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.lowpass_cosine_lanczos_filter_coef" title="Permalink to this definition">¶</a></dt>
<dd><p>return the convolution coefficients for low pass lanczos filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cf: float</strong></dt><dd><p>Cutoff frequency expressed as a ratio of a Nyquist frequency.</p>
</dd>
<dt><strong>m: int</strong></dt><dd><p>Size of filtering window size.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>results: list</dt><dd><p>Coefficients of filtering window.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.ts_gaussian_filter">
<span class="sig-name descname"><span class="pre">ts_gaussian_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#ts_gaussian_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.ts_gaussian_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Column-wise Gaussian smoothing of regular time series. 
Missing/irregular values are not handled, which means this function is not much different from
a rolling window gaussian average in pandas which may be preferable in the case of 
missing data (ts.rolling(window=5,win_type=’gaussian’).mean. 
This function has been kept around awaiting irreg as an aspiration but yet to be implemented.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>The series to be smoothed</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">int or freq</span></dt><dd><p>The sigma scale of the smoothing (analogous to std. deviation), given as a number of steps 
or freq</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>A new regular time series with the same interval of ts.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.unit_impulse_ts">
<span class="sig-name descname"><span class="pre">unit_impulse_ts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/frequency_response.html#unit_impulse_ts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.unit_impulse_ts" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>size</strong><span class="classifier">int</span></dt><dd><p>Length of impluse time series, odd number.</p>
</dd>
<dt><strong>interval</strong><span class="classifier">string</span></dt><dd><p>time series interval, such as “15min”</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.Dataframe</dt><dd><p>time series value 0.0 except 1 at the middle of time series.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-vtools.functions.interannual">
<span id="vtools-functions-interannual-module"></span><h2>vtools.functions.interannual module<a class="headerlink" href="#module-vtools.functions.interannual" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interannual.interannual">
<span class="sig-name descname"><span class="pre">interannual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interannual.html#interannual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interannual.interannual" title="Permalink to this definition">¶</a></dt>
<dd><p>Pivots years of multiyear series to columns and convert index to elapsed time of year</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts</strong><span class="classifier">series  Univariate series</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>annual</strong><span class="classifier">DataFrame with year in the columns and elapsed time of year as index</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interannual.interannual_sample">
<span class="sig-name descname"><span class="pre">interannual_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interannual.html#interannual_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interannual.interannual_sample" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interannual.interannual_ticks_labels">
<span class="sig-name descname"><span class="pre">interannual_ticks_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interannual.html#interannual_ticks_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interannual.interannual_ticks_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenient ticks and labels for interannual</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>freq</strong><span class="classifier">Frequency string for desired spacing. Must be “Q”,”QS”,”M”,”MS” for quarterly or monthly</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ticks_labels</strong><span class="classifier">tuple of tick locations and labels</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-vtools.functions.interpolate">
<span id="vtools-functions-interpolate-module"></span><h2>vtools.functions.interpolate module<a class="headerlink" href="#module-vtools.functions.interpolate" title="Permalink to this heading">¶</a></h2>
<p>Module for data interpolation using splines or interfaces unavailable in Pandas.</p>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate._monotonic_spline">
<span class="sig-name descname"><span class="pre">_monotonic_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xnew</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/_monotonic_spline.html#_monotonic_spline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate._monotonic_spline" title="Permalink to this definition">¶</a></dt>
<dd><p>Third order (M3-A) monotonicity-preserving spline
Usage:          interpolate.spline(x,y,xnew)</p>
<blockquote>
<div><dl class="simple">
<dt>where</dt><dd><p>x are the sorted index values of the original data
y are the original dataxnew
xnew are new locations for the spline</p>
</dd>
</dl>
<p>Reference: Huynh, HT &lt;&lt;Accurate Monotone Cubic Interpolation&gt;&gt;,
SIAM J. Numer. Analysis V30 No. 1 pp 57-100 
All equation numbers refer to this paper. The variable names are 
also almost the same. Double letters like “ee” to indicate 
that the subscript should have “+1/2” added to it and a number after
the variable to show the “t” that the first member applies to.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate._ratsp1">
<span class="sig-name descname"><span class="pre">_ratsp1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#_ratsp1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate._ratsp1" title="Permalink to this definition">¶</a></dt>
<dd><p>RATSP1 in Spath (1995)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.example">
<span class="sig-name descname"><span class="pre">example</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#example"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.example" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.interpolate_to_index">
<span class="sig-name descname"><span class="pre">interpolate_to_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#interpolate_to_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.interpolate_to_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.monotonic_spline">
<span class="sig-name descname"><span class="pre">monotonic_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#monotonic_spline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.monotonic_spline" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolating a regular time series (rts) to a finer rts by rational histospline.</p>
<p>The rational histospline preserves area under the curve. This is a good choice of spline for period averaged data where an interpolant is desired
that is ‘conservative’. Note that it is the underlying continuous interpolant
that will be ‘conservative though, not the returned discrete time series which
merely samples the underlying interpolant.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pandas.DataFrame</span></code></span></dt><dd><p>Series to be interpolated, typically with DatetimeIndex</p>
</dd>
<dt><strong>dest</strong><span class="classifier">a pandas freq code (e.g. ‘16min’ or ‘D’) or a DateTimeIndex</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></span></dt><dd><p>A regular time series with same columns as ts, populated with instantaneous values and with
an index of type DateTimeIndex</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhist">
<span class="sig-name descname"><span class="pre">rhist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhist" title="Permalink to this definition">¶</a></dt>
<dd><p>Histopline for arrays with tension.
Based by an algorithm rhist2 in 
One Dimensional Spline Interpolation Algorithms
by Helmuth Spath (1995).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">array-like</span></dt><dd><p>Abscissa array of original data,
of length n</p>
</dd>
<dt><strong>y</strong><span class="classifier">array-like, dimension (n-1)</span></dt><dd><p>Values (mantissa) of original data giving the rectangle (average) values between x[i] and x[i+1]</p>
</dd>
<dt><strong>xnew</strong><span class="classifier">array-like</span></dt><dd><p>Array of new locations at which to interpolate.</p>
</dd>
<dt><strong>y0,yn</strong><span class="classifier">float</span></dt><dd><p>Initial and terminal values</p>
</dd>
<dt><strong>p,q: array-like, dimension (n-1)</strong></dt><dd><p>Tension parameter, p and q are almost always the same. The higher p and q are for a particular x interval, the more rectangular the interpolant will look and the more 
positivity and shape preserving it is at the expense
of accuracy. For this routine any number p,q &gt; -1 is allowed, although the bound routine doesn’t use vals less
than zero.</p>
</dd>
<dt><strong>Returns</strong></dt><dd></dd>
<dt><strong>——-</strong></dt><dd></dd>
<dt><strong>ynew</strong><span class="classifier">array-like</span></dt><dd><p>Array that interpolates the original data.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhist_bound">
<span class="sig-name descname"><span class="pre">rhist_bound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">floor_eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhist_bound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhist_bound" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy implementation of histospline with bounds
Histopline for arrays with lower bound enforcement.
This routine drives rhist() but tests that the output
array observes the lower bound and adapts the tension parameters as needed.</p>
<p>This will not work exactly if the input
array has values right on the lower bound. In this case,
the parameter floor_eps allows you to specify a tolerance
of bound violation to shoot for … and if it isn’t met in maxiter iterations the value is simply floored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">array-like</span></dt><dd><p>Abscissa array of original data to be interpolated,
of length n</p>
</dd>
<dt><strong>y</strong><span class="classifier">array-like, dimension (n-1)</span></dt><dd><p>Values (mantissa) of original data giving the rectangle (average) values between x[i] and x[i+1]</p>
</dd>
<dt><strong>xnew</strong><span class="classifier">array-like</span></dt><dd><p>Array of new locations at which to interpolate.</p>
</dd>
<dt><strong>y0,yn</strong><span class="classifier">float</span></dt><dd><p>Initial and terminal values</p>
</dd>
<dt><strong>p: float</strong></dt><dd><p>Tension parameter. This starts out as a global scalar, but will be converted to an array and adapted locally. 
The higher this goes for a particular x interval, the more rectangular the interpolant will look and the more 
positivity and shape preserving it is at the expense
of accuracy. A good number is 1, and for this routine,
p &gt; 0 is required because the adaptive process multiplies it by pfactor each iteration on the expectation that it will get bigger.</p>
</dd>
<dt><strong>lbound: float</strong></dt><dd><p>Lower bound to be enforced. If the original y’s are strictly above this value, the output has the potential to also be strictly above. If the original y’s lie on the lower bound, then the lower bound can only be enforced within a tolerance using the Spath algorithm …
and once the values reach that tolerance they are floored. If lbound = None, this function behaves like rhist()</p>
</dd>
<dt><strong>maxiter</strong><span class="classifier">integer</span></dt><dd><p>Number of times to increase p by multiplying it by pfactor before giving up on satisfying floor_eps.</p>
</dd>
<dt><strong>pfactor</strong><span class="classifier">float</span></dt><dd><p>Factor by which to multiply individual time step p</p>
</dd>
<dt><strong>floor_eps</strong><span class="classifier">float</span></dt><dd><p>Tolerance for lower bound violation at which the algorithm will be terminated and the bounds will be enforced by flooring.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ynew</strong><span class="classifier">array-like</span></dt><dd><p>Array that interpolates the original data, on a curve that conserves mass and strictly observes the lower bound.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhist_coef">
<span class="sig-name descname"><span class="pre">rhist_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhist_coef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhist_coef" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine that produces coefficients for the histospline</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhist_val">
<span class="sig-name descname"><span class="pre">rhist_val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhist_val"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhist_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a histospline at new x points</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhistinterp">
<span class="sig-name descname"><span class="pre">rhistinterp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowbound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolbound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhistinterp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhistinterp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate a regular time series (rts) to a finer rts by rational histospline.</p>
<p>The rational histospline preserves area under the curve. This is a good choice of spline for period averaged data where an interpolant is desired
that is ‘conservative’. Note that it is the underlying continuous interpolant
that will be ‘conservative though, not the returned discrete time series which
merely samples the underlying interpolant.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pandas.DataFrame</span></code></span></dt><dd><p>Series to be interpolated, with period index and assuming time stamps at beginning
of the period and no missing data</p>
</dd>
<dt><strong>dest</strong><span class="classifier">string or <code class="xref py py-class docutils literal notranslate"><span class="pre">DateTimeIndex</span></code></span></dt><dd><p>A pandas freq code (e.g. ‘16min’ or ‘D’) or a DateTimeIndex</p>
</dd>
<dt><strong>p</strong><span class="classifier">float, optional</span></dt><dd><p>Spline tension, usually between 0 and 20. Must &gt;-1. For a ‘sufficiently large’ value of p, the interpolant will be monotonicity-preserving and will maintain strict positivity (always being strictly &gt; <cite>lowbound</cite>.</p>
</dd>
<dt><strong>lowbound</strong><span class="classifier">float, optional</span></dt><dd><p>Lower bound of interpolated values.</p>
</dd>
<dt><strong>tolbound</strong><span class="classifier">float, optional</span></dt><dd><p>Tolerance for determining if an input is on the bound.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></span></dt><dd><p>A regular time series with same columns as ts, populated with instantaneous values and with
an index of type DateTimeIndex</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.tridiagonal">
<span class="sig-name descname"><span class="pre">tridiagonal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#tridiagonal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.tridiagonal" title="Permalink to this definition">¶</a></dt>
<dd><p>a is the lower band (with leading zero)
b is the center diagonal (length == nrow)
c is upper band (trailing zero)
d is right hand side</p>
</dd></dl>

</div>
<div class="section" id="module-vtools.functions.lag_cross_correlation">
<span id="vtools-functions-lag-cross-correlation-module"></span><h2>vtools.functions.lag_cross_correlation module<a class="headerlink" href="#module-vtools.functions.lag_cross_correlation" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.lag_cross_correlation.calculate_lag">
<span class="sig-name descname"><span class="pre">calculate_lag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lagged</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/lag_cross_correlation.html#calculate_lag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.lag_cross_correlation.calculate_lag" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate shift in lagged, that maximizes cross-correlation with base.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>base,lagged:</strong><span class="classifier">class:<cite>Pandas.Series</cite></span></dt><dd><p>time series to compare. The result is relative to base</p>
</dd>
<dt><strong>max_lag: interval</strong></dt><dd><p>Maximum pos/negative time shift to consider in cross-correlation 
(ie, from -max_lag to +max_lag). Required windows in lagged will
account for this bracket. For series dominated by a single 
frequency (eg 1c/12.5 hours for tides), the algorithm can tolerate
a range of 180 degrees (6 hours)</p>
</dd>
<dt><strong>res: interval</strong></dt><dd><p>Resolution of analysis. The series lagged will
be interpolated to this resolution using interpolate_method. Unit
used here will determine the type of the output. See documentation
of the interval concept which is most compatible with 
pandas.tseries.offsets, not timeDelta, because of better math
properties in things like division – vtime helpers like minutes(1) 
may be helpful</p>
</dd>
<dt><strong>interpolate_method: str, optional</strong></dt><dd><p>Interpolate method to refine lagged to res. Must be compatible with 
pandas interpolation method names (and hence scipy)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>lag</strong><span class="classifier">interval</span></dt><dd><p>Shift as a pandas.tseries.offsets subtype that matches units with res
This shift is the apparent lateness (pos) or earliness (neg). It must be
applied to base or removed to lagged to align the features.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.lag_cross_correlation.icrosscorr">
<span class="sig-name descname"><span class="pre">icrosscorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/lag_cross_correlation.html#icrosscorr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.lag_cross_correlation.icrosscorr" title="Permalink to this definition">¶</a></dt>
<dd><p>Lag-N cross correlation. 
Shifted data filled with NaNs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lag</strong><span class="classifier">int, default 0</span></dt><dd></dd>
<dt><strong>ts0, ts1</strong><span class="classifier">pandas.Series objects of equal length</span></dt><dd></dd>
<dt><strong>Returns</strong></dt><dd></dd>
<dt><strong>———-</strong></dt><dd></dd>
<dt><strong>crosscorr</strong><span class="classifier">float</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.lag_cross_correlation.mincrosscorr">
<span class="sig-name descname"><span class="pre">mincrosscorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/lag_cross_correlation.html#mincrosscorr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.lag_cross_correlation.mincrosscorr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtools.functions.merge">
<span id="vtools-functions-merge-module"></span><h2>vtools.functions.merge module<a class="headerlink" href="#module-vtools.functions.merge" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.merge.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/merge.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.merge.main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.merge.ts_merge">
<span class="sig-name descname"><span class="pre">ts_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/merge.html#ts_merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.merge.ts_merge" title="Permalink to this definition">¶</a></dt>
<dd><p>merge a number of timeseries together and return a new ts.
Similar to concatenate, but provides more control over order in cases of overlap</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>series</strong><span class="classifier">tuple(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a>) or tuple(<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2022.9.1.dev0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataArray)</span></code></a></span></dt><dd><p>Series ranked from hight to low priority</p>
</dd>
<dt><strong>Returns</strong></dt><dd></dd>
<dt><strong>——-</strong></dt><dd></dd>
<dt><strong>merged</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>A new time series with time interval same as the inputs, time extent
the union of the inputs, and filled first with ts1, then with remaining
gaps filled with ts2, then ts3….</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.merge.ts_splice">
<span class="sig-name descname"><span class="pre">ts_splice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prefer_last'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">floor_dates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/merge.html#ts_splice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.merge.ts_splice" title="Permalink to this definition">¶</a></dt>
<dd><p>splice a number of timeseries together in a non-overlapping way. 
The function supports three methods of positioning the breakpoints
between series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>series</strong><span class="classifier">tuple(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a>)</span></dt><dd><p>Series ranked from first to last in time. Must have identical column structure
or unexpected results may occur during concatenate.</p>
</dd>
<dt><strong>transition</strong><span class="classifier">‘prefer_first’ | ‘prefer_last’ | list(pd.Datetime)</span></dt><dd><p>Description of how to switch between series. If prefer_first, the
earlier series will be used until their end point.  
If prefer_last, the first time stamp of the 
later series will be used.</p>
</dd>
<dt><strong>floor_dates: bool</strong></dt><dd><p>Floor the transition dates that are inferred with ‘prefer_first’ or ‘prefer_last’.
Note that this can produce nans if the input series are regular with a freq attribute
or a big gap otherwise unless there is overlapping data covering the days that are rounded.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>spliced</strong><span class="classifier"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>A new time series with freq same as the inputs if they are all the same,
time extent the union of the inputs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-vtools.functions.period_op">
<span id="vtools-functions-period-op-module"></span><h2>vtools.functions.period_op module<a class="headerlink" href="#module-vtools.functions.period_op" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.period_op.period_op">
<span class="sig-name descname"><span class="pre">period_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'D'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_absent_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/period_op.html#period_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.period_op.period_op" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.period_op.window_op">
<span class="sig-name descname"><span class="pre">window_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'D'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_absent_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/period_op.html#window_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.period_op.window_op" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-vtools.functions.skill_metrics">
<span id="vtools-functions-skill-metrics-module"></span><h2>vtools.functions.skill_metrics module<a class="headerlink" href="#module-vtools.functions.skill_metrics" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics._main">
<span class="sig-name descname"><span class="pre">_main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#_main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics._main" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.corr_coefficient">
<span class="sig-name descname"><span class="pre">corr_coefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pearson'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#corr_coefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.corr_coefficient" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the correlation coefficient (the ‘r’ in ‘-squared’ between two series.</p>
<p>For time series where the targets are serially correlated and may span only a fraction
of the natural variability, this statistic may not be appropriate and Murphy (1988) explains
why caution should be exercised in using this statistic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series to analyze</p>
</dd>
<dt><strong>method</strong><span class="classifier">pearson’, ‘kendall’, ‘spearman’</span></dt><dd><p>Method compatilble with pandasa</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>r</strong><span class="classifier">float</span></dt><dd><p>Correlation coefficient</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.mean_error">
<span class="sig-name descname"><span class="pre">mean_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proportiontocut</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#mean_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.mean_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the untrimmed mean error, discounting nan values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to be analyzed</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>med</strong><span class="classifier">float</span></dt><dd><p>Median error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.median_error">
<span class="sig-name descname"><span class="pre">median_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#median_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.median_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the median error, discounting nan values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to be analyzed</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>med</strong><span class="classifier">float</span></dt><dd><p>Median error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.mse">
<span class="sig-name descname"><span class="pre">mse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#mse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.mse" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean squared error</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to analyze</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mse</strong><span class="classifier">vtools.data.timeseries.TimeSeries</span></dt><dd><p>Mean squared error between predictions and targets</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.rmse">
<span class="sig-name descname"><span class="pre">rmse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#rmse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.rmse" title="Permalink to this definition">¶</a></dt>
<dd><p>Root mean squared error</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to analyze</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mse</strong><span class="classifier">float</span></dt><dd><p>Mean squared error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.skill_score">
<span class="sig-name descname"><span class="pre">skill_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#skill_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.skill_score" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a Nash-Sutcliffe-like skill score based on mean squared error</p>
<p>As per the discussion in Murphy (1988) other reference forecasts (climatology, 
harmonic tide, etc.) are possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to be analyzed</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>rmse</strong><span class="classifier">float</span></dt><dd><p>Root mean squared error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.tmean_error">
<span class="sig-name descname"><span class="pre">tmean_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclusive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[True,</span> <span class="pre">True]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#tmean_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.tmean_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the (possibly trimmed) mean error, discounting nan values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to be analyzed</p>
</dd>
<dt><strong>limits</strong><span class="classifier">tuple(float)</span></dt><dd><p>Low and high limits for trimming</p>
</dd>
<dt><strong>inclusive</strong><span class="classifier">[boolean, boolean]</span></dt><dd><p>True if clipping is inclusive on the low/high end</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mean</strong><span class="classifier">float</span></dt><dd><p>Trimmed mean error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-vtools.functions">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-vtools.functions" title="Permalink to this heading">¶</a></h2>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, California Department of Water Resources.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/vtools.functions.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>