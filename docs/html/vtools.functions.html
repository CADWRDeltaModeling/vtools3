<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>vtools.functions package &#8212; vtools 3.9.5.post5+dirty documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <script src="_static/documentation_options.js?v=0ca39674"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="vtools.datastore package" href="vtools.datastore.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.png" border="0" alt="py4sci"/></a>
</div>



      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/dwrsmall.jpg" alt="Logo"/>
            </a></p>
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/dwrsmall.jpg" alt="Logo" />
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Introduction and concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="daylight_savings.html">Daylight Savings conversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolation.html">Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/filters.html">Averging, Filtering and Low Passing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/filters.html#Filters">Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/tidal_envelope.html">Tidal Envelope Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/climatology.html">Fitting and using a climatology</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/merge_splice.html">Merging and Splicing Time Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/merge_splice.html#ts_merge:-strict-priority-option"><code class="docutils literal notranslate"><span class="pre">ts_merge</span></code>: strict priority option</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/extrapolation.html">Extrapolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/transition.html">Transitioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/neighbor_fill.html">Filling Series Based on a Neighbor (like series)</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="vtools.html">vtools package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">vtools</a><ul>
  <li><a href="vtools.html">vtools package</a><ul>
      <li>Previous: <a href="vtools.datastore.html" title="previous chapter">vtools.datastore package</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="vtools-functions-package">
<h1>vtools.functions package<a class="headerlink" href="#vtools-functions-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-vtools.functions.climatology">
<span id="vtools-functions-climatology-module"></span><h2>vtools.functions.climatology module<a class="headerlink" href="#module-vtools.functions.climatology" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.climatology.apply_climatology">
<span class="sig-name descname"><span class="pre">apply_climatology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">climate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/climatology.html#apply_climatology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.climatology.apply_climatology" title="Link to this definition">¶</a></dt>
<dd><p>Apply daily or monthly climatology to a new index or generate index from start/end/freq</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>climate</strong><span class="classifier">DataFrame or Series</span></dt><dd><p>DataFrame with integer index representing month of year (Jan=1) or day of year. Must be of size 12, 365, or 366. Day 366 will be inferred from day 365 value.</p>
</dd>
<dt><strong>index</strong><span class="classifier">pandas.DatetimeIndex, optional</span></dt><dd><p>Locations to be inferred. If not provided, must specify start, end, and freq.</p>
</dd>
<dt><strong>start</strong><span class="classifier">str or datetime-like, optional</span></dt><dd><p>Start date for generating index (used if index is None).</p>
</dd>
<dt><strong>end</strong><span class="classifier">str or datetime-like, optional</span></dt><dd><p>End date for generating index (used if index is None).</p>
</dd>
<dt><strong>freq</strong><span class="classifier">str, optional</span></dt><dd><p>Frequency string for generating index (used if index is None). E.g., ‘D’ for daily, ‘M’ for monthly.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>DataFrame or Series</dt><dd><p>Values extracted from climatology for the month or day at the specified index.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If index is not provided, start, end, and freq must be specified to generate a DatetimeIndex using pandas.date_range.</p></li>
<li><p>Backward compatible: original behavior is preserved if index is provided.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.climatology.climatology">
<span class="sig-name descname"><span class="pre">climatology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsmooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/climatology.html#climatology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.climatology.climatology" title="Link to this definition">¶</a></dt>
<dd><p>“ Create a climatology on the columns of ts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts: DataFrame or Series</strong></dt><dd></dd>
<dt><strong>DataStructure to be analyzed. Must have a length of at least 2*freq</strong></dt><dd></dd>
<dt><strong>freq: period [“day”,”month”]</strong></dt><dd></dd>
<dt><strong>Period over which the climatology is analyzed</strong></dt><dd></dd>
<dt><strong>nsmooth: int</strong></dt><dd><p>window size (number of values) of pre-smoothing. This may not make sense for series that are not approximately regular. An odd number is usually best.</p>
</dd>
<dt><strong>Returns:</strong></dt><dd><p>out: DataFrame or Series
Data structure of the same type as ts, with Integer index representing month (Jan=1) or day of year (1:365).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.climatology.climatology_quantiles">
<span class="sig-name descname"><span class="pre">climatology_quantiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_day_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_day_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.05,</span> <span class="pre">0.25,</span> <span class="pre">0.5,</span> <span class="pre">0.75,</span> <span class="pre">0.95]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/climatology.html#climatology_quantiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.climatology.climatology_quantiles" title="Link to this definition">¶</a></dt>
<dd><p>“ Create windowed quantiles across years on a time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts: DataFrame or Series</strong></dt><dd></dd>
<dt><strong>DataStructure to be analyzed.</strong></dt><dd></dd>
<dt><strong>min_day_year: int</strong></dt><dd></dd>
<dt><strong>Minimum Julian day to be considered</strong></dt><dd></dd>
<dt><strong>freq: period [“day”,”month”]</strong></dt><dd></dd>
<dt><strong>Maximum Julian day to be considered</strong></dt><dd></dd>
<dt><strong>window_width: int</strong></dt><dd></dd>
<dt><strong>Number of days to include, including the central day and days on each side. So for instance window_width=15 would span the central date and 7 days on each side</strong></dt><dd></dd>
<dt><strong>quantiles: array-like</strong></dt><dd><p>quantiles requested</p>
</dd>
<dt><strong>Returns:</strong></dt><dd><p>out: DataFrame or Series
Data structure with Julian day as the index and quantiles as columns.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vtools.functions.colname_align">
<span id="vtools-functions-colname-align-module"></span><h2>vtools.functions.colname_align module<a class="headerlink" href="#module-vtools.functions.colname_align" title="Link to this heading">¶</a></h2>
<p>Column naming alignment utilities for time series composition functions.</p>
<p>This module provides decorators that standardize how functions like
<code class="docutils literal notranslate"><span class="pre">ts_merge</span></code>, <code class="docutils literal notranslate"><span class="pre">ts_splice</span></code>, and <code class="docutils literal notranslate"><span class="pre">transition_ts</span></code> handle their <code class="docutils literal notranslate"><span class="pre">names</span></code>
argument and enforce column consistency across multiple time series inputs.</p>
<section id="main-features">
<h3>Main features<a class="headerlink" href="#main-features" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>Column consistency enforcement</strong>:
Ensures that when <code class="docutils literal notranslate"><span class="pre">names=None</span></code> (default), all input DataFrames share
identical columns. This prevents accidental creation of staggered or
mismatched columns.</p></li>
<li><p><strong>Centralized naming behavior</strong>:
Applies uniform handling of <code class="docutils literal notranslate"><span class="pre">names</span></code> values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> — require identical columns across all inputs and keep them.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code> — require univariate inputs (single column each); output is
a single-column DataFrame (or Series if all inputs were Series) with
this name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Iterable[str]</span></code> — treated as a column selector: these columns are
selected (and ordered) from the final output and must exist in every
input.</p></li>
</ul>
</li>
<li><p><strong>Support for both list-style and pairwise APIs</strong>:
Works for functions that accept a sequence of time series (like
<code class="docutils literal notranslate"><span class="pre">ts_merge</span></code>/<code class="docutils literal notranslate"><span class="pre">ts_splice</span></code>) or two explicit series arguments
(like <code class="docutils literal notranslate"><span class="pre">transition_ts</span></code>).</p></li>
</ul>
</section>
<section id="usage-pattern">
<h3>Usage pattern<a class="headerlink" href="#usage-pattern" title="Link to this heading">¶</a></h3>
<p>Decorate your functions as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@columns_aligned</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same_set&quot;</span><span class="p">)</span>
<span class="nd">@names_aligned</span><span class="p">(</span><span class="n">seq_arg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pre_rename</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">ts_splice</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
    <span class="o">...</span>

<span class="nd">@columns_aligned</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same_set&quot;</span><span class="p">)</span>
<span class="nd">@names_aligned_pair</span><span class="p">(</span><span class="n">ts0_kw</span><span class="o">=</span><span class="s2">&quot;ts0&quot;</span><span class="p">,</span> <span class="n">ts1_kw</span><span class="o">=</span><span class="s2">&quot;ts1&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">transition_ts</span><span class="p">(</span><span class="n">ts0</span><span class="p">,</span> <span class="n">ts1</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>This ensures consistent semantics for all multi-series combination tools.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.colname_align._coerce_inputs_strict">
<span class="sig-name descname"><span class="pre">_coerce_inputs_strict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/colname_align.html#_coerce_inputs_strict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.colname_align._coerce_inputs_strict" title="Link to this definition">¶</a></dt>
<dd><p>Strict input alignment policy:
- names is None  -&gt; all inputs must have identical column lists (no unions/intersections).
- names is str   -&gt; leave inputs as-is; final renaming happens via align_names(…).
- names is list  -&gt; for each DF, select exactly those columns; for a Series, only len==1 allowed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.colname_align.align_inputs_pair_strict">
<span class="sig-name descname"><span class="pre">align_inputs_pair_strict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts0_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ts0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts1_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ts1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'names'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/colname_align.html#align_inputs_pair_strict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.colname_align.align_inputs_pair_strict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.colname_align.align_inputs_strict">
<span class="sig-name descname"><span class="pre">align_inputs_strict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_arg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'names'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/colname_align.html#align_inputs_strict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.colname_align.align_inputs_strict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.colname_align.align_names">
<span class="sig-name descname"><span class="pre">align_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/colname_align.html#align_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.colname_align.align_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-vtools.functions.envelope">
<span id="vtools-functions-envelope-module"></span><h2>vtools.functions.envelope module<a class="headerlink" href="#module-vtools.functions.envelope" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PchipInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_cubic.html#PchipInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">CubicHermiteSpline</span></code></p>
<p>PCHIP 1-D monotonic cubic interpolation.</p>
<p><code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are arrays of values used to approximate some function f,
with <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">f(x)</span></code>. The interpolant uses monotonic cubic splines
to find the value of new points. (PCHIP stands for Piecewise Cubic
Hermite Interpolating Polynomial).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">ndarray, shape (npoints, )</span></dt><dd><p>A 1-D array of monotonically increasing real values. <code class="docutils literal notranslate"><span class="pre">x</span></code> cannot
include duplicate values (otherwise f is overspecified)</p>
</dd>
<dt><strong>y</strong><span class="classifier">ndarray, shape (…, npoints, …)</span></dt><dd><p>A N-D array of real values. <code class="docutils literal notranslate"><span class="pre">y</span></code>’s length along the interpolation
axis must be equal to the length of <code class="docutils literal notranslate"><span class="pre">x</span></code>. Use the <code class="docutils literal notranslate"><span class="pre">axis</span></code>
parameter to select the interpolation axis.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>Axis in the <code class="docutils literal notranslate"><span class="pre">y</span></code> array corresponding to the x-coordinate values. Defaults
to <code class="docutils literal notranslate"><span class="pre">axis=0</span></code>.</p>
</dd>
<dt><strong>extrapolate</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to extrapolate to out-of-bounds points based on first
and last intervals, or to return NaNs.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">CubicHermiteSpline</span></code></dt><dd><p>Piecewise-cubic interpolator.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Akima1DInterpolator</span></code></dt><dd><p>Akima 1D interpolator.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">CubicSpline</span></code></dt><dd><p>Cubic spline data interpolator.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">PPoly</span></code></dt><dd><p>Piecewise polynomial in terms of coefficients and breakpoints.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The interpolator preserves monotonicity in the interpolation data and does
not overshoot if the data is not smooth.</p>
<p>The first derivatives are guaranteed to be continuous, but the second
derivatives may jump at <span class="math notranslate nohighlight">\(x_k\)</span>.</p>
<p>Determines the derivatives at the points <span class="math notranslate nohighlight">\(x_k\)</span>, <span class="math notranslate nohighlight">\(f'_k\)</span>,
by using PCHIP algorithm <a class="reference internal" href="#rca5d2d2ab283-1" id="id1">[1]</a>.</p>
<p>Let <span class="math notranslate nohighlight">\(h_k = x_{k+1} - x_k\)</span>, and  <span class="math notranslate nohighlight">\(d_k = (y_{k+1} - y_k) / h_k\)</span>
are the slopes at internal points <span class="math notranslate nohighlight">\(x_k\)</span>.
If the signs of <span class="math notranslate nohighlight">\(d_k\)</span> and <span class="math notranslate nohighlight">\(d_{k-1}\)</span> are different or either of
them equals zero, then <span class="math notranslate nohighlight">\(f'_k = 0\)</span>. Otherwise, it is given by the
weighted harmonic mean</p>
<div class="math notranslate nohighlight">
\[\frac{w_1 + w_2}{f'_k} = \frac{w_1}{d_{k-1}} + \frac{w_2}{d_k}\]</div>
<p>where <span class="math notranslate nohighlight">\(w_1 = 2 h_k + h_{k-1}\)</span> and <span class="math notranslate nohighlight">\(w_2 = h_k + 2 h_{k-1}\)</span>.</p>
<p>The end slopes are set using a one-sided scheme <a class="reference internal" href="#rca5d2d2ab283-2" id="id2">[2]</a>.</p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="rca5d2d2ab283-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>F. N. Fritsch and J. Butland,
A method for constructing local
monotone piecewise cubic interpolants,
SIAM J. Sci. Comput., 5(2), 300-304 (1984).
<a href="#id3"><span class="problematic" id="id4">:doi:`10.1137/0905021`</span></a>.</p>
</div>
<div class="citation" id="rca5d2d2ab283-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>see, e.g., C. Moler, Numerical Computing with Matlab, 2004.
<a href="#id5"><span class="problematic" id="id6">:doi:`10.1137/1.9780898717952`</span></a></p>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>axis</strong></dt><dd></dd>
<dt><strong>c</strong></dt><dd></dd>
<dt><strong>extrapolate</strong></dt><dd></dd>
<dt><strong>x</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(x[, nu, extrapolate])</p></td>
<td><p>Evaluate the piecewise polynomial or its derivative.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">derivative</span></code>([nu])</p></td>
<td><p>Construct a new piecewise polynomial representing the derivative.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">antiderivative</span></code>([nu])</p></td>
<td><p>Construct a new piecewise polynomial representing the antiderivative.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">roots</span></code>([discontinuity, extrapolate])</p></td>
<td><p>Find real roots of the piecewise polynomial.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator.__annotations__">
<span class="sig-name descname"><span class="pre">__annotations__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator.__annotations__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&quot;PCHIP</span> <span class="pre">1-D</span> <span class="pre">monotonic</span> <span class="pre">cubic</span> <span class="pre">interpolation.\n\n</span>&#160;&#160;&#160; <span class="pre">``x``</span> <span class="pre">and</span> <span class="pre">``y``</span> <span class="pre">are</span> <span class="pre">arrays</span> <span class="pre">of</span> <span class="pre">values</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">approximate</span> <span class="pre">some</span> <span class="pre">function</span> <span class="pre">f,\n</span>&#160;&#160;&#160; <span class="pre">with</span> <span class="pre">``y</span> <span class="pre">=</span> <span class="pre">f(x)``.</span> <span class="pre">The</span> <span class="pre">interpolant</span> <span class="pre">uses</span> <span class="pre">monotonic</span> <span class="pre">cubic</span> <span class="pre">splines\n</span>&#160;&#160;&#160; <span class="pre">to</span> <span class="pre">find</span> <span class="pre">the</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">new</span> <span class="pre">points.</span> <span class="pre">(PCHIP</span> <span class="pre">stands</span> <span class="pre">for</span> <span class="pre">Piecewise</span> <span class="pre">Cubic\n</span>&#160;&#160;&#160; <span class="pre">Hermite</span> <span class="pre">Interpolating</span> <span class="pre">Polynomial).\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">x</span> <span class="pre">:</span> <span class="pre">ndarray,</span> <span class="pre">shape</span> <span class="pre">(npoints,</span> <span class="pre">)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">1-D</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">monotonically</span> <span class="pre">increasing</span> <span class="pre">real</span> <span class="pre">values.</span> <span class="pre">``x``</span> <span class="pre">cannot\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">include</span> <span class="pre">duplicate</span> <span class="pre">values</span> <span class="pre">(otherwise</span> <span class="pre">f</span> <span class="pre">is</span> <span class="pre">overspecified)\n</span>&#160;&#160;&#160; <span class="pre">y</span> <span class="pre">:</span> <span class="pre">ndarray,</span> <span class="pre">shape</span> <span class="pre">(...,</span> <span class="pre">npoints,</span> <span class="pre">...)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">N-D</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">real</span> <span class="pre">values.</span> <span class="pre">``y``'s</span> <span class="pre">length</span> <span class="pre">along</span> <span class="pre">the</span> <span class="pre">interpolation\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">axis</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">equal</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">length</span> <span class="pre">of</span> <span class="pre">``x``.</span> <span class="pre">Use</span> <span class="pre">the</span> <span class="pre">``axis``\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">parameter</span> <span class="pre">to</span> <span class="pre">select</span> <span class="pre">the</span> <span class="pre">interpolation</span> <span class="pre">axis.\n</span>&#160;&#160;&#160; <span class="pre">axis</span> <span class="pre">:</span> <span class="pre">int,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Axis</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">``y``</span> <span class="pre">array</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">x-coordinate</span> <span class="pre">values.</span> <span class="pre">Defaults\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">to</span> <span class="pre">``axis=0``.\n</span>&#160;&#160;&#160; <span class="pre">extrapolate</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Whether</span> <span class="pre">to</span> <span class="pre">extrapolate</span> <span class="pre">to</span> <span class="pre">out-of-bounds</span> <span class="pre">points</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">first\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">and</span> <span class="pre">last</span> <span class="pre">intervals,</span> <span class="pre">or</span> <span class="pre">to</span> <span class="pre">return</span> <span class="pre">NaNs.\n\n</span>&#160;&#160;&#160; <span class="pre">Methods\n</span>&#160;&#160;&#160; <span class="pre">-------\n</span>&#160;&#160;&#160; <span class="pre">__call__\n</span>&#160;&#160;&#160; <span class="pre">derivative\n</span>&#160;&#160;&#160; <span class="pre">antiderivative\n</span>&#160;&#160;&#160; <span class="pre">roots\n\n</span>&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">Also\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">CubicHermiteSpline</span> <span class="pre">:</span> <span class="pre">Piecewise-cubic</span> <span class="pre">interpolator.\n</span>&#160;&#160;&#160; <span class="pre">Akima1DInterpolator</span> <span class="pre">:</span> <span class="pre">Akima</span> <span class="pre">1D</span> <span class="pre">interpolator.\n</span>&#160;&#160;&#160; <span class="pre">CubicSpline</span> <span class="pre">:</span> <span class="pre">Cubic</span> <span class="pre">spline</span> <span class="pre">data</span> <span class="pre">interpolator.\n</span>&#160;&#160;&#160; <span class="pre">PPoly</span> <span class="pre">:</span> <span class="pre">Piecewise</span> <span class="pre">polynomial</span> <span class="pre">in</span> <span class="pre">terms</span> <span class="pre">of</span> <span class="pre">coefficients</span> <span class="pre">and</span> <span class="pre">breakpoints.\n\n</span>&#160;&#160;&#160; <span class="pre">Notes\n</span>&#160;&#160;&#160; <span class="pre">-----\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">interpolator</span> <span class="pre">preserves</span> <span class="pre">monotonicity</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">interpolation</span> <span class="pre">data</span> <span class="pre">and</span> <span class="pre">does\n</span>&#160;&#160;&#160; <span class="pre">not</span> <span class="pre">overshoot</span> <span class="pre">if</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">smooth.\n\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">first</span> <span class="pre">derivatives</span> <span class="pre">are</span> <span class="pre">guaranteed</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">continuous,</span> <span class="pre">but</span> <span class="pre">the</span> <span class="pre">second\n</span>&#160;&#160;&#160; <span class="pre">derivatives</span> <span class="pre">may</span> <span class="pre">jump</span> <span class="pre">at</span> <span class="pre">:math:`x_k`.\n\n</span>&#160;&#160;&#160; <span class="pre">Determines</span> <span class="pre">the</span> <span class="pre">derivatives</span> <span class="pre">at</span> <span class="pre">the</span> <span class="pre">points</span> <span class="pre">:math:`x_k`,</span> <span class="pre">:math:`f'_k`,\n</span>&#160;&#160;&#160; <span class="pre">by</span> <span class="pre">using</span> <span class="pre">PCHIP</span> <span class="pre">algorithm</span> <span class="pre">[1]_.\n\n</span>&#160;&#160;&#160; <span class="pre">Let</span> <span class="pre">:math:`h_k</span> <span class="pre">=</span> <span class="pre">x_{k+1}</span> <span class="pre">-</span> <span class="pre">x_k`,</span> <span class="pre">and</span>&#160; <span class="pre">:math:`d_k</span> <span class="pre">=</span> <span class="pre">(y_{k+1}</span> <span class="pre">-</span> <span class="pre">y_k)</span> <span class="pre">/</span> <span class="pre">h_k`\n</span>&#160;&#160;&#160; <span class="pre">are</span> <span class="pre">the</span> <span class="pre">slopes</span> <span class="pre">at</span> <span class="pre">internal</span> <span class="pre">points</span> <span class="pre">:math:`x_k`.\n</span>&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">the</span> <span class="pre">signs</span> <span class="pre">of</span> <span class="pre">:math:`d_k`</span> <span class="pre">and</span> <span class="pre">:math:`d_{k-1}`</span> <span class="pre">are</span> <span class="pre">different</span> <span class="pre">or</span> <span class="pre">either</span> <span class="pre">of\n</span>&#160;&#160;&#160; <span class="pre">them</span> <span class="pre">equals</span> <span class="pre">zero,</span> <span class="pre">then</span> <span class="pre">:math:`f'_k</span> <span class="pre">=</span> <span class="pre">0`.</span> <span class="pre">Otherwise,</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">given</span> <span class="pre">by</span> <span class="pre">the\n</span>&#160;&#160;&#160; <span class="pre">weighted</span> <span class="pre">harmonic</span> <span class="pre">mean\n\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">math::\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\\frac{w_1</span> <span class="pre">+</span> <span class="pre">w_2}{f'_k}</span> <span class="pre">=</span> <span class="pre">\\frac{w_1}{d_{k-1}}</span> <span class="pre">+</span> <span class="pre">\\frac{w_2}{d_k}\n\n</span>&#160;&#160;&#160; <span class="pre">where</span> <span class="pre">:math:`w_1</span> <span class="pre">=</span> <span class="pre">2</span> <span class="pre">h_k</span> <span class="pre">+</span> <span class="pre">h_{k-1}`</span> <span class="pre">and</span> <span class="pre">:math:`w_2</span> <span class="pre">=</span> <span class="pre">h_k</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">h_{k-1}`.\n\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">end</span> <span class="pre">slopes</span> <span class="pre">are</span> <span class="pre">set</span> <span class="pre">using</span> <span class="pre">a</span> <span class="pre">one-sided</span> <span class="pre">scheme</span> <span class="pre">[2]_.\n\n\n</span>&#160;&#160;&#160; <span class="pre">References\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">[1]</span> <span class="pre">F.</span> <span class="pre">N.</span> <span class="pre">Fritsch</span> <span class="pre">and</span> <span class="pre">J.</span> <span class="pre">Butland,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">method</span> <span class="pre">for</span> <span class="pre">constructing</span> <span class="pre">local\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">monotone</span> <span class="pre">piecewise</span> <span class="pre">cubic</span> <span class="pre">interpolants,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">SIAM</span> <span class="pre">J.</span> <span class="pre">Sci.</span> <span class="pre">Comput.,</span> <span class="pre">5(2),</span> <span class="pre">300-304</span> <span class="pre">(1984).\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">:doi:`10.1137/0905021`.\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">[2]</span> <span class="pre">see,</span> <span class="pre">e.g.,</span> <span class="pre">C.</span> <span class="pre">Moler,</span> <span class="pre">Numerical</span> <span class="pre">Computing</span> <span class="pre">with</span> <span class="pre">Matlab,</span> <span class="pre">2004.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">:doi:`10.1137/1.9780898717952`\n\n</span>&#160;&#160;&#160; <span class="pre">&quot;</span></em><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_cubic.html#PchipInterpolator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'scipy.interpolate._cubic'</span></em><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator._edge_case">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_edge_case</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_cubic.html#PchipInterpolator._edge_case"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator._edge_case" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator._find_derivatives">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_find_derivatives</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_cubic.html#PchipInterpolator._find_derivatives"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator._find_derivatives" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator.axis">
<span class="sig-name descname"><span class="pre">axis</span></span><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator.axis" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator.c">
<span class="sig-name descname"><span class="pre">c</span></span><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator.extrapolate">
<span class="sig-name descname"><span class="pre">extrapolate</span></span><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator.extrapolate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator.x">
<span class="sig-name descname"><span class="pre">x</span></span><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator.x" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.chunked_loess_smoothing">
<span class="sig-name descname"><span class="pre">chunked_loess_smoothing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_days</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_days</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#chunked_loess_smoothing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.chunked_loess_smoothing" title="Link to this definition">¶</a></dt>
<dd><p>Apply LOESS smoothing in overlapping chunks to reduce computation time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts</strong><span class="classifier">pd.Series</span></dt><dd><p>Time series with datetime index and possible NaNs.</p>
</dd>
<dt><strong>window_hours</strong><span class="classifier">float</span></dt><dd><p>LOESS smoothing window size in hours.</p>
</dd>
<dt><strong>chunk_days</strong><span class="classifier">int</span></dt><dd><p>Core chunk size (e.g., 10 days).</p>
</dd>
<dt><strong>overlap_days</strong><span class="classifier">int</span></dt><dd><p>Overlap added before and after each chunk to avoid edge effects.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pd.Series</dt><dd><p>Smoothed series, NaNs where input is NaN or unsupported.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.filter_extrema_ngood">
<span class="sig-name descname"><span class="pre">filter_extrema_ngood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extrema_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loess_window_pts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_good</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig_gap_minutes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#filter_extrema_ngood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.filter_extrema_ngood" title="Link to this definition">¶</a></dt>
<dd><p>Filter extrema based on local and contextual data quality criteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>extrema_df</strong><span class="classifier">pd.DataFrame</span></dt><dd><p>DataFrame with columns ‘time’ and ‘value’ for candidate extrema.</p>
</dd>
<dt><strong>smoothed</strong><span class="classifier">pd.Series</span></dt><dd><p>Smoothed version of the signal used for extrema detection.</p>
</dd>
<dt><strong>series</strong><span class="classifier">pd.Series</span></dt><dd><p>Original time series (with gaps).</p>
</dd>
<dt><strong>loess_window_pts</strong><span class="classifier">int</span></dt><dd><p>Number of points in the LOESS window.</p>
</dd>
<dt><strong>n_good</strong><span class="classifier">int</span></dt><dd><p>Minimum number of non-NaN points required.</p>
</dd>
<dt><strong>sig_gap_minutes</strong><span class="classifier">float</span></dt><dd><p>Threshold for detecting significant gaps (in minutes).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pd.DataFrame</dt><dd><p>Filtered extrema DataFrame.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.find_peaks">
<span class="sig-name descname"><span class="pre">find_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prominence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plateau_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/_peak_finding.html#find_peaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.find_peaks" title="Link to this definition">¶</a></dt>
<dd><p>Find peaks inside a signal based on peak properties.</p>
<p>This function takes a 1-D array and finds all local maxima by
simple comparison of neighboring values. Optionally, a subset of these
peaks can be selected by specifying conditions for a peak’s properties.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier">sequence</span></dt><dd><p>A signal with peaks.</p>
</dd>
<dt><strong>height</strong><span class="classifier">number or ndarray or sequence, optional</span></dt><dd><p>Required height of peaks. Either a number, <code class="docutils literal notranslate"><span class="pre">None</span></code>, an array matching
<cite>x</cite> or a 2-element sequence of the former. The first element is
always interpreted as the  minimal and the second, if supplied, as the
maximal required height.</p>
</dd>
<dt><strong>threshold</strong><span class="classifier">number or ndarray or sequence, optional</span></dt><dd><p>Required threshold of peaks, the vertical distance to its neighboring
samples. Either a number, <code class="docutils literal notranslate"><span class="pre">None</span></code>, an array matching <cite>x</cite> or a
2-element sequence of the former. The first element is always
interpreted as the  minimal and the second, if supplied, as the maximal
required threshold.</p>
</dd>
<dt><strong>distance</strong><span class="classifier">number, optional</span></dt><dd><p>Required minimal horizontal distance (&gt;= 1) in samples between
neighbouring peaks. Smaller peaks are removed first until the condition
is fulfilled for all remaining peaks.</p>
</dd>
<dt><strong>prominence</strong><span class="classifier">number or ndarray or sequence, optional</span></dt><dd><p>Required prominence of peaks. Either a number, <code class="docutils literal notranslate"><span class="pre">None</span></code>, an array
matching <cite>x</cite> or a 2-element sequence of the former. The first
element is always interpreted as the  minimal and the second, if
supplied, as the maximal required prominence.</p>
</dd>
<dt><strong>width</strong><span class="classifier">number or ndarray or sequence, optional</span></dt><dd><p>Required width of peaks in samples. Either a number, <code class="docutils literal notranslate"><span class="pre">None</span></code>, an array
matching <cite>x</cite> or a 2-element sequence of the former. The first
element is always interpreted as the  minimal and the second, if
supplied, as the maximal required width.</p>
</dd>
<dt><strong>wlen</strong><span class="classifier">int, optional</span></dt><dd><p>Used for calculation of the peaks prominences, thus it is only used if
one of the arguments <cite>prominence</cite> or <cite>width</cite> is given. See argument
<cite>wlen</cite> in <cite>peak_prominences</cite> for a full description of its effects.</p>
</dd>
<dt><strong>rel_height</strong><span class="classifier">float, optional</span></dt><dd><p>Used for calculation of the peaks width, thus it is only used if <cite>width</cite>
is given. See argument  <cite>rel_height</cite> in <cite>peak_widths</cite> for a full
description of its effects.</p>
</dd>
<dt><strong>plateau_size</strong><span class="classifier">number or ndarray or sequence, optional</span></dt><dd><p>Required size of the flat top of peaks in samples. Either a number,
<code class="docutils literal notranslate"><span class="pre">None</span></code>, an array matching <cite>x</cite> or a 2-element sequence of the former.
The first element is always interpreted as the minimal and the second,
if supplied as the maximal required plateau size.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.0.</span></p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>peaks</strong><span class="classifier">ndarray</span></dt><dd><p>Indices of peaks in <cite>x</cite> that satisfy all given conditions.</p>
</dd>
<dt><strong>properties</strong><span class="classifier">dict</span></dt><dd><p>A dictionary containing properties of the returned peaks which were
calculated as intermediate results during evaluation of the specified
conditions:</p>
<ul>
<li><dl class="simple">
<dt>‘peak_heights’</dt><dd><p>If <cite>height</cite> is given, the height of each peak in <cite>x</cite>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>‘left_thresholds’, ‘right_thresholds’</dt><dd><p>If <cite>threshold</cite> is given, these keys contain a peaks vertical
distance to its neighbouring samples.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>‘prominences’, ‘right_bases’, ‘left_bases’</dt><dd><p>If <cite>prominence</cite> is given, these keys are accessible. See
<cite>peak_prominences</cite> for a description of their content.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>‘width_heights’, ‘left_ips’, ‘right_ips’</dt><dd><p>If <cite>width</cite> is given, these keys are accessible. See <cite>peak_widths</cite>
for a description of their content.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>‘plateau_sizes’, left_edges’, ‘right_edges’</dt><dd><p>If <cite>plateau_size</cite> is given, these keys are accessible and contain
the indices of a peak’s edges (edges are still part of the
plateau) and the calculated plateau sizes.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.0.</span></p>
</div>
</dd>
</dl>
</li>
</ul>
<p>To calculate and return properties without excluding peaks, provide the
open interval <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">None)</span></code> as a value to the appropriate argument
(excluding <cite>distance</cite>).</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Warns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>PeakPropertyWarning</dt><dd><p>Raised if a peak’s properties have unexpected values (see
<cite>peak_prominences</cite> and <cite>peak_widths</cite>).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function may return unexpected results for data containing NaNs. To
avoid this, NaNs should either be removed or replaced.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_peaks_cwt</span></code></dt><dd><p>Find peaks using the wavelet transformation.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">peak_prominences</span></code></dt><dd><p>Directly calculate the prominence of peaks.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">peak_widths</span></code></dt><dd><p>Directly calculate the width of peaks.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>In the context of this function, a peak or local maximum is defined as any
sample whose two direct neighbours have a smaller amplitude. For flat peaks
(more than one sample of equal amplitude wide) the index of the middle
sample is returned (rounded down in case the number of samples is even).
For noisy signals the peak locations can be off because the noise might
change the position of local maxima. In those cases consider smoothing the
signal before searching for peaks or use other peak finding and fitting
methods (like <cite>find_peaks_cwt</cite>).</p>
<p>Some additional comments on specifying conditions:</p>
<ul class="simple">
<li><p>Almost all conditions (excluding <cite>distance</cite>) can be given as half-open or
closed intervals, e.g., <code class="docutils literal notranslate"><span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">None)</span></code> defines the half-open
interval <span class="math notranslate nohighlight">\([1, \infty]\)</span> while <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">1)</span></code> defines the interval
<span class="math notranslate nohighlight">\([-\infty, 1]\)</span>. The open interval <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">None)</span></code> can be specified
as well, which returns the matching properties without exclusion of peaks.</p></li>
<li><p>The border is always included in the interval used to select valid peaks.</p></li>
<li><p>For several conditions the interval borders can be specified with
arrays matching <cite>x</cite> in shape which enables dynamic constrains based on
the sample position.</p></li>
<li><p>The conditions are evaluated in the following order: <cite>plateau_size</cite>,
<cite>height</cite>, <cite>threshold</cite>, <cite>distance</cite>, <cite>prominence</cite>, <cite>width</cite>. In most cases
this order is the fastest one because faster operations are applied first
to reduce the number of peaks that need to be evaluated later.</p></li>
<li><p>While indices in <cite>peaks</cite> are guaranteed to be at least <cite>distance</cite> samples
apart, edges of flat peaks may be closer than the allowed <cite>distance</cite>.</p></li>
<li><p>Use <cite>wlen</cite> to reduce the time it takes to evaluate the conditions for
<cite>prominence</cite> or <cite>width</cite> if <cite>x</cite> is large or has many local maxima
(see <cite>peak_prominences</cite>).</p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.1.0.</span></p>
</div>
<p class="rubric">Examples</p>
<p>To demonstrate this function’s usage we use a signal <cite>x</cite> supplied with
SciPy (see <cite>scipy.datasets.electrocardiogram</cite>). Let’s find all peaks (local
maxima) in <cite>x</cite> whose amplitude lies above 0.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.datasets</span> <span class="kn">import</span> <span class="n">electrocardiogram</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">find_peaks</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">electrocardiogram</span><span class="p">()[</span><span class="mi">2000</span><span class="p">:</span><span class="mi">4000</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">peaks</span><span class="p">],</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>We can select peaks below 0 with <code class="docutils literal notranslate"><span class="pre">height=(None,</span> <span class="pre">0)</span></code> or use arrays matching
<cite>x</cite> in size to reflect a changing condition for different parts of the
signal.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">border</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">border</span><span class="p">,</span> <span class="n">border</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">border</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">border</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">peaks</span><span class="p">],</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Another useful condition for periodic signals can be given with the
<cite>distance</cite> argument. In this case, we can easily select the positions of
QRS complexes within the electrocardiogram (ECG) by demanding a distance of
at least 150 samples.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span>
<span class="go">array([186, 180, 177, 171, 177, 169, 167, 164, 158, 162, 172])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">peaks</span><span class="p">],</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Especially for noisy signals peaks can be easily grouped by their
prominence (see <cite>peak_prominences</cite>). E.g., we can select all peaks except
for the mentioned QRS complexes by limiting the allowed prominence to 0.6.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span><span class="p">,</span> <span class="n">properties</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prominence</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;prominences&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="go">0.5049999999999999</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">peaks</span><span class="p">],</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>And, finally, let’s examine a different section of the ECG which contains
beat forms of different shape. To select only the atypical heart beats, we
combine two conditions: a minimal prominence of 1 and width of at least 20
samples.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">electrocardiogram</span><span class="p">()[</span><span class="mi">17000</span><span class="p">:</span><span class="mi">18000</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span><span class="p">,</span> <span class="n">properties</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prominence</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;prominences&quot;</span><span class="p">],</span> <span class="n">properties</span><span class="p">[</span><span class="s2">&quot;widths&quot;</span><span class="p">]</span>
<span class="go">(array([1.495, 2.3  ]), array([36.93773946, 39.32723577]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">peaks</span><span class="p">],</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">peaks</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">peaks</span><span class="p">]</span> <span class="o">-</span> <span class="n">properties</span><span class="p">[</span><span class="s2">&quot;prominences&quot;</span><span class="p">],</span>
<span class="gp">... </span>           <span class="n">ymax</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">peaks</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;C1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;width_heights&quot;</span><span class="p">],</span> <span class="n">xmin</span><span class="o">=</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;left_ips&quot;</span><span class="p">],</span>
<span class="gp">... </span>           <span class="n">xmax</span><span class="o">=</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;right_ips&quot;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;C1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.find_raw_extrema">
<span class="sig-name descname"><span class="pre">find_raw_extrema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smoothed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prominence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#find_raw_extrema"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.find_raw_extrema" title="Link to this definition">¶</a></dt>
<dd><p>Find raw peaks and troughs using scipy.signal.find_peaks.
Returns DataFrames for peaks and troughs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.generate_pink_noise">
<span class="sig-name descname"><span class="pre">generate_pink_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#generate_pink_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.generate_pink_noise" title="Link to this definition">¶</a></dt>
<dd><p>Generate pink (1/f) noise using the Voss-McCartney algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n</strong><span class="classifier">int</span></dt><dd><p>Number of samples to generate.</p>
</dd>
<dt><strong>seed</strong><span class="classifier">int or None</span></dt><dd><p>Random seed for reproducibility.</p>
</dd>
<dt><strong>scale</strong><span class="classifier">float</span></dt><dd><p>Standard deviation scaling factor for the noise.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>Pink noise signal of length n.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.generate_simplified_mixed_tide">
<span class="sig-name descname"><span class="pre">generate_simplified_mixed_tide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2022-01-01'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'15min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A_M2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A_K1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A_O1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_D1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.570795</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#generate_simplified_mixed_tide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.generate_simplified_mixed_tide" title="Link to this definition">¶</a></dt>
<dd><p>Generate a simplified synthetic mixed semidiurnal/diurnal tide with explicit O1 and K1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>start_time</strong><span class="classifier">str</span></dt><dd><p>Start time for the series.</p>
</dd>
<dt><strong>ndays</strong><span class="classifier">int</span></dt><dd><p>Number of days.</p>
</dd>
<dt><strong>freq</strong><span class="classifier">str</span></dt><dd><p>Sampling interval.</p>
</dd>
<dt><strong>A_M2</strong><span class="classifier">float</span></dt><dd><p>Amplitude of M2.</p>
</dd>
<dt><strong>A_K1</strong><span class="classifier">float</span></dt><dd><p>Amplitude of K1.</p>
</dd>
<dt><strong>A_O1</strong><span class="classifier">float</span></dt><dd><p>Amplitude of O1.</p>
</dd>
<dt><strong>phase_D1</strong><span class="classifier">float</span></dt><dd><p>Common phase shift for O1 and K1.</p>
</dd>
<dt><strong>return_components</strong><span class="classifier">bool</span></dt><dd><p>Whether to return individual components.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pd.Series or pd.DataFrame</dt><dd><p>Combined tide or components with time index.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.interpolate_envelope">
<span class="sig-name descname"><span class="pre">interpolate_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anchor_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_anchor_gap_hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">36</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#interpolate_envelope"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.interpolate_envelope" title="Link to this definition">¶</a></dt>
<dd><p>Interpolate envelope using PCHIP, breaking if anchor points are too far apart.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.lowess">
<span class="sig-name descname"><span class="pre">lowess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">endog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6666666666666666</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">it</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xvals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'drop'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/nonparametric/smoothers_lowess.html#lowess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.lowess" title="Link to this definition">¶</a></dt>
<dd><p>LOWESS (Locally Weighted Scatterplot Smoothing)</p>
<p>A lowess function that outs smoothed estimates of endog
at the given exog values from points (exog, endog)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>endog</strong><span class="classifier">1-D numpy array</span></dt><dd><p>The y-values of the observed points</p>
</dd>
<dt><strong>exog</strong><span class="classifier">1-D numpy array</span></dt><dd><p>The x-values of the observed points</p>
</dd>
<dt><strong>frac</strong><span class="classifier">float</span></dt><dd><p>Between 0 and 1. The fraction of the data used
when estimating each y-value.</p>
</dd>
<dt><strong>it</strong><span class="classifier">int</span></dt><dd><p>The number of residual-based reweightings
to perform.</p>
</dd>
<dt><strong>delta</strong><span class="classifier">float</span></dt><dd><p>Distance within which to use linear-interpolation
instead of weighted regression.</p>
</dd>
<dt><strong>xvals: 1-D numpy array</strong></dt><dd><p>Values of the exogenous variable at which to evaluate the regression.
If supplied, cannot use delta.</p>
</dd>
<dt><strong>is_sorted</strong><span class="classifier">bool</span></dt><dd><p>If False (default), then the data will be sorted by exog before
calculating lowess. If True, then it is assumed that the data is
already sorted by exog. If xvals is specified, then it too must be
sorted if is_sorted is True.</p>
</dd>
<dt><strong>missing</strong><span class="classifier">str</span></dt><dd><p>Available options are ‘none’, ‘drop’, and ‘raise’. If ‘none’, no nan
checking is done. If ‘drop’, any observations with nans are dropped.
If ‘raise’, an error is raised. Default is ‘drop’.</p>
</dd>
<dt><strong>return_sorted</strong><span class="classifier">bool</span></dt><dd><p>If True (default), then the returned array is sorted by exog and has
missing (nan or infinite) observations removed.
If False, then the returned array is in the same length and the same
sequence of observations as the input array.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">{ndarray, float}</span></dt><dd><p>The returned array is two-dimensional if return_sorted is True, and
one dimensional if return_sorted is False.
If return_sorted is True, then a numpy array with two columns. The
first column contains the sorted x (exog) values and the second column
the associated estimated y (endog) values.
If return_sorted is False, then only the fitted values are returned,
and the observations will be in the same order as the input arrays.
If xvals is provided, then return_sorted is ignored and the returned
array is always one dimensional, containing the y values fitted at
the x values provided by xvals.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This lowess function implements the algorithm given in the
reference below using local linear estimates.</p>
<p>Suppose the input data has N points. The algorithm works by
estimating the <cite>smooth</cite> y_i by taking the frac*N closest points
to (x_i,y_i) based on their x values and estimating y_i
using a weighted linear regression. The weight for (x_j,y_j)
is tricube function applied to abs(x_i-x_j).</p>
<p>If it &gt; 1, then further weighted local linear regressions
are performed, where the weights are the same as above
times the _lowess_bisquare function of the residuals. Each iteration
takes approximately the same amount of time as the original fit,
so these iterations are expensive. They are most useful when
the noise has extremely heavy tails, such as Cauchy noise.
Noise with less heavy-tails, such as t-distributions with df&gt;2,
are less problematic. The weights downgrade the influence of
points with large residuals. In the extreme case, points whose
residuals are larger than 6 times the median absolute residual
are given weight 0.</p>
<p><cite>delta</cite> can be used to save computations. For each <cite>x_i</cite>, regressions
are skipped for points closer than <cite>delta</cite>. The next regression is
fit for the farthest point within delta of <cite>x_i</cite> and all points in
between are estimated by linearly interpolating between the two
regression fits.</p>
<p>Judicious choice of delta can cut computation time considerably
for large data (N &gt; 5000). A good choice is <code class="docutils literal notranslate"><span class="pre">delta</span> <span class="pre">=</span> <span class="pre">0.01</span> <span class="pre">*</span> <span class="pre">range(exog)</span></code>.</p>
<p>If <cite>xvals</cite> is provided, the regression is then computed at those points
and the fit values are returned. Otherwise, the regression is run
at points of <cite>exog</cite>.</p>
<p>Some experimentation is likely required to find a good
choice of <cite>frac</cite> and <cite>iter</cite> for a particular dataset.</p>
<p class="rubric">References</p>
<p>Cleveland, W.S. (1979) “Robust Locally Weighted Regression
and Smoothing Scatterplots”. Journal of the American Statistical
Association 74 (368): 829-836.</p>
<p class="rubric">Examples</p>
<p>The below allows a comparison between how different the fits from
lowess for different values of frac can be.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lowess</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">nonparametric</span><span class="o">.</span><span class="n">lowess</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>This gives a similar comparison for when it is 0 vs not.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lowess</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">nonparametric</span><span class="o">.</span><span class="n">lowess</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">stats</span><span class="o">.</span><span class="n">cauchy</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">it</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.savgol_filter">
<span class="sig-name descname"><span class="pre">savgol_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'interp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/_savitzky_golay.html#savgol_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.savgol_filter" title="Link to this definition">¶</a></dt>
<dd><p>Apply a Savitzky-Golay filter to an array.</p>
<p>This is a 1-D filter. If <cite>x</cite>  has dimension greater than 1, <cite>axis</cite>
determines the axis along which the filter is applied.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">array_like</span></dt><dd><p>The data to be filtered. If <cite>x</cite> is not a single or double precision
floating point array, it will be converted to type <code class="docutils literal notranslate"><span class="pre">numpy.float64</span></code>
before filtering.</p>
</dd>
<dt><strong>window_length</strong><span class="classifier">int</span></dt><dd><p>The length of the filter window (i.e., the number of coefficients).
If <cite>mode</cite> is ‘interp’, <cite>window_length</cite> must be less than or equal
to the size of <cite>x</cite>.</p>
</dd>
<dt><strong>polyorder</strong><span class="classifier">int</span></dt><dd><p>The order of the polynomial used to fit the samples.
<cite>polyorder</cite> must be less than <cite>window_length</cite>.</p>
</dd>
<dt><strong>deriv</strong><span class="classifier">int, optional</span></dt><dd><p>The order of the derivative to compute. This must be a
nonnegative integer. The default is 0, which means to filter
the data without differentiating.</p>
</dd>
<dt><strong>delta</strong><span class="classifier">float, optional</span></dt><dd><p>The spacing of the samples to which the filter will be applied.
This is only used if deriv &gt; 0. Default is 1.0.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>The axis of the array <cite>x</cite> along which the filter is to be applied.
Default is -1.</p>
</dd>
<dt><strong>mode</strong><span class="classifier">str, optional</span></dt><dd><p>Must be ‘mirror’, ‘constant’, ‘nearest’, ‘wrap’ or ‘interp’. This
determines the type of extension to use for the padded signal to
which the filter is applied.  When <cite>mode</cite> is ‘constant’, the padding
value is given by <cite>cval</cite>.  See the Notes for more details on ‘mirror’,
‘constant’, ‘wrap’, and ‘nearest’.
When the ‘interp’ mode is selected (the default), no extension
is used.  Instead, a degree <cite>polyorder</cite> polynomial is fit to the
last <cite>window_length</cite> values of the edges, and this polynomial is
used to evaluate the last <cite>window_length // 2</cite> output values.</p>
</dd>
<dt><strong>cval</strong><span class="classifier">scalar, optional</span></dt><dd><p>Value to fill past the edges of the input if <cite>mode</cite> is ‘constant’.
Default is 0.0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>y</strong><span class="classifier">ndarray, same shape as <cite>x</cite></span></dt><dd><p>The filtered data.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">savgol_coeffs</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Details on the <cite>mode</cite> options:</p>
<blockquote>
<div><dl class="simple">
<dt>‘mirror’:</dt><dd><p>Repeats the values at the edges in reverse order. The value
closest to the edge is not included.</p>
</dd>
<dt>‘nearest’:</dt><dd><p>The extension contains the nearest input value.</p>
</dd>
<dt>‘constant’:</dt><dd><p>The extension contains the value given by the <cite>cval</cite> argument.</p>
</dd>
<dt>‘wrap’:</dt><dd><p>The extension contains the values from the other end of the array.</p>
</dd>
</dl>
</div></blockquote>
<p>For example, if the input is [1, 2, 3, 4, 5, 6, 7, 8], and
<cite>window_length</cite> is 7, the following shows the extended data for
the various <cite>mode</cite> options (assuming <cite>cval</cite> is 0):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mode</span>       <span class="o">|</span>   <span class="n">Ext</span>   <span class="o">|</span>         <span class="n">Input</span>          <span class="o">|</span>   <span class="n">Ext</span>
<span class="o">-----------+---------+------------------------+---------</span>
<span class="s1">&#39;mirror&#39;</span>   <span class="o">|</span> <span class="mi">4</span>  <span class="mi">3</span>  <span class="mi">2</span> <span class="o">|</span> <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span> <span class="o">|</span> <span class="mi">7</span>  <span class="mi">6</span>  <span class="mi">5</span>
<span class="s1">&#39;nearest&#39;</span>  <span class="o">|</span> <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span> <span class="o">|</span> <span class="mi">8</span>  <span class="mi">8</span>  <span class="mi">8</span>
<span class="s1">&#39;constant&#39;</span> <span class="o">|</span> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span> <span class="o">|</span> <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="s1">&#39;wrap&#39;</span>     <span class="o">|</span> <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span> <span class="o">|</span> <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span> <span class="o">|</span> <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.14.0.</span></p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">savgol_filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># For compact display.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<p>Filter with a window length of 5 and a degree 2 polynomial.  Use
the defaults for all other parameters.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">savgol_filter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">array([1.66, 3.17, 3.54, 2.86, 0.66, 0.17, 1.  , 4.  , 9.  ])</span>
</pre></div>
</div>
<p>Note that the last five values in x are samples of a parabola, so
when mode=’interp’ (the default) is used with polyorder=2, the last
three values are unchanged. Compare that to, for example,
<cite>mode=’nearest’</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">savgol_filter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="go">array([1.74, 3.03, 3.54, 2.86, 0.66, 0.17, 1.  , 4.6 , 7.97])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.select_salient_extrema">
<span class="sig-name descname"><span class="pre">select_salient_extrema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extrema</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing_hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'outer'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#select_salient_extrema"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.select_salient_extrema" title="Link to this definition">¶</a></dt>
<dd><p>Select salient extrema (HH/LL or HL/LH) using literal spacing-based OR logic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>extrema</strong><span class="classifier">pd.DataFrame with columns [“time”, “value”]</span></dt><dd><p>Candidate extrema.</p>
</dd>
<dt><strong>typ</strong><span class="classifier">str</span></dt><dd><p>Either “high” or “low” (for peak or trough selection).</p>
</dd>
<dt><strong>spacing_hours</strong><span class="classifier">float</span></dt><dd><p>Time window for neighbor comparison.</p>
</dd>
<dt><strong>envelope_type</strong><span class="classifier">str</span></dt><dd><p>Either “outer” (default) or “inner” to switch saliency logic.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pd.DataFrame</dt><dd><p>Extrema that passed the saliency test.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.smooth_series">
<span class="sig-name descname"><span class="pre">smooth_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.75</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#smooth_series"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.smooth_series" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.smooth_series2">
<span class="sig-name descname"><span class="pre">smooth_series2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_pts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lowess'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#smooth_series2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.smooth_series2" title="Link to this definition">¶</a></dt>
<dd><p>Smooth a time series using the specified method.
Currently supports ‘lowess’, ‘moving_average’, or ‘savgol’.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.tidal_envelope">
<span class="sig-name descname"><span class="pre">tidal_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing_window_hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_good</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_prominence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saliency_window_hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_anchor_gap_hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">36</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'outer'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#tidal_envelope"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.tidal_envelope" title="Link to this definition">¶</a></dt>
<dd><p>Compute the tidal envelope (high and low) of a time series using smoothing, extrema detection, and interpolation.
This function processes a time series to extract its tidal envelope by smoothing the data, identifying significant peaks and troughs, filtering out unreliable extrema, selecting salient extrema within a specified window, and interpolating between anchor points to generate continuous envelope curves.
Parameters
———-
series : pandas.Series</p>
<blockquote>
<div><p>Time-indexed series of water levels or similar data.</p>
</div></blockquote>
<dl class="simple">
<dt>smoothing_window_hours<span class="classifier">float, optional</span></dt><dd><p>Window size in hours for smoothing the input series (default is 2.5).</p>
</dd>
<dt>n_good<span class="classifier">int, optional</span></dt><dd><p>Minimum number of good points required for an extremum to be considered valid (default is 3).</p>
</dd>
<dt>peak_prominence<span class="classifier">float, optional</span></dt><dd><p>Minimum prominence of peaks/troughs to be considered as extrema (default is 0.05).</p>
</dd>
<dt>saliency_window_hours<span class="classifier">float, optional</span></dt><dd><p>Window size in hours for selecting salient extrema (default is 14).</p>
</dd>
<dt>max_anchor_gap_hours<span class="classifier">float, optional</span></dt><dd><p>Maximum allowed gap in hours between anchor points for interpolation (default is 36).</p>
</dd>
<dt>envelope_type<span class="classifier">str, optional</span></dt><dd><p>Type of envelope to compute, e.g., “outer” (default is “outer”).</p>
</dd>
</dl>
<section id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>env_high<span class="classifier">pandas.Series</span></dt><dd><p>Interpolated high (upper) envelope of the input series.</p>
</dd>
<dt>env_low<span class="classifier">pandas.Series</span></dt><dd><p>Interpolated low (lower) envelope of the input series.</p>
</dd>
<dt>anchor_highs<span class="classifier">pandas.DataFrame</span></dt><dd><p>DataFrame of selected anchor points for the high envelope.</p>
</dd>
<dt>anchor_lows<span class="classifier">pandas.DataFrame</span></dt><dd><p>DataFrame of selected anchor points for the low envelope.</p>
</dd>
<dt>smoothed<span class="classifier">pandas.Series</span></dt><dd><p>Smoothed version of the input series.</p>
</dd>
</dl>
</section>
<section id="notes">
<h3>Notes<a class="headerlink" href="#notes" title="Link to this heading">¶</a></h3>
<p>This function assumes regular time intervals in the input series. If the frequency cannot be inferred, it is estimated from the first two timestamps.</p>
</section>
</dd></dl>

</section>
<section id="module-vtools.functions.error_detect">
<span id="vtools-functions-error-detect-module"></span><h2>vtools.functions.error_detect module<a class="headerlink" href="#module-vtools.functions.error_detect" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect._nrepeat">
<span class="sig-name descname"><span class="pre">_nrepeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#_nrepeat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect._nrepeat" title="Link to this definition">¶</a></dt>
<dd><p>Series-only version</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.bounds_test">
<span class="sig-name descname"><span class="pre">bounds_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#bounds_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.bounds_test" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.despike">
<span class="sig-name descname"><span class="pre">despike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#despike"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.despike" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.example">
<span class="sig-name descname"><span class="pre">example</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#example"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.example" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.example2">
<span class="sig-name descname"><span class="pre">example2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#example2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.example2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.med_outliers">
<span class="sig-name descname"><span class="pre">med_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.01,</span> <span class="pre">0.99)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_anomaly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#med_outliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.med_outliers" title="Link to this definition">¶</a></dt>
<dd><p>Detect outliers by running a median filter, subtracting it
from the original series and comparing the resulting residuals
to a global robust range of scale (the interquartile range).
Individual time points are rejected if the residual at that time point is more than level times the range of scale.</p>
<p>The original concept comes from Basu &amp; Meckesheimer (2007)
Automatic outlier detection for time series: an application to sensor data
although they didn’t use the interquartile range but rather
expert judgment. To use this function effectively, you need to
be thoughtful about what the interquartile range will be. For instance,
for a strongly tidal flow station it is likely to</p>
<dl class="simple">
<dt>level: Number of times the scale or interquantile range the data has to be</dt><dd><p>to be rejected.d</p>
</dd>
<dt>scale: Expert judgment of the scale of maximum variation over a time step.</dt><dd><p>If None, the interquartile range will be used. Note that for a
strongly tidal station the interquartile range may substantially overestimate the reasonable variation over a single time step, in which case the filter will work fine, but level should be set to
a number (less than one) accordingly.</p>
</dd>
</dl>
<p>filt_len: length of median filter, default is 5</p>
<dl class="simple">
<dt>quantiles<span class="classifier">tuple of quantiles defining the measure of scale. Ignored</span></dt><dd><p>if scale is given directly. Default is interquartile range, and
this is almost always a reasonable choice.</p>
</dd>
</dl>
<p>copy: if True, a copy is made leaving original series intact</p>
<p>You can also specify rejection of  values based on a simple range</p>
<p>Returns: copy of series with outliers replaced by nan</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.median_test">
<span class="sig-name descname"><span class="pre">median_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.005,</span> <span class="pre">0.095)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#median_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.median_test" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.nrepeat">
<span class="sig-name descname"><span class="pre">nrepeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#nrepeat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.nrepeat" title="Link to this definition">¶</a></dt>
<dd><p>Return the length of consecutive runs of repeated values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts:  DataFrame or series</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Like-indexed series with lengths of runs. Nans will be mapped to 0</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.steep_then_nan">
<span class="sig-name descname"><span class="pre">steep_then_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.01,</span> <span class="pre">0.99)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_anomaly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#steep_then_nan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.steep_then_nan" title="Link to this definition">¶</a></dt>
<dd><p>Detect outliers by running a median filter, subtracting it
from the original series and comparing the resulting residuals
to a global robust range of scale (the interquartile range).
Individual time points are rejected if the residual at that time point is more than level times the range of scale.</p>
<p>The original concept comes from Basu &amp; Meckesheimer (2007)
although they didn’t use the interquartile range but rather
expert judgment. To use this function effectively, you need to
be thoughtful about what the interquartile range will be. For instance,
for a strongly tidal flow station it is likely to</p>
<dl class="simple">
<dt>level: Number of times the scale or interquantile range the data has to be</dt><dd><p>to be rejected.d</p>
</dd>
<dt>scale: Expert judgment of the scale of maximum variation over a time step.</dt><dd><p>If None, the interquartile range will be used. Note that for a
strongly tidal station the interquartile range may substantially overestimate the reasonable variation over a single time step, in which case the filter will work fine, but level should be set to
a number (less than one) accordingly.</p>
</dd>
</dl>
<p>filt_len: length of median filter, default is 5</p>
<dl class="simple">
<dt>quantiles<span class="classifier">tuple of quantiles defining the measure of scale. Ignored</span></dt><dd><p>if scale is given directly. Default is interquartile range, and
this is almost always a reasonable choice.</p>
</dd>
</dl>
<p>copy: if True, a copy is made leaving original series intact</p>
<p>You can also specify rejection of  values based on a simple range</p>
<p>Returns: copy of series with outliers replaced by nan</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.threshold">
<span class="sig-name descname"><span class="pre">threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#threshold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.threshold" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-vtools.functions.example2">
<span id="vtools-functions-example2-module"></span><h2>vtools.functions.example2 module<a class="headerlink" href="#module-vtools.functions.example2" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.example2.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/example2.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.example2.main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-vtools.functions.filter">
<span id="vtools-functions-filter-module"></span><h2>vtools.functions.filter module<a class="headerlink" href="#module-vtools.functions.filter" title="Link to this heading">¶</a></h2>
<p>Module contains filter used in tidal time series analysis.</p>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter._gf1d">
<span class="sig-name descname"><span class="pre">_gf1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#_gf1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter._gf1d" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter._lanczos_impl">
<span class="sig-name descname"><span class="pre">_lanczos_impl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosine_taper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#_lanczos_impl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter._lanczos_impl" title="Link to this definition">¶</a></dt>
<dd><p>squared low-pass cosine lanczos  filter on a regular time series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd></dd>
<dt><strong>filter_len</strong><span class="classifier">int, time_interval</span></dt><dd><p>Size of lanczos window, default is to number of samples within filter_period*1.25.</p>
</dd>
<dt><strong>cutoff_frequency: float,optional</strong></dt><dd><p>Cutoff frequency expressed as a ratio of a Nyquist frequency,
should within the range (0,1). For example, if the sampling frequency
is 1 hour, the Nyquist frequency is 1 sample/2 hours. If we want a
36 hour cutoff period, the frequency is 1/36 or 0.0278 cycles per hour.
Hence the cutoff frequency argument used here would be
0.0278/0.5 = 0.056.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">string  or  _time_interval</span></dt><dd><blockquote>
<div><p>Period of cutting off frequency. If input as a string, it must
be  convertible to a _time_interval (Pandas freq).
cutoff_frequency and cutoff_period can’t be specified at the same time.</p>
</div></blockquote>
<dl class="simple">
<dt>padtype<span class="classifier">str or None, optional</span></dt><dd><p>Must be ‘odd’, ‘even’, ‘constant’, or None. This determines the type
of extension to use for the padded signal to which the filter is applied.
If padtype is None, no padding is used. The default is None.</p>
</dd>
<dt>padlen<span class="classifier">int or None, optional</span></dt><dd><p>The number of elements by which to extend x at both ends of axis
before applying the filter. This value must be less than x.shape[axis]-1.
padlen=0 implies no padding. If padtye is not None and padlen is not
given, padlen is be set to 6*m.</p>
</dd>
<dt>fill_edge_nan: bool,optional</dt><dd><p>If pading is not used and fill_edge_nan is true, resulting data on
the both ends are filled with nan to account for edge effect. This is
2*m on the either end of the result. Default is true.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></span></dt><dd><p>A new regular time series with the same interval of ts. If no pading
is used the beigning and ending 4*m resulting data will be set to nan
to remove edge effect.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If input timeseries is not regular,
or, cutoff_period and cutoff_frequency are given at the same time,
or, neither cutoff_period nor curoff_frequence is given,
or, padtype is not “odd”,”even”,”constant”,or None,
or, padlen is larger than data size</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.butter">
<span class="sig-name descname"><span class="pre">butter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Wn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">btype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'low'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ba'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/_filter_design.html#butter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.butter" title="Link to this definition">¶</a></dt>
<dd><p>Butterworth digital and analog filter design.</p>
<p>Design an Nth-order digital or analog Butterworth filter and return
the filter coefficients.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>N</strong><span class="classifier">int</span></dt><dd><p>The order of the filter. For ‘bandpass’ and ‘bandstop’ filters,
the resulting order of the final second-order sections (‘sos’)
matrix is <code class="docutils literal notranslate"><span class="pre">2*N</span></code>, with <cite>N</cite> the number of biquad sections
of the desired system.</p>
</dd>
<dt><strong>Wn</strong><span class="classifier">array_like</span></dt><dd><p>The critical frequency or frequencies. For lowpass and highpass
filters, Wn is a scalar; for bandpass and bandstop filters,
Wn is a length-2 sequence.</p>
<p>For a Butterworth filter, this is the point at which the gain
drops to 1/sqrt(2) that of the passband (the “-3 dB point”).</p>
<p>For digital filters, if <cite>fs</cite> is not specified, <cite>Wn</cite> units are
normalized from 0 to 1, where 1 is the Nyquist frequency (<cite>Wn</cite> is
thus in half cycles / sample and defined as 2*critical frequencies
/ <cite>fs</cite>). If <cite>fs</cite> is specified, <cite>Wn</cite> is in the same units as <cite>fs</cite>.</p>
<p>For analog filters, <cite>Wn</cite> is an angular frequency (e.g. rad/s).</p>
</dd>
<dt><strong>btype</strong><span class="classifier">{‘lowpass’, ‘highpass’, ‘bandpass’, ‘bandstop’}, optional</span></dt><dd><p>The type of filter.  Default is ‘lowpass’.</p>
</dd>
<dt><strong>analog</strong><span class="classifier">bool, optional</span></dt><dd><p>When True, return an analog filter, otherwise a digital filter is
returned.</p>
</dd>
<dt><strong>output</strong><span class="classifier">{‘ba’, ‘zpk’, ‘sos’}, optional</span></dt><dd><p>Type of output:  numerator/denominator (‘ba’), pole-zero (‘zpk’), or
second-order sections (‘sos’). Default is ‘ba’ for backwards
compatibility, but ‘sos’ should be used for general-purpose filtering.</p>
</dd>
<dt><strong>fs</strong><span class="classifier">float, optional</span></dt><dd><p>The sampling frequency of the digital system.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.0.</span></p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>b, a</strong><span class="classifier">ndarray, ndarray</span></dt><dd><p>Numerator (<cite>b</cite>) and denominator (<cite>a</cite>) polynomials of the IIR filter.
Only returned if <code class="docutils literal notranslate"><span class="pre">output='ba'</span></code>.</p>
</dd>
<dt><strong>z, p, k</strong><span class="classifier">ndarray, ndarray, float</span></dt><dd><p>Zeros, poles, and system gain of the IIR filter transfer
function.  Only returned if <code class="docutils literal notranslate"><span class="pre">output='zpk'</span></code>.</p>
</dd>
<dt><strong>sos</strong><span class="classifier">ndarray</span></dt><dd><p>Second-order sections representation of the IIR filter.
Only returned if <code class="docutils literal notranslate"><span class="pre">output='sos'</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">buttord</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">buttap</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The Butterworth filter has maximally flat frequency response in the
passband.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'sos'</span></code> output parameter was added in 0.16.0.</p>
<p>If the transfer function form <code class="docutils literal notranslate"><span class="pre">[b,</span> <span class="pre">a]</span></code> is requested, numerical
problems can occur since the conversion between roots and
the polynomial coefficients is a numerically sensitive operation,
even for N &gt;= 4. It is recommended to work with the SOS
representation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Designing high-order and narrowband IIR filters in TF form can
result in unstable or incorrect filtering due to floating point
numerical precision issues. Consider inspecting output filter
characteristics <cite>freqz</cite> or designing the filters with second-order
sections via <code class="docutils literal notranslate"><span class="pre">output='sos'</span></code>.</p>
</div>
<p class="rubric">Examples</p>
<p>Design an analog filter and plot its frequency response, showing the
critical points:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Butterworth filter frequency response&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [radians / second]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude [dB]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span> <span class="c1"># cutoff frequency</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Generate a signal made up of 10 Hz and 20 Hz, sampled at 1 kHz</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># 1 second</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">20</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;10 Hz and 20 Hz sinusoids&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Design a digital high-pass filter at 15 Hz to remove the 10 Hz tone, and
apply it to the signal. (It’s recommended to use second-order sections
format when filtering, to avoid numerical error with transfer function
(<code class="docutils literal notranslate"><span class="pre">ba</span></code>) format):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;hp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">filtered</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;After 15 Hz high-pass filter&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [seconds]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.butterworth">
<span class="sig-name descname"><span class="pre">butterworth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#butterworth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.butterworth" title="Link to this definition">¶</a></dt>
<dd><p>low-pass butterworth-squared filter on a regular time series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>Must be one or two dimensional, and regular.</p>
</dd>
<dt><strong>order: int ,optional</strong></dt><dd><p>The default is 4.</p>
</dd>
<dt><strong>cutoff_frequency: float,optional</strong></dt><dd><p>Cutoff frequency expressed as a ratio with Nyquist frequency,
should within the range (0,1). For a discretely sampled system,
the Nyquist frequency is the fastest frequency that can be resolved by that
sampling, which is half the sampling frequency. For example, if the sampling frequency
is 1 sample/1 hour, the Nyquist frequency is 1 sample/2 hours. If we want a
36 hour cutoff period, the frequency is 1/36 or 0.0278 cycles per hour.
Hence the cutoff frequency argument used here would be
0.0278/0.5 = 0.056.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">string  or  _time_interval</span></dt><dd><p>Period corresponding to cutoff frequency. If input as a string, it must
be  convertible to a regular interval using the same rules as a pandas frequency..
cutoff_frequency and cutoff_period can’t be specified at the same time.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>result</dt><dd><p>A new regular time series with the same interval as ts.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If input order is not even, or input timeseries is not regular,
or neither cutoff_period and cutoff_frequency is given while input
time series interval is not 15min or 1 hour, or  cutoff_period and cutoff_frequency
are given at the same time.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.convert_span_to_nstep">
<span class="sig-name descname"><span class="pre">convert_span_to_nstep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#convert_span_to_nstep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.convert_span_to_nstep" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.cosine_lanczos">
<span class="sig-name descname"><span class="pre">cosine_lanczos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#cosine_lanczos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.cosine_lanczos" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.cosine_lanczos5">
<span class="sig-name descname"><span class="pre">cosine_lanczos5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#cosine_lanczos5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.cosine_lanczos5" title="Link to this definition">¶</a></dt>
<dd><p>squared low-pass cosine lanczos  filter on a regular time series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd></dd>
<dt><strong>filter_len</strong><span class="classifier">int, time_interval</span></dt><dd><p>Size of lanczos window, default is to number of samples within filter_period*1.25.</p>
</dd>
<dt><strong>cutoff_frequency: float,optional</strong></dt><dd><p>Cutoff frequency expressed as a ratio of a Nyquist frequency,
should within the range (0,1). For example, if the sampling frequency
is 1 hour, the Nyquist frequency is 1 sample/2 hours. If we want a
36 hour cutoff period, the frequency is 1/36 or 0.0278 cycles per hour.
Hence the cutoff frequency argument used here would be
0.0278/0.5 = 0.056.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">string  or  _time_interval</span></dt><dd><blockquote>
<div><p>Period of cutting off frequency. If input as a string, it must
be  convertible to a _time_interval (Pandas freq).
cutoff_frequency and cutoff_period can’t be specified at the same time.</p>
</div></blockquote>
<dl class="simple">
<dt>padtype<span class="classifier">str or None, optional</span></dt><dd><p>Must be ‘odd’, ‘even’, ‘constant’, or None. This determines the type
of extension to use for the padded signal to which the filter is applied.
If padtype is None, no padding is used. The default is None.</p>
</dd>
<dt>padlen<span class="classifier">int or None, optional</span></dt><dd><p>The number of elements by which to extend x at both ends of axis
before applying the filter. This value must be less than x.shape[axis]-1.
padlen=0 implies no padding. If padtye is not None and padlen is not
given, padlen is be set to 6*m.</p>
</dd>
<dt>fill_edge_nan: bool,optional</dt><dd><p>If pading is not used and fill_edge_nan is true, resulting data on
the both ends are filled with nan to account for edge effect. This is
2*m on the either end of the result. Default is true.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></span></dt><dd><p>A new regular time series with the same interval of ts. If no pading
is used the beigning and ending 4*m resulting data will be set to nan
to remove edge effect.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If input timeseries is not regular,
or, cutoff_period and cutoff_frequency are given at the same time,
or, neither cutoff_period nor curoff_frequence is given,
or, padtype is not “odd”,”even”,”constant”,or None,
or, padlen is larger than data size</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.filtfilt">
<span class="sig-name descname"><span class="pre">filtfilt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'odd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pad'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/_signaltools.html#filtfilt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.filtfilt" title="Link to this definition">¶</a></dt>
<dd><p>Apply a digital filter forward and backward to a signal.</p>
<p>This function applies a linear digital filter twice, once forward and
once backwards.  The combined filter has zero phase and a filter order
twice that of the original.</p>
<p>The function provides options for handling the edges of the signal.</p>
<p>The function <cite>sosfiltfilt</cite> (and filter design using <code class="docutils literal notranslate"><span class="pre">output='sos'</span></code>)
should be preferred over <cite>filtfilt</cite> for most filtering tasks, as
second-order sections have fewer numerical problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>b</strong><span class="classifier">(N,) array_like</span></dt><dd><p>The numerator coefficient vector of the filter.</p>
</dd>
<dt><strong>a</strong><span class="classifier">(N,) array_like</span></dt><dd><p>The denominator coefficient vector of the filter.  If <code class="docutils literal notranslate"><span class="pre">a[0]</span></code>
is not 1, then both <cite>a</cite> and <cite>b</cite> are normalized by <code class="docutils literal notranslate"><span class="pre">a[0]</span></code>.</p>
</dd>
<dt><strong>x</strong><span class="classifier">array_like</span></dt><dd><p>The array of data to be filtered.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>The axis of <cite>x</cite> to which the filter is applied.
Default is -1.</p>
</dd>
<dt><strong>padtype</strong><span class="classifier">str or None, optional</span></dt><dd><p>Must be ‘odd’, ‘even’, ‘constant’, or None.  This determines the
type of extension to use for the padded signal to which the filter
is applied.  If <cite>padtype</cite> is None, no padding is used.  The default
is ‘odd’.</p>
</dd>
<dt><strong>padlen</strong><span class="classifier">int or None, optional</span></dt><dd><p>The number of elements by which to extend <cite>x</cite> at both ends of
<cite>axis</cite> before applying the filter.  This value must be less than
<code class="docutils literal notranslate"><span class="pre">x.shape[axis]</span> <span class="pre">-</span> <span class="pre">1</span></code>.  <code class="docutils literal notranslate"><span class="pre">padlen=0</span></code> implies no padding.
The default value is <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">*</span> <span class="pre">max(len(a),</span> <span class="pre">len(b))</span></code>.</p>
</dd>
<dt><strong>method</strong><span class="classifier">str, optional</span></dt><dd><p>Determines the method for handling the edges of the signal, either
“pad” or “gust”.  When <cite>method</cite> is “pad”, the signal is padded; the
type of padding is determined by <cite>padtype</cite> and <cite>padlen</cite>, and <cite>irlen</cite>
is ignored.  When <cite>method</cite> is “gust”, Gustafsson’s method is used,
and <cite>padtype</cite> and <cite>padlen</cite> are ignored.</p>
</dd>
<dt><strong>irlen</strong><span class="classifier">int or None, optional</span></dt><dd><p>When <cite>method</cite> is “gust”, <cite>irlen</cite> specifies the length of the
impulse response of the filter.  If <cite>irlen</cite> is None, no part
of the impulse response is ignored.  For a long signal, specifying
<cite>irlen</cite> can significantly improve the performance of the filter.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y</strong><span class="classifier">ndarray</span></dt><dd><p>The filtered output with the same shape as <cite>x</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">sosfiltfilt</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">lfilter_zi</span></code>, <a class="reference internal" href="#vtools.functions.filter.lfilter" title="vtools.functions.filter.lfilter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lfilter</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">lfiltic</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">savgol_filter</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">sosfilt</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>When <cite>method</cite> is “pad”, the function pads the data along the given axis
in one of three ways: odd, even or constant.  The odd and even extensions
have the corresponding symmetry about the end point of the data.  The
constant extension extends the data with the values at the end points. On
both the forward and backward passes, the initial condition of the
filter is found by using <cite>lfilter_zi</cite> and scaling it by the end point of
the extended data.</p>
<p>When <cite>method</cite> is “gust”, Gustafsson’s method <a class="reference internal" href="#rf9ecd08cd80f-1" id="id9">[1]</a> is used.  Initial
conditions are chosen for the forward and backward passes so that the
forward-backward filter gives the same result as the backward-forward
filter.</p>
<p>The option to use Gustaffson’s method was added in scipy version 0.16.0.</p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="rf9ecd08cd80f-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">1</a><span class="fn-bracket">]</span></span>
<p>F. Gustaffson, “Determining the initial states in forward-backward
filtering”, Transactions on Signal Processing, Vol. 46, pp. 988-992,
1996.</p>
</div>
</div>
<p class="rubric">Examples</p>
<p>The examples will use several functions from <cite>scipy.signal</cite>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>First we create a one second signal that is the sum of two pure sine
waves, with frequencies 5 Hz and 250 Hz, sampled at 2000 Hz.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">2001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xlow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xhigh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">250</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">xlow</span> <span class="o">+</span> <span class="n">xhigh</span>
</pre></div>
</div>
<p>Now create a lowpass Butterworth filter with a cutoff of 0.125 times
the Nyquist frequency, or 125 Hz, and apply it to <code class="docutils literal notranslate"><span class="pre">x</span></code> with <cite>filtfilt</cite>.
The result should be approximately <code class="docutils literal notranslate"><span class="pre">xlow</span></code>, with no phase shift.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">padlen</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">xlow</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="go">9.1086182074789912e-06</span>
</pre></div>
</div>
<p>We get a fairly clean result for this artificial example because
the odd extension is exact, and with the moderately long padding,
the filter’s transients have dissipated by the time the actual data
is reached.  In general, transient effects at the edges are
unavoidable.</p>
<p>The following example demonstrates the option <code class="docutils literal notranslate"><span class="pre">method=&quot;gust&quot;</span></code>.</p>
<p>First, create a filter.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellip</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">)</span>  <span class="c1"># Filter to be applied.</span>
</pre></div>
</div>
<p><cite>sig</cite> is a random input signal to be filtered.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</pre></div>
</div>
<p>Apply <cite>filtfilt</cite> to <cite>sig</cite>, once using the Gustafsson method, and
once using padding, and plot the results for comparison.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fgust</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;gust&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpad</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">padlen</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fgust</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;gust&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpad</span><span class="p">,</span> <span class="s1">&#39;c-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pad&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The <cite>irlen</cite> argument can be used to improve the performance
of Gustafsson’s method.</p>
<p>Estimate the impulse response length of the filter.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">tf2zpk</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">approx_impulse_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">r</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">approx_impulse_len</span>
<span class="go">137</span>
</pre></div>
</div>
<p>Apply the filter to a longer signal, with and without the <cite>irlen</cite>
argument.  The difference between <cite>y1</cite> and <cite>y2</cite> is small.  For long
signals, using <cite>irlen</cite> gives a significant performance improvement.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">4000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y1</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;gust&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y2</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;gust&#39;</span><span class="p">,</span> <span class="n">irlen</span><span class="o">=</span><span class="n">approx_impulse_len</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)))</span>
<span class="go">2.875334415008979e-10</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.firwin">
<span class="sig-name descname"><span class="pre">firwin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">numtaps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window='hamming'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_zero=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nyq=&lt;object</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/_fir_filter_design.html#firwin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.firwin" title="Link to this definition">¶</a></dt>
<dd><p>FIR filter design using the window method.</p>
<p>This function computes the coefficients of a finite impulse response
filter. The filter will have linear phase; it will be Type I if
<cite>numtaps</cite> is odd and Type II if <cite>numtaps</cite> is even.</p>
<p>Type II filters always have zero response at the Nyquist frequency, so a
ValueError exception is raised if firwin is called with <cite>numtaps</cite> even and
having a passband whose right end is at the Nyquist frequency.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>numtaps</strong><span class="classifier">int</span></dt><dd><p>Length of the filter (number of coefficients, i.e. the filter
order + 1).  <cite>numtaps</cite> must be odd if a passband includes the
Nyquist frequency.</p>
</dd>
<dt><strong>cutoff</strong><span class="classifier">float or 1-D array_like</span></dt><dd><p>Cutoff frequency of filter (expressed in the same units as <cite>fs</cite>)
OR an array of cutoff frequencies (that is, band edges). In the
latter case, the frequencies in <cite>cutoff</cite> should be positive and
monotonically increasing between 0 and <cite>fs/2</cite>. The values 0 and
<cite>fs/2</cite> must not be included in <cite>cutoff</cite>.</p>
</dd>
<dt><strong>width</strong><span class="classifier">float or None, optional</span></dt><dd><p>If <cite>width</cite> is not None, then assume it is the approximate width
of the transition region (expressed in the same units as <cite>fs</cite>)
for use in Kaiser FIR filter design. In this case, the <cite>window</cite>
argument is ignored.</p>
</dd>
<dt><strong>window</strong><span class="classifier">string or tuple of string and parameter values, optional</span></dt><dd><p>Desired window to use. See <cite>scipy.signal.get_window</cite> for a list
of windows and required parameters.</p>
</dd>
<dt><strong>pass_zero</strong><span class="classifier">{True, False, ‘bandpass’, ‘lowpass’, ‘highpass’, ‘bandstop’}, optional</span></dt><dd><p>If True, the gain at the frequency 0 (i.e., the “DC gain”) is 1.
If False, the DC gain is 0. Can also be a string argument for the
desired filter type (equivalent to <code class="docutils literal notranslate"><span class="pre">btype</span></code> in IIR design functions).</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3.0: </span>Support for string arguments.</p>
</div>
</dd>
<dt><strong>scale</strong><span class="classifier">bool, optional</span></dt><dd><p>Set to True to scale the coefficients so that the frequency
response is exactly unity at a certain frequency.
That frequency is either:</p>
<ul class="simple">
<li><p>0 (DC) if the first passband starts at 0 (i.e. pass_zero
is True)</p></li>
<li><p><cite>fs/2</cite> (the Nyquist frequency) if the first passband ends at
<cite>fs/2</cite> (i.e the filter is a single band highpass filter);
center of first passband otherwise</p></li>
</ul>
</dd>
<dt><strong>nyq</strong><span class="classifier">float, optional, deprecated</span></dt><dd><p>This is the Nyquist frequency. Each frequency in <cite>cutoff</cite> must be
between 0 and <cite>nyq</cite>. Default is 1.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.0.0: </span><cite>firwin</cite> keyword argument <cite>nyq</cite> is deprecated in favour of <cite>fs</cite> and
will be removed in SciPy 1.14.0.</p>
</div>
</dd>
<dt><strong>fs</strong><span class="classifier">float, optional</span></dt><dd><p>The sampling frequency of the signal. Each frequency in <cite>cutoff</cite>
must be between 0 and <code class="docutils literal notranslate"><span class="pre">fs/2</span></code>.  Default is 2.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>h</strong><span class="classifier">(numtaps,) ndarray</span></dt><dd><p>Coefficients of length <cite>numtaps</cite> FIR filter.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If any value in <cite>cutoff</cite> is less than or equal to 0 or greater
than or equal to <code class="docutils literal notranslate"><span class="pre">fs/2</span></code>, if the values in <cite>cutoff</cite> are not strictly
monotonically increasing, or if <cite>numtaps</cite> is even but a passband
includes the Nyquist frequency.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">firwin2</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">firls</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">minimum_phase</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">remez</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Low-pass from 0 to f:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numtaps</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="go">array([ 0.06799017,  0.86401967,  0.06799017])</span>
</pre></div>
</div>
<p>Use a specific window function:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;nuttall&#39;</span><span class="p">)</span>
<span class="go">array([  3.56607041e-04,   9.99286786e-01,   3.56607041e-04])</span>
</pre></div>
</div>
<p>High-pass (‘stop’ from 0 to f):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">pass_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">array([-0.00859313,  0.98281375, -0.00859313])</span>
</pre></div>
</div>
<p>Band-pass:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="p">[</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">],</span> <span class="n">pass_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">array([ 0.06301614,  0.88770441,  0.06301614])</span>
</pre></div>
</div>
<p>Band-stop:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="p">[</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">])</span>
<span class="go">array([-0.00801395,  1.0160279 , -0.00801395])</span>
</pre></div>
</div>
<p>Multi-band (passbands are [0, f1], [f2, f3] and [f4, 1]):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f3</span><span class="p">,</span> <span class="n">f4</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="p">[</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">,</span> <span class="n">f4</span><span class="p">])</span>
<span class="go">array([-0.01376344,  1.02752689, -0.01376344])</span>
</pre></div>
</div>
<p>Multi-band (passbands are [f1, f2] and [f3,f4]):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="p">[</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">,</span> <span class="n">f4</span><span class="p">],</span> <span class="n">pass_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">array([ 0.04890915,  0.91284326,  0.04890915])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.gaussian_filter1d">
<span class="sig-name descname"><span class="pre">gaussian_filter1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/ndimage/_filters.html#gaussian_filter1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.gaussian_filter1d" title="Link to this definition">¶</a></dt>
<dd><p>1-D Gaussian filter.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>input</strong><span class="classifier">array_like</span></dt><dd><p>The input array.</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">scalar</span></dt><dd><p>standard deviation for Gaussian kernel</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>The axis of <cite>input</cite> along which to calculate. Default is -1.</p>
</dd>
<dt><strong>order</strong><span class="classifier">int, optional</span></dt><dd><p>An order of 0 corresponds to convolution with a Gaussian
kernel. A positive order corresponds to convolution with
that derivative of a Gaussian.</p>
</dd>
<dt><strong>output</strong><span class="classifier">array or dtype, optional</span></dt><dd><p>The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p>
</dd>
<dt><strong>mode</strong><span class="classifier">{‘reflect’, ‘constant’, ‘nearest’, ‘mirror’, ‘wrap’}, optional</span></dt><dd><p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘reflect’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>‘reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel. This mode is also sometimes referred to as half-sample
symmetric.</p>
</dd>
<dt>‘constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>‘nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>‘mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel. This mode is also sometimes referred to as whole-sample
symmetric.</p>
</dd>
<dt>‘wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
<p>For consistency with the interpolation functions, the following mode
names can also be used:</p>
<dl class="simple">
<dt>‘grid-mirror’</dt><dd><p>This is a synonym for ‘reflect’.</p>
</dd>
<dt>‘grid-constant’</dt><dd><p>This is a synonym for ‘constant’.</p>
</dd>
<dt>‘grid-wrap’</dt><dd><p>This is a synonym for ‘wrap’.</p>
</dd>
</dl>
</dd>
<dt><strong>cval</strong><span class="classifier">scalar, optional</span></dt><dd><p>Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p>
</dd>
<dt><strong>truncate</strong><span class="classifier">float, optional</span></dt><dd><p>Truncate the filter at this many standard deviations.
Default is 4.0.</p>
</dd>
<dt><strong>radius</strong><span class="classifier">None or int, optional</span></dt><dd><p>Radius of the Gaussian kernel. If specified, the size of
the kernel will be <code class="docutils literal notranslate"><span class="pre">2*radius</span> <span class="pre">+</span> <span class="pre">1</span></code>, and <cite>truncate</cite> is ignored.
Default is None.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>gaussian_filter1d</strong><span class="classifier">ndarray</span></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The Gaussian kernel will have size <code class="docutils literal notranslate"><span class="pre">2*radius</span> <span class="pre">+</span> <span class="pre">1</span></code> along each axis. If
<cite>radius</cite> is None, a default <code class="docutils literal notranslate"><span class="pre">radius</span> <span class="pre">=</span> <span class="pre">round(truncate</span> <span class="pre">*</span> <span class="pre">sigma)</span></code> will be
used.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">gaussian_filter1d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussian_filter1d</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">array([ 1.42704095,  2.06782203,  3.        ,  3.93217797,  4.57295905])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussian_filter1d</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">array([ 2.91948343,  2.95023502,  3.        ,  3.04976498,  3.08051657])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y3</span> <span class="o">=</span> <span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y6</span> <span class="o">=</span> <span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original data&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y3</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;filtered, sigma=3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y6</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;filtered, sigma=6&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.generate_godin_fir">
<span class="sig-name descname"><span class="pre">generate_godin_fir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#generate_godin_fir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.generate_godin_fir" title="Link to this definition">¶</a></dt>
<dd><p>generate godin filter impulse response for given freq
freq is a pandas freq</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.godin">
<span class="sig-name descname"><span class="pre">godin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#godin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.godin" title="Link to this definition">¶</a></dt>
<dd><p>Low-pass Godin filter a regular time series.
Applies the <span class="math notranslate nohighlight">\(\mathcal{A_{24}^{2}A_{25}}\)</span> Godin filter <a class="reference internal" href="#r1d48320053b8-1" id="id11">[1]</a>
The filter is generalized to be the equivalent of one
boxcar of the length of the lunar diurnal (~25 hours)
constituent and two of the solar diurnal (~24 hours), though the
implementation combines these steps.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>A new regular time series with the same interval of ts.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>NotImplementedError</dt><dd><p>If input time series is not univariate</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="r1d48320053b8-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id11">1</a><span class="fn-bracket">]</span></span>
<p>Godin (1972) Analysis of Tides</p>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.hours">
<span class="sig-name descname"><span class="pre">hours</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/data/vtime.html#hours"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.hours" title="Link to this definition">¶</a></dt>
<dd><p>Create a time interval representing h hours</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.lanczos">
<span class="sig-name descname"><span class="pre">lanczos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#lanczos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.lanczos" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.lfilter">
<span class="sig-name descname"><span class="pre">lfilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/_signaltools.html#lfilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.lfilter" title="Link to this definition">¶</a></dt>
<dd><p>Filter data along one-dimension with an IIR or FIR filter.</p>
<p>Filter a data sequence, <cite>x</cite>, using a digital filter.  This works for many
fundamental data types (including Object type).  The filter is a direct
form II transposed implementation of the standard difference equation
(see Notes).</p>
<p>The function <cite>sosfilt</cite> (and filter design using <code class="docutils literal notranslate"><span class="pre">output='sos'</span></code>) should be
preferred over <cite>lfilter</cite> for most filtering tasks, as second-order sections
have fewer numerical problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>b</strong><span class="classifier">array_like</span></dt><dd><p>The numerator coefficient vector in a 1-D sequence.</p>
</dd>
<dt><strong>a</strong><span class="classifier">array_like</span></dt><dd><p>The denominator coefficient vector in a 1-D sequence.  If <code class="docutils literal notranslate"><span class="pre">a[0]</span></code>
is not 1, then both <cite>a</cite> and <cite>b</cite> are normalized by <code class="docutils literal notranslate"><span class="pre">a[0]</span></code>.</p>
</dd>
<dt><strong>x</strong><span class="classifier">array_like</span></dt><dd><p>An N-dimensional input array.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>The axis of the input data array along which to apply the
linear filter. The filter is applied to each subarray along
this axis.  Default is -1.</p>
</dd>
<dt><strong>zi</strong><span class="classifier">array_like, optional</span></dt><dd><p>Initial conditions for the filter delays.  It is a vector
(or array of vectors for an N-dimensional input) of length
<code class="docutils literal notranslate"><span class="pre">max(len(a),</span> <span class="pre">len(b))</span> <span class="pre">-</span> <span class="pre">1</span></code>.  If <cite>zi</cite> is None or is not given then
initial rest is assumed.  See <cite>lfiltic</cite> for more information.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y</strong><span class="classifier">array</span></dt><dd><p>The output of the digital filter.</p>
</dd>
<dt><strong>zf</strong><span class="classifier">array, optional</span></dt><dd><p>If <cite>zi</cite> is None, this is not returned, otherwise, <cite>zf</cite> holds the
final filter delay values.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">lfiltic</span></code></dt><dd><p>Construct initial conditions for <cite>lfilter</cite>.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">lfilter_zi</span></code></dt><dd><p>Compute initial state (steady state of step response) for <cite>lfilter</cite>.</p>
</dd>
<dt><a class="reference internal" href="#vtools.functions.filter.filtfilt" title="vtools.functions.filter.filtfilt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filtfilt</span></code></a></dt><dd><p>A forward-backward filter, to obtain a filter with zero phase.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">savgol_filter</span></code></dt><dd><p>A Savitzky-Golay filter.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">sosfilt</span></code></dt><dd><p>Filter data using cascaded second-order sections.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">sosfiltfilt</span></code></dt><dd><p>A forward-backward filter using second-order sections.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The filter function is implemented as a direct II transposed structure.
This means that the filter implements:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">M</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">M</span><span class="p">]</span>
                      <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="o">...</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">N</span><span class="p">]</span>
</pre></div>
</div>
<p>where <cite>M</cite> is the degree of the numerator, <cite>N</cite> is the degree of the
denominator, and <cite>n</cite> is the sample number.  It is implemented using
the following difference equations (assuming M = N):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>               <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="o">...</span>
<span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</pre></div>
</div>
<p>where <cite>d</cite> are the state variables.</p>
<p>The rational transfer function describing this filter in the
z-transform domain is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                    <span class="o">-</span><span class="mi">1</span>              <span class="o">-</span><span class="n">M</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">z</span>  <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">M</span><span class="p">]</span> <span class="n">z</span>
<span class="n">Y</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="o">--------------------------------</span> <span class="n">X</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                    <span class="o">-</span><span class="mi">1</span>              <span class="o">-</span><span class="n">N</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">z</span>  <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="n">z</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<p>Generate a noisy signal to be filtered:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">0.75</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.1</span><span class="p">)</span> <span class="o">+</span>
<span class="gp">... </span>     <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1.25</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
<span class="gp">... </span>     <span class="mf">0.18</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">3.85</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xn</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.08</span>
</pre></div>
</div>
<p>Create an order 3 lowpass butterworth filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
<p>Apply the filter to xn.  Use lfilter_zi to choose the initial condition of
the filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">zi</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">lfilter_zi</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">xn</span><span class="p">,</span> <span class="n">zi</span><span class="o">=</span><span class="n">zi</span><span class="o">*</span><span class="n">xn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Apply the filter again, to have a result filtered at an order the same as
filtfilt:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">zi</span><span class="o">=</span><span class="n">zi</span><span class="o">*</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Use filtfilt to apply the filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">xn</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the original signal and the various filtered versions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">xn</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;noisy signal&#39;</span><span class="p">,</span> <span class="s1">&#39;lfilter, once&#39;</span><span class="p">,</span> <span class="s1">&#39;lfilter, twice&#39;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s1">&#39;filtfilt&#39;</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.lowpass_cosine_lanczos_filter_coef">
<span class="sig-name descname"><span class="pre">lowpass_cosine_lanczos_filter_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#lowpass_cosine_lanczos_filter_coef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.lowpass_cosine_lanczos_filter_coef" title="Link to this definition">¶</a></dt>
<dd><p>return the convolution coefficients for low pass lanczos filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cf: float</strong></dt><dd><p>Cutoff frequency expressed as a ratio of a Nyquist frequency.</p>
</dd>
<dt><strong>m: int</strong></dt><dd><p>Size of filtering window size.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>results: list</dt><dd><p>Coefficients of filtering window.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.lowpass_lanczos_filter_coef">
<span class="sig-name descname"><span class="pre">lowpass_lanczos_filter_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosine_taper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#lowpass_lanczos_filter_coef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.lowpass_lanczos_filter_coef" title="Link to this definition">¶</a></dt>
<dd><p>Return the convolution coefficients for a low-pass Lanczos filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cf</strong><span class="classifier">float</span></dt><dd><p>Cutoff frequency expressed as a ratio of the Nyquist frequency.</p>
</dd>
<dt><strong>m</strong><span class="classifier">int</span></dt><dd><p>Size of the filtering window.</p>
</dd>
<dt><strong>normalize</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to normalize the filter coefficients so they sum to 1.</p>
</dd>
<dt><strong>cosine_taper</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, applies a cosine-squared taper to the Lanczos window.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>res</strong><span class="classifier">np.ndarray</span></dt><dd><p>Coefficients of the filtering window.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.minutes">
<span class="sig-name descname"><span class="pre">minutes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/data/vtime.html#minutes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.minutes" title="Link to this definition">¶</a></dt>
<dd><p>Create a time interval representing m minutes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.process_cutoff">
<span class="sig-name descname"><span class="pre">process_cutoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#process_cutoff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.process_cutoff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.seconds">
<span class="sig-name descname"><span class="pre">seconds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/data/vtime.html#seconds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.seconds" title="Link to this definition">¶</a></dt>
<dd><p>Create a time interval representing s seconds</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.ts_gaussian_filter">
<span class="sig-name descname"><span class="pre">ts_gaussian_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#ts_gaussian_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.ts_gaussian_filter" title="Link to this definition">¶</a></dt>
<dd><p>Column-wise Gaussian smoothing of regular time series.
Missing/irregular values are not handled, which means this function is not much different from
a rolling window gaussian average in pandas which may be preferable in the case of
missing data (ts.rolling(window=5,win_type=’gaussian’).mean.
This function has been kept around awaiting irreg as an aspiration but yet to be implemented.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>The series to be smoothed</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">int or freq</span></dt><dd><p>The sigma scale of the smoothing (analogous to std. deviation), given as a number of steps
or freq</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>A new regular time series with the same interval of ts.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vtools.functions.frequency_response">
<span id="vtools-functions-frequency-response-module"></span><h2>vtools.functions.frequency_response module<a class="headerlink" href="#module-vtools.functions.frequency_response" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.butterworth">
<span class="sig-name descname"><span class="pre">butterworth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#butterworth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.butterworth" title="Link to this definition">¶</a></dt>
<dd><p>low-pass butterworth-squared filter on a regular time series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>Must be one or two dimensional, and regular.</p>
</dd>
<dt><strong>order: int ,optional</strong></dt><dd><p>The default is 4.</p>
</dd>
<dt><strong>cutoff_frequency: float,optional</strong></dt><dd><p>Cutoff frequency expressed as a ratio with Nyquist frequency,
should within the range (0,1). For a discretely sampled system,
the Nyquist frequency is the fastest frequency that can be resolved by that
sampling, which is half the sampling frequency. For example, if the sampling frequency
is 1 sample/1 hour, the Nyquist frequency is 1 sample/2 hours. If we want a
36 hour cutoff period, the frequency is 1/36 or 0.0278 cycles per hour.
Hence the cutoff frequency argument used here would be
0.0278/0.5 = 0.056.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">string  or  _time_interval</span></dt><dd><p>Period corresponding to cutoff frequency. If input as a string, it must
be  convertible to a regular interval using the same rules as a pandas frequency..
cutoff_frequency and cutoff_period can’t be specified at the same time.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>result</dt><dd><p>A new regular time series with the same interval as ts.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If input order is not even, or input timeseries is not regular,
or neither cutoff_period and cutoff_frequency is given while input
time series interval is not 15min or 1 hour, or  cutoff_period and cutoff_frequency
are given at the same time.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.compare_response">
<span class="sig-name descname"><span class="pre">compare_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/frequency_response.html#compare_response"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.compare_response" title="Link to this definition">¶</a></dt>
<dd><p>Generate frequency response plot of low-pass filters: cosine_lanczos, boxcar 24h, boxcar 25h, and godin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cutoff_period</strong><span class="classifier">int</span></dt><dd><p>Low-pass filter cutoff period in number of hours.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.cosine_lanczos">
<span class="sig-name descname"><span class="pre">cosine_lanczos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#cosine_lanczos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.cosine_lanczos" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.cosine_lanczos5">
<span class="sig-name descname"><span class="pre">cosine_lanczos5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#cosine_lanczos5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.cosine_lanczos5" title="Link to this definition">¶</a></dt>
<dd><p>squared low-pass cosine lanczos  filter on a regular time series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd></dd>
<dt><strong>filter_len</strong><span class="classifier">int, time_interval</span></dt><dd><p>Size of lanczos window, default is to number of samples within filter_period*1.25.</p>
</dd>
<dt><strong>cutoff_frequency: float,optional</strong></dt><dd><p>Cutoff frequency expressed as a ratio of a Nyquist frequency,
should within the range (0,1). For example, if the sampling frequency
is 1 hour, the Nyquist frequency is 1 sample/2 hours. If we want a
36 hour cutoff period, the frequency is 1/36 or 0.0278 cycles per hour.
Hence the cutoff frequency argument used here would be
0.0278/0.5 = 0.056.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">string  or  _time_interval</span></dt><dd><blockquote>
<div><p>Period of cutting off frequency. If input as a string, it must
be  convertible to a _time_interval (Pandas freq).
cutoff_frequency and cutoff_period can’t be specified at the same time.</p>
</div></blockquote>
<dl class="simple">
<dt>padtype<span class="classifier">str or None, optional</span></dt><dd><p>Must be ‘odd’, ‘even’, ‘constant’, or None. This determines the type
of extension to use for the padded signal to which the filter is applied.
If padtype is None, no padding is used. The default is None.</p>
</dd>
<dt>padlen<span class="classifier">int or None, optional</span></dt><dd><p>The number of elements by which to extend x at both ends of axis
before applying the filter. This value must be less than x.shape[axis]-1.
padlen=0 implies no padding. If padtye is not None and padlen is not
given, padlen is be set to 6*m.</p>
</dd>
<dt>fill_edge_nan: bool,optional</dt><dd><p>If pading is not used and fill_edge_nan is true, resulting data on
the both ends are filled with nan to account for edge effect. This is
2*m on the either end of the result. Default is true.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></span></dt><dd><p>A new regular time series with the same interval of ts. If no pading
is used the beigning and ending 4*m resulting data will be set to nan
to remove edge effect.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If input timeseries is not regular,
or, cutoff_period and cutoff_frequency are given at the same time,
or, neither cutoff_period nor curoff_frequence is given,
or, padtype is not “odd”,”even”,”constant”,or None,
or, padlen is larger than data size</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.freqz">
<span class="sig-name descname"><span class="pre">freqz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.283185307179586</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_nyquist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/_filter_design.html#freqz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.freqz" title="Link to this definition">¶</a></dt>
<dd><p>Compute the frequency response of a digital filter.</p>
<p>Given the M-order numerator <cite>b</cite> and N-order denominator <cite>a</cite> of a digital
filter, compute its frequency response:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>            <span class="n">jw</span>                 <span class="o">-</span><span class="n">jw</span>              <span class="o">-</span><span class="n">jwM</span>
   <span class="n">jw</span>    <span class="n">B</span><span class="p">(</span><span class="n">e</span>  <span class="p">)</span>    <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">e</span>    <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">M</span><span class="p">]</span><span class="n">e</span>
<span class="n">H</span><span class="p">(</span><span class="n">e</span>  <span class="p">)</span> <span class="o">=</span> <span class="o">------</span> <span class="o">=</span> <span class="o">-----------------------------------</span>
            <span class="n">jw</span>                 <span class="o">-</span><span class="n">jw</span>              <span class="o">-</span><span class="n">jwN</span>
         <span class="n">A</span><span class="p">(</span><span class="n">e</span>  <span class="p">)</span>    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">e</span>    <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">]</span><span class="n">e</span>
</pre></div>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>b</strong><span class="classifier">array_like</span></dt><dd><p>Numerator of a linear filter. If <cite>b</cite> has dimension greater than 1,
it is assumed that the coefficients are stored in the first dimension,
and <code class="docutils literal notranslate"><span class="pre">b.shape[1:]</span></code>, <code class="docutils literal notranslate"><span class="pre">a.shape[1:]</span></code>, and the shape of the frequencies
array must be compatible for broadcasting.</p>
</dd>
<dt><strong>a</strong><span class="classifier">array_like</span></dt><dd><p>Denominator of a linear filter. If <cite>b</cite> has dimension greater than 1,
it is assumed that the coefficients are stored in the first dimension,
and <code class="docutils literal notranslate"><span class="pre">b.shape[1:]</span></code>, <code class="docutils literal notranslate"><span class="pre">a.shape[1:]</span></code>, and the shape of the frequencies
array must be compatible for broadcasting.</p>
</dd>
<dt><strong>worN</strong><span class="classifier">{None, int, array_like}, optional</span></dt><dd><p>If a single integer, then compute at that many frequencies (default is
N=512). This is a convenient alternative to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span> <span class="k">if</span> <span class="n">whole</span> <span class="k">else</span> <span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">include_nyquist</span><span class="p">)</span>
</pre></div>
</div>
<p>Using a number that is fast for FFT computations can result in
faster computations (see Notes).</p>
<p>If an array_like, compute the response at the frequencies given.
These are in the same units as <cite>fs</cite>.</p>
</dd>
<dt><strong>whole</strong><span class="classifier">bool, optional</span></dt><dd><p>Normally, frequencies are computed from 0 to the Nyquist frequency,
fs/2 (upper-half of unit-circle). If <cite>whole</cite> is True, compute
frequencies from 0 to fs. Ignored if worN is array_like.</p>
</dd>
<dt><strong>plot</strong><span class="classifier">callable</span></dt><dd><p>A callable that takes two arguments. If given, the return parameters
<cite>w</cite> and <cite>h</cite> are passed to plot. Useful for plotting the frequency
response inside <cite>freqz</cite>.</p>
</dd>
<dt><strong>fs</strong><span class="classifier">float, optional</span></dt><dd><p>The sampling frequency of the digital system. Defaults to 2*pi
radians/sample (so w is from 0 to pi).</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.0.</span></p>
</div>
</dd>
<dt><strong>include_nyquist</strong><span class="classifier">bool, optional</span></dt><dd><p>If <cite>whole</cite> is False and <cite>worN</cite> is an integer, setting <cite>include_nyquist</cite>
to True will include the last frequency (Nyquist frequency) and is
otherwise ignored.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.5.0.</span></p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>w</strong><span class="classifier">ndarray</span></dt><dd><p>The frequencies at which <cite>h</cite> was computed, in the same units as <cite>fs</cite>.
By default, <cite>w</cite> is normalized to the range [0, pi) (radians/sample).</p>
</dd>
<dt><strong>h</strong><span class="classifier">ndarray</span></dt><dd><p>The frequency response, as complex numbers.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">freqz_zpk</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">sosfreqz</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Using Matplotlib’s <code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.plot()</span></code> function as the callable
for <cite>plot</cite> produces unexpected results, as this plots the real part of the
complex transfer function, not the magnitude.
Try <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">w,</span> <span class="pre">h:</span> <span class="pre">plot(w,</span> <span class="pre">np.abs(h))</span></code>.</p>
<p>A direct computation via (R)FFT is used to compute the frequency response
when the following conditions are met:</p>
<ol class="arabic simple">
<li><p>An integer value is given for <cite>worN</cite>.</p></li>
<li><p><cite>worN</cite> is fast to compute via FFT (i.e.,
<cite>next_fast_len(worN) &lt;scipy.fft.next_fast_len&gt;</cite> equals <cite>worN</cite>).</p></li>
<li><p>The denominator coefficients are a single value (<code class="docutils literal notranslate"><span class="pre">a.shape[0]</span> <span class="pre">==</span> <span class="pre">1</span></code>).</p></li>
<li><p><cite>worN</cite> is at least as long as the numerator coefficients
(<code class="docutils literal notranslate"><span class="pre">worN</span> <span class="pre">&gt;=</span> <span class="pre">b.shape[0]</span></code>).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">b.ndim</span> <span class="pre">&gt;</span> <span class="pre">1</span></code>, then <code class="docutils literal notranslate"><span class="pre">b.shape[-1]</span> <span class="pre">==</span> <span class="pre">1</span></code>.</p></li>
</ol>
<p>For long FIR filters, the FFT approach can have lower error and be much
faster than the equivalent direct polynomial calculation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;kaiser&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Digital filter frequency response&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude [dB]&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [rad/sample]&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">angles</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Angle (radians)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Broadcasting Examples</p>
<p>Suppose we have two FIR filters whose coefficients are stored in the
rows of an array with shape (2, 25). For this demonstration, we’ll
use random data:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
</pre></div>
</div>
<p>To compute the frequency response for these two filters with one call
to <cite>freqz</cite>, we must pass in <code class="docutils literal notranslate"><span class="pre">b.T</span></code>, because <cite>freqz</cite> expects the first
axis to hold the coefficients. We must then extend the shape with a
trivial dimension of length 1 to allow broadcasting with the array
of frequencies.  That is, we pass in <code class="docutils literal notranslate"><span class="pre">b.T[...,</span> <span class="pre">np.newaxis]</span></code>, which has
shape (25, 2, 1):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">worN</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1024,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 1024)</span>
</pre></div>
</div>
<p>Now, suppose we have two transfer functions, with the same numerator
coefficients <code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">=</span> <span class="pre">[0.5,</span> <span class="pre">0.5]</span></code>. The coefficients for the two denominators
are stored in the first dimension of the 2-D array  <cite>a</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span>   <span class="mi">1</span>      <span class="mi">1</span>  <span class="p">]</span>
    <span class="p">[</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span> <span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]])</span>
</pre></div>
</div>
<p>Only <cite>a</cite> is more than 1-D. To make it compatible for
broadcasting with the frequencies, we extend it with a trivial dimension
in the call to <cite>freqz</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">worN</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1024,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 1024)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.godin">
<span class="sig-name descname"><span class="pre">godin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#godin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.godin" title="Link to this definition">¶</a></dt>
<dd><p>Low-pass Godin filter a regular time series.
Applies the <span class="math notranslate nohighlight">\(\mathcal{A_{24}^{2}A_{25}}\)</span> Godin filter <a class="reference internal" href="#ra2b1b86d9761-1" id="id13">[1]</a>
The filter is generalized to be the equivalent of one
boxcar of the length of the lunar diurnal (~25 hours)
constituent and two of the solar diurnal (~24 hours), though the
implementation combines these steps.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>A new regular time series with the same interval of ts.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>NotImplementedError</dt><dd><p>If input time series is not univariate</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="ra2b1b86d9761-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id13">1</a><span class="fn-bracket">]</span></span>
<p>Godin (1972) Analysis of Tides</p>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.inset_axes">
<span class="sig-name descname"><span class="pre">inset_axes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'upper</span> <span class="pre">right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_to_anchor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borderpad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mpl_toolkits/axes_grid1/inset_locator.html#inset_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.inset_axes" title="Link to this definition">¶</a></dt>
<dd><p>Create an inset axes with a given width and height.</p>
<p>Both sizes used can be specified either in inches or percentage.
For example,:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inset_axes</span><span class="p">(</span><span class="n">parent_axes</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;40%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;30%&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>creates in inset axes in the lower left corner of <em>parent_axes</em> which spans
over 30% in height and 40% in width of the <em>parent_axes</em>. Since the usage
of <cite>.inset_axes</cite> may become slightly tricky when exceeding such standard
cases, it is recommended to read <span class="xref std std-doc">the examples</span>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>parent_axes</strong><span class="classifier"><cite>matplotlib.axes.Axes</cite></span></dt><dd><p>Axes to place the inset axes.</p>
</dd>
<dt><strong>width, height</strong><span class="classifier">float or str</span></dt><dd><p>Size of the inset axes to create. If a float is provided, it is
the size in inches, e.g. <em>width=1.3</em>. If a string is provided, it is
the size in relative units, e.g. <em>width=’40%’</em>. By default, i.e. if
neither <em>bbox_to_anchor</em> nor <em>bbox_transform</em> are specified, those
are relative to the parent_axes. Otherwise, they are to be understood
relative to the bounding box provided via <em>bbox_to_anchor</em>.</p>
</dd>
<dt><strong>loc</strong><span class="classifier">str, default: ‘upper right’</span></dt><dd><p>Location to place the inset axes.  Valid locations are
‘upper left’, ‘upper center’, ‘upper right’,
‘center left’, ‘center’, ‘center right’,
‘lower left’, ‘lower center’, ‘lower right’.
For backward compatibility, numeric values are accepted as well.
See the parameter <em>loc</em> of <cite>.Legend</cite> for details.</p>
</dd>
<dt><strong>bbox_to_anchor</strong><span class="classifier">tuple or <cite>~matplotlib.transforms.BboxBase</cite>, optional</span></dt><dd><p>Bbox that the inset axes will be anchored to. If None,
a tuple of (0, 0, 1, 1) is used if <em>bbox_transform</em> is set
to <em>parent_axes.transAxes</em> or <em>parent_axes.figure.transFigure</em>.
Otherwise, <em>parent_axes.bbox</em> is used. If a tuple, can be either
[left, bottom, width, height], or [left, bottom].
If the kwargs <em>width</em> and/or <em>height</em> are specified in relative units,
the 2-tuple [left, bottom] cannot be used. Note that,
unless <em>bbox_transform</em> is set, the units of the bounding box
are interpreted in the pixel coordinate. When using <em>bbox_to_anchor</em>
with tuple, it almost always makes sense to also specify
a <em>bbox_transform</em>. This might often be the axes transform
<em>parent_axes.transAxes</em>.</p>
</dd>
<dt><strong>bbox_transform</strong><span class="classifier"><cite>~matplotlib.transforms.Transform</cite>, optional</span></dt><dd><p>Transformation for the bbox that contains the inset axes.
If None, a <cite>.transforms.IdentityTransform</cite> is used. The value
of <em>bbox_to_anchor</em> (or the return value of its get_points method)
is transformed by the <em>bbox_transform</em> and then interpreted
as points in the pixel coordinate (which is dpi dependent).
You may provide <em>bbox_to_anchor</em> in some normalized coordinate,
and give an appropriate transform (e.g., <em>parent_axes.transAxes</em>).</p>
</dd>
<dt><strong>axes_class</strong><span class="classifier"><cite>~matplotlib.axes.Axes</cite> type, default: <cite>.HostAxes</cite></span></dt><dd><p>The type of the newly created inset axes.</p>
</dd>
<dt><strong>axes_kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>Keyword arguments to pass to the constructor of the inset axes.
Valid arguments include:</p>
<p>Properties:
adjustable: {‘box’, ‘datalim’}
agg_filter: a filter function, which takes a (m, n, 3) float array and a dpi value, and returns a (m, n, 3) array and two offsets from the bottom left corner of the image
alpha: scalar or None
anchor: (float, float) or {‘C’, ‘SW’, ‘S’, ‘SE’, ‘E’, ‘NE’, …}
animated: bool
aspect: {‘auto’, ‘equal’} or float
autoscale_on: bool
autoscalex_on: unknown
autoscaley_on: unknown
axes_locator: Callable[[Axes, Renderer], Bbox]
axisbelow: bool or ‘line’
box_aspect: float or None
clip_box: <cite>~matplotlib.transforms.BboxBase</cite> or None
clip_on: bool
clip_path: Patch or (Path, Transform) or None
facecolor or fc: color
figure: <cite>~matplotlib.figure.Figure</cite>
frame_on: bool
gid: str
in_layout: bool
label: object
mouseover: bool
navigate: bool
navigate_mode: unknown
path_effects: list of <cite>.AbstractPathEffect</cite>
picker: None or bool or float or callable
position: [left, bottom, width, height] or <cite>~matplotlib.transforms.Bbox</cite>
prop_cycle: <cite>~cycler.Cycler</cite>
rasterization_zorder: float or None
rasterized: bool
sketch_params: (scale: float, length: float, randomness: float)
snap: bool or None
subplotspec: unknown
title: str
transform: <cite>~matplotlib.transforms.Transform</cite>
url: str
visible: bool
xbound: (lower: float, upper: float)
xlabel: str
xlim: (left: float, right: float)
xmargin: float greater than -0.5
xscale: unknown
xticklabels: unknown
xticks: unknown
ybound: (lower: float, upper: float)
ylabel: str
ylim: (bottom: float, top: float)
ymargin: float greater than -0.5
yscale: unknown
yticklabels: unknown
yticks: unknown
zorder: float</p>
</dd>
<dt><strong>borderpad</strong><span class="classifier">float, default: 0.5</span></dt><dd><p>Padding between inset axes and the bbox_to_anchor.
The units are axes font size, i.e. for a default font size of 10 points
<em>borderpad = 0.5</em> is equivalent to a padding of 5 points.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>inset_axes</strong><span class="classifier"><em>axes_class</em></span></dt><dd><p>Inset axes object created.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The meaning of <em>bbox_to_anchor</em> and <em>bbox_to_transform</em> is interpreted
differently from that of legend. The value of bbox_to_anchor
(or the return value of its get_points method; the default is
<em>parent_axes.bbox</em>) is transformed by the bbox_transform (the default
is Identity transform) and then interpreted as points in the pixel
coordinate (which is dpi dependent).</p>
<p>Thus, following three calls are identical and creates an inset axes
with respect to the <em>parent_axes</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">axins</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">parent_axes</span><span class="p">,</span> <span class="s2">&quot;30%&quot;</span><span class="p">,</span> <span class="s2">&quot;40%&quot;</span><span class="p">)</span>
<span class="n">axins</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">parent_axes</span><span class="p">,</span> <span class="s2">&quot;30%&quot;</span><span class="p">,</span> <span class="s2">&quot;40%&quot;</span><span class="p">,</span>
                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">parent_axes</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
<span class="n">axins</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">parent_axes</span><span class="p">,</span> <span class="s2">&quot;30%&quot;</span><span class="p">,</span> <span class="s2">&quot;40%&quot;</span><span class="p">,</span>
                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">parent_axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.lanczos">
<span class="sig-name descname"><span class="pre">lanczos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#lanczos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.lanczos" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.lowpass_cosine_lanczos_filter_coef">
<span class="sig-name descname"><span class="pre">lowpass_cosine_lanczos_filter_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#lowpass_cosine_lanczos_filter_coef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.lowpass_cosine_lanczos_filter_coef" title="Link to this definition">¶</a></dt>
<dd><p>return the convolution coefficients for low pass lanczos filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cf: float</strong></dt><dd><p>Cutoff frequency expressed as a ratio of a Nyquist frequency.</p>
</dd>
<dt><strong>m: int</strong></dt><dd><p>Size of filtering window size.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>results: list</dt><dd><p>Coefficients of filtering window.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.lowpass_lanczos_filter_coef">
<span class="sig-name descname"><span class="pre">lowpass_lanczos_filter_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosine_taper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#lowpass_lanczos_filter_coef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.lowpass_lanczos_filter_coef" title="Link to this definition">¶</a></dt>
<dd><p>Return the convolution coefficients for a low-pass Lanczos filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cf</strong><span class="classifier">float</span></dt><dd><p>Cutoff frequency expressed as a ratio of the Nyquist frequency.</p>
</dd>
<dt><strong>m</strong><span class="classifier">int</span></dt><dd><p>Size of the filtering window.</p>
</dd>
<dt><strong>normalize</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to normalize the filter coefficients so they sum to 1.</p>
</dd>
<dt><strong>cosine_taper</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, applies a cosine-squared taper to the Lanczos window.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>res</strong><span class="classifier">np.ndarray</span></dt><dd><p>Coefficients of the filtering window.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/frequency_response.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.mark_inset">
<span class="sig-name descname"><span class="pre">mark_inset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inset_axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mpl_toolkits/axes_grid1/inset_locator.html#mark_inset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.mark_inset" title="Link to this definition">¶</a></dt>
<dd><p>Draw a box to mark the location of an area represented by an inset axes.</p>
<p>This function draws a box in <em>parent_axes</em> at the bounding box of
<em>inset_axes</em>, and shows a connection with the inset axes by drawing lines
at the corners, giving a “zoomed in” effect.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>parent_axes</strong><span class="classifier"><cite>~matplotlib.axes.Axes</cite></span></dt><dd><p>Axes which contains the area of the inset axes.</p>
</dd>
<dt><strong>inset_axes</strong><span class="classifier"><cite>~matplotlib.axes.Axes</cite></span></dt><dd><p>The inset axes.</p>
</dd>
<dt><strong>loc1, loc2</strong><span class="classifier">{1, 2, 3, 4}</span></dt><dd><p>Corners to use for connecting the inset axes and the area in the
parent axes.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Patch properties for the lines and box drawn:</p>
<p>Properties:
agg_filter: a filter function, which takes a (m, n, 3) float array and a dpi value, and returns a (m, n, 3) array and two offsets from the bottom left corner of the image
alpha: unknown
animated: bool
antialiased or aa: bool or None
capstyle: <cite>.CapStyle</cite> or {‘butt’, ‘projecting’, ‘round’}
clip_box: <cite>~matplotlib.transforms.BboxBase</cite> or None
clip_on: bool
clip_path: Patch or (Path, Transform) or None
color: color
edgecolor or ec: color or None
facecolor or fc: color or None
figure: <cite>~matplotlib.figure.Figure</cite>
fill: bool
gid: str
hatch: {‘/’, ‘\’, ‘|’, ‘-’, ‘+’, ‘x’, ‘o’, ‘O’, ‘.’, ‘*’}
in_layout: bool
joinstyle: <cite>.JoinStyle</cite> or {‘miter’, ‘round’, ‘bevel’}
label: object
linestyle or ls: {‘-’, ‘–’, ‘-.’, ‘:’, ‘’, (offset, on-off-seq), …}
linewidth or lw: float or None
mouseover: bool
path_effects: list of <cite>.AbstractPathEffect</cite>
picker: None or bool or float or callable
rasterized: bool
sketch_params: (scale: float, length: float, randomness: float)
snap: bool or None
transform: <cite>~matplotlib.transforms.Transform</cite>
url: str
visible: bool
zorder: float</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>pp</strong><span class="classifier"><cite>~matplotlib.patches.Patch</cite></span></dt><dd><p>The patch drawn to represent the area of the inset axes.</p>
</dd>
<dt><strong>p1, p2</strong><span class="classifier"><cite>~matplotlib.patches.Patch</cite></span></dt><dd><p>The patches connecting two corners of the inset axes and its area.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.ts_gaussian_filter">
<span class="sig-name descname"><span class="pre">ts_gaussian_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#ts_gaussian_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.ts_gaussian_filter" title="Link to this definition">¶</a></dt>
<dd><p>Column-wise Gaussian smoothing of regular time series.
Missing/irregular values are not handled, which means this function is not much different from
a rolling window gaussian average in pandas which may be preferable in the case of
missing data (ts.rolling(window=5,win_type=’gaussian’).mean.
This function has been kept around awaiting irreg as an aspiration but yet to be implemented.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>The series to be smoothed</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">int or freq</span></dt><dd><p>The sigma scale of the smoothing (analogous to std. deviation), given as a number of steps
or freq</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>A new regular time series with the same interval of ts.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.unit_impulse_ts">
<span class="sig-name descname"><span class="pre">unit_impulse_ts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/frequency_response.html#unit_impulse_ts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.unit_impulse_ts" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>size</strong><span class="classifier">int</span></dt><dd><p>Length of impluse time series, odd number.</p>
</dd>
<dt><strong>interval</strong><span class="classifier">string</span></dt><dd><p>time series interval, such as “15min”</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.Dataframe</dt><dd><p>time series value 0.0 except 1 at the middle of time series.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vtools.functions.interannual">
<span id="vtools-functions-interannual-module"></span><h2>vtools.functions.interannual module<a class="headerlink" href="#module-vtools.functions.interannual" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interannual.interannual">
<span class="sig-name descname"><span class="pre">interannual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interannual.html#interannual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interannual.interannual" title="Link to this definition">¶</a></dt>
<dd><p>Pivots years of multiyear series to columns and convert index to elapsed time of year</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts</strong><span class="classifier">series  Univariate series</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>annual</strong><span class="classifier">DataFrame with year in the columns and elapsed time of year as index</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interannual.interannual_sample">
<span class="sig-name descname"><span class="pre">interannual_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interannual.html#interannual_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interannual.interannual_sample" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interannual.interannual_ticks_labels">
<span class="sig-name descname"><span class="pre">interannual_ticks_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interannual.html#interannual_ticks_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interannual.interannual_ticks_labels" title="Link to this definition">¶</a></dt>
<dd><p>Convenient ticks and labels for interannual</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>freq</strong><span class="classifier">Frequency string for desired spacing. Must be “Q”,”QS”,”M”,”MS” for quarterly or monthly</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ticks_labels</strong><span class="classifier">tuple of tick locations and labels</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vtools.functions.interpolate">
<span id="vtools-functions-interpolate-module"></span><h2>vtools.functions.interpolate module<a class="headerlink" href="#module-vtools.functions.interpolate" title="Link to this heading">¶</a></h2>
<p>Module for data interpolation using splines or interfaces unavailable in Pandas.</p>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate._monotonic_spline">
<span class="sig-name descname"><span class="pre">_monotonic_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xnew</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/_monotonic_spline.html#_monotonic_spline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate._monotonic_spline" title="Link to this definition">¶</a></dt>
<dd><p>Third order (M3-A) monotonicity-preserving spline
Usage:          interpolate.spline(x,y,xnew)</p>
<blockquote>
<div><dl class="simple">
<dt>where</dt><dd><p>x are the sorted index values of the original data
y are the original dataxnew
xnew are new locations for the spline</p>
</dd>
</dl>
<p>Reference: Huynh, HT &lt;&lt;Accurate Monotone Cubic Interpolation&gt;&gt;,
SIAM J. Numer. Analysis V30 No. 1 pp 57-100
All equation numbers refer to this paper. The variable names are
also almost the same. Double letters like “ee” to indicate
that the subscript should have “+1/2” added to it and a number after
the variable to show the “t” that the first member applies to.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate._ratsp1">
<span class="sig-name descname"><span class="pre">_ratsp1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#_ratsp1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate._ratsp1" title="Link to this definition">¶</a></dt>
<dd><p>RATSP1 in Spath (1995)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.interpolate_to_index">
<span class="sig-name descname"><span class="pre">interpolate_to_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#interpolate_to_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.interpolate_to_index" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.monotonic_spline">
<span class="sig-name descname"><span class="pre">monotonic_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#monotonic_spline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.monotonic_spline" title="Link to this definition">¶</a></dt>
<dd><p>Interpolating a regular time series (rts) to a finer rts by rational histospline.</p>
<p>The rational histospline preserves area under the curve. This is a good choice of spline for period averaged data where an interpolant is desired
that is ‘conservative’. Note that it is the underlying continuous interpolant
that will be ‘conservative though, not the returned discrete time series which
merely samples the underlying interpolant.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pandas.DataFrame</span></code></span></dt><dd><p>Series to be interpolated, typically with DatetimeIndex</p>
</dd>
<dt><strong>dest</strong><span class="classifier">a pandas freq code (e.g. ‘16min’ or ‘D’) or a DateTimeIndex</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></span></dt><dd><p>A regular time series with same columns as ts, populated with instantaneous values and with
an index of type DateTimeIndex</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhist">
<span class="sig-name descname"><span class="pre">rhist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhist" title="Link to this definition">¶</a></dt>
<dd><p>Histopline for arrays with tension.
Based by an algorithm rhist2 in
One Dimensional Spline Interpolation Algorithms
by Helmuth Spath (1995).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">array-like</span></dt><dd><p>Abscissa array of original data,
of length n</p>
</dd>
<dt><strong>y</strong><span class="classifier">array-like, dimension (n-1)</span></dt><dd><p>Values (mantissa) of original data giving the rectangle (average) values between x[i] and x[i+1]</p>
</dd>
<dt><strong>xnew</strong><span class="classifier">array-like</span></dt><dd><p>Array of new locations at which to interpolate.</p>
</dd>
<dt><strong>y0,yn</strong><span class="classifier">float</span></dt><dd><p>Initial and terminal values</p>
</dd>
<dt><strong>p,q: array-like, dimension (n-1)</strong></dt><dd><p>Tension parameter, p and q are almost always the same. The higher p and q are for a particular x interval, the more rectangular the interpolant will look and the more
positivity and shape preserving it is at the expense
of accuracy. For this routine any number p,q &gt; -1 is allowed, although the bound routine doesn’t use vals less
than zero.</p>
</dd>
<dt><strong>Returns</strong></dt><dd></dd>
<dt><strong>——-</strong></dt><dd></dd>
<dt><strong>ynew</strong><span class="classifier">array-like</span></dt><dd><p>Array that interpolates the original data.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhist_bound">
<span class="sig-name descname"><span class="pre">rhist_bound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">floor_eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhist_bound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhist_bound" title="Link to this definition">¶</a></dt>
<dd><p>Numpy implementation of histospline with bounds
Histopline for arrays with lower bound enforcement.
This routine drives rhist() but tests that the output
array observes the lower bound and adapts the tension parameters as needed.</p>
<p>This will not work exactly if the input
array has values right on the lower bound. In this case,
the parameter floor_eps allows you to specify a tolerance
of bound violation to shoot for … and if it isn’t met in maxiter iterations the value is simply floored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">array-like</span></dt><dd><p>Abscissa array of original data to be interpolated,
of length n</p>
</dd>
<dt><strong>y</strong><span class="classifier">array-like, dimension (n-1)</span></dt><dd><p>Values (mantissa) of original data giving the rectangle (average) values between x[i] and x[i+1]</p>
</dd>
<dt><strong>xnew</strong><span class="classifier">array-like</span></dt><dd><p>Array of new locations at which to interpolate.</p>
</dd>
<dt><strong>y0,yn</strong><span class="classifier">float</span></dt><dd><p>Initial and terminal values</p>
</dd>
<dt><strong>p: float</strong></dt><dd><p>Tension parameter. This starts out as a global scalar, but will be converted to an array and adapted locally.
The higher this goes for a particular x interval, the more rectangular the interpolant will look and the more
positivity and shape preserving it is at the expense
of accuracy. A good number is 1, and for this routine,
p &gt; 0 is required because the adaptive process multiplies it by pfactor each iteration on the expectation that it will get bigger.</p>
</dd>
<dt><strong>lbound: float</strong></dt><dd><p>Lower bound to be enforced. If the original y’s are strictly above this value, the output has the potential to also be strictly above. If the original y’s lie on the lower bound, then the lower bound can only be enforced within a tolerance using the Spath algorithm …
and once the values reach that tolerance they are floored. If lbound = None, this function behaves like rhist()</p>
</dd>
<dt><strong>maxiter</strong><span class="classifier">integer</span></dt><dd><p>Number of times to increase p by multiplying it by pfactor before giving up on satisfying floor_eps.</p>
</dd>
<dt><strong>pfactor</strong><span class="classifier">float</span></dt><dd><p>Factor by which to multiply individual time step p</p>
</dd>
<dt><strong>floor_eps</strong><span class="classifier">float</span></dt><dd><p>Tolerance for lower bound violation at which the algorithm will be terminated and the bounds will be enforced by flooring.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ynew</strong><span class="classifier">array-like</span></dt><dd><p>Array that interpolates the original data, on a curve that conserves mass and strictly observes the lower bound.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhist_coef">
<span class="sig-name descname"><span class="pre">rhist_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhist_coef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhist_coef" title="Link to this definition">¶</a></dt>
<dd><p>Routine that produces coefficients for the histospline</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhist_example">
<span class="sig-name descname"><span class="pre">rhist_example</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhist_example"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhist_example" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhist_val">
<span class="sig-name descname"><span class="pre">rhist_val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhist_val"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhist_val" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate a histospline at new x points</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhistinterp">
<span class="sig-name descname"><span class="pre">rhistinterp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowbound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolbound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhistinterp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhistinterp" title="Link to this definition">¶</a></dt>
<dd><p>Interpolate a regular time series (rts) to a finer rts by rational histospline.</p>
<p>The rational histospline preserves area under the curve. This is a good choice of spline for period averaged data where an interpolant is desired
that is ‘conservative’. Note that it is the underlying continuous interpolant
that will be ‘conservative though, not the returned discrete time series which
merely samples the underlying interpolant.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pandas.DataFrame</span></code></span></dt><dd><p>Series to be interpolated, with period index and assuming time stamps at beginning
of the period and no missing data</p>
</dd>
<dt><strong>dest</strong><span class="classifier">string or <code class="xref py py-class docutils literal notranslate"><span class="pre">DateTimeIndex</span></code></span></dt><dd><p>A pandas freq code (e.g. ‘16min’ or ‘D’) or a DateTimeIndex</p>
</dd>
<dt><strong>p</strong><span class="classifier">float, optional</span></dt><dd><p>Spline tension, usually between 0 and 20. Must &gt;-1. For a ‘sufficiently large’ value of p, the interpolant will be monotonicity-preserving and will maintain strict positivity (always being strictly &gt; <cite>lowbound</cite>). It will also preserve the original shape of the time series.</p>
</dd>
<dt><strong>lowbound</strong><span class="classifier">float, optional</span></dt><dd><p>Lower bound of interpolated values.</p>
</dd>
<dt><strong>tolbound</strong><span class="classifier">float, optional</span></dt><dd><p>Tolerance for determining if an input is on the bound.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></span></dt><dd><p>A regular time series with same columns as ts, populated with instantaneous values and with
an index of type DateTimeIndex</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.tridiagonal">
<span class="sig-name descname"><span class="pre">tridiagonal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#tridiagonal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.tridiagonal" title="Link to this definition">¶</a></dt>
<dd><p>a is the lower band (with leading zero)
b is the center diagonal (length == nrow)
c is upper band (trailing zero)
d is right hand side</p>
</dd></dl>

</section>
<section id="module-vtools.functions.lag_cross_correlation">
<span id="vtools-functions-lag-cross-correlation-module"></span><h2>vtools.functions.lag_cross_correlation module<a class="headerlink" href="#module-vtools.functions.lag_cross_correlation" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.lag_cross_correlation._coerce_fixed_duration">
<span class="sig-name descname"><span class="pre">_coerce_fixed_duration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/lag_cross_correlation.html#_coerce_fixed_duration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.lag_cross_correlation._coerce_fixed_duration" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.lag_cross_correlation.calculate_lag">
<span class="sig-name descname"><span class="pre">calculate_lag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lagged</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/lag_cross_correlation.html#calculate_lag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.lag_cross_correlation.calculate_lag" title="Link to this definition">¶</a></dt>
<dd><p>Calculate shift in lagged, that maximizes cross-correlation with base.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>base,lagged: :class:`Pandas.Series`</strong></dt><dd><p>time series to compare. The result is relative to base</p>
</dd>
<dt><strong>max_lag: interval</strong></dt><dd><p>Maximum pos/negative time shift to consider in cross-correlation
(ie, from -max_lag to +max_lag). Required windows in lagged will
account for this bracket. For series dominated by a single
frequency (eg 1c/12.5 hours for tides), the algorithm can tolerate
a range of 180 degrees (6 hours)</p>
</dd>
<dt><strong>res: interval</strong></dt><dd><p>Resolution of analysis. The series lagged will
be interpolated to this resolution using interpolate_method. Unit
used here will determine the type of the output. See documentation
of the interval concept which is most compatible with
pandas.tseries.offsets, not timeDelta, because of better math
properties in things like division – vtime helpers like minutes(1)
may be helpful</p>
</dd>
<dt><strong>interpolate_method: str, optional</strong></dt><dd><p>Interpolate method to refine lagged to res. Must be compatible with
pandas interpolation method names (and hence scipy)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>lag</strong><span class="classifier">interval</span></dt><dd><p>Shift as a pandas.tseries.offsets subtype that matches units with res
This shift is the apparent lateness (pos) or earliness (neg). It must be
applied to base or removed to lagged to align the features.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.lag_cross_correlation.icrosscorr">
<span class="sig-name descname"><span class="pre">icrosscorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/lag_cross_correlation.html#icrosscorr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.lag_cross_correlation.icrosscorr" title="Link to this definition">¶</a></dt>
<dd><p>Lag-N cross correlation.
Shifted data filled with NaNs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lag</strong><span class="classifier">int, default 0</span></dt><dd></dd>
<dt><strong>ts0, ts1</strong><span class="classifier">pandas.Series objects of equal length</span></dt><dd></dd>
<dt><strong>Returns</strong></dt><dd></dd>
<dt><strong>———-</strong></dt><dd></dd>
<dt><strong>crosscorr</strong><span class="classifier">float</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.lag_cross_correlation.mincrosscorr">
<span class="sig-name descname"><span class="pre">mincrosscorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/lag_cross_correlation.html#mincrosscorr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.lag_cross_correlation.mincrosscorr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.lag_cross_correlation.to_offset">
<span class="sig-name descname"><span class="pre">to_offset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vtools.functions.lag_cross_correlation.to_offset" title="Link to this definition">¶</a></dt>
<dd><p>Return DateOffset object from string or datetime.timedelta object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>freq</strong><span class="classifier">str, datetime.timedelta, BaseOffset or None</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>BaseOffset subclass or None</dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If freq is an invalid frequency</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseOffset</span></code></dt><dd><p>Standard kind of date increment used for a date range.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pandas.tseries.frequencies</span> <span class="kn">import</span> <span class="n">to_offset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">to_offset</span><span class="p">(</span><span class="s2">&quot;5min&quot;</span><span class="p">)</span>
<span class="go">&lt;5 * Minutes&gt;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">to_offset</span><span class="p">(</span><span class="s2">&quot;1D1h&quot;</span><span class="p">)</span>
<span class="go">&lt;25 * Hours&gt;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">to_offset</span><span class="p">(</span><span class="s2">&quot;2W&quot;</span><span class="p">)</span>
<span class="go">&lt;2 * Weeks: weekday=6&gt;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">to_offset</span><span class="p">(</span><span class="s2">&quot;2B&quot;</span><span class="p">)</span>
<span class="go">&lt;2 * BusinessDays&gt;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">to_offset</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="go">&lt;Day&gt;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">to_offset</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">Hour</span><span class="p">())</span>
<span class="go">&lt;Hour&gt;</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-vtools.functions.merge">
<span id="vtools-functions-merge-module"></span><h2>vtools.functions.merge module<a class="headerlink" href="#module-vtools.functions.merge" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.merge._reindex_to_continuous">
<span class="sig-name descname"><span class="pre">_reindex_to_continuous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/merge.html#_reindex_to_continuous"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.merge._reindex_to_continuous" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.merge.align_inputs_strict">
<span class="sig-name descname"><span class="pre">align_inputs_strict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq_arg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'names'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/colname_align.html#align_inputs_strict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.merge.align_inputs_strict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.merge.reduce">
<span class="sig-name descname"><span class="pre">reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">initial</span></span></em><span class="optional">]</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">value</span></span></span><a class="headerlink" href="#vtools.functions.merge.reduce" title="Link to this definition">¶</a></dt>
<dd><p>Apply a function of two arguments cumulatively to the items of a sequence
or iterable, from left to right, so as to reduce the iterable to a single
value.  For example, reduce(lambda x, y: x+y, [1, 2, 3, 4, 5]) calculates
((((1+2)+3)+4)+5).  If initial is present, it is placed before the items
of the iterable in the calculation, and serves as a default when the
iterable is empty.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.merge.ts_merge">
<span class="sig-name descname"><span class="pre">ts_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict_priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/merge.html#ts_merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.merge.ts_merge" title="Link to this definition">¶</a></dt>
<dd><p>Merge multiple time series together, prioritizing series in order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>series</strong><span class="classifier">sequence of pandas.Series or pandas.DataFrame</span></dt><dd><p>Higher priority first. All indexes must be DatetimeIndex.</p>
</dd>
<dt><strong>names</strong><span class="classifier">None, str, or iterable of str, optional</span></dt><dd><ul class="simple">
<li><p>If <cite>None</cite> (default), inputs must share compatible column names.</p></li>
<li><p>If <cite>str</cite>, the output is univariate and will be named accordingly.</p></li>
<li><p>If iterable, it is used as a subset/ordering of columns.</p></li>
</ul>
</dd>
<dt><strong>strict_priority</strong><span class="classifier">bool, default False</span></dt><dd><p>If False (default): lower-priority data may fill NaNs in higher-priority
series anywhere (traditional merge/overlay).
If True: for each column, within the window
[first_valid_index, last_valid_index] of any higher-priority series,
lower-priority data are masked out — even if the higher-priority value is NaN.
Outside those windows, behavior is unchanged.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.Series or pandas.DataFrame</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.merge.ts_splice">
<span class="sig-name descname"><span class="pre">ts_splice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prefer_last'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">floor_dates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/merge.html#ts_splice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.merge.ts_splice" title="Link to this definition">¶</a></dt>
<dd><p>Splice multiple time series together, prioritizing series in patches of time.</p>
<p>Unlike <cite>ts_merge</cite>, which blends overlapping data points, <cite>ts_splice</cite> stitches
together time series without overlap. The function determines when to switch
between series based on a transition strategy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>series</strong><span class="classifier">tuple or list of pandas.DataFrame or pandas.Series</span></dt><dd><p>A tuple or list of time series.
Each series must have a <cite>DatetimeIndex</cite> and consistent column structure.</p>
</dd>
<dt><strong>names</strong><span class="classifier">None, str, or iterable of str, optional</span></dt><dd><ul class="simple">
<li><p>If <cite>None</cite> (default), all input series must share common column names,
and the output will merge common columns.</p></li>
<li><p>If a <cite>str</cite>, all input series must have a <strong>single column</strong>, and the
output will be a DataFrame with this name as the column name.</p></li>
<li><p>If an iterable of <cite>str</cite>, all input DataFrames must have the same
number of columns matching the length of <cite>names</cite>, and these will be
used for the output.</p></li>
</ul>
</dd>
<dt><strong>transition</strong><span class="classifier">{‘prefer_first’, ‘prefer_last’} or list of pandas.Timestamp</span></dt><dd><p>Defines how to determine breakpoints between time series:
- <cite>‘prefer_first’</cite>: Uses the earlier series on the list during until its valid timestamp.
- <cite>‘prefer_last’</cite>: Uses the later series starting from its first valid timestamp.
- A list of specific timestamps can also be provided as transition points.</p>
</dd>
<dt><strong>floor_dates</strong><span class="classifier">bool, optional, default=False</span></dt><dd><p>If <cite>True</cite>, inferred transition timestamps (<cite>prefer_first</cite> or <cite>prefer_last</cite>)
are floored to the beginning of the day. This can introduce NaNs if the
input series are regular with a <cite>freq</cite> attribute.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.DataFrame or pandas.Series</dt><dd><ul class="simple">
<li><p>If the input contains multi-column DataFrames, the output is a DataFrame
with the same column structure.</p></li>
<li><p>If a collection of single-column <cite>Series</cite> is provided, the output will be
a Series.</p></li>
<li><p>The output retains a <cite>freq</cite> attribute if all inputs share the same frequency.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#vtools.functions.merge.ts_merge" title="vtools.functions.merge.ts_merge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ts_merge</span></code></a></dt><dd><p>Merges series by filling gaps in order of priority.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The output time index is the union of input time indices.</p></li>
<li><p>If <cite>transition</cite> is <cite>‘prefer_first’</cite>, gaps may appear in the final time series.</p></li>
<li><p>If <cite>transition</cite> is <cite>‘prefer_last’</cite>, overlapping data is resolved in favor
of later series.</p></li>
</ul>
</dd></dl>

</section>
<section id="module-vtools.functions.neighbor_fill">
<span id="vtools-functions-neighbor-fill-module"></span><h2>vtools.functions.neighbor_fill module<a class="headerlink" href="#module-vtools.functions.neighbor_fill" title="Link to this heading">¶</a></h2>
<p>Neighbor-based time-series gap filling.</p>
<p>This module provides a single high-level API, <code class="xref py py-func docutils literal notranslate"><span class="pre">fill_from_neighbor()</span></code>,
with pluggable backends for common algorithms used to infer a target series
from one or more nearby stations. It is designed for operational use in
Delta/Bay hydrodynamics workflows, but is intentionally general.</p>
<section id="highlights">
<h3>Highlights<a class="headerlink" href="#highlights" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Robust time alignment and optional resampling.</p></li>
<li><p>Multiple modeling strategies: OLS/robust, rolling regression,</p></li>
</ul>
<p>lagged elastic-net, and state-space/Kalman.
- Forward-chaining (temporal) cross-validation utilities.
- Optional regime stratification (e.g., barrier in/out, season).
- Uncertainty estimates where available (analytic or residual-based).
- Clear return structure with diagnostics for auditability.</p>
</section>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Link to this heading">¶</a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">fill_from_neighbor</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">target</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">neighbor</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;state_space&quot;</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">regime</span><span class="o">=</span><span class="n">regime_series</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filled</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;filled&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">info</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s2">&quot;model_info&quot;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="id15">
<h3>Notes<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>“Neighbor” can be one series or multiple (as a DataFrame); both are supported.</p></li>
<li><p>Missing data in the target are left as-is where the model cannot reasonably</p></li>
</ul>
<p>infer a value (e.g., no overlapping neighbor data). Where predictions exist,
they are merged into the target to produce <cite>filled</cite>.
- For state-space and ARIMAX, missing values are handled natively by the
Kalman filter/SARIMAX, but the model must still be trained on an overlap
window that contains data.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.DFMFill">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DFMFill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">endog</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anom_var</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'neighbor'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rx_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#DFMFill"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.DFMFill" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel" title="statsmodels.tsa.statespace.mlemodel.MLEModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLEModel</span></code></a></p>
<p>Bivariate DFM with level+slope common factor and optional anomalies.
States (ordered):</p>
<blockquote>
<div><p>[ mu, beta, (ay?), (ax?) ]</p>
</div></blockquote>
<dl class="simple">
<dt>where ay is included iff anom_var in {“target”,”both”},</dt><dd><p>ax is included iff anom_var in {“neighbor”,”both”}.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">endog_names</span></code></dt><dd><p>Names of endogenous variables.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">exog_names</span></code></dt><dd><p>The names of the exogenous variables.</p>
</dd>
<dt><strong>initial_variance</strong></dt><dd></dd>
<dt><strong>initialization</strong></dt><dd></dd>
<dt><strong>loglikelihood_burn</strong></dt><dd></dd>
<dt><a class="reference internal" href="#vtools.functions.neighbor_fill.DFMFill.param_names" title="vtools.functions.neighbor_fill.DFMFill.param_names"><code class="xref py py-obj docutils literal notranslate"><span class="pre">param_names</span></code></a></dt><dd><p>(list of str) List of human readable parameter names (for parameters</p>
</dd>
<dt><a class="reference internal" href="#vtools.functions.neighbor_fill.DFMFill.start_params" title="vtools.functions.neighbor_fill.DFMFill.start_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">start_params</span></code></a></dt><dd><p>(array) Starting parameters for maximum likelihood estimation.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_names</span></code></dt><dd><p>(list of str) List of human readable names for unobserved states.</p>
</dd>
<dt><strong>tolerance</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">clone</span></code>(endog[, exog])</p></td>
<td><p>Clone state space model with new data and optionally new specification</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code>(params[, transformed, ...])</p></td>
<td><p>Kalman filtering</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code>([start_params, transformed, ...])</p></td>
<td><p>Fits the model by maximum likelihood via Kalman filter.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_constrained</span></code>(constraints[, start_params])</p></td>
<td><p>Fit the model with some parameters subject to equality constraints.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fix_params</span></code>(params)</p></td>
<td><p>Fix parameters to specific values (context manager)</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_formula</span></code>(formula, data[, subset])</p></td>
<td><p>Not implemented for state space models</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">handle_params</span></code>(params[, transformed, ...])</p></td>
<td><p>Ensure model parameters satisfy shape and other requirements</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">hessian</span></code>(params, *args, **kwargs)</p></td>
<td><p>Hessian matrix of the likelihood function, evaluated at the given parameters</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">impulse_responses</span></code>(params[, steps, impulse, ...])</p></td>
<td><p>Impulse response function</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">information</span></code>(params)</p></td>
<td><p>Fisher information matrix of model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize</span></code>()</p></td>
<td><p>Initialize (possibly re-initialize) a Model instance.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize_approximate_diffuse</span></code>([variance])</p></td>
<td><p>Initialize approximate diffuse</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize_known</span></code>(initial_state, ...)</p></td>
<td><p>Initialize known</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize_statespace</span></code>(**kwargs)</p></td>
<td><p>Initialize the state space representation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize_stationary</span></code>()</p></td>
<td><p>Initialize stationary</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">loglike</span></code>(params, *args, **kwargs)</p></td>
<td><p>Loglikelihood evaluation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">loglikeobs</span></code>(params[, transformed, ...])</p></td>
<td><p>Loglikelihood evaluation</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">observed_information_matrix</span></code>(params[, ...])</p></td>
<td><p>Observed information matrix</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">opg_information_matrix</span></code>(params[, ...])</p></td>
<td><p>Outer product of gradients information matrix</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code>(params[, exog])</p></td>
<td><p>After a model has been fit predict returns the fitted values.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code>()</p></td>
<td><p>Prepare data for use in the state space representation</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">score</span></code>(params, *args, **kwargs)</p></td>
<td><p>Compute the score function at params.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">score_obs</span></code>(params[, method, transformed, ...])</p></td>
<td><p>Compute the score per observation, evaluated at params</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_conserve_memory</span></code>([conserve_memory])</p></td>
<td><p>Set the memory conservation method</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_filter_method</span></code>([filter_method])</p></td>
<td><p>Set the filtering method</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_inversion_method</span></code>([inversion_method])</p></td>
<td><p>Set the inversion method</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_smoother_output</span></code>([smoother_output])</p></td>
<td><p>Set the smoother output</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_stability_method</span></code>([stability_method])</p></td>
<td><p>Set the numerical stability method</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">simulate</span></code>(params, nsimulations[, ...])</p></td>
<td><p>Simulate a new time series following the state space model</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">simulation_smoother</span></code>([simulation_output])</p></td>
<td><p>Retrieve a simulation smoother for the state space model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">smooth</span></code>(params[, transformed, ...])</p></td>
<td><p>Kalman smoothing</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_jacobian</span></code>(unconstrained[, ...])</p></td>
<td><p>Jacobian matrix for the parameter transformation function</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_params</span></code>(unconstrained)</p></td>
<td><p>Transform unconstrained parameters used by the optimizer to constrained parameters used in likelihood evaluation</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">untransform_params</span></code>(constrained)</p></td>
<td><p>Transform constrained parameters used in likelihood evaluation to unconstrained parameters used by the optimizer</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.DFMFill.update" title="vtools.functions.neighbor_fill.DFMFill.update"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update</span></code></a>(params[, transformed])</p></td>
<td><p>Update the parameters of the model</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.DFMFill.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'\n</span>&#160;&#160;&#160; <span class="pre">Bivariate</span> <span class="pre">DFM</span> <span class="pre">with</span> <span class="pre">level+slope</span> <span class="pre">common</span> <span class="pre">factor</span> <span class="pre">and</span> <span class="pre">optional</span> <span class="pre">anomalies.\n</span>&#160;&#160;&#160; <span class="pre">States</span> <span class="pre">(ordered):\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">[</span> <span class="pre">mu,</span> <span class="pre">beta,</span> <span class="pre">(ay?),</span> <span class="pre">(ax?)</span> <span class="pre">]\n</span>&#160;&#160;&#160; <span class="pre">where</span> <span class="pre">ay</span> <span class="pre">is</span> <span class="pre">included</span> <span class="pre">iff</span> <span class="pre">anom_var</span> <span class="pre">in</span> <span class="pre">{&quot;target&quot;,&quot;both&quot;},\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">ax</span> <span class="pre">is</span> <span class="pre">included</span> <span class="pre">iff</span> <span class="pre">anom_var</span> <span class="pre">in</span> <span class="pre">{&quot;neighbor&quot;,&quot;both&quot;}.\n</span>&#160;&#160;&#160; <span class="pre">'</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.DFMFill.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.DFMFill.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">endog</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anom_var</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'neighbor'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rx_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#DFMFill.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.DFMFill.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.DFMFill.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'vtools.functions.neighbor_fill'</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.DFMFill.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.DFMFill._constrain">
<span class="sig-name descname"><span class="pre">_constrain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#DFMFill._constrain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.DFMFill._constrain" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.DFMFill.param_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">param_names</span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.DFMFill.param_names" title="Link to this definition">¶</a></dt>
<dd><p>(list of str) List of human readable parameter names (for parameters
actually included in the model).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.DFMFill.start_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">start_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.DFMFill.start_params" title="Link to this definition">¶</a></dt>
<dd><p>(array) Starting parameters for maximum likelihood estimation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.DFMFill.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#DFMFill.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.DFMFill.update" title="Link to this definition">¶</a></dt>
<dd><p>Update the parameters of the model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like</span></dt><dd><p>Array of new parameters.</p>
</dd>
<dt><strong>transformed</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not <cite>params</cite> is already transformed. If set to False,
<cite>transform_params</cite> is called. Default is True.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like</span></dt><dd><p>Array of parameters.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Since Model is a base class, this method should be overridden by
subclasses to perform actual updating steps.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.ElasticNetCV">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ElasticNetCV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_alphas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy_X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cyclic'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/linear_model/_coordinate_descent.html#ElasticNetCV"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.ElasticNetCV" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RegressorMixin</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">LinearModelCV</span></code></p>
<p>Elastic Net model with iterative fitting along a regularization path.</p>
<p>See glossary entry for <span class="xref std std-term">cross-validation estimator</span>.</p>
<p>Read more in the <span class="xref std std-ref">User Guide</span>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>l1_ratio</strong><span class="classifier">float or list of float, default=0.5</span></dt><dd><p>Float between 0 and 1 passed to ElasticNet (scaling between
l1 and l2 penalties). For <code class="docutils literal notranslate"><span class="pre">l1_ratio</span> <span class="pre">=</span> <span class="pre">0</span></code>
the penalty is an L2 penalty. For <code class="docutils literal notranslate"><span class="pre">l1_ratio</span> <span class="pre">=</span> <span class="pre">1</span></code> it is an L1 penalty.
For <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">l1_ratio</span> <span class="pre">&lt;</span> <span class="pre">1</span></code>, the penalty is a combination of L1 and L2
This parameter can be a list, in which case the different
values are tested by cross-validation and the one giving the best
prediction score is used. Note that a good choice of list of
values for l1_ratio is often to put more values close to 1
(i.e. Lasso) and less close to 0 (i.e. Ridge), as in <code class="docutils literal notranslate"><span class="pre">[.1,</span> <span class="pre">.5,</span> <span class="pre">.7,</span>
<span class="pre">.9,</span> <span class="pre">.95,</span> <span class="pre">.99,</span> <span class="pre">1]</span></code>.</p>
</dd>
<dt><strong>eps</strong><span class="classifier">float, default=1e-3</span></dt><dd><p>Length of the path. <code class="docutils literal notranslate"><span class="pre">eps=1e-3</span></code> means that
<code class="docutils literal notranslate"><span class="pre">alpha_min</span> <span class="pre">/</span> <span class="pre">alpha_max</span> <span class="pre">=</span> <span class="pre">1e-3</span></code>.</p>
</dd>
<dt><strong>n_alphas</strong><span class="classifier">int, default=100</span></dt><dd><p>Number of alphas along the regularization path, used for each l1_ratio.</p>
</dd>
<dt><strong>alphas</strong><span class="classifier">array-like, default=None</span></dt><dd><p>List of alphas where to compute the models.
If None alphas are set automatically.</p>
</dd>
<dt><strong>fit_intercept</strong><span class="classifier">bool, default=True</span></dt><dd><p>Whether to calculate the intercept for this model. If set
to false, no intercept will be used in calculations
(i.e. data is expected to be centered).</p>
</dd>
<dt><strong>precompute</strong><span class="classifier">‘auto’, bool or array-like of shape             (n_features, n_features), default=’auto’</span></dt><dd><p>Whether to use a precomputed Gram matrix to speed up
calculations. If set to <code class="docutils literal notranslate"><span class="pre">'auto'</span></code> let us decide. The Gram
matrix can also be passed as argument.</p>
</dd>
<dt><strong>max_iter</strong><span class="classifier">int, default=1000</span></dt><dd><p>The maximum number of iterations.</p>
</dd>
<dt><strong>tol</strong><span class="classifier">float, default=1e-4</span></dt><dd><p>The tolerance for the optimization: if the updates are
smaller than <code class="docutils literal notranslate"><span class="pre">tol</span></code>, the optimization code checks the
dual gap for optimality and continues until it is smaller
than <code class="docutils literal notranslate"><span class="pre">tol</span></code>.</p>
</dd>
<dt><strong>cv</strong><span class="classifier">int, cross-validation generator or iterable, default=None</span></dt><dd><p>Determines the cross-validation splitting strategy.
Possible inputs for cv are:</p>
<ul class="simple">
<li><p>None, to use the default 5-fold cross-validation,</p></li>
<li><p>int, to specify the number of folds.</p></li>
<li><p><span class="xref std std-term">CV splitter</span>,</p></li>
<li><p>An iterable yielding (train, test) splits as arrays of indices.</p></li>
</ul>
<p>For int/None inputs, <code class="xref py py-class docutils literal notranslate"><span class="pre">KFold</span></code> is used.</p>
<p>Refer <span class="xref std std-ref">User Guide</span> for the various
cross-validation strategies that can be used here.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.22: </span><code class="docutils literal notranslate"><span class="pre">cv</span></code> default value if None changed from 3-fold to 5-fold.</p>
</div>
</dd>
<dt><strong>copy_X</strong><span class="classifier">bool, default=True</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, X will be copied; else, it may be overwritten.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool or int, default=0</span></dt><dd><p>Amount of verbosity.</p>
</dd>
<dt><strong>n_jobs</strong><span class="classifier">int, default=None</span></dt><dd><p>Number of CPUs to use during the cross validation.
<code class="docutils literal notranslate"><span class="pre">None</span></code> means 1 unless in a <code class="xref py py-obj docutils literal notranslate"><span class="pre">joblib.parallel_backend</span></code> context.
<code class="docutils literal notranslate"><span class="pre">-1</span></code> means using all processors. See <span class="xref std std-term">Glossary</span>
for more details.</p>
</dd>
<dt><strong>positive</strong><span class="classifier">bool, default=False</span></dt><dd><p>When set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, forces the coefficients to be positive.</p>
</dd>
<dt><strong>random_state</strong><span class="classifier">int, RandomState instance, default=None</span></dt><dd><p>The seed of the pseudo random number generator that selects a random
feature to update. Used when <code class="docutils literal notranslate"><span class="pre">selection</span></code> == ‘random’.
Pass an int for reproducible output across multiple function calls.
See <span class="xref std std-term">Glossary</span>.</p>
</dd>
<dt><strong>selection</strong><span class="classifier">{‘cyclic’, ‘random’}, default=’cyclic’</span></dt><dd><p>If set to ‘random’, a random coefficient is updated every iteration
rather than looping over features sequentially by default. This
(setting to ‘random’) often leads to significantly faster convergence
especially when tol is higher than 1e-4.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">enet_path</span></code></dt><dd><p>Compute elastic net path with coordinate descent.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">ElasticNet</span></code></dt><dd><p>Linear regression with combined L1 and L2 priors as regularizer.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>In <cite>fit</cite>, once the best parameters <cite>l1_ratio</cite> and <cite>alpha</cite> are found through
cross-validation, the model is fit again using the entire training set.</p>
<p>To avoid unnecessary memory duplication the <cite>X</cite> argument of the <cite>fit</cite>
method should be directly passed as a Fortran-contiguous numpy array.</p>
<p>The parameter <cite>l1_ratio</cite> corresponds to alpha in the glmnet R package
while alpha corresponds to the lambda parameter in glmnet.
More specifically, the optimization objective is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">)</span> <span class="o">*</span> <span class="o">||</span><span class="n">y</span> <span class="o">-</span> <span class="n">Xw</span><span class="o">||^</span><span class="mi">2_2</span>
<span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">l1_ratio</span> <span class="o">*</span> <span class="o">||</span><span class="n">w</span><span class="o">||</span><span class="n">_1</span>
<span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">l1_ratio</span><span class="p">)</span> <span class="o">*</span> <span class="o">||</span><span class="n">w</span><span class="o">||^</span><span class="mi">2_2</span>
</pre></div>
</div>
<p>If you are interested in controlling the L1 and L2 penalty
separately, keep in mind that this is equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">*</span> <span class="n">L1</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">L2</span>
</pre></div>
</div>
<p>for:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="ow">and</span> <span class="n">l1_ratio</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
<p>For an example, see
<span class="xref std std-ref">examples/linear_model/plot_lasso_model_selection.py</span>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">ElasticNetCV</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_regression</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_regression</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regr</span> <span class="o">=</span> <span class="n">ElasticNetCV</span><span class="p">(</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">regr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">ElasticNetCV(cv=5, random_state=0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">regr</span><span class="o">.</span><span class="n">alpha_</span><span class="p">)</span>
<span class="go">0.199...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">regr</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>
<span class="go">0.398...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">regr</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]))</span>
<span class="go">[0.398...]</span>
</pre></div>
</div>
<dl class="field-list">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>alpha_</strong><span class="classifier">float</span></dt><dd><p>The amount of penalization chosen by cross validation.</p>
</dd>
<dt><strong>l1_ratio_</strong><span class="classifier">float</span></dt><dd><p>The compromise between l1 and l2 penalization chosen by
cross validation.</p>
</dd>
<dt><strong>coef_</strong><span class="classifier">ndarray of shape (n_features,) or (n_targets, n_features)</span></dt><dd><p>Parameter vector (w in the cost function formula).</p>
</dd>
<dt><strong>intercept_</strong><span class="classifier">float or ndarray of shape (n_targets, n_features)</span></dt><dd><p>Independent term in the decision function.</p>
</dd>
<dt><strong>mse_path_</strong><span class="classifier">ndarray of shape (n_l1_ratio, n_alpha, n_folds)</span></dt><dd><p>Mean square error for the test set on each fold, varying l1_ratio and
alpha.</p>
</dd>
<dt><strong>alphas_</strong><span class="classifier">ndarray of shape (n_alphas,) or (n_l1_ratio, n_alphas)</span></dt><dd><p>The grid of alphas used for fitting, for each l1_ratio.</p>
</dd>
<dt><strong>dual_gap_</strong><span class="classifier">float</span></dt><dd><p>The dual gaps at the end of the optimization for the optimal alpha.</p>
</dd>
<dt><strong>n_iter_</strong><span class="classifier">int</span></dt><dd><p>Number of iterations run by the coordinate descent solver to reach
the specified tolerance for the optimal alpha.</p>
</dd>
<dt><strong>n_features_in_</strong><span class="classifier">int</span></dt><dd><p>Number of features seen during <span class="xref std std-term">fit</span>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.24.</span></p>
</div>
</dd>
<dt><strong>feature_names_in_</strong><span class="classifier">ndarray of shape (<cite>n_features_in_</cite>,)</span></dt><dd><p>Names of features seen during <span class="xref std std-term">fit</span>. Defined only when <cite>X</cite>
has feature names that are all strings.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.0.</span></p>
</div>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code>(X, y[, sample_weight])</p></td>
<td><p>Fit linear model with coordinate descent.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_metadata_routing</span></code>()</p></td>
<td><p>Get metadata routing of this object.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_params</span></code>([deep])</p></td>
<td><p>Get parameters for this estimator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.ElasticNetCV.path" title="vtools.functions.neighbor_fill.ElasticNetCV.path"><code class="xref py py-obj docutils literal notranslate"><span class="pre">path</span></code></a>(X, y, *[, l1_ratio, eps, n_alphas, ...])</p></td>
<td><p>Compute elastic net path with coordinate descent.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code>(X)</p></td>
<td><p>Predict using the linear model.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">score</span></code>(X, y[, sample_weight])</p></td>
<td><p>Return the coefficient of determination of the prediction.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.ElasticNetCV.set_fit_request" title="vtools.functions.neighbor_fill.ElasticNetCV.set_fit_request"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_fit_request</span></code></a>(*[, sample_weight])</p></td>
<td><p>Request metadata passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code>(**params)</p></td>
<td><p>Set the parameters of this estimator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.ElasticNetCV.set_score_request" title="vtools.functions.neighbor_fill.ElasticNetCV.set_score_request"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_score_request</span></code></a>(*[, sample_weight])</p></td>
<td><p>Request metadata passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.ElasticNetCV.__abstractmethods__">
<span class="sig-name descname"><span class="pre">__abstractmethods__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">frozenset({})</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.ElasticNetCV.__abstractmethods__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.ElasticNetCV.__annotations__">
<span class="sig-name descname"><span class="pre">__annotations__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'_parameter_constraints':</span> <span class="pre">&lt;class</span> <span class="pre">'dict'&gt;}</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.ElasticNetCV.__annotations__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.ElasticNetCV.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&quot;Elastic</span> <span class="pre">Net</span> <span class="pre">model</span> <span class="pre">with</span> <span class="pre">iterative</span> <span class="pre">fitting</span> <span class="pre">along</span> <span class="pre">a</span> <span class="pre">regularization</span> <span class="pre">path.\n\n</span>&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">glossary</span> <span class="pre">entry</span> <span class="pre">for</span> <span class="pre">:term:`cross-validation</span> <span class="pre">estimator`.\n\n</span>&#160;&#160;&#160; <span class="pre">Read</span> <span class="pre">more</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">:ref:`User</span> <span class="pre">Guide</span> <span class="pre">&lt;elastic_net&gt;`.\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">l1_ratio</span> <span class="pre">:</span> <span class="pre">float</span> <span class="pre">or</span> <span class="pre">list</span> <span class="pre">of</span> <span class="pre">float,</span> <span class="pre">default=0.5\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Float</span> <span class="pre">between</span> <span class="pre">0</span> <span class="pre">and</span> <span class="pre">1</span> <span class="pre">passed</span> <span class="pre">to</span> <span class="pre">ElasticNet</span> <span class="pre">(scaling</span> <span class="pre">between\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">l1</span> <span class="pre">and</span> <span class="pre">l2</span> <span class="pre">penalties).</span> <span class="pre">For</span> <span class="pre">``l1_ratio</span> <span class="pre">=</span> <span class="pre">0``\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">the</span> <span class="pre">penalty</span> <span class="pre">is</span> <span class="pre">an</span> <span class="pre">L2</span> <span class="pre">penalty.</span> <span class="pre">For</span> <span class="pre">``l1_ratio</span> <span class="pre">=</span> <span class="pre">1``</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">an</span> <span class="pre">L1</span> <span class="pre">penalty.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">For</span> <span class="pre">``0</span> <span class="pre">&lt;</span> <span class="pre">l1_ratio</span> <span class="pre">&lt;</span> <span class="pre">1``,</span> <span class="pre">the</span> <span class="pre">penalty</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">combination</span> <span class="pre">of</span> <span class="pre">L1</span> <span class="pre">and</span> <span class="pre">L2\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">This</span> <span class="pre">parameter</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">list,</span> <span class="pre">in</span> <span class="pre">which</span> <span class="pre">case</span> <span class="pre">the</span> <span class="pre">different\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">values</span> <span class="pre">are</span> <span class="pre">tested</span> <span class="pre">by</span> <span class="pre">cross-validation</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">one</span> <span class="pre">giving</span> <span class="pre">the</span> <span class="pre">best\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">prediction</span> <span class="pre">score</span> <span class="pre">is</span> <span class="pre">used.</span> <span class="pre">Note</span> <span class="pre">that</span> <span class="pre">a</span> <span class="pre">good</span> <span class="pre">choice</span> <span class="pre">of</span> <span class="pre">list</span> <span class="pre">of\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">values</span> <span class="pre">for</span> <span class="pre">l1_ratio</span> <span class="pre">is</span> <span class="pre">often</span> <span class="pre">to</span> <span class="pre">put</span> <span class="pre">more</span> <span class="pre">values</span> <span class="pre">close</span> <span class="pre">to</span> <span class="pre">1\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(i.e.</span> <span class="pre">Lasso)</span> <span class="pre">and</span> <span class="pre">less</span> <span class="pre">close</span> <span class="pre">to</span> <span class="pre">0</span> <span class="pre">(i.e.</span> <span class="pre">Ridge),</span> <span class="pre">as</span> <span class="pre">in</span> <span class="pre">``[.1,</span> <span class="pre">.5,</span> <span class="pre">.7,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">.9,</span> <span class="pre">.95,</span> <span class="pre">.99,</span> <span class="pre">1]``.\n\n</span>&#160;&#160;&#160; <span class="pre">eps</span> <span class="pre">:</span> <span class="pre">float,</span> <span class="pre">default=1e-3\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Length</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">path.</span> <span class="pre">``eps=1e-3``</span> <span class="pre">means</span> <span class="pre">that\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">``alpha_min</span> <span class="pre">/</span> <span class="pre">alpha_max</span> <span class="pre">=</span> <span class="pre">1e-3``.\n\n</span>&#160;&#160;&#160; <span class="pre">n_alphas</span> <span class="pre">:</span> <span class="pre">int,</span> <span class="pre">default=100\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Number</span> <span class="pre">of</span> <span class="pre">alphas</span> <span class="pre">along</span> <span class="pre">the</span> <span class="pre">regularization</span> <span class="pre">path,</span> <span class="pre">used</span> <span class="pre">for</span> <span class="pre">each</span> <span class="pre">l1_ratio.\n\n</span>&#160;&#160;&#160; <span class="pre">alphas</span> <span class="pre">:</span> <span class="pre">array-like,</span> <span class="pre">default=None\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">List</span> <span class="pre">of</span> <span class="pre">alphas</span> <span class="pre">where</span> <span class="pre">to</span> <span class="pre">compute</span> <span class="pre">the</span> <span class="pre">models.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">None</span> <span class="pre">alphas</span> <span class="pre">are</span> <span class="pre">set</span> <span class="pre">automatically.\n\n</span>&#160;&#160;&#160; <span class="pre">fit_intercept</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">default=True\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Whether</span> <span class="pre">to</span> <span class="pre">calculate</span> <span class="pre">the</span> <span class="pre">intercept</span> <span class="pre">for</span> <span class="pre">this</span> <span class="pre">model.</span> <span class="pre">If</span> <span class="pre">set\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">to</span> <span class="pre">false,</span> <span class="pre">no</span> <span class="pre">intercept</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">used</span> <span class="pre">in</span> <span class="pre">calculations\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(i.e.</span> <span class="pre">data</span> <span class="pre">is</span> <span class="pre">expected</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">centered).\n\n</span>&#160;&#160;&#160; <span class="pre">precompute</span> <span class="pre">:</span> <span class="pre">'auto',</span> <span class="pre">bool</span> <span class="pre">or</span> <span class="pre">array-like</span> <span class="pre">of</span> <span class="pre">shape</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(n_features,</span> <span class="pre">n_features),</span> <span class="pre">default='auto'\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Whether</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">a</span> <span class="pre">precomputed</span> <span class="pre">Gram</span> <span class="pre">matrix</span> <span class="pre">to</span> <span class="pre">speed</span> <span class="pre">up\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">calculations.</span> <span class="pre">If</span> <span class="pre">set</span> <span class="pre">to</span> <span class="pre">``'auto'``</span> <span class="pre">let</span> <span class="pre">us</span> <span class="pre">decide.</span> <span class="pre">The</span> <span class="pre">Gram\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">matrix</span> <span class="pre">can</span> <span class="pre">also</span> <span class="pre">be</span> <span class="pre">passed</span> <span class="pre">as</span> <span class="pre">argument.\n\n</span>&#160;&#160;&#160; <span class="pre">max_iter</span> <span class="pre">:</span> <span class="pre">int,</span> <span class="pre">default=1000\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">maximum</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">iterations.\n\n</span>&#160;&#160;&#160; <span class="pre">tol</span> <span class="pre">:</span> <span class="pre">float,</span> <span class="pre">default=1e-4\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">tolerance</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">optimization:</span> <span class="pre">if</span> <span class="pre">the</span> <span class="pre">updates</span> <span class="pre">are\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">smaller</span> <span class="pre">than</span> <span class="pre">``tol``,</span> <span class="pre">the</span> <span class="pre">optimization</span> <span class="pre">code</span> <span class="pre">checks</span> <span class="pre">the\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">dual</span> <span class="pre">gap</span> <span class="pre">for</span> <span class="pre">optimality</span> <span class="pre">and</span> <span class="pre">continues</span> <span class="pre">until</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">smaller\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">than</span> <span class="pre">``tol``.\n\n</span>&#160;&#160;&#160; <span class="pre">cv</span> <span class="pre">:</span> <span class="pre">int,</span> <span class="pre">cross-validation</span> <span class="pre">generator</span> <span class="pre">or</span> <span class="pre">iterable,</span> <span class="pre">default=None\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Determines</span> <span class="pre">the</span> <span class="pre">cross-validation</span> <span class="pre">splitting</span> <span class="pre">strategy.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Possible</span> <span class="pre">inputs</span> <span class="pre">for</span> <span class="pre">cv</span> <span class="pre">are:\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">None,</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">the</span> <span class="pre">default</span> <span class="pre">5-fold</span> <span class="pre">cross-validation,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">int,</span> <span class="pre">to</span> <span class="pre">specify</span> <span class="pre">the</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">folds.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">:term:`CV</span> <span class="pre">splitter`,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">An</span> <span class="pre">iterable</span> <span class="pre">yielding</span> <span class="pre">(train,</span> <span class="pre">test)</span> <span class="pre">splits</span> <span class="pre">as</span> <span class="pre">arrays</span> <span class="pre">of</span> <span class="pre">indices.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">For</span> <span class="pre">int/None</span> <span class="pre">inputs,</span> <span class="pre">:class:`~sklearn.model_selection.KFold`</span> <span class="pre">is</span> <span class="pre">used.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Refer</span> <span class="pre">:ref:`User</span> <span class="pre">Guide</span> <span class="pre">&lt;cross_validation&gt;`</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">various\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">cross-validation</span> <span class="pre">strategies</span> <span class="pre">that</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">used</span> <span class="pre">here.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionchanged::</span> <span class="pre">0.22\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">``cv``</span> <span class="pre">default</span> <span class="pre">value</span> <span class="pre">if</span> <span class="pre">None</span> <span class="pre">changed</span> <span class="pre">from</span> <span class="pre">3-fold</span> <span class="pre">to</span> <span class="pre">5-fold.\n\n</span>&#160;&#160;&#160; <span class="pre">copy_X</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">default=True\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">``True``,</span> <span class="pre">X</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">copied;</span> <span class="pre">else,</span> <span class="pre">it</span> <span class="pre">may</span> <span class="pre">be</span> <span class="pre">overwritten.\n\n</span>&#160;&#160;&#160; <span class="pre">verbose</span> <span class="pre">:</span> <span class="pre">bool</span> <span class="pre">or</span> <span class="pre">int,</span> <span class="pre">default=0\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Amount</span> <span class="pre">of</span> <span class="pre">verbosity.\n\n</span>&#160;&#160;&#160; <span class="pre">n_jobs</span> <span class="pre">:</span> <span class="pre">int,</span> <span class="pre">default=None\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Number</span> <span class="pre">of</span> <span class="pre">CPUs</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">during</span> <span class="pre">the</span> <span class="pre">cross</span> <span class="pre">validation.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">``None``</span> <span class="pre">means</span> <span class="pre">1</span> <span class="pre">unless</span> <span class="pre">in</span> <span class="pre">a</span> <span class="pre">:obj:`joblib.parallel_backend`</span> <span class="pre">context.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">``-1``</span> <span class="pre">means</span> <span class="pre">using</span> <span class="pre">all</span> <span class="pre">processors.</span> <span class="pre">See</span> <span class="pre">:term:`Glossary</span> <span class="pre">&lt;n_jobs&gt;`\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">for</span> <span class="pre">more</span> <span class="pre">details.\n\n</span>&#160;&#160;&#160; <span class="pre">positive</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">default=False\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">When</span> <span class="pre">set</span> <span class="pre">to</span> <span class="pre">``True``,</span> <span class="pre">forces</span> <span class="pre">the</span> <span class="pre">coefficients</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">positive.\n\n</span>&#160;&#160;&#160; <span class="pre">random_state</span> <span class="pre">:</span> <span class="pre">int,</span> <span class="pre">RandomState</span> <span class="pre">instance,</span> <span class="pre">default=None\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">seed</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">pseudo</span> <span class="pre">random</span> <span class="pre">number</span> <span class="pre">generator</span> <span class="pre">that</span> <span class="pre">selects</span> <span class="pre">a</span> <span class="pre">random\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">feature</span> <span class="pre">to</span> <span class="pre">update.</span> <span class="pre">Used</span> <span class="pre">when</span> <span class="pre">``selection``</span> <span class="pre">==</span> <span class="pre">'random'.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Pass</span> <span class="pre">an</span> <span class="pre">int</span> <span class="pre">for</span> <span class="pre">reproducible</span> <span class="pre">output</span> <span class="pre">across</span> <span class="pre">multiple</span> <span class="pre">function</span> <span class="pre">calls.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">:term:`Glossary</span> <span class="pre">&lt;random_state&gt;`.\n\n</span>&#160;&#160;&#160; <span class="pre">selection</span> <span class="pre">:</span> <span class="pre">{'cyclic',</span> <span class="pre">'random'},</span> <span class="pre">default='cyclic'\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">set</span> <span class="pre">to</span> <span class="pre">'random',</span> <span class="pre">a</span> <span class="pre">random</span> <span class="pre">coefficient</span> <span class="pre">is</span> <span class="pre">updated</span> <span class="pre">every</span> <span class="pre">iteration\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">rather</span> <span class="pre">than</span> <span class="pre">looping</span> <span class="pre">over</span> <span class="pre">features</span> <span class="pre">sequentially</span> <span class="pre">by</span> <span class="pre">default.</span> <span class="pre">This\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(setting</span> <span class="pre">to</span> <span class="pre">'random')</span> <span class="pre">often</span> <span class="pre">leads</span> <span class="pre">to</span> <span class="pre">significantly</span> <span class="pre">faster</span> <span class="pre">convergence\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">especially</span> <span class="pre">when</span> <span class="pre">tol</span> <span class="pre">is</span> <span class="pre">higher</span> <span class="pre">than</span> <span class="pre">1e-4.\n\n</span>&#160;&#160;&#160; <span class="pre">Attributes\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">alpha_</span> <span class="pre">:</span> <span class="pre">float\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">amount</span> <span class="pre">of</span> <span class="pre">penalization</span> <span class="pre">chosen</span> <span class="pre">by</span> <span class="pre">cross</span> <span class="pre">validation.\n\n</span>&#160;&#160;&#160; <span class="pre">l1_ratio_</span> <span class="pre">:</span> <span class="pre">float\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">compromise</span> <span class="pre">between</span> <span class="pre">l1</span> <span class="pre">and</span> <span class="pre">l2</span> <span class="pre">penalization</span> <span class="pre">chosen</span> <span class="pre">by\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">cross</span> <span class="pre">validation.\n\n</span>&#160;&#160;&#160; <span class="pre">coef_</span> <span class="pre">:</span> <span class="pre">ndarray</span> <span class="pre">of</span> <span class="pre">shape</span> <span class="pre">(n_features,)</span> <span class="pre">or</span> <span class="pre">(n_targets,</span> <span class="pre">n_features)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Parameter</span> <span class="pre">vector</span> <span class="pre">(w</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">cost</span> <span class="pre">function</span> <span class="pre">formula).\n\n</span>&#160;&#160;&#160; <span class="pre">intercept_</span> <span class="pre">:</span> <span class="pre">float</span> <span class="pre">or</span> <span class="pre">ndarray</span> <span class="pre">of</span> <span class="pre">shape</span> <span class="pre">(n_targets,</span> <span class="pre">n_features)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Independent</span> <span class="pre">term</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">decision</span> <span class="pre">function.\n\n</span>&#160;&#160;&#160; <span class="pre">mse_path_</span> <span class="pre">:</span> <span class="pre">ndarray</span> <span class="pre">of</span> <span class="pre">shape</span> <span class="pre">(n_l1_ratio,</span> <span class="pre">n_alpha,</span> <span class="pre">n_folds)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Mean</span> <span class="pre">square</span> <span class="pre">error</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">test</span> <span class="pre">set</span> <span class="pre">on</span> <span class="pre">each</span> <span class="pre">fold,</span> <span class="pre">varying</span> <span class="pre">l1_ratio</span> <span class="pre">and\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">alpha.\n\n</span>&#160;&#160;&#160; <span class="pre">alphas_</span> <span class="pre">:</span> <span class="pre">ndarray</span> <span class="pre">of</span> <span class="pre">shape</span> <span class="pre">(n_alphas,)</span> <span class="pre">or</span> <span class="pre">(n_l1_ratio,</span> <span class="pre">n_alphas)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">grid</span> <span class="pre">of</span> <span class="pre">alphas</span> <span class="pre">used</span> <span class="pre">for</span> <span class="pre">fitting,</span> <span class="pre">for</span> <span class="pre">each</span> <span class="pre">l1_ratio.\n\n</span>&#160;&#160;&#160; <span class="pre">dual_gap_</span> <span class="pre">:</span> <span class="pre">float\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">dual</span> <span class="pre">gaps</span> <span class="pre">at</span> <span class="pre">the</span> <span class="pre">end</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">optimization</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">optimal</span> <span class="pre">alpha.\n\n</span>&#160;&#160;&#160; <span class="pre">n_iter_</span> <span class="pre">:</span> <span class="pre">int\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Number</span> <span class="pre">of</span> <span class="pre">iterations</span> <span class="pre">run</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">coordinate</span> <span class="pre">descent</span> <span class="pre">solver</span> <span class="pre">to</span> <span class="pre">reach\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">the</span> <span class="pre">specified</span> <span class="pre">tolerance</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">optimal</span> <span class="pre">alpha.\n\n</span>&#160;&#160;&#160; <span class="pre">n_features_in_</span> <span class="pre">:</span> <span class="pre">int\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Number</span> <span class="pre">of</span> <span class="pre">features</span> <span class="pre">seen</span> <span class="pre">during</span> <span class="pre">:term:`fit`.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">0.24\n\n</span>&#160;&#160;&#160; <span class="pre">feature_names_in_</span> <span class="pre">:</span> <span class="pre">ndarray</span> <span class="pre">of</span> <span class="pre">shape</span> <span class="pre">(`n_features_in_`,)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Names</span> <span class="pre">of</span> <span class="pre">features</span> <span class="pre">seen</span> <span class="pre">during</span> <span class="pre">:term:`fit`.</span> <span class="pre">Defined</span> <span class="pre">only</span> <span class="pre">when</span> <span class="pre">`X`\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">has</span> <span class="pre">feature</span> <span class="pre">names</span> <span class="pre">that</span> <span class="pre">are</span> <span class="pre">all</span> <span class="pre">strings.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">1.0\n\n</span>&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">Also\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">enet_path</span> <span class="pre">:</span> <span class="pre">Compute</span> <span class="pre">elastic</span> <span class="pre">net</span> <span class="pre">path</span> <span class="pre">with</span> <span class="pre">coordinate</span> <span class="pre">descent.\n</span>&#160;&#160;&#160; <span class="pre">ElasticNet</span> <span class="pre">:</span> <span class="pre">Linear</span> <span class="pre">regression</span> <span class="pre">with</span> <span class="pre">combined</span> <span class="pre">L1</span> <span class="pre">and</span> <span class="pre">L2</span> <span class="pre">priors</span> <span class="pre">as</span> <span class="pre">regularizer.\n\n</span>&#160;&#160;&#160; <span class="pre">Notes\n</span>&#160;&#160;&#160; <span class="pre">-----\n</span>&#160;&#160;&#160; <span class="pre">In</span> <span class="pre">`fit`,</span> <span class="pre">once</span> <span class="pre">the</span> <span class="pre">best</span> <span class="pre">parameters</span> <span class="pre">`l1_ratio`</span> <span class="pre">and</span> <span class="pre">`alpha`</span> <span class="pre">are</span> <span class="pre">found</span> <span class="pre">through\n</span>&#160;&#160;&#160; <span class="pre">cross-validation,</span> <span class="pre">the</span> <span class="pre">model</span> <span class="pre">is</span> <span class="pre">fit</span> <span class="pre">again</span> <span class="pre">using</span> <span class="pre">the</span> <span class="pre">entire</span> <span class="pre">training</span> <span class="pre">set.\n\n</span>&#160;&#160;&#160; <span class="pre">To</span> <span class="pre">avoid</span> <span class="pre">unnecessary</span> <span class="pre">memory</span> <span class="pre">duplication</span> <span class="pre">the</span> <span class="pre">`X`</span> <span class="pre">argument</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">`fit`\n</span>&#160;&#160;&#160; <span class="pre">method</span> <span class="pre">should</span> <span class="pre">be</span> <span class="pre">directly</span> <span class="pre">passed</span> <span class="pre">as</span> <span class="pre">a</span> <span class="pre">Fortran-contiguous</span> <span class="pre">numpy</span> <span class="pre">array.\n\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">parameter</span> <span class="pre">`l1_ratio`</span> <span class="pre">corresponds</span> <span class="pre">to</span> <span class="pre">alpha</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">glmnet</span> <span class="pre">R</span> <span class="pre">package\n</span>&#160;&#160;&#160; <span class="pre">while</span> <span class="pre">alpha</span> <span class="pre">corresponds</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">lambda</span> <span class="pre">parameter</span> <span class="pre">in</span> <span class="pre">glmnet.\n</span>&#160;&#160;&#160; <span class="pre">More</span> <span class="pre">specifically,</span> <span class="pre">the</span> <span class="pre">optimization</span> <span class="pre">objective</span> <span class="pre">is::\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1</span> <span class="pre">/</span> <span class="pre">(2</span> <span class="pre">*</span> <span class="pre">n_samples)</span> <span class="pre">*</span> <span class="pre">||y</span> <span class="pre">-</span> <span class="pre">Xw||^2_2\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">+</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">l1_ratio</span> <span class="pre">*</span> <span class="pre">||w||_1\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">+</span> <span class="pre">0.5</span> <span class="pre">*</span> <span class="pre">alpha</span> <span class="pre">*</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">l1_ratio)</span> <span class="pre">*</span> <span class="pre">||w||^2_2\n\n</span>&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">you</span> <span class="pre">are</span> <span class="pre">interested</span> <span class="pre">in</span> <span class="pre">controlling</span> <span class="pre">the</span> <span class="pre">L1</span> <span class="pre">and</span> <span class="pre">L2</span> <span class="pre">penalty\n</span>&#160;&#160;&#160; <span class="pre">separately,</span> <span class="pre">keep</span> <span class="pre">in</span> <span class="pre">mind</span> <span class="pre">that</span> <span class="pre">this</span> <span class="pre">is</span> <span class="pre">equivalent</span> <span class="pre">to::\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">a</span> <span class="pre">*</span> <span class="pre">L1</span> <span class="pre">+</span> <span class="pre">b</span> <span class="pre">*</span> <span class="pre">L2\n\n</span>&#160;&#160;&#160; <span class="pre">for::\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">alpha</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span> <span class="pre">and</span> <span class="pre">l1_ratio</span> <span class="pre">=</span> <span class="pre">a</span> <span class="pre">/</span> <span class="pre">(a</span> <span class="pre">+</span> <span class="pre">b).\n\n</span>&#160;&#160;&#160; <span class="pre">For</span> <span class="pre">an</span> <span class="pre">example,</span> <span class="pre">see\n</span>&#160;&#160;&#160; <span class="pre">:ref:`examples/linear_model/plot_lasso_model_selection.py\n</span>&#160;&#160;&#160; <span class="pre">&lt;sphx_glr_auto_examples_linear_model_plot_lasso_model_selection.py&gt;`.\n\n</span>&#160;&#160;&#160; <span class="pre">Examples\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">from</span> <span class="pre">sklearn.linear_model</span> <span class="pre">import</span> <span class="pre">ElasticNetCV\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">from</span> <span class="pre">sklearn.datasets</span> <span class="pre">import</span> <span class="pre">make_regression\n\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">X,</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">make_regression(n_features=2,</span> <span class="pre">random_state=0)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">regr</span> <span class="pre">=</span> <span class="pre">ElasticNetCV(cv=5,</span> <span class="pre">random_state=0)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">regr.fit(X,</span> <span class="pre">y)\n</span>&#160;&#160;&#160; <span class="pre">ElasticNetCV(cv=5,</span> <span class="pre">random_state=0)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">print(regr.alpha_)\n</span>&#160;&#160;&#160; <span class="pre">0.199...\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">print(regr.intercept_)\n</span>&#160;&#160;&#160; <span class="pre">0.398...\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">print(regr.predict([[0,</span> <span class="pre">0]]))\n</span>&#160;&#160;&#160; <span class="pre">[0.398...]\n</span>&#160;&#160;&#160; <span class="pre">&quot;</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.ElasticNetCV.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.ElasticNetCV.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_alphas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy_X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cyclic'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/linear_model/_coordinate_descent.html#ElasticNetCV.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.ElasticNetCV.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.ElasticNetCV.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sklearn.linear_model._coordinate_descent'</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.ElasticNetCV.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.ElasticNetCV._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.ElasticNetCV._abc_impl" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.ElasticNetCV._get_estimator">
<span class="sig-name descname"><span class="pre">_get_estimator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/linear_model/_coordinate_descent.html#ElasticNetCV._get_estimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.ElasticNetCV._get_estimator" title="Link to this definition">¶</a></dt>
<dd><p>Model to be fitted after the best alpha has been determined.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.ElasticNetCV._is_multitask">
<span class="sig-name descname"><span class="pre">_is_multitask</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/linear_model/_coordinate_descent.html#ElasticNetCV._is_multitask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.ElasticNetCV._is_multitask" title="Link to this definition">¶</a></dt>
<dd><p>Bool indicating if class is meant for multidimensional target.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.ElasticNetCV._more_tags">
<span class="sig-name descname"><span class="pre">_more_tags</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/linear_model/_coordinate_descent.html#ElasticNetCV._more_tags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.ElasticNetCV._more_tags" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.ElasticNetCV._parameter_constraints">
<span class="sig-name descname"><span class="pre">_parameter_constraints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'alphas':</span> <span class="pre">['array-like',</span> <span class="pre">None],</span> <span class="pre">'copy_X':</span> <span class="pre">['boolean'],</span> <span class="pre">'cv':</span> <span class="pre">['cv_object'],</span> <span class="pre">'eps':</span> <span class="pre">[&lt;sklearn.utils._param_validation.Interval</span> <span class="pre">object&gt;],</span> <span class="pre">'fit_intercept':</span> <span class="pre">['boolean'],</span> <span class="pre">'l1_ratio':</span> <span class="pre">[&lt;sklearn.utils._param_validation.Interval</span> <span class="pre">object&gt;,</span> <span class="pre">'array-like'],</span> <span class="pre">'max_iter':</span> <span class="pre">[&lt;sklearn.utils._param_validation.Interval</span> <span class="pre">object&gt;],</span> <span class="pre">'n_alphas':</span> <span class="pre">[&lt;sklearn.utils._param_validation.Interval</span> <span class="pre">object&gt;],</span> <span class="pre">'n_jobs':</span> <span class="pre">[&lt;class</span> <span class="pre">'numbers.Integral'&gt;,</span> <span class="pre">None],</span> <span class="pre">'positive':</span> <span class="pre">['boolean'],</span> <span class="pre">'precompute':</span> <span class="pre">[&lt;sklearn.utils._param_validation.StrOptions</span> <span class="pre">object&gt;,</span> <span class="pre">'array-like',</span> <span class="pre">'boolean'],</span> <span class="pre">'random_state':</span> <span class="pre">['random_state'],</span> <span class="pre">'selection':</span> <span class="pre">[&lt;sklearn.utils._param_validation.StrOptions</span> <span class="pre">object&gt;],</span> <span class="pre">'tol':</span> <span class="pre">[&lt;sklearn.utils._param_validation.Interval</span> <span class="pre">object&gt;],</span> <span class="pre">'verbose':</span> <span class="pre">['verbose']}</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.ElasticNetCV._parameter_constraints" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.ElasticNetCV.path">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_alphas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precompute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy_X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_n_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_input</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vtools.functions.neighbor_fill.ElasticNetCV.path" title="Link to this definition">¶</a></dt>
<dd><p>Compute elastic net path with coordinate descent.</p>
<p>The elastic net optimization function varies for mono and multi-outputs.</p>
<p>For mono-output tasks it is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">)</span> <span class="o">*</span> <span class="o">||</span><span class="n">y</span> <span class="o">-</span> <span class="n">Xw</span><span class="o">||^</span><span class="mi">2_2</span>
<span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">l1_ratio</span> <span class="o">*</span> <span class="o">||</span><span class="n">w</span><span class="o">||</span><span class="n">_1</span>
<span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">l1_ratio</span><span class="p">)</span> <span class="o">*</span> <span class="o">||</span><span class="n">w</span><span class="o">||^</span><span class="mi">2_2</span>
</pre></div>
</div>
<p>For multi-output tasks it is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">))</span> <span class="o">*</span> <span class="o">||</span><span class="n">Y</span> <span class="o">-</span> <span class="n">XW</span><span class="o">||</span><span class="n">_Fro</span><span class="o">^</span><span class="mi">2</span>
<span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">l1_ratio</span> <span class="o">*</span> <span class="o">||</span><span class="n">W</span><span class="o">||</span><span class="n">_21</span>
<span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">l1_ratio</span><span class="p">)</span> <span class="o">*</span> <span class="o">||</span><span class="n">W</span><span class="o">||</span><span class="n">_Fro</span><span class="o">^</span><span class="mi">2</span>
</pre></div>
</div>
<p>Where:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">||</span><span class="n">W</span><span class="o">||</span><span class="n">_21</span> <span class="o">=</span> \<span class="n">sum_i</span> \<span class="n">sqrt</span><span class="p">{</span>\<span class="n">sum_j</span> <span class="n">w_</span><span class="p">{</span><span class="n">ij</span><span class="p">}</span><span class="o">^</span><span class="mi">2</span><span class="p">}</span>
</pre></div>
</div>
<p>i.e. the sum of norm of each row.</p>
<p>Read more in the <span class="xref std std-ref">User Guide</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">{array-like, sparse matrix} of shape (n_samples, n_features)</span></dt><dd><p>Training data. Pass directly as Fortran-contiguous data to avoid
unnecessary memory duplication. If <code class="docutils literal notranslate"><span class="pre">y</span></code> is mono-output then <code class="docutils literal notranslate"><span class="pre">X</span></code>
can be sparse.</p>
</dd>
<dt><strong>y</strong><span class="classifier">{array-like, sparse matrix} of shape (n_samples,) or         (n_samples, n_targets)</span></dt><dd><p>Target values.</p>
</dd>
<dt><strong>l1_ratio</strong><span class="classifier">float, default=0.5</span></dt><dd><p>Number between 0 and 1 passed to elastic net (scaling between
l1 and l2 penalties). <code class="docutils literal notranslate"><span class="pre">l1_ratio=1</span></code> corresponds to the Lasso.</p>
</dd>
<dt><strong>eps</strong><span class="classifier">float, default=1e-3</span></dt><dd><p>Length of the path. <code class="docutils literal notranslate"><span class="pre">eps=1e-3</span></code> means that
<code class="docutils literal notranslate"><span class="pre">alpha_min</span> <span class="pre">/</span> <span class="pre">alpha_max</span> <span class="pre">=</span> <span class="pre">1e-3</span></code>.</p>
</dd>
<dt><strong>n_alphas</strong><span class="classifier">int, default=100</span></dt><dd><p>Number of alphas along the regularization path.</p>
</dd>
<dt><strong>alphas</strong><span class="classifier">array-like, default=None</span></dt><dd><p>List of alphas where to compute the models.
If None alphas are set automatically.</p>
</dd>
<dt><strong>precompute</strong><span class="classifier">‘auto’, bool or array-like of shape             (n_features, n_features), default=’auto’</span></dt><dd><p>Whether to use a precomputed Gram matrix to speed up
calculations. If set to <code class="docutils literal notranslate"><span class="pre">'auto'</span></code> let us decide. The Gram
matrix can also be passed as argument.</p>
</dd>
<dt><strong>Xy</strong><span class="classifier">array-like of shape (n_features,) or (n_features, n_targets),         default=None</span></dt><dd><p>Xy = np.dot(X.T, y) that can be precomputed. It is useful
only when the Gram matrix is precomputed.</p>
</dd>
<dt><strong>copy_X</strong><span class="classifier">bool, default=True</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, X will be copied; else, it may be overwritten.</p>
</dd>
<dt><strong>coef_init</strong><span class="classifier">array-like of shape (n_features, ), default=None</span></dt><dd><p>The initial values of the coefficients.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool or int, default=False</span></dt><dd><p>Amount of verbosity.</p>
</dd>
<dt><strong>return_n_iter</strong><span class="classifier">bool, default=False</span></dt><dd><p>Whether to return the number of iterations or not.</p>
</dd>
<dt><strong>positive</strong><span class="classifier">bool, default=False</span></dt><dd><p>If set to True, forces coefficients to be positive.
(Only allowed when <code class="docutils literal notranslate"><span class="pre">y.ndim</span> <span class="pre">==</span> <span class="pre">1</span></code>).</p>
</dd>
<dt><strong>check_input</strong><span class="classifier">bool, default=True</span></dt><dd><p>If set to False, the input validation checks are skipped (including the
Gram matrix when provided). It is assumed that they are handled
by the caller.</p>
</dd>
<dt><strong>**params</strong><span class="classifier">kwargs</span></dt><dd><p>Keyword arguments passed to the coordinate descent solver.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>alphas</strong><span class="classifier">ndarray of shape (n_alphas,)</span></dt><dd><p>The alphas along the path where models are computed.</p>
</dd>
<dt><strong>coefs</strong><span class="classifier">ndarray of shape (n_features, n_alphas) or             (n_targets, n_features, n_alphas)</span></dt><dd><p>Coefficients along the path.</p>
</dd>
<dt><strong>dual_gaps</strong><span class="classifier">ndarray of shape (n_alphas,)</span></dt><dd><p>The dual gaps at the end of the optimization for each alpha.</p>
</dd>
<dt><strong>n_iters</strong><span class="classifier">list of int</span></dt><dd><p>The number of iterations taken by the coordinate descent optimizer to
reach the specified tolerance for each alpha.
(Is returned when <code class="docutils literal notranslate"><span class="pre">return_n_iter</span></code> is set to True).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultiTaskElasticNet</span></code></dt><dd><p>Multi-task ElasticNet model trained with L1/L2 mixed-norm     as regularizer.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">MultiTaskElasticNetCV</span></code></dt><dd><p>Multi-task L1/L2 ElasticNet with built-in cross-validation.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">ElasticNet</span></code></dt><dd><p>Linear regression with combined L1 and L2 priors as regularizer.</p>
</dd>
<dt><a class="reference internal" href="#vtools.functions.neighbor_fill.ElasticNetCV" title="vtools.functions.neighbor_fill.ElasticNetCV"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ElasticNetCV</span></code></a></dt><dd><p>Elastic Net model with iterative fitting along a regularization path.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>For an example, see
<span class="xref std std-ref">examples/linear_model/plot_lasso_coordinate_descent_path.py</span>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.ElasticNetCV.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#vtools.functions.neighbor_fill.ElasticNetCV" title="sklearn.linear_model._coordinate_descent.ElasticNetCV"><span class="pre">ElasticNetCV</span></a></span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.ElasticNetCV.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Request metadata passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant if
<code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code>).
Please see <span class="xref std std-ref">User Guide</span> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3.</span></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only relevant if this estimator is used as a
sub-estimator of a meta-estimator, e.g. used inside a
<a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline" title="sklearn.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>. Otherwise it has no effect.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sample_weight</strong><span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>self</strong><span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.ElasticNetCV.set_score_request">
<span class="sig-name descname"><span class="pre">set_score_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#vtools.functions.neighbor_fill.ElasticNetCV" title="sklearn.linear_model._coordinate_descent.ElasticNetCV"><span class="pre">ElasticNetCV</span></a></span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.ElasticNetCV.set_score_request" title="Link to this definition">¶</a></dt>
<dd><p>Request metadata passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p>
<p>Note that this method is only relevant if
<code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code>).
Please see <span class="xref std std-ref">User Guide</span> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">score</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3.</span></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only relevant if this estimator is used as a
sub-estimator of a meta-estimator, e.g. used inside a
<a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline" title="sklearn.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>. Otherwise it has no effect.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sample_weight</strong><span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>self</strong><span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FillResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filled</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">yhat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi_lower</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi_upper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#FillResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Container for gap-filling outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filled</strong><span class="classifier">pd.Series</span></dt><dd><p>Target series with gaps filled where possible.</p>
</dd>
<dt><strong>yhat</strong><span class="classifier">pd.Series</span></dt><dd><p>Model predictions aligned to the union index used for fitting/prediction.</p>
</dd>
<dt><strong>pi_lower, pi_upper</strong><span class="classifier">Optional[pd.Series]</span></dt><dd><p>Prediction interval bounds where available; otherwise <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt><strong>model_info</strong><span class="classifier">dict</span></dt><dd><p>Method, parameters, chosen lags, training window, etc.</p>
</dd>
<dt><strong>metrics</strong><span class="classifier">dict</span></dt><dd><p>Holdout scores (MAE/RMSE/R^2) using forward-chaining CV where configured.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>to_dict</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.__annotations__">
<span class="sig-name descname"><span class="pre">__annotations__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'filled':</span> <span class="pre">'pd.Series',</span> <span class="pre">'metrics':</span> <span class="pre">'Dict[str,</span> <span class="pre">float]',</span> <span class="pre">'model_info':</span> <span class="pre">'Dict[str,</span> <span class="pre">Any]',</span> <span class="pre">'pi_lower':</span> <span class="pre">'Optional[pd.Series]',</span> <span class="pre">'pi_upper':</span> <span class="pre">'Optional[pd.Series]',</span> <span class="pre">'yhat':</span> <span class="pre">'pd.Series'}</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.__annotations__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.__dataclass_fields__">
<span class="sig-name descname"><span class="pre">__dataclass_fields__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'filled':</span> <span class="pre">Field(name='filled',type='pd.Series',default=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'metrics':</span> <span class="pre">Field(name='metrics',type='Dict[str,</span> <span class="pre">float]',default=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'model_info':</span> <span class="pre">Field(name='model_info',type='Dict[str,</span> <span class="pre">Any]',default=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'pi_lower':</span> <span class="pre">Field(name='pi_lower',type='Optional[pd.Series]',default=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'pi_upper':</span> <span class="pre">Field(name='pi_upper',type='Optional[pd.Series]',default=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'yhat':</span> <span class="pre">Field(name='yhat',type='pd.Series',default=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD)}</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.__dataclass_fields__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.__dataclass_params__">
<span class="sig-name descname"><span class="pre">__dataclass_params__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">_DataclassParams(init=True,repr=True,eq=True,order=False,unsafe_hash=False,frozen=False)</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.__dataclass_params__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.__dict__">
<span class="sig-name descname"><span class="pre">__dict__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">mappingproxy({'__module__':</span> <span class="pre">'vtools.functions.neighbor_fill',</span> <span class="pre">'__annotations__':</span> <span class="pre">{'filled':</span> <span class="pre">'pd.Series',</span> <span class="pre">'yhat':</span> <span class="pre">'pd.Series',</span> <span class="pre">'pi_lower':</span> <span class="pre">'Optional[pd.Series]',</span> <span class="pre">'pi_upper':</span> <span class="pre">'Optional[pd.Series]',</span> <span class="pre">'model_info':</span> <span class="pre">'Dict[str,</span> <span class="pre">Any]',</span> <span class="pre">'metrics':</span> <span class="pre">'Dict[str,</span> <span class="pre">float]'},</span> <span class="pre">'__doc__':</span> <span class="pre">'Container</span> <span class="pre">for</span> <span class="pre">gap-filling</span> <span class="pre">outputs.\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">filled</span> <span class="pre">:</span> <span class="pre">pd.Series\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Target</span> <span class="pre">series</span> <span class="pre">with</span> <span class="pre">gaps</span> <span class="pre">filled</span> <span class="pre">where</span> <span class="pre">possible.\n\n</span>&#160;&#160;&#160; <span class="pre">yhat</span> <span class="pre">:</span> <span class="pre">pd.Series\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Model</span> <span class="pre">predictions</span> <span class="pre">aligned</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">union</span> <span class="pre">index</span> <span class="pre">used</span> <span class="pre">for</span> <span class="pre">fitting/prediction.\n\n</span>&#160;&#160;&#160; <span class="pre">pi_lower,</span> <span class="pre">pi_upper</span> <span class="pre">:</span> <span class="pre">Optional[pd.Series]\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Prediction</span> <span class="pre">interval</span> <span class="pre">bounds</span> <span class="pre">where</span> <span class="pre">available;</span> <span class="pre">otherwise</span> <span class="pre">``None``.\n\n</span>&#160;&#160;&#160; <span class="pre">model_info</span> <span class="pre">:</span> <span class="pre">dict\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Method,</span> <span class="pre">parameters,</span> <span class="pre">chosen</span> <span class="pre">lags,</span> <span class="pre">training</span> <span class="pre">window,</span> <span class="pre">etc.\n\n</span>&#160;&#160;&#160; <span class="pre">metrics</span> <span class="pre">:</span> <span class="pre">dict\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Holdout</span> <span class="pre">scores</span> <span class="pre">(MAE/RMSE/R^2)</span> <span class="pre">using</span> <span class="pre">forward-chaining</span> <span class="pre">CV</span> <span class="pre">where</span> <span class="pre">configured.\n</span>&#160;&#160;&#160; <span class="pre">',</span> <span class="pre">'to_dict':</span> <span class="pre">&lt;function</span> <span class="pre">FillResult.to_dict&gt;,</span> <span class="pre">'__dict__':</span> <span class="pre">&lt;attribute</span> <span class="pre">'__dict__'</span> <span class="pre">of</span> <span class="pre">'FillResult'</span> <span class="pre">objects&gt;,</span> <span class="pre">'__weakref__':</span> <span class="pre">&lt;attribute</span> <span class="pre">'__weakref__'</span> <span class="pre">of</span> <span class="pre">'FillResult'</span> <span class="pre">objects&gt;,</span> <span class="pre">'__dataclass_params__':</span> <span class="pre">_DataclassParams(init=True,repr=True,eq=True,order=False,unsafe_hash=False,frozen=False),</span> <span class="pre">'__dataclass_fields__':</span> <span class="pre">{'filled':</span> <span class="pre">Field(name='filled',type='pd.Series',default=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'yhat':</span> <span class="pre">Field(name='yhat',type='pd.Series',default=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'pi_lower':</span> <span class="pre">Field(name='pi_lower',type='Optional[pd.Series]',default=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'pi_upper':</span> <span class="pre">Field(name='pi_upper',type='Optional[pd.Series]',default=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'model_info':</span> <span class="pre">Field(name='model_info',type='Dict[str,</span> <span class="pre">Any]',default=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'metrics':</span> <span class="pre">Field(name='metrics',type='Dict[str,</span> <span class="pre">float]',default=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD)},</span> <span class="pre">'__init__':</span> <span class="pre">&lt;function</span> <span class="pre">FillResult.__init__&gt;,</span> <span class="pre">'__repr__':</span> <span class="pre">&lt;function</span> <span class="pre">FillResult.__repr__&gt;,</span> <span class="pre">'__eq__':</span> <span class="pre">&lt;function</span> <span class="pre">FillResult.__eq__&gt;,</span> <span class="pre">'__hash__':</span> <span class="pre">None,</span> <span class="pre">'__match_args__':</span> <span class="pre">('filled',</span> <span class="pre">'yhat',</span> <span class="pre">'pi_lower',</span> <span class="pre">'pi_upper',</span> <span class="pre">'model_info',</span> <span class="pre">'metrics')})</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.__dict__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Container</span> <span class="pre">for</span> <span class="pre">gap-filling</span> <span class="pre">outputs.\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">filled</span> <span class="pre">:</span> <span class="pre">pd.Series\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Target</span> <span class="pre">series</span> <span class="pre">with</span> <span class="pre">gaps</span> <span class="pre">filled</span> <span class="pre">where</span> <span class="pre">possible.\n\n</span>&#160;&#160;&#160; <span class="pre">yhat</span> <span class="pre">:</span> <span class="pre">pd.Series\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Model</span> <span class="pre">predictions</span> <span class="pre">aligned</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">union</span> <span class="pre">index</span> <span class="pre">used</span> <span class="pre">for</span> <span class="pre">fitting/prediction.\n\n</span>&#160;&#160;&#160; <span class="pre">pi_lower,</span> <span class="pre">pi_upper</span> <span class="pre">:</span> <span class="pre">Optional[pd.Series]\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Prediction</span> <span class="pre">interval</span> <span class="pre">bounds</span> <span class="pre">where</span> <span class="pre">available;</span> <span class="pre">otherwise</span> <span class="pre">``None``.\n\n</span>&#160;&#160;&#160; <span class="pre">model_info</span> <span class="pre">:</span> <span class="pre">dict\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Method,</span> <span class="pre">parameters,</span> <span class="pre">chosen</span> <span class="pre">lags,</span> <span class="pre">training</span> <span class="pre">window,</span> <span class="pre">etc.\n\n</span>&#160;&#160;&#160; <span class="pre">metrics</span> <span class="pre">:</span> <span class="pre">dict\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Holdout</span> <span class="pre">scores</span> <span class="pre">(MAE/RMSE/R^2)</span> <span class="pre">using</span> <span class="pre">forward-chaining</span> <span class="pre">CV</span> <span class="pre">where</span> <span class="pre">configured.\n</span>&#160;&#160;&#160; <span class="pre">'</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.__eq__" title="Link to this definition">¶</a></dt>
<dd><p>Return self==value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.__hash__">
<span class="sig-name descname"><span class="pre">__hash__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.__hash__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filled</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">yhat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi_lower</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pi_upper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.__match_args__">
<span class="sig-name descname"><span class="pre">__match_args__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('filled',</span> <span class="pre">'yhat',</span> <span class="pre">'pi_lower',</span> <span class="pre">'pi_upper',</span> <span class="pre">'model_info',</span> <span class="pre">'metrics')</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.__match_args__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'vtools.functions.neighbor_fill'</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.__repr__" title="Link to this definition">¶</a></dt>
<dd><p>Return repr(self).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.__weakref__" title="Link to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.filled">
<span class="sig-name descname"><span class="pre">filled</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></em><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.filled" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.metrics">
<span class="sig-name descname"><span class="pre">metrics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.metrics" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.model_info">
<span class="sig-name descname"><span class="pre">model_info</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.model_info" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.pi_lower">
<span class="sig-name descname"><span class="pre">pi_lower</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.pi_lower" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.pi_upper">
<span class="sig-name descname"><span class="pre">pi_upper</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.pi_upper" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#FillResult.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.to_dict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.FillResult.yhat">
<span class="sig-name descname"><span class="pre">yhat</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></em><a class="headerlink" href="#vtools.functions.neighbor_fill.FillResult.yhat" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.HuberT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">HuberT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.345</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/norms.html#HuberT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.HuberT" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">RobustNorm</span></code></p>
<p>Huber’s T for M estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t</strong><span class="classifier">float, optional</span></dt><dd><p>The tuning constant for Huber’s t function. The default value is
1.345.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">statsmodels.robust.norms.RobustNorm</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(z)</p></td>
<td><p>Returns the value of estimator rho applied to an input</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.HuberT.psi" title="vtools.functions.neighbor_fill.HuberT.psi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psi</span></code></a>(z)</p></td>
<td><p>The psi function for Huber's t estimator</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.HuberT.psi_deriv" title="vtools.functions.neighbor_fill.HuberT.psi_deriv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psi_deriv</span></code></a>(z)</p></td>
<td><p>The derivative of Huber's t psi function</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.HuberT.rho" title="vtools.functions.neighbor_fill.HuberT.rho"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rho</span></code></a>(z)</p></td>
<td><p>The robust criterion function for Huber's t.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.HuberT.weights" title="vtools.functions.neighbor_fill.HuberT.weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">weights</span></code></a>(z)</p></td>
<td><p>Huber's t weighting function for the IRLS algorithm</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.HuberT.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&quot;\n</span>&#160;&#160;&#160; <span class="pre">Huber's</span> <span class="pre">T</span> <span class="pre">for</span> <span class="pre">M</span> <span class="pre">estimation.\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">t</span> <span class="pre">:</span> <span class="pre">float,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">tuning</span> <span class="pre">constant</span> <span class="pre">for</span> <span class="pre">Huber's</span> <span class="pre">t</span> <span class="pre">function.</span> <span class="pre">The</span> <span class="pre">default</span> <span class="pre">value</span> <span class="pre">is\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1.345.\n\n</span>&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">Also\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">statsmodels.robust.norms.RobustNorm\n</span>&#160;&#160;&#160; <span class="pre">&quot;</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.HuberT.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.HuberT.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.345</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/norms.html#HuberT.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.HuberT.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.HuberT.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'statsmodels.robust.norms'</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.HuberT.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.HuberT._subset">
<span class="sig-name descname"><span class="pre">_subset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/norms.html#HuberT._subset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.HuberT._subset" title="Link to this definition">¶</a></dt>
<dd><p>Huber’s T is defined piecewise over the range for z</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.HuberT.psi">
<span class="sig-name descname"><span class="pre">psi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/norms.html#HuberT.psi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.HuberT.psi" title="Link to this definition">¶</a></dt>
<dd><p>The psi function for Huber’s t estimator</p>
<p>The analytic derivative of rho</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z</strong><span class="classifier">array_like</span></dt><dd><p>1d array</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>psi</strong><span class="classifier">ndarray</span></dt><dd><p>psi(z) = z      for |z| &lt;= t</p>
<p>psi(z) = sign(z)*t for |z| &gt; t</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.HuberT.psi_deriv">
<span class="sig-name descname"><span class="pre">psi_deriv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/norms.html#HuberT.psi_deriv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.HuberT.psi_deriv" title="Link to this definition">¶</a></dt>
<dd><p>The derivative of Huber’s t psi function</p>
<p class="rubric">Notes</p>
<p>Used to estimate the robust covariance matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.HuberT.rho">
<span class="sig-name descname"><span class="pre">rho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/norms.html#HuberT.rho"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.HuberT.rho" title="Link to this definition">¶</a></dt>
<dd><p>The robust criterion function for Huber’s t.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z</strong><span class="classifier">array_like</span></dt><dd><p>1d array</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>rho</strong><span class="classifier">ndarray</span></dt><dd><p>rho(z) = .5*z**2            for |z| &lt;= t</p>
<p>rho(z) = |z|*t - .5*t**2    for |z| &gt; t</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.HuberT.weights">
<span class="sig-name descname"><span class="pre">weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/norms.html#HuberT.weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.HuberT.weights" title="Link to this definition">¶</a></dt>
<dd><p>Huber’s t weighting function for the IRLS algorithm</p>
<p>The psi function scaled by z</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>z</strong><span class="classifier">array_like</span></dt><dd><p>1d array</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>weights</strong><span class="classifier">ndarray</span></dt><dd><p>weights(z) = 1          for |z| &lt;= t</p>
<p>weights(z) = t/|z|      for |z| &gt; t</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.KNeighborsRegressor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">KNeighborsRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minkowski'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/neighbors/_regression.html#KNeighborsRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.KNeighborsRegressor" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">KNeighborsMixin</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">RegressorMixin</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">NeighborsBase</span></code></p>
<p>Regression based on k-nearest neighbors.</p>
<p>The target is predicted by local interpolation of the targets
associated of the nearest neighbors in the training set.</p>
<p>Read more in the <span class="xref std std-ref">User Guide</span>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.</span></p>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>n_neighbors</strong><span class="classifier">int, default=5</span></dt><dd><p>Number of neighbors to use by default for <code class="xref py py-meth docutils literal notranslate"><span class="pre">kneighbors()</span></code> queries.</p>
</dd>
<dt><strong>weights</strong><span class="classifier">{‘uniform’, ‘distance’}, callable or None, default=’uniform’</span></dt><dd><p>Weight function used in prediction.  Possible values:</p>
<ul class="simple">
<li><p>‘uniform’ : uniform weights.  All points in each neighborhood
are weighted equally.</p></li>
<li><p>‘distance’ : weight points by the inverse of their distance.
in this case, closer neighbors of a query point will have a
greater influence than neighbors which are further away.</p></li>
<li><p>[callable] : a user-defined function which accepts an
array of distances, and returns an array of the same shape
containing the weights.</p></li>
</ul>
<p>Uniform weights are used by default.</p>
</dd>
<dt><strong>algorithm</strong><span class="classifier">{‘auto’, ‘ball_tree’, ‘kd_tree’, ‘brute’}, default=’auto’</span></dt><dd><p>Algorithm used to compute the nearest neighbors:</p>
<ul class="simple">
<li><p>‘ball_tree’ will use <code class="xref py py-class docutils literal notranslate"><span class="pre">BallTree</span></code></p></li>
<li><p>‘kd_tree’ will use <code class="xref py py-class docutils literal notranslate"><span class="pre">KDTree</span></code></p></li>
<li><p>‘brute’ will use a brute-force search.</p></li>
<li><p>‘auto’ will attempt to decide the most appropriate algorithm
based on the values passed to <a class="reference internal" href="#vtools.functions.neighbor_fill.KNeighborsRegressor.fit" title="vtools.functions.neighbor_fill.KNeighborsRegressor.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> method.</p></li>
</ul>
<p>Note: fitting on sparse input will override the setting of
this parameter, using brute force.</p>
</dd>
<dt><strong>leaf_size</strong><span class="classifier">int, default=30</span></dt><dd><p>Leaf size passed to BallTree or KDTree.  This can affect the
speed of the construction and query, as well as the memory
required to store the tree.  The optimal value depends on the
nature of the problem.</p>
</dd>
<dt><strong>p</strong><span class="classifier">float, default=2</span></dt><dd><p>Power parameter for the Minkowski metric. When p = 1, this is
equivalent to using manhattan_distance (l1), and euclidean_distance
(l2) for p = 2. For arbitrary p, minkowski_distance (l_p) is used.</p>
</dd>
<dt><strong>metric</strong><span class="classifier">str, DistanceMetric object or callable, default=’minkowski’</span></dt><dd><p>Metric to use for distance computation. Default is “minkowski”, which
results in the standard Euclidean distance when p = 2. See the
documentation of <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/spatial.distance.html">scipy.spatial.distance</a> and
the metrics listed in
<code class="xref py py-class docutils literal notranslate"><span class="pre">distance_metrics</span></code> for valid metric
values.</p>
<p>If metric is “precomputed”, X is assumed to be a distance matrix and
must be square during fit. X may be a <span class="xref std std-term">sparse graph</span>, in which
case only “nonzero” elements may be considered neighbors.</p>
<p>If metric is a callable function, it takes two arrays representing 1D
vectors as inputs and must return one value indicating the distance
between those vectors. This works for Scipy’s metrics, but is less
efficient than passing the metric name as a string.</p>
<p>If metric is a DistanceMetric object, it will be passed directly to
the underlying computation routines.</p>
</dd>
<dt><strong>metric_params</strong><span class="classifier">dict, default=None</span></dt><dd><p>Additional keyword arguments for the metric function.</p>
</dd>
<dt><strong>n_jobs</strong><span class="classifier">int, default=None</span></dt><dd><p>The number of parallel jobs to run for neighbors search.
<code class="docutils literal notranslate"><span class="pre">None</span></code> means 1 unless in a <code class="xref py py-obj docutils literal notranslate"><span class="pre">joblib.parallel_backend</span></code> context.
<code class="docutils literal notranslate"><span class="pre">-1</span></code> means using all processors. See <span class="xref std std-term">Glossary</span>
for more details.
Doesn’t affect <a class="reference internal" href="#vtools.functions.neighbor_fill.KNeighborsRegressor.fit" title="vtools.functions.neighbor_fill.KNeighborsRegressor.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> method.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">NearestNeighbors</span></code></dt><dd><p>Unsupervised learner for implementing neighbor searches.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">RadiusNeighborsRegressor</span></code></dt><dd><p>Regression based on neighbors within a fixed radius.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">KNeighborsClassifier</span></code></dt><dd><p>Classifier implementing the k-nearest neighbors vote.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">RadiusNeighborsClassifier</span></code></dt><dd><p>Classifier implementing a vote among neighbors within a given radius.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>See <span class="xref std std-ref">Nearest Neighbors</span> in the online documentation
for a discussion of the choice of <code class="docutils literal notranslate"><span class="pre">algorithm</span></code> and <code class="docutils literal notranslate"><span class="pre">leaf_size</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Regarding the Nearest Neighbors algorithms, if it is found that two
neighbors, neighbor <cite>k+1</cite> and <cite>k</cite>, have identical distances but
different labels, the results will depend on the ordering of the
training data.</p>
</div>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm">https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm</a></p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neigh</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">KNeighborsRegressor(...)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">neigh</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mf">1.5</span><span class="p">]]))</span>
<span class="go">[0.5]</span>
</pre></div>
</div>
<dl class="field-list">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>effective_metric_</strong><span class="classifier">str or callable</span></dt><dd><p>The distance metric to use. It will be same as the <cite>metric</cite> parameter
or a synonym of it, e.g. ‘euclidean’ if the <cite>metric</cite> parameter set to
‘minkowski’ and <cite>p</cite> parameter set to 2.</p>
</dd>
<dt><strong>effective_metric_params_</strong><span class="classifier">dict</span></dt><dd><p>Additional keyword arguments for the metric function. For most metrics
will be same with <cite>metric_params</cite> parameter, but may also contain the
<cite>p</cite> parameter value if the <cite>effective_metric_</cite> attribute is set to
‘minkowski’.</p>
</dd>
<dt><strong>n_features_in_</strong><span class="classifier">int</span></dt><dd><p>Number of features seen during <span class="xref std std-term">fit</span>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.24.</span></p>
</div>
</dd>
<dt><strong>feature_names_in_</strong><span class="classifier">ndarray of shape (<cite>n_features_in_</cite>,)</span></dt><dd><p>Names of features seen during <span class="xref std std-term">fit</span>. Defined only when <cite>X</cite>
has feature names that are all strings.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.0.</span></p>
</div>
</dd>
<dt><strong>n_samples_fit_</strong><span class="classifier">int</span></dt><dd><p>Number of samples in the fitted data.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.KNeighborsRegressor.fit" title="vtools.functions.neighbor_fill.KNeighborsRegressor.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(X, y)</p></td>
<td><p>Fit the k-nearest neighbors regressor from the training dataset.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_metadata_routing</span></code>()</p></td>
<td><p>Get metadata routing of this object.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_params</span></code>([deep])</p></td>
<td><p>Get parameters for this estimator.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">kneighbors</span></code>([X, n_neighbors, return_distance])</p></td>
<td><p>Find the K-neighbors of a point.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">kneighbors_graph</span></code>([X, n_neighbors, mode])</p></td>
<td><p>Compute the (weighted) graph of k-Neighbors for points in X.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.KNeighborsRegressor.predict" title="vtools.functions.neighbor_fill.KNeighborsRegressor.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(X)</p></td>
<td><p>Predict the target for the provided data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">score</span></code>(X, y[, sample_weight])</p></td>
<td><p>Return the coefficient of determination of the prediction.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code>(**params)</p></td>
<td><p>Set the parameters of this estimator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.KNeighborsRegressor.set_score_request" title="vtools.functions.neighbor_fill.KNeighborsRegressor.set_score_request"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_score_request</span></code></a>(*[, sample_weight])</p></td>
<td><p>Request metadata passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.KNeighborsRegressor.__abstractmethods__">
<span class="sig-name descname"><span class="pre">__abstractmethods__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">frozenset({})</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.KNeighborsRegressor.__abstractmethods__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.KNeighborsRegressor.__annotations__">
<span class="sig-name descname"><span class="pre">__annotations__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'_parameter_constraints':</span> <span class="pre">&lt;class</span> <span class="pre">'dict'&gt;}</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.KNeighborsRegressor.__annotations__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.KNeighborsRegressor.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Regression</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">k-nearest</span> <span class="pre">neighbors.\n\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">target</span> <span class="pre">is</span> <span class="pre">predicted</span> <span class="pre">by</span> <span class="pre">local</span> <span class="pre">interpolation</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">targets\n</span>&#160;&#160;&#160; <span class="pre">associated</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">nearest</span> <span class="pre">neighbors</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">training</span> <span class="pre">set.\n\n</span>&#160;&#160;&#160; <span class="pre">Read</span> <span class="pre">more</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">:ref:`User</span> <span class="pre">Guide</span> <span class="pre">&lt;regression&gt;`.\n\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">0.9\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">n_neighbors</span> <span class="pre">:</span> <span class="pre">int,</span> <span class="pre">default=5\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Number</span> <span class="pre">of</span> <span class="pre">neighbors</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">by</span> <span class="pre">default</span> <span class="pre">for</span> <span class="pre">:meth:`kneighbors`</span> <span class="pre">queries.\n\n</span>&#160;&#160;&#160; <span class="pre">weights</span> <span class="pre">:</span> <span class="pre">{\'uniform\',</span> <span class="pre">\'distance\'},</span> <span class="pre">callable</span> <span class="pre">or</span> <span class="pre">None,</span> <span class="pre">default=\'uniform\'\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Weight</span> <span class="pre">function</span> <span class="pre">used</span> <span class="pre">in</span> <span class="pre">prediction.</span>&#160; <span class="pre">Possible</span> <span class="pre">values:\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">\'uniform\'</span> <span class="pre">:</span> <span class="pre">uniform</span> <span class="pre">weights.</span>&#160; <span class="pre">All</span> <span class="pre">points</span> <span class="pre">in</span> <span class="pre">each</span> <span class="pre">neighborhood\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">are</span> <span class="pre">weighted</span> <span class="pre">equally.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">\'distance\'</span> <span class="pre">:</span> <span class="pre">weight</span> <span class="pre">points</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">inverse</span> <span class="pre">of</span> <span class="pre">their</span> <span class="pre">distance.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">in</span> <span class="pre">this</span> <span class="pre">case,</span> <span class="pre">closer</span> <span class="pre">neighbors</span> <span class="pre">of</span> <span class="pre">a</span> <span class="pre">query</span> <span class="pre">point</span> <span class="pre">will</span> <span class="pre">have</span> <span class="pre">a\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">greater</span> <span class="pre">influence</span> <span class="pre">than</span> <span class="pre">neighbors</span> <span class="pre">which</span> <span class="pre">are</span> <span class="pre">further</span> <span class="pre">away.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">[callable]</span> <span class="pre">:</span> <span class="pre">a</span> <span class="pre">user-defined</span> <span class="pre">function</span> <span class="pre">which</span> <span class="pre">accepts</span> <span class="pre">an\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">array</span> <span class="pre">of</span> <span class="pre">distances,</span> <span class="pre">and</span> <span class="pre">returns</span> <span class="pre">an</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">same</span> <span class="pre">shape\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">containing</span> <span class="pre">the</span> <span class="pre">weights.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Uniform</span> <span class="pre">weights</span> <span class="pre">are</span> <span class="pre">used</span> <span class="pre">by</span> <span class="pre">default.\n\n</span>&#160;&#160;&#160; <span class="pre">algorithm</span> <span class="pre">:</span> <span class="pre">{\'auto\',</span> <span class="pre">\'ball_tree\',</span> <span class="pre">\'kd_tree\',</span> <span class="pre">\'brute\'},</span> <span class="pre">default=\'auto\'\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Algorithm</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">compute</span> <span class="pre">the</span> <span class="pre">nearest</span> <span class="pre">neighbors:\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">\'ball_tree\'</span> <span class="pre">will</span> <span class="pre">use</span> <span class="pre">:class:`BallTree`\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">\'kd_tree\'</span> <span class="pre">will</span> <span class="pre">use</span> <span class="pre">:class:`KDTree`\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">\'brute\'</span> <span class="pre">will</span> <span class="pre">use</span> <span class="pre">a</span> <span class="pre">brute-force</span> <span class="pre">search.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">\'auto\'</span> <span class="pre">will</span> <span class="pre">attempt</span> <span class="pre">to</span> <span class="pre">decide</span> <span class="pre">the</span> <span class="pre">most</span> <span class="pre">appropriate</span> <span class="pre">algorithm\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">based</span> <span class="pre">on</span> <span class="pre">the</span> <span class="pre">values</span> <span class="pre">passed</span> <span class="pre">to</span> <span class="pre">:meth:`fit`</span> <span class="pre">method.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Note:</span> <span class="pre">fitting</span> <span class="pre">on</span> <span class="pre">sparse</span> <span class="pre">input</span> <span class="pre">will</span> <span class="pre">override</span> <span class="pre">the</span> <span class="pre">setting</span> <span class="pre">of\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">this</span> <span class="pre">parameter,</span> <span class="pre">using</span> <span class="pre">brute</span> <span class="pre">force.\n\n</span>&#160;&#160;&#160; <span class="pre">leaf_size</span> <span class="pre">:</span> <span class="pre">int,</span> <span class="pre">default=30\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Leaf</span> <span class="pre">size</span> <span class="pre">passed</span> <span class="pre">to</span> <span class="pre">BallTree</span> <span class="pre">or</span> <span class="pre">KDTree.</span>&#160; <span class="pre">This</span> <span class="pre">can</span> <span class="pre">affect</span> <span class="pre">the\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">speed</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">construction</span> <span class="pre">and</span> <span class="pre">query,</span> <span class="pre">as</span> <span class="pre">well</span> <span class="pre">as</span> <span class="pre">the</span> <span class="pre">memory\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">required</span> <span class="pre">to</span> <span class="pre">store</span> <span class="pre">the</span> <span class="pre">tree.</span>&#160; <span class="pre">The</span> <span class="pre">optimal</span> <span class="pre">value</span> <span class="pre">depends</span> <span class="pre">on</span> <span class="pre">the\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">nature</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">problem.\n\n</span>&#160;&#160;&#160; <span class="pre">p</span> <span class="pre">:</span> <span class="pre">float,</span> <span class="pre">default=2\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Power</span> <span class="pre">parameter</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">Minkowski</span> <span class="pre">metric.</span> <span class="pre">When</span> <span class="pre">p</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">this</span> <span class="pre">is\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">equivalent</span> <span class="pre">to</span> <span class="pre">using</span> <span class="pre">manhattan_distance</span> <span class="pre">(l1),</span> <span class="pre">and</span> <span class="pre">euclidean_distance\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">(l2)</span> <span class="pre">for</span> <span class="pre">p</span> <span class="pre">=</span> <span class="pre">2.</span> <span class="pre">For</span> <span class="pre">arbitrary</span> <span class="pre">p,</span> <span class="pre">minkowski_distance</span> <span class="pre">(l_p)</span> <span class="pre">is</span> <span class="pre">used.\n\n</span>&#160;&#160;&#160; <span class="pre">metric</span> <span class="pre">:</span> <span class="pre">str,</span> <span class="pre">DistanceMetric</span> <span class="pre">object</span> <span class="pre">or</span> <span class="pre">callable,</span> <span class="pre">default=\'minkowski\'\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Metric</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">for</span> <span class="pre">distance</span> <span class="pre">computation.</span> <span class="pre">Default</span> <span class="pre">is</span> <span class="pre">&quot;minkowski&quot;,</span> <span class="pre">which\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">results</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">standard</span> <span class="pre">Euclidean</span> <span class="pre">distance</span> <span class="pre">when</span> <span class="pre">p</span> <span class="pre">=</span> <span class="pre">2.</span> <span class="pre">See</span> <span class="pre">the\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">documentation</span> <span class="pre">of</span> <span class="pre">`scipy.spatial.distance\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">&lt;https://docs.scipy.org/doc/scipy/reference/spatial.distance.html&gt;`_</span> <span class="pre">and\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">the</span> <span class="pre">metrics</span> <span class="pre">listed</span> <span class="pre">in\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">:class:`~sklearn.metrics.pairwise.distance_metrics`</span> <span class="pre">for</span> <span class="pre">valid</span> <span class="pre">metric\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">values.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">metric</span> <span class="pre">is</span> <span class="pre">&quot;precomputed&quot;,</span> <span class="pre">X</span> <span class="pre">is</span> <span class="pre">assumed</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">distance</span> <span class="pre">matrix</span> <span class="pre">and\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">must</span> <span class="pre">be</span> <span class="pre">square</span> <span class="pre">during</span> <span class="pre">fit.</span> <span class="pre">X</span> <span class="pre">may</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">:term:`sparse</span> <span class="pre">graph`,</span> <span class="pre">in</span> <span class="pre">which\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">case</span> <span class="pre">only</span> <span class="pre">&quot;nonzero&quot;</span> <span class="pre">elements</span> <span class="pre">may</span> <span class="pre">be</span> <span class="pre">considered</span> <span class="pre">neighbors.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">metric</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">callable</span> <span class="pre">function,</span> <span class="pre">it</span> <span class="pre">takes</span> <span class="pre">two</span> <span class="pre">arrays</span> <span class="pre">representing</span> <span class="pre">1D\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">vectors</span> <span class="pre">as</span> <span class="pre">inputs</span> <span class="pre">and</span> <span class="pre">must</span> <span class="pre">return</span> <span class="pre">one</span> <span class="pre">value</span> <span class="pre">indicating</span> <span class="pre">the</span> <span class="pre">distance\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">between</span> <span class="pre">those</span> <span class="pre">vectors.</span> <span class="pre">This</span> <span class="pre">works</span> <span class="pre">for</span> <span class="pre">Scipy\'s</span> <span class="pre">metrics,</span> <span class="pre">but</span> <span class="pre">is</span> <span class="pre">less\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">efficient</span> <span class="pre">than</span> <span class="pre">passing</span> <span class="pre">the</span> <span class="pre">metric</span> <span class="pre">name</span> <span class="pre">as</span> <span class="pre">a</span> <span class="pre">string.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">metric</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">DistanceMetric</span> <span class="pre">object,</span> <span class="pre">it</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">passed</span> <span class="pre">directly</span> <span class="pre">to\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">the</span> <span class="pre">underlying</span> <span class="pre">computation</span> <span class="pre">routines.\n\n</span>&#160;&#160;&#160; <span class="pre">metric_params</span> <span class="pre">:</span> <span class="pre">dict,</span> <span class="pre">default=None\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Additional</span> <span class="pre">keyword</span> <span class="pre">arguments</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">metric</span> <span class="pre">function.\n\n</span>&#160;&#160;&#160; <span class="pre">n_jobs</span> <span class="pre">:</span> <span class="pre">int,</span> <span class="pre">default=None\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">parallel</span> <span class="pre">jobs</span> <span class="pre">to</span> <span class="pre">run</span> <span class="pre">for</span> <span class="pre">neighbors</span> <span class="pre">search.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">``None``</span> <span class="pre">means</span> <span class="pre">1</span> <span class="pre">unless</span> <span class="pre">in</span> <span class="pre">a</span> <span class="pre">:obj:`joblib.parallel_backend`</span> <span class="pre">context.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">``-1``</span> <span class="pre">means</span> <span class="pre">using</span> <span class="pre">all</span> <span class="pre">processors.</span> <span class="pre">See</span> <span class="pre">:term:`Glossary</span> <span class="pre">&lt;n_jobs&gt;`\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">for</span> <span class="pre">more</span> <span class="pre">details.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Doesn\'t</span> <span class="pre">affect</span> <span class="pre">:meth:`fit`</span> <span class="pre">method.\n\n</span>&#160;&#160;&#160; <span class="pre">Attributes\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">effective_metric_</span> <span class="pre">:</span> <span class="pre">str</span> <span class="pre">or</span> <span class="pre">callable\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">distance</span> <span class="pre">metric</span> <span class="pre">to</span> <span class="pre">use.</span> <span class="pre">It</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">same</span> <span class="pre">as</span> <span class="pre">the</span> <span class="pre">`metric`</span> <span class="pre">parameter\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">or</span> <span class="pre">a</span> <span class="pre">synonym</span> <span class="pre">of</span> <span class="pre">it,</span> <span class="pre">e.g.</span> <span class="pre">\'euclidean\'</span> <span class="pre">if</span> <span class="pre">the</span> <span class="pre">`metric`</span> <span class="pre">parameter</span> <span class="pre">set</span> <span class="pre">to\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\'minkowski\'</span> <span class="pre">and</span> <span class="pre">`p`</span> <span class="pre">parameter</span> <span class="pre">set</span> <span class="pre">to</span> <span class="pre">2.\n\n</span>&#160;&#160;&#160; <span class="pre">effective_metric_params_</span> <span class="pre">:</span> <span class="pre">dict\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Additional</span> <span class="pre">keyword</span> <span class="pre">arguments</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">metric</span> <span class="pre">function.</span> <span class="pre">For</span> <span class="pre">most</span> <span class="pre">metrics\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">will</span> <span class="pre">be</span> <span class="pre">same</span> <span class="pre">with</span> <span class="pre">`metric_params`</span> <span class="pre">parameter,</span> <span class="pre">but</span> <span class="pre">may</span> <span class="pre">also</span> <span class="pre">contain</span> <span class="pre">the\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">`p`</span> <span class="pre">parameter</span> <span class="pre">value</span> <span class="pre">if</span> <span class="pre">the</span> <span class="pre">`effective_metric_`</span> <span class="pre">attribute</span> <span class="pre">is</span> <span class="pre">set</span> <span class="pre">to\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\'minkowski\'.\n\n</span>&#160;&#160;&#160; <span class="pre">n_features_in_</span> <span class="pre">:</span> <span class="pre">int\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Number</span> <span class="pre">of</span> <span class="pre">features</span> <span class="pre">seen</span> <span class="pre">during</span> <span class="pre">:term:`fit`.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">0.24\n\n</span>&#160;&#160;&#160; <span class="pre">feature_names_in_</span> <span class="pre">:</span> <span class="pre">ndarray</span> <span class="pre">of</span> <span class="pre">shape</span> <span class="pre">(`n_features_in_`,)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Names</span> <span class="pre">of</span> <span class="pre">features</span> <span class="pre">seen</span> <span class="pre">during</span> <span class="pre">:term:`fit`.</span> <span class="pre">Defined</span> <span class="pre">only</span> <span class="pre">when</span> <span class="pre">`X`\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">has</span> <span class="pre">feature</span> <span class="pre">names</span> <span class="pre">that</span> <span class="pre">are</span> <span class="pre">all</span> <span class="pre">strings.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">1.0\n\n</span>&#160;&#160;&#160; <span class="pre">n_samples_fit_</span> <span class="pre">:</span> <span class="pre">int\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Number</span> <span class="pre">of</span> <span class="pre">samples</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">fitted</span> <span class="pre">data.\n\n</span>&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">Also\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">NearestNeighbors</span> <span class="pre">:</span> <span class="pre">Unsupervised</span> <span class="pre">learner</span> <span class="pre">for</span> <span class="pre">implementing</span> <span class="pre">neighbor</span> <span class="pre">searches.\n</span>&#160;&#160;&#160; <span class="pre">RadiusNeighborsRegressor</span> <span class="pre">:</span> <span class="pre">Regression</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">neighbors</span> <span class="pre">within</span> <span class="pre">a</span> <span class="pre">fixed</span> <span class="pre">radius.\n</span>&#160;&#160;&#160; <span class="pre">KNeighborsClassifier</span> <span class="pre">:</span> <span class="pre">Classifier</span> <span class="pre">implementing</span> <span class="pre">the</span> <span class="pre">k-nearest</span> <span class="pre">neighbors</span> <span class="pre">vote.\n</span>&#160;&#160;&#160; <span class="pre">RadiusNeighborsClassifier</span> <span class="pre">:</span> <span class="pre">Classifier</span> <span class="pre">implementing\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">a</span> <span class="pre">vote</span> <span class="pre">among</span> <span class="pre">neighbors</span> <span class="pre">within</span> <span class="pre">a</span> <span class="pre">given</span> <span class="pre">radius.\n\n</span>&#160;&#160;&#160; <span class="pre">Notes\n</span>&#160;&#160;&#160; <span class="pre">-----\n</span>&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">:ref:`Nearest</span> <span class="pre">Neighbors</span> <span class="pre">&lt;neighbors&gt;`</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">online</span> <span class="pre">documentation\n</span>&#160;&#160;&#160; <span class="pre">for</span> <span class="pre">a</span> <span class="pre">discussion</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">choice</span> <span class="pre">of</span> <span class="pre">``algorithm``</span> <span class="pre">and</span> <span class="pre">``leaf_size``.\n\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">warning::\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Regarding</span> <span class="pre">the</span> <span class="pre">Nearest</span> <span class="pre">Neighbors</span> <span class="pre">algorithms,</span> <span class="pre">if</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">found</span> <span class="pre">that</span> <span class="pre">two\n</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">neighbors,</span> <span class="pre">neighbor</span> <span class="pre">`k+1`</span> <span class="pre">and</span> <span class="pre">`k`,</span> <span class="pre">have</span> <span class="pre">identical</span> <span class="pre">distances</span> <span class="pre">but\n</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">different</span> <span class="pre">labels,</span> <span class="pre">the</span> <span class="pre">results</span> <span class="pre">will</span> <span class="pre">depend</span> <span class="pre">on</span> <span class="pre">the</span> <span class="pre">ordering</span> <span class="pre">of</span> <span class="pre">the\n</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">training</span> <span class="pre">data.\n\n</span>&#160;&#160;&#160; <span class="pre">https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm\n\n</span>&#160;&#160;&#160; <span class="pre">Examples\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">X</span> <span class="pre">=</span> <span class="pre">[[0],</span> <span class="pre">[1],</span> <span class="pre">[2],</span> <span class="pre">[3]]\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">1]\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">from</span> <span class="pre">sklearn.neighbors</span> <span class="pre">import</span> <span class="pre">KNeighborsRegressor\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">neigh</span> <span class="pre">=</span> <span class="pre">KNeighborsRegressor(n_neighbors=2)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">neigh.fit(X,</span> <span class="pre">y)\n</span>&#160;&#160;&#160; <span class="pre">KNeighborsRegressor(...)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">print(neigh.predict([[1.5]]))\n</span>&#160;&#160;&#160; <span class="pre">[0.5]\n</span>&#160;&#160;&#160; <span class="pre">'</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.KNeighborsRegressor.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.KNeighborsRegressor.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'uniform'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'minkowski'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/neighbors/_regression.html#KNeighborsRegressor.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.KNeighborsRegressor.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.KNeighborsRegressor.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sklearn.neighbors._regression'</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.KNeighborsRegressor.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.KNeighborsRegressor._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.KNeighborsRegressor._abc_impl" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.KNeighborsRegressor._more_tags">
<span class="sig-name descname"><span class="pre">_more_tags</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/neighbors/_regression.html#KNeighborsRegressor._more_tags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.KNeighborsRegressor._more_tags" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.KNeighborsRegressor._parameter_constraints">
<span class="sig-name descname"><span class="pre">_parameter_constraints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'algorithm':</span> <span class="pre">[&lt;sklearn.utils._param_validation.StrOptions</span> <span class="pre">object&gt;],</span> <span class="pre">'leaf_size':</span> <span class="pre">[&lt;sklearn.utils._param_validation.Interval</span> <span class="pre">object&gt;],</span> <span class="pre">'metric':</span> <span class="pre">[&lt;sklearn.utils._param_validation.StrOptions</span> <span class="pre">object&gt;,</span> <span class="pre">&lt;built-in</span> <span class="pre">function</span> <span class="pre">callable&gt;,</span> <span class="pre">&lt;class</span> <span class="pre">'sklearn.metrics._dist_metrics.DistanceMetric'&gt;],</span> <span class="pre">'metric_params':</span> <span class="pre">[&lt;class</span> <span class="pre">'dict'&gt;,</span> <span class="pre">None],</span> <span class="pre">'n_jobs':</span> <span class="pre">[&lt;class</span> <span class="pre">'numbers.Integral'&gt;,</span> <span class="pre">None],</span> <span class="pre">'n_neighbors':</span> <span class="pre">[&lt;sklearn.utils._param_validation.Interval</span> <span class="pre">object&gt;,</span> <span class="pre">None],</span> <span class="pre">'p':</span> <span class="pre">[&lt;sklearn.utils._param_validation.Interval</span> <span class="pre">object&gt;,</span> <span class="pre">None],</span> <span class="pre">'weights':</span> <span class="pre">[&lt;sklearn.utils._param_validation.StrOptions</span> <span class="pre">object&gt;,</span> <span class="pre">&lt;built-in</span> <span class="pre">function</span> <span class="pre">callable&gt;,</span> <span class="pre">None]}</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.KNeighborsRegressor._parameter_constraints" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.KNeighborsRegressor.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/neighbors/_regression.html#KNeighborsRegressor.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.KNeighborsRegressor.fit" title="Link to this definition">¶</a></dt>
<dd><p>Fit the k-nearest neighbors regressor from the training dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">{array-like, sparse matrix} of shape (n_samples, n_features) or                 (n_samples, n_samples) if metric=’precomputed’</span></dt><dd><p>Training data.</p>
</dd>
<dt><strong>y</strong><span class="classifier">{array-like, sparse matrix} of shape (n_samples,) or                 (n_samples, n_outputs)</span></dt><dd><p>Target values.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>self</strong><span class="classifier">KNeighborsRegressor</span></dt><dd><p>The fitted k-nearest neighbors regressor.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.KNeighborsRegressor.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/neighbors/_regression.html#KNeighborsRegressor.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.KNeighborsRegressor.predict" title="Link to this definition">¶</a></dt>
<dd><p>Predict the target for the provided data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">{array-like, sparse matrix} of shape (n_queries, n_features),                 or (n_queries, n_indexed) if metric == ‘precomputed’</span></dt><dd><p>Test samples.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y</strong><span class="classifier">ndarray of shape (n_queries,) or (n_queries, n_outputs), dtype=int</span></dt><dd><p>Target values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.KNeighborsRegressor.set_score_request">
<span class="sig-name descname"><span class="pre">set_score_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#vtools.functions.neighbor_fill.KNeighborsRegressor" title="sklearn.neighbors._regression.KNeighborsRegressor"><span class="pre">KNeighborsRegressor</span></a></span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.KNeighborsRegressor.set_score_request" title="Link to this definition">¶</a></dt>
<dd><p>Request metadata passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p>
<p>Note that this method is only relevant if
<code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code>).
Please see <span class="xref std std-ref">User Guide</span> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">score</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3.</span></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only relevant if this estimator is used as a
sub-estimator of a meta-estimator, e.g. used inside a
<a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline" title="sklearn.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>. Otherwise it has no effect.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sample_weight</strong><span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>self</strong><span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MLEModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">endog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeriesModel</span></code></p>
<p>State space model for maximum likelihood estimation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>endog</strong><span class="classifier">array_like</span></dt><dd><p>The observed time-series process <span class="math notranslate nohighlight">\(y\)</span></p>
</dd>
<dt><strong>k_states</strong><span class="classifier">int</span></dt><dd><p>The dimension of the unobserved state process.</p>
</dd>
<dt><strong>exog</strong><span class="classifier">array_like, optional</span></dt><dd><p>Array of exogenous regressors, shaped nobs x k. Default is no
exogenous regressors.</p>
</dd>
<dt><strong>dates</strong><span class="classifier">array_like of datetime, optional</span></dt><dd><p>An array-like object of datetime objects. If a Pandas object is given
for endog, it is assumed to have a DateIndex.</p>
</dd>
<dt><strong>freq</strong><span class="classifier">str, optional</span></dt><dd><p>The frequency of the time-series. A Pandas offset or ‘B’, ‘D’, ‘W’,
‘M’, ‘A’, or ‘Q’. This is optional if dates are given.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments may be used to provide default values for state space
matrices or for Kalman filtering options. See <cite>Representation</cite>, and
<cite>KalmanFilter</cite> for more details.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">statsmodels.tsa.statespace.mlemodel.MLEResults</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">statsmodels.tsa.statespace.kalman_filter.KalmanFilter</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">statsmodels.tsa.statespace.representation.Representation</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This class wraps the state space model with Kalman filtering to add in
functionality for maximum likelihood estimation. In particular, it adds
the concept of updating the state space representation based on a defined
set of parameters, through the <cite>update</cite> method or <cite>updater</cite> attribute (see
below for more details on which to use when), and it adds a <cite>fit</cite> method
which uses a numerical optimizer to select the parameters that maximize
the likelihood of the model.</p>
<p>The <cite>start_params</cite> <cite>update</cite> method must be overridden in the
child class (and the <cite>transform</cite> and <cite>untransform</cite> methods, if needed).</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ssm</strong><span class="classifier">statsmodels.tsa.statespace.kalman_filter.KalmanFilter</span></dt><dd><p>Underlying state space representation.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.clone" title="vtools.functions.neighbor_fill.MLEModel.clone"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clone</span></code></a>(endog[, exog])</p></td>
<td><p>Clone state space model with new data and optionally new specification</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.filter" title="vtools.functions.neighbor_fill.MLEModel.filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code></a>(params[, transformed, ...])</p></td>
<td><p>Kalman filtering</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.fit" title="vtools.functions.neighbor_fill.MLEModel.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>([start_params, transformed, ...])</p></td>
<td><p>Fits the model by maximum likelihood via Kalman filter.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.fit_constrained" title="vtools.functions.neighbor_fill.MLEModel.fit_constrained"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_constrained</span></code></a>(constraints[, start_params])</p></td>
<td><p>Fit the model with some parameters subject to equality constraints.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.fix_params" title="vtools.functions.neighbor_fill.MLEModel.fix_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fix_params</span></code></a>(params)</p></td>
<td><p>Fix parameters to specific values (context manager)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.from_formula" title="vtools.functions.neighbor_fill.MLEModel.from_formula"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_formula</span></code></a>(formula, data[, subset])</p></td>
<td><p>Not implemented for state space models</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.handle_params" title="vtools.functions.neighbor_fill.MLEModel.handle_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">handle_params</span></code></a>(params[, transformed, ...])</p></td>
<td><p>Ensure model parameters satisfy shape and other requirements</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.hessian" title="vtools.functions.neighbor_fill.MLEModel.hessian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hessian</span></code></a>(params, *args, **kwargs)</p></td>
<td><p>Hessian matrix of the likelihood function, evaluated at the given parameters</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.impulse_responses" title="vtools.functions.neighbor_fill.MLEModel.impulse_responses"><code class="xref py py-obj docutils literal notranslate"><span class="pre">impulse_responses</span></code></a>(params[, steps, impulse, ...])</p></td>
<td><p>Impulse response function</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">information</span></code>(params)</p></td>
<td><p>Fisher information matrix of model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize</span></code>()</p></td>
<td><p>Initialize (possibly re-initialize) a Model instance.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.initialize_approximate_diffuse" title="vtools.functions.neighbor_fill.MLEModel.initialize_approximate_diffuse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize_approximate_diffuse</span></code></a>([variance])</p></td>
<td><p>Initialize approximate diffuse</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.initialize_known" title="vtools.functions.neighbor_fill.MLEModel.initialize_known"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize_known</span></code></a>(initial_state, ...)</p></td>
<td><p>Initialize known</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.initialize_statespace" title="vtools.functions.neighbor_fill.MLEModel.initialize_statespace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize_statespace</span></code></a>(**kwargs)</p></td>
<td><p>Initialize the state space representation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.initialize_stationary" title="vtools.functions.neighbor_fill.MLEModel.initialize_stationary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize_stationary</span></code></a>()</p></td>
<td><p>Initialize stationary</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.loglike" title="vtools.functions.neighbor_fill.MLEModel.loglike"><code class="xref py py-obj docutils literal notranslate"><span class="pre">loglike</span></code></a>(params, *args, **kwargs)</p></td>
<td><p>Loglikelihood evaluation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.loglikeobs" title="vtools.functions.neighbor_fill.MLEModel.loglikeobs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">loglikeobs</span></code></a>(params[, transformed, ...])</p></td>
<td><p>Loglikelihood evaluation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.observed_information_matrix" title="vtools.functions.neighbor_fill.MLEModel.observed_information_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">observed_information_matrix</span></code></a>(params[, ...])</p></td>
<td><p>Observed information matrix</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.opg_information_matrix" title="vtools.functions.neighbor_fill.MLEModel.opg_information_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">opg_information_matrix</span></code></a>(params[, ...])</p></td>
<td><p>Outer product of gradients information matrix</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code>(params[, exog])</p></td>
<td><p>After a model has been fit predict returns the fitted values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.prepare_data" title="vtools.functions.neighbor_fill.MLEModel.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a>()</p></td>
<td><p>Prepare data for use in the state space representation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.score" title="vtools.functions.neighbor_fill.MLEModel.score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score</span></code></a>(params, *args, **kwargs)</p></td>
<td><p>Compute the score function at params.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.score_obs" title="vtools.functions.neighbor_fill.MLEModel.score_obs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score_obs</span></code></a>(params[, method, transformed, ...])</p></td>
<td><p>Compute the score per observation, evaluated at params</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.set_conserve_memory" title="vtools.functions.neighbor_fill.MLEModel.set_conserve_memory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_conserve_memory</span></code></a>([conserve_memory])</p></td>
<td><p>Set the memory conservation method</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.set_filter_method" title="vtools.functions.neighbor_fill.MLEModel.set_filter_method"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_filter_method</span></code></a>([filter_method])</p></td>
<td><p>Set the filtering method</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.set_inversion_method" title="vtools.functions.neighbor_fill.MLEModel.set_inversion_method"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_inversion_method</span></code></a>([inversion_method])</p></td>
<td><p>Set the inversion method</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.set_smoother_output" title="vtools.functions.neighbor_fill.MLEModel.set_smoother_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_smoother_output</span></code></a>([smoother_output])</p></td>
<td><p>Set the smoother output</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.set_stability_method" title="vtools.functions.neighbor_fill.MLEModel.set_stability_method"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_stability_method</span></code></a>([stability_method])</p></td>
<td><p>Set the numerical stability method</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.simulate" title="vtools.functions.neighbor_fill.MLEModel.simulate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">simulate</span></code></a>(params, nsimulations[, ...])</p></td>
<td><p>Simulate a new time series following the state space model</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.simulation_smoother" title="vtools.functions.neighbor_fill.MLEModel.simulation_smoother"><code class="xref py py-obj docutils literal notranslate"><span class="pre">simulation_smoother</span></code></a>([simulation_output])</p></td>
<td><p>Retrieve a simulation smoother for the state space model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.smooth" title="vtools.functions.neighbor_fill.MLEModel.smooth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smooth</span></code></a>(params[, transformed, ...])</p></td>
<td><p>Kalman smoothing</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.transform_jacobian" title="vtools.functions.neighbor_fill.MLEModel.transform_jacobian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_jacobian</span></code></a>(unconstrained[, ...])</p></td>
<td><p>Jacobian matrix for the parameter transformation function</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.transform_params" title="vtools.functions.neighbor_fill.MLEModel.transform_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_params</span></code></a>(unconstrained)</p></td>
<td><p>Transform unconstrained parameters used by the optimizer to constrained parameters used in likelihood evaluation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.untransform_params" title="vtools.functions.neighbor_fill.MLEModel.untransform_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">untransform_params</span></code></a>(constrained)</p></td>
<td><p>Transform constrained parameters used in likelihood evaluation to unconstrained parameters used by the optimizer</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.update" title="vtools.functions.neighbor_fill.MLEModel.update"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update</span></code></a>(params[, transformed, ...])</p></td>
<td><p>Update the parameters of the model</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.__annotations__">
<span class="sig-name descname"><span class="pre">__annotations__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.__annotations__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&quot;\n</span>&#160;&#160;&#160; <span class="pre">State</span> <span class="pre">space</span> <span class="pre">model</span> <span class="pre">for</span> <span class="pre">maximum</span> <span class="pre">likelihood</span> <span class="pre">estimation\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">endog</span> <span class="pre">:</span> <span class="pre">array_like\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">observed</span> <span class="pre">time-series</span> <span class="pre">process</span> <span class="pre">:math:`y`\n</span>&#160;&#160;&#160; <span class="pre">k_states</span> <span class="pre">:</span> <span class="pre">int\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">dimension</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">unobserved</span> <span class="pre">state</span> <span class="pre">process.\n</span>&#160;&#160;&#160; <span class="pre">exog</span> <span class="pre">:</span> <span class="pre">array_like,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Array</span> <span class="pre">of</span> <span class="pre">exogenous</span> <span class="pre">regressors,</span> <span class="pre">shaped</span> <span class="pre">nobs</span> <span class="pre">x</span> <span class="pre">k.</span> <span class="pre">Default</span> <span class="pre">is</span> <span class="pre">no\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">exogenous</span> <span class="pre">regressors.\n</span>&#160;&#160;&#160; <span class="pre">dates</span> <span class="pre">:</span> <span class="pre">array_like</span> <span class="pre">of</span> <span class="pre">datetime,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">An</span> <span class="pre">array-like</span> <span class="pre">object</span> <span class="pre">of</span> <span class="pre">datetime</span> <span class="pre">objects.</span> <span class="pre">If</span> <span class="pre">a</span> <span class="pre">Pandas</span> <span class="pre">object</span> <span class="pre">is</span> <span class="pre">given\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">for</span> <span class="pre">endog,</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">assumed</span> <span class="pre">to</span> <span class="pre">have</span> <span class="pre">a</span> <span class="pre">DateIndex.\n</span>&#160;&#160;&#160; <span class="pre">freq</span> <span class="pre">:</span> <span class="pre">str,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">frequency</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">time-series.</span> <span class="pre">A</span> <span class="pre">Pandas</span> <span class="pre">offset</span> <span class="pre">or</span> <span class="pre">'B',</span> <span class="pre">'D',</span> <span class="pre">'W',\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">'M',</span> <span class="pre">'A',</span> <span class="pre">or</span> <span class="pre">'Q'.</span> <span class="pre">This</span> <span class="pre">is</span> <span class="pre">optional</span> <span class="pre">if</span> <span class="pre">dates</span> <span class="pre">are</span> <span class="pre">given.\n</span>&#160;&#160;&#160; <span class="pre">**kwargs\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Keyword</span> <span class="pre">arguments</span> <span class="pre">may</span> <span class="pre">be</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">provide</span> <span class="pre">default</span> <span class="pre">values</span> <span class="pre">for</span> <span class="pre">state</span> <span class="pre">space\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">matrices</span> <span class="pre">or</span> <span class="pre">for</span> <span class="pre">Kalman</span> <span class="pre">filtering</span> <span class="pre">options.</span> <span class="pre">See</span> <span class="pre">`Representation`,</span> <span class="pre">and\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">`KalmanFilter`</span> <span class="pre">for</span> <span class="pre">more</span> <span class="pre">details.\n\n</span>&#160;&#160;&#160; <span class="pre">Attributes\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">ssm</span> <span class="pre">:</span> <span class="pre">statsmodels.tsa.statespace.kalman_filter.KalmanFilter\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Underlying</span> <span class="pre">state</span> <span class="pre">space</span> <span class="pre">representation.\n\n</span>&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">Also\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">statsmodels.tsa.statespace.mlemodel.MLEResults\n</span>&#160;&#160;&#160; <span class="pre">statsmodels.tsa.statespace.kalman_filter.KalmanFilter\n</span>&#160;&#160;&#160; <span class="pre">statsmodels.tsa.statespace.representation.Representation\n\n</span>&#160;&#160;&#160; <span class="pre">Notes\n</span>&#160;&#160;&#160; <span class="pre">-----\n</span>&#160;&#160;&#160; <span class="pre">This</span> <span class="pre">class</span> <span class="pre">wraps</span> <span class="pre">the</span> <span class="pre">state</span> <span class="pre">space</span> <span class="pre">model</span> <span class="pre">with</span> <span class="pre">Kalman</span> <span class="pre">filtering</span> <span class="pre">to</span> <span class="pre">add</span> <span class="pre">in\n</span>&#160;&#160;&#160; <span class="pre">functionality</span> <span class="pre">for</span> <span class="pre">maximum</span> <span class="pre">likelihood</span> <span class="pre">estimation.</span> <span class="pre">In</span> <span class="pre">particular,</span> <span class="pre">it</span> <span class="pre">adds\n</span>&#160;&#160;&#160; <span class="pre">the</span> <span class="pre">concept</span> <span class="pre">of</span> <span class="pre">updating</span> <span class="pre">the</span> <span class="pre">state</span> <span class="pre">space</span> <span class="pre">representation</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">a</span> <span class="pre">defined\n</span>&#160;&#160;&#160; <span class="pre">set</span> <span class="pre">of</span> <span class="pre">parameters,</span> <span class="pre">through</span> <span class="pre">the</span> <span class="pre">`update`</span> <span class="pre">method</span> <span class="pre">or</span> <span class="pre">`updater`</span> <span class="pre">attribute</span> <span class="pre">(see\n</span>&#160;&#160;&#160; <span class="pre">below</span> <span class="pre">for</span> <span class="pre">more</span> <span class="pre">details</span> <span class="pre">on</span> <span class="pre">which</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">when),</span> <span class="pre">and</span> <span class="pre">it</span> <span class="pre">adds</span> <span class="pre">a</span> <span class="pre">`fit`</span> <span class="pre">method\n</span>&#160;&#160;&#160; <span class="pre">which</span> <span class="pre">uses</span> <span class="pre">a</span> <span class="pre">numerical</span> <span class="pre">optimizer</span> <span class="pre">to</span> <span class="pre">select</span> <span class="pre">the</span> <span class="pre">parameters</span> <span class="pre">that</span> <span class="pre">maximize\n</span>&#160;&#160;&#160; <span class="pre">the</span> <span class="pre">likelihood</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">model.\n\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">`start_params`</span> <span class="pre">`update`</span> <span class="pre">method</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">overridden</span> <span class="pre">in</span> <span class="pre">the\n</span>&#160;&#160;&#160; <span class="pre">child</span> <span class="pre">class</span> <span class="pre">(and</span> <span class="pre">the</span> <span class="pre">`transform`</span> <span class="pre">and</span> <span class="pre">`untransform`</span> <span class="pre">methods,</span> <span class="pre">if</span> <span class="pre">needed).\n</span>&#160;&#160;&#160; <span class="pre">&quot;</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.__getitem__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">endog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'statsmodels.tsa.statespace.mlemodel'</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.__setitem__">
<span class="sig-name descname"><span class="pre">__setitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.__setitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.__setitem__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._clone_from_init_kwds">
<span class="sig-name descname"><span class="pre">_clone_from_init_kwds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">endog</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel._clone_from_init_kwds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._clone_from_init_kwds" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._forecasts_error_partial_derivatives">
<span class="sig-name descname"><span class="pre">_forecasts_error_partial_derivatives</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includes_fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_complex_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel._forecasts_error_partial_derivatives"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._forecasts_error_partial_derivatives" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._get_extension_time_varying_matrices">
<span class="sig-name descname"><span class="pre">_get_extension_time_varying_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_of_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includes_fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel._get_extension_time_varying_matrices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._get_extension_time_varying_matrices" title="Link to this definition">¶</a></dt>
<dd><p>Get updated time-varying state space system matrices</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like</span></dt><dd><p>Array of parameters used to construct the time-varying system
matrices.</p>
</dd>
<dt><strong>exog</strong><span class="classifier">array_like or None</span></dt><dd><p>New observations of exogenous regressors, if applicable.</p>
</dd>
<dt><strong>out_of_sample</strong><span class="classifier">int</span></dt><dd><p>Number of new observations required.</p>
</dd>
<dt><strong>extend_kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>Dictionary of keyword arguments to pass to the state space model
constructor. For example, for an SARIMAX state space model, this
could be used to pass the <cite>concentrate_scale=True</cite> keyword
argument. Any arguments that are not explicitly set in this
dictionary will be copied from the current model instance.</p>
</dd>
<dt><strong>transformed</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not <cite>start_params</cite> is already transformed. Default is
True.</p>
</dd>
<dt><strong>includes_fixed</strong><span class="classifier">bool, optional</span></dt><dd><p>If parameters were previously fixed with the <cite>fix_params</cite> method,
this argument describes whether or not <cite>start_params</cite> also includes
the fixed parameters, in addition to the free parameters. Default
is False.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._get_index_with_final_state">
<span class="sig-name descname"><span class="pre">_get_index_with_final_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel._get_index_with_final_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._get_index_with_final_state" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._get_init_kwds">
<span class="sig-name descname"><span class="pre">_get_init_kwds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel._get_init_kwds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._get_init_kwds" title="Link to this definition">¶</a></dt>
<dd><p>return dictionary with extra keys used in model.__init__</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._hessian_complex_step">
<span class="sig-name descname"><span class="pre">_hessian_complex_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel._hessian_complex_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._hessian_complex_step" title="Link to this definition">¶</a></dt>
<dd><p>Hessian matrix computed by second-order complex-step differentiation
on the <cite>loglike</cite> function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._hessian_finite_difference">
<span class="sig-name descname"><span class="pre">_hessian_finite_difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel._hessian_finite_difference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._hessian_finite_difference" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._hessian_oim">
<span class="sig-name descname"><span class="pre">_hessian_oim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel._hessian_oim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._hessian_oim" title="Link to this definition">¶</a></dt>
<dd><p>Hessian matrix computed using the Harvey (1989) information matrix</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._hessian_opg">
<span class="sig-name descname"><span class="pre">_hessian_opg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel._hessian_opg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._hessian_opg" title="Link to this definition">¶</a></dt>
<dd><p>Hessian matrix computed using the outer product of gradients
information matrix</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._hessian_param_defaults">
<span class="sig-name descname"><span class="pre">_hessian_param_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[True,</span> <span class="pre">'approx',</span> <span class="pre">None,</span> <span class="pre">False]</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._hessian_param_defaults" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._hessian_param_names">
<span class="sig-name descname"><span class="pre">_hessian_param_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['transformed',</span> <span class="pre">'hessian_method',</span> <span class="pre">'approx_complex_step',</span> <span class="pre">'approx_centered']</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._hessian_param_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._loglike_param_defaults">
<span class="sig-name descname"><span class="pre">_loglike_param_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[True,</span> <span class="pre">False,</span> <span class="pre">False]</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._loglike_param_defaults" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._loglike_param_names">
<span class="sig-name descname"><span class="pre">_loglike_param_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['transformed',</span> <span class="pre">'includes_fixed',</span> <span class="pre">'complex_step']</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._loglike_param_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._res_classes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_res_classes</span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._res_classes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._score_complex_step">
<span class="sig-name descname"><span class="pre">_score_complex_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel._score_complex_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._score_complex_step" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._score_finite_difference">
<span class="sig-name descname"><span class="pre">_score_finite_difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel._score_finite_difference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._score_finite_difference" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._score_harvey">
<span class="sig-name descname"><span class="pre">_score_harvey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_complex_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel._score_harvey"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._score_harvey" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._score_obs_harvey">
<span class="sig-name descname"><span class="pre">_score_obs_harvey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_complex_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includes_fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel._score_obs_harvey"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._score_obs_harvey" title="Link to this definition">¶</a></dt>
<dd><p>Score</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like, optional</span></dt><dd><p>Array of parameters at which to evaluate the loglikelihood
function.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments to pass to the Kalman filter. See
<cite>KalmanFilter.filter</cite> for more details.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method is from Harvey (1989), section 3.4.5</p>
<p class="rubric">References</p>
<p>Harvey, Andrew C. 1990.
Forecasting, Structural Time Series Models and the Kalman Filter.
Cambridge University Press.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._score_param_defaults">
<span class="sig-name descname"><span class="pre">_score_param_defaults</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[True,</span> <span class="pre">False,</span> <span class="pre">'approx',</span> <span class="pre">None,</span> <span class="pre">False]</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._score_param_defaults" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._score_param_names">
<span class="sig-name descname"><span class="pre">_score_param_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['transformed',</span> <span class="pre">'includes_fixed',</span> <span class="pre">'score_method',</span> <span class="pre">'approx_complex_step',</span> <span class="pre">'approx_centered']</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._score_param_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._validate_can_fix_params">
<span class="sig-name descname"><span class="pre">_validate_can_fix_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel._validate_can_fix_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._validate_can_fix_params" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._validate_out_of_sample_exog">
<span class="sig-name descname"><span class="pre">_validate_out_of_sample_exog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_of_sample</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel._validate_out_of_sample_exog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._validate_out_of_sample_exog" title="Link to this definition">¶</a></dt>
<dd><p>Validate given <cite>exog</cite> as satisfactory for out-of-sample operations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>exog</strong><span class="classifier">array_like or None</span></dt><dd><p>New observations of exogenous regressors, if applicable.</p>
</dd>
<dt><strong>out_of_sample</strong><span class="classifier">int</span></dt><dd><p>Number of new observations required.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>exog</strong><span class="classifier">array or None</span></dt><dd><p>A numpy array of shape (out_of_sample, k_exog) if the model
contains an <cite>exog</cite> component, or None if it does not.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel._wrap_results">
<span class="sig-name descname"><span class="pre">_wrap_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_raw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wrapper_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel._wrap_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel._wrap_results" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.clone">
<span class="sig-name descname"><span class="pre">clone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">endog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.clone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.clone" title="Link to this definition">¶</a></dt>
<dd><p>Clone state space model with new data and optionally new specification</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>endog</strong><span class="classifier">array_like</span></dt><dd><p>The observed time-series process <span class="math notranslate nohighlight">\(y\)</span></p>
</dd>
<dt><strong>k_states</strong><span class="classifier">int</span></dt><dd><p>The dimension of the unobserved state process.</p>
</dd>
<dt><strong>exog</strong><span class="classifier">array_like, optional</span></dt><dd><p>Array of exogenous regressors, shaped nobs x k. Default is no
exogenous regressors.</p>
</dd>
<dt><strong>kwargs</strong></dt><dd><p>Keyword arguments to pass to the new model class to change the
model specification.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>model</strong><span class="classifier">MLEModel subclass</span></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method must be implemented</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includes_fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complex_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_ssm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_wrapper_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.filter" title="Link to this definition">¶</a></dt>
<dd><p>Kalman filtering</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like</span></dt><dd><p>Array of parameters at which to evaluate the loglikelihood
function.</p>
</dd>
<dt><strong>transformed</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not <cite>params</cite> is already transformed. Default is True.</p>
</dd>
<dt><strong>return_ssm</strong><span class="classifier">bool,optional</span></dt><dd><p>Whether or not to return only the state space output or a full
results object. Default is to return a full results object.</p>
</dd>
<dt><strong>cov_type</strong><span class="classifier">str, optional</span></dt><dd><p>See <cite>MLEResults.fit</cite> for a description of covariance matrix types
for results object.</p>
</dd>
<dt><strong>cov_kwds</strong><span class="classifier">dict or None, optional</span></dt><dd><p>See <cite>MLEResults.get_robustcov_results</cite> for a description required
keywords for alternative covariance estimators</p>
</dd>
<dt><strong>low_memory</strong><span class="classifier">bool, optional</span></dt><dd><p>If set to True, techniques are applied to substantially reduce
memory usage. If used, some features of the results object will
not be available (including in-sample prediction), although
out-of-sample forecasting is possible. Default is False.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments to pass to the Kalman filter. See
<cite>KalmanFilter.filter</cite> for more details.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includes_fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lbfgs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_score</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_complex_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_hessian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.fit" title="Link to this definition">¶</a></dt>
<dd><p>Fits the model by maximum likelihood via Kalman filter.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>start_params</strong><span class="classifier">array_like, optional</span></dt><dd><p>Initial guess of the solution for the loglikelihood maximization.
If None, the default is given by Model.start_params.</p>
</dd>
<dt><strong>transformed</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not <cite>start_params</cite> is already transformed. Default is
True.</p>
</dd>
<dt><strong>includes_fixed</strong><span class="classifier">bool, optional</span></dt><dd><p>If parameters were previously fixed with the <cite>fix_params</cite> method,
this argument describes whether or not <cite>start_params</cite> also includes
the fixed parameters, in addition to the free parameters. Default
is False.</p>
</dd>
<dt><strong>cov_type</strong><span class="classifier">str, optional</span></dt><dd><p>The <cite>cov_type</cite> keyword governs the method for calculating the
covariance matrix of parameter estimates. Can be one of:</p>
<ul class="simple">
<li><p>‘opg’ for the outer product of gradient estimator</p></li>
<li><p>‘oim’ for the observed information matrix estimator, calculated
using the method of Harvey (1989)</p></li>
<li><p>‘approx’ for the observed information matrix estimator,
calculated using a numerical approximation of the Hessian matrix.</p></li>
<li><p>‘robust’ for an approximate (quasi-maximum likelihood) covariance
matrix that may be valid even in the presence of some
misspecifications. Intermediate calculations use the ‘oim’
method.</p></li>
<li><p>‘robust_approx’ is the same as ‘robust’ except that the
intermediate calculations use the ‘approx’ method.</p></li>
<li><p>‘none’ for no covariance matrix calculation.</p></li>
</ul>
<p>Default is ‘opg’ unless memory conservation is used to avoid
computing the loglikelihood values for each observation, in which
case the default is ‘approx’.</p>
</dd>
<dt><strong>cov_kwds</strong><span class="classifier">dict or None, optional</span></dt><dd><p>A dictionary of arguments affecting covariance matrix computation.</p>
<p><strong>opg, oim, approx, robust, robust_approx</strong></p>
<ul class="simple">
<li><p>‘approx_complex_step’ : bool, optional - If True, numerical
approximations are computed using complex-step methods. If False,
numerical approximations are computed using finite difference
methods. Default is True.</p></li>
<li><p>‘approx_centered’ : bool, optional - If True, numerical
approximations computed using finite difference methods use a
centered approximation. Default is False.</p></li>
</ul>
</dd>
<dt><strong>method</strong><span class="classifier">str, optional</span></dt><dd><p>The <cite>method</cite> determines which solver from <cite>scipy.optimize</cite>
is used, and it can be chosen from among the following strings:</p>
<ul class="simple">
<li><p>‘newton’ for Newton-Raphson</p></li>
<li><p>‘nm’ for Nelder-Mead</p></li>
<li><p>‘bfgs’ for Broyden-Fletcher-Goldfarb-Shanno (BFGS)</p></li>
<li><p>‘lbfgs’ for limited-memory BFGS with optional box constraints</p></li>
<li><p>‘powell’ for modified Powell’s method</p></li>
<li><p>‘cg’ for conjugate gradient</p></li>
<li><p>‘ncg’ for Newton-conjugate gradient</p></li>
<li><p>‘basinhopping’ for global basin-hopping solver</p></li>
</ul>
<p>The explicit arguments in <cite>fit</cite> are passed to the solver,
with the exception of the basin-hopping solver. Each
solver has several optional arguments that are not the same across
solvers. See the notes section below (or scipy.optimize) for the
available arguments and for the list of explicit arguments that the
basin-hopping solver supports.</p>
</dd>
<dt><strong>maxiter</strong><span class="classifier">int, optional</span></dt><dd><p>The maximum number of iterations to perform.</p>
</dd>
<dt><strong>full_output</strong><span class="classifier">bool, optional</span></dt><dd><p>Set to True to have all available output in the Results object’s
mle_retvals attribute. The output is dependent on the solver.
See LikelihoodModelResults notes section for more information.</p>
</dd>
<dt><strong>disp</strong><span class="classifier">bool, optional</span></dt><dd><p>Set to True to print convergence messages.</p>
</dd>
<dt><strong>callback</strong><span class="classifier">callable callback(xk), optional</span></dt><dd><p>Called after each iteration, as callback(xk), where xk is the
current parameter vector.</p>
</dd>
<dt><strong>return_params</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not to return only the array of maximizing parameters.
Default is False.</p>
</dd>
<dt><strong>optim_score</strong><span class="classifier">{‘harvey’, ‘approx’} or None, optional</span></dt><dd><p>The method by which the score vector is calculated. ‘harvey’ uses
the method from Harvey (1989), ‘approx’ uses either finite
difference or complex step differentiation depending upon the
value of <cite>optim_complex_step</cite>, and None uses the built-in gradient
approximation of the optimizer. Default is None. This keyword is
only relevant if the optimization method uses the score.</p>
</dd>
<dt><strong>optim_complex_step</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not to use complex step differentiation when
approximating the score; if False, finite difference approximation
is used. Default is True. This keyword is only relevant if
<cite>optim_score</cite> is set to ‘harvey’ or ‘approx’.</p>
</dd>
<dt><strong>optim_hessian</strong><span class="classifier">{‘opg’,’oim’,’approx’}, optional</span></dt><dd><p>The method by which the Hessian is numerically approximated. ‘opg’
uses outer product of gradients, ‘oim’ uses the information
matrix formula from Harvey (1989), and ‘approx’ uses numerical
approximation. This keyword is only relevant if the
optimization method uses the Hessian matrix.</p>
</dd>
<dt><strong>low_memory</strong><span class="classifier">bool, optional</span></dt><dd><p>If set to True, techniques are applied to substantially reduce
memory usage. If used, some features of the results object will
not be available (including smoothed results and in-sample
prediction), although out-of-sample forecasting is possible.
Default is False.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments to pass to the optimizer.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>results</dt><dd><p>Results object holding results from fitting a state space model.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">statsmodels.base.model.LikelihoodModel.fit</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">statsmodels.tsa.statespace.mlemodel.MLEResults</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">statsmodels.tsa.statespace.structural.UnobservedComponentsResults</span></code></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.fit_constrained">
<span class="sig-name descname"><span class="pre">fit_constrained</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">constraints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">fit_kwds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.fit_constrained"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.fit_constrained" title="Link to this definition">¶</a></dt>
<dd><p>Fit the model with some parameters subject to equality constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>constraints</strong><span class="classifier">dict</span></dt><dd><p>Dictionary of constraints, of the form <cite>param_name: fixed_value</cite>.
See the <cite>param_names</cite> property for valid parameter names.</p>
</dd>
<dt><strong>start_params</strong><span class="classifier">array_like, optional</span></dt><dd><p>Initial guess of the solution for the loglikelihood maximization.
If None, the default is given by Model.start_params.</p>
</dd>
<dt><strong>**fit_kwds</strong><span class="classifier">keyword arguments</span></dt><dd><p>fit_kwds are used in the optimization of the remaining parameters.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>results</strong><span class="classifier">Results instance</span></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">endog</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit_constrained</span><span class="p">({</span><span class="s1">&#39;ar.L1&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.fix_params">
<span class="sig-name descname"><span class="pre">fix_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.fix_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.fix_params" title="Link to this definition">¶</a></dt>
<dd><p>Fix parameters to specific values (context manager)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">dict</span></dt><dd><p>Dictionary describing the fixed parameter values, of the form
<cite>param_name: fixed_value</cite>. See the <cite>param_names</cite> property for valid
parameter names.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">SARIMAX</span><span class="p">(</span><span class="n">endog</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">mod</span><span class="o">.</span><span class="n">fix_params</span><span class="p">({</span><span class="s1">&#39;ar.L1&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}):</span>
<span class="go">        res = mod.fit()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.from_formula">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_formula</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">formula</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.from_formula"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.from_formula" title="Link to this definition">¶</a></dt>
<dd><p>Not implemented for state space models</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.handle_params">
<span class="sig-name descname"><span class="pre">handle_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includes_fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_jacobian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.handle_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.handle_params" title="Link to this definition">¶</a></dt>
<dd><p>Ensure model parameters satisfy shape and other requirements</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.hessian">
<span class="sig-name descname"><span class="pre">hessian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.hessian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.hessian" title="Link to this definition">¶</a></dt>
<dd><p>Hessian matrix of the likelihood function, evaluated at the given
parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like</span></dt><dd><p>Array of parameters at which to evaluate the hessian.</p>
</dd>
<dt><strong>*args</strong></dt><dd><p>Additional positional arguments to the <cite>loglike</cite> method.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments to the <cite>loglike</cite> method.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>hessian</strong><span class="classifier">ndarray</span></dt><dd><p>Hessian matrix evaluated at <cite>params</cite></p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is a numerical approximation.</p>
<p>Both args and kwargs are necessary because the optimizer from
<cite>fit</cite> must call this function and only supports passing arguments via
args (for example <cite>scipy.optimize.fmin_l_bfgs</cite>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.impulse_responses">
<span class="sig-name descname"><span class="pre">impulse_responses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impulse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orthogonalized</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cumulative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anchor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includes_fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.impulse_responses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.impulse_responses" title="Link to this definition">¶</a></dt>
<dd><p>Impulse response function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like</span></dt><dd><p>Array of model parameters.</p>
</dd>
<dt><strong>steps</strong><span class="classifier">int, optional</span></dt><dd><p>The number of steps for which impulse responses are calculated.
Default is 1. Note that for time-invariant models, the initial
impulse is not counted as a step, so if <cite>steps=1</cite>, the output will
have 2 entries.</p>
</dd>
<dt><strong>impulse</strong><span class="classifier">int, str or array_like</span></dt><dd><p>If an integer, the state innovation to pulse; must be between 0
and <cite>k_posdef-1</cite>. If a str, it indicates which column of df
the unit (1) impulse is given.
Alternatively, a custom impulse vector may be provided; must be
shaped <cite>k_posdef x 1</cite>.</p>
</dd>
<dt><strong>orthogonalized</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not to perform impulse using orthogonalized innovations.
Note that this will also affect custum <cite>impulse</cite> vectors. Default
is False.</p>
</dd>
<dt><strong>cumulative</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not to return cumulative impulse responses. Default is
False.</p>
</dd>
<dt><strong>anchor</strong><span class="classifier">int, str, or datetime, optional</span></dt><dd><p>Time point within the sample for the state innovation impulse. Type
depends on the index of the given <cite>endog</cite> in the model. Two special
cases are the strings ‘start’ and ‘end’, which refer to setting the
impulse at the first and last points of the sample, respectively.
Integer values can run from 0 to <cite>nobs - 1</cite>, or can be negative to
apply negative indexing. Finally, if a date/time index was provided
to the model, then this argument can be a date string to parse or a
datetime type. Default is ‘start’.</p>
</dd>
<dt><strong>exog</strong><span class="classifier">array_like, optional</span></dt><dd><p>New observations of exogenous regressors for our-of-sample periods,
if applicable.</p>
</dd>
<dt><strong>transformed</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not <cite>params</cite> is already transformed. Default is
True.</p>
</dd>
<dt><strong>includes_fixed</strong><span class="classifier">bool, optional</span></dt><dd><p>If parameters were previously fixed with the <cite>fix_params</cite> method,
this argument describes whether or not <cite>params</cite> also includes
the fixed parameters, in addition to the free parameters. Default
is False.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>If the model has time-varying design or transition matrices and the
combination of <cite>anchor</cite> and <cite>steps</cite> implies creating impulse
responses for the out-of-sample period, then these matrices must
have updated values provided for the out-of-sample steps. For
example, if <cite>design</cite> is a time-varying component, <cite>nobs</cite> is 10,
<cite>anchor=1</cite>, and <cite>steps</cite> is 15, a (<cite>k_endog</cite> x <cite>k_states</cite> x 7)
matrix must be provided with the new design matrix values.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>impulse_responses</strong><span class="classifier">ndarray</span></dt><dd><p>Responses for each endogenous variable due to the impulse
given by the <cite>impulse</cite> argument. For a time-invariant model, the
impulse responses are given for <cite>steps + 1</cite> elements (this gives
the “initial impulse” followed by <cite>steps</cite> responses for the
important cases of VAR and SARIMAX models), while for time-varying
models the impulse responses are only given for <cite>steps</cite> elements
(to avoid having to unexpectedly provide updated time-varying
matrices).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.simulate" title="vtools.functions.neighbor_fill.MLEModel.simulate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">simulate</span></code></a></dt><dd><p>Simulate a time series according to the given state space model, optionally with specified series for the innovations.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Intercepts in the measurement and state equation are ignored when
calculating impulse responses.</p>
<dl class="simple">
<dt>TODO: add an option to allow changing the ordering for the</dt><dd><p>orthogonalized option. Will require permuting matrices when
constructing the extended model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.initial_variance">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initial_variance</span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.initial_variance" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.initialization">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialization</span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.initialization" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.initialize_approximate_diffuse">
<span class="sig-name descname"><span class="pre">initialize_approximate_diffuse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.initialize_approximate_diffuse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.initialize_approximate_diffuse" title="Link to this definition">¶</a></dt>
<dd><p>Initialize approximate diffuse</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.initialize_known">
<span class="sig-name descname"><span class="pre">initialize_known</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state_cov</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.initialize_known"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.initialize_known" title="Link to this definition">¶</a></dt>
<dd><p>Initialize known</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.initialize_statespace">
<span class="sig-name descname"><span class="pre">initialize_statespace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.initialize_statespace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.initialize_statespace" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the state space representation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments to pass to the state space class
constructor.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.initialize_stationary">
<span class="sig-name descname"><span class="pre">initialize_stationary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.initialize_stationary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.initialize_stationary" title="Link to this definition">¶</a></dt>
<dd><p>Initialize stationary</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.loglike">
<span class="sig-name descname"><span class="pre">loglike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.loglike"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.loglike" title="Link to this definition">¶</a></dt>
<dd><p>Loglikelihood evaluation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like</span></dt><dd><p>Array of parameters at which to evaluate the loglikelihood
function.</p>
</dd>
<dt><strong>transformed</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not <cite>params</cite> is already transformed. Default is True.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments to pass to the Kalman filter. See
<cite>KalmanFilter.filter</cite> for more details.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.update" title="vtools.functions.neighbor_fill.MLEModel.update"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update</span></code></a></dt><dd><p>modifies the internal state of the state space model to reflect new params</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p><a class="reference internal" href="#rd0f2802b970c-1" id="id16">[1]</a> recommend maximizing the average likelihood to avoid scale issues;
this is done automatically by the base Model fit method.</p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="rd0f2802b970c-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id16">1</a><span class="fn-bracket">]</span></span>
<p>Koopman, Siem Jan, Neil Shephard, and Jurgen A. Doornik. 1999.
Statistical Algorithms for Models in State Space Using SsfPack 2.2.
Econometrics Journal 2 (1): 107-60. doi:10.1111/1368-423X.00023.</p>
</div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.loglikelihood_burn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loglikelihood_burn</span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.loglikelihood_burn" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.loglikeobs">
<span class="sig-name descname"><span class="pre">loglikeobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includes_fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complex_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.loglikeobs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.loglikeobs" title="Link to this definition">¶</a></dt>
<dd><p>Loglikelihood evaluation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like</span></dt><dd><p>Array of parameters at which to evaluate the loglikelihood
function.</p>
</dd>
<dt><strong>transformed</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not <cite>params</cite> is already transformed. Default is True.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments to pass to the Kalman filter. See
<cite>KalmanFilter.filter</cite> for more details.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.update" title="vtools.functions.neighbor_fill.MLEModel.update"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update</span></code></a></dt><dd><p>modifies the internal state of the Model to reflect new params</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p><a class="reference internal" href="#re08a7da1fb83-1" id="id18">[1]</a> recommend maximizing the average likelihood to avoid scale issues;
this is done automatically by the base Model fit method.</p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="re08a7da1fb83-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id18">1</a><span class="fn-bracket">]</span></span>
<p>Koopman, Siem Jan, Neil Shephard, and Jurgen A. Doornik. 1999.
Statistical Algorithms for Models in State Space Using SsfPack 2.2.
Econometrics Journal 2 (1): 107-60. doi:10.1111/1368-423X.00023.</p>
</div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.observed_information_matrix">
<span class="sig-name descname"><span class="pre">observed_information_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includes_fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_complex_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.observed_information_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.observed_information_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Observed information matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like, optional</span></dt><dd><p>Array of parameters at which to evaluate the loglikelihood
function.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments to pass to the Kalman filter. See
<cite>KalmanFilter.filter</cite> for more details.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method is from Harvey (1989), which shows that the information
matrix only depends on terms from the gradient. This implementation is
partially analytic and partially numeric approximation, therefore,
because it uses the analytic formula for the information matrix, with
numerically computed elements of the gradient.</p>
<p class="rubric">References</p>
<p>Harvey, Andrew C. 1990.
Forecasting, Structural Time Series Models and the Kalman Filter.
Cambridge University Press.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.opg_information_matrix">
<span class="sig-name descname"><span class="pre">opg_information_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includes_fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_complex_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.opg_information_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.opg_information_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Outer product of gradients information matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like, optional</span></dt><dd><p>Array of parameters at which to evaluate the loglikelihood
function.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional arguments to the <cite>loglikeobs</cite> method.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<p>Berndt, Ernst R., Bronwyn Hall, Robert Hall, and Jerry Hausman. 1974.
Estimation and Inference in Nonlinear Structural Models.
NBER Chapters. National Bureau of Economic Research, Inc.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.param_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">param_names</span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.param_names" title="Link to this definition">¶</a></dt>
<dd><p>(list of str) List of human readable parameter names (for parameters
actually included in the model).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.prepare_data" title="Link to this definition">¶</a></dt>
<dd><p>Prepare data for use in the state space representation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.score" title="Link to this definition">¶</a></dt>
<dd><p>Compute the score function at params.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like</span></dt><dd><p>Array of parameters at which to evaluate the score.</p>
</dd>
<dt><strong>*args</strong></dt><dd><p>Additional positional arguments to the <cite>loglike</cite> method.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments to the <cite>loglike</cite> method.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>score</strong><span class="classifier">ndarray</span></dt><dd><p>Score, evaluated at <cite>params</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is a numerical approximation, calculated using first-order complex
step differentiation on the <cite>loglike</cite> method.</p>
<p>Both args and kwargs are necessary because the optimizer from
<cite>fit</cite> must call this function and only supports passing arguments via
args (for example <cite>scipy.optimize.fmin_l_bfgs</cite>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.score_obs">
<span class="sig-name descname"><span class="pre">score_obs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'approx'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includes_fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_complex_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.score_obs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.score_obs" title="Link to this definition">¶</a></dt>
<dd><p>Compute the score per observation, evaluated at params</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like</span></dt><dd><p>Array of parameters at which to evaluate the score.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional arguments to the <cite>loglike</cite> method.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>score</strong><span class="classifier">ndarray</span></dt><dd><p>Score per observation, evaluated at <cite>params</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is a numerical approximation, calculated using first-order complex
step differentiation on the <cite>loglikeobs</cite> method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.set_conserve_memory">
<span class="sig-name descname"><span class="pre">set_conserve_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conserve_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.set_conserve_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.set_conserve_memory" title="Link to this definition">¶</a></dt>
<dd><p>Set the memory conservation method</p>
<p>By default, the Kalman filter computes a number of intermediate
matrices at each iteration. The memory conservation options control
which of those matrices are stored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>conserve_memory</strong><span class="classifier">int, optional</span></dt><dd><p>Bitmask value to set the memory conservation method to. See notes
for details.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments may be used to influence the memory conservation
method by setting individual boolean flags.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method is rarely used. See the corresponding function in the
<cite>KalmanFilter</cite> class for details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.set_filter_method">
<span class="sig-name descname"><span class="pre">set_filter_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.set_filter_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.set_filter_method" title="Link to this definition">¶</a></dt>
<dd><p>Set the filtering method</p>
<p>The filtering method controls aspects of which Kalman filtering
approach will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filter_method</strong><span class="classifier">int, optional</span></dt><dd><p>Bitmask value to set the filter method to. See notes for details.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments may be used to influence the filter method by
setting individual boolean flags. See notes for details.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method is rarely used. See the corresponding function in the
<cite>KalmanFilter</cite> class for details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.set_inversion_method">
<span class="sig-name descname"><span class="pre">set_inversion_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inversion_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.set_inversion_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.set_inversion_method" title="Link to this definition">¶</a></dt>
<dd><p>Set the inversion method</p>
<p>The Kalman filter may contain one matrix inversion: that of the
forecast error covariance matrix. The inversion method controls how and
if that inverse is performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inversion_method</strong><span class="classifier">int, optional</span></dt><dd><p>Bitmask value to set the inversion method to. See notes for
details.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments may be used to influence the inversion method by
setting individual boolean flags. See notes for details.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method is rarely used. See the corresponding function in the
<cite>KalmanFilter</cite> class for details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.set_smoother_output">
<span class="sig-name descname"><span class="pre">set_smoother_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smoother_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.set_smoother_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.set_smoother_output" title="Link to this definition">¶</a></dt>
<dd><p>Set the smoother output</p>
<p>The smoother can produce several types of results. The smoother output
variable controls which are calculated and returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>smoother_output</strong><span class="classifier">int, optional</span></dt><dd><p>Bitmask value to set the smoother output to. See notes for details.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments may be used to influence the smoother output by
setting individual boolean flags.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method is rarely used. See the corresponding function in the
<cite>KalmanSmoother</cite> class for details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.set_stability_method">
<span class="sig-name descname"><span class="pre">set_stability_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stability_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.set_stability_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.set_stability_method" title="Link to this definition">¶</a></dt>
<dd><p>Set the numerical stability method</p>
<p>The Kalman filter is a recursive algorithm that may in some cases
suffer issues with numerical stability. The stability method controls
what, if any, measures are taken to promote stability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>stability_method</strong><span class="classifier">int, optional</span></dt><dd><p>Bitmask value to set the stability method to. See notes for
details.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Keyword arguments may be used to influence the stability method by
setting individual boolean flags. See notes for details.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method is rarely used. See the corresponding function in the
<cite>KalmanFilter</cite> class for details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.simulate">
<span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsimulations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measurement_shocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_shocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anchor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repetitions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includes_fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretransformed_measurement_shocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretransformed_state_shocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretransformed_initial_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.simulate" title="Link to this definition">¶</a></dt>
<dd><p>Simulate a new time series following the state space model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like</span></dt><dd><p>Array of parameters to use in constructing the state space
representation to use when simulating.</p>
</dd>
<dt><strong>nsimulations</strong><span class="classifier">int</span></dt><dd><p>The number of observations to simulate. If the model is
time-invariant this can be any number. If the model is
time-varying, then this number must be less than or equal to the
number of observations.</p>
</dd>
<dt><strong>measurement_shocks</strong><span class="classifier">array_like, optional</span></dt><dd><p>If specified, these are the shocks to the measurement equation,
<span class="math notranslate nohighlight">\(\varepsilon_t\)</span>. If unspecified, these are automatically
generated using a pseudo-random number generator. If specified,
must be shaped <cite>nsimulations</cite> x <cite>k_endog</cite>, where <cite>k_endog</cite> is the
same as in the state space model.</p>
</dd>
<dt><strong>state_shocks</strong><span class="classifier">array_like, optional</span></dt><dd><p>If specified, these are the shocks to the state equation,
<span class="math notranslate nohighlight">\(\eta_t\)</span>. If unspecified, these are automatically
generated using a pseudo-random number generator. If specified,
must be shaped <cite>nsimulations</cite> x <cite>k_posdef</cite> where <cite>k_posdef</cite> is the
same as in the state space model.</p>
</dd>
<dt><strong>initial_state</strong><span class="classifier">array_like, optional</span></dt><dd><p>If specified, this is the initial state vector to use in
simulation, which should be shaped (<cite>k_states</cite> x 1), where
<cite>k_states</cite> is the same as in the state space model. If unspecified,
but the model has been initialized, then that initialization is
used. This must be specified if <cite>anchor</cite> is anything other than
“start” or 0 (or else you can use the <cite>simulate</cite> method on a
results object rather than on the model object).</p>
</dd>
<dt><strong>anchor</strong><span class="classifier">int, str, or datetime, optional</span></dt><dd><p>First period for simulation. The simulation will be conditional on
all existing datapoints prior to the <cite>anchor</cite>.  Type depends on the
index of the given <cite>endog</cite> in the model. Two special cases are the
strings ‘start’ and ‘end’. <cite>start</cite> refers to beginning the
simulation at the first period of the sample, and <cite>end</cite> refers to
beginning the simulation at the first period after the sample.
Integer values can run from 0 to <cite>nobs</cite>, or can be negative to
apply negative indexing. Finally, if a date/time index was provided
to the model, then this argument can be a date string to parse or a
datetime type. Default is ‘start’.</p>
</dd>
<dt><strong>repetitions</strong><span class="classifier">int, optional</span></dt><dd><p>Number of simulated paths to generate. Default is 1 simulated path.</p>
</dd>
<dt><strong>exog</strong><span class="classifier">array_like, optional</span></dt><dd><p>New observations of exogenous regressors, if applicable.</p>
</dd>
<dt><strong>transformed</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not <cite>params</cite> is already transformed. Default is
True.</p>
</dd>
<dt><strong>includes_fixed</strong><span class="classifier">bool, optional</span></dt><dd><p>If parameters were previously fixed with the <cite>fix_params</cite> method,
this argument describes whether or not <cite>params</cite> also includes
the fixed parameters, in addition to the free parameters. Default
is False.</p>
</dd>
<dt><strong>pretransformed_measurement_shocks</strong><span class="classifier">bool, optional</span></dt><dd><p>If <cite>measurement_shocks</cite> is provided, this flag indicates whether it
should be directly used as the shocks. If False, then it is assumed
to contain draws from the standard Normal distribution that must be
transformed using the <cite>obs_cov</cite> covariance matrix. Default is True.</p>
</dd>
<dt><strong>pretransformed_state_shocks</strong><span class="classifier">bool, optional</span></dt><dd><p>If <cite>state_shocks</cite> is provided, this flag indicates whether it
should be directly used as the shocks. If False, then it is assumed
to contain draws from the standard Normal distribution that must be
transformed using the <cite>state_cov</cite> covariance matrix. Default is
True.</p>
</dd>
<dt><strong>pretransformed_initial_state</strong><span class="classifier">bool, optional</span></dt><dd><p>If <cite>initial_state</cite> is provided, this flag indicates whether it
should be directly used as the initial_state. If False, then it is
assumed to contain draws from the standard Normal distribution that
must be transformed using the <cite>initial_state_cov</cite> covariance
matrix. Default is True.</p>
</dd>
<dt><strong>random_state</strong><span class="classifier">{None, int, Generator, RandomState}, optional</span></dt><dd><p>If <cite>seed</cite> is None (or <cite>np.random</cite>), the
class:<code class="docutils literal notranslate"><span class="pre">~numpy.random.RandomState</span></code> singleton is used.
If <cite>seed</cite> is an int, a new class:<code class="docutils literal notranslate"><span class="pre">~numpy.random.RandomState</span></code>
instance is used, seeded with <cite>seed</cite>.
If <cite>seed</cite> is already a class:<code class="docutils literal notranslate"><span class="pre">~numpy.random.Generator</span></code> or
class:<code class="docutils literal notranslate"><span class="pre">~numpy.random.RandomState</span></code> instance then that instance is
used.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>simulated_obs</strong><span class="classifier">ndarray</span></dt><dd><p>An array of simulated observations. If <cite>repetitions=None</cite>, then it
will be shaped (nsimulations x k_endog) or (nsimulations,) if
<cite>k_endog=1</cite>. Otherwise it will be shaped
(nsimulations x k_endog x repetitions). If the model was given
Pandas input then the output will be a Pandas object. If
<cite>k_endog &gt; 1</cite> and <cite>repetitions</cite> is not None, then the output will
be a Pandas DataFrame that has a MultiIndex for the columns, with
the first level containing the names of the <cite>endog</cite> variables and
the second level containing the repetition number.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.impulse_responses" title="vtools.functions.neighbor_fill.MLEModel.impulse_responses"><code class="xref py py-obj docutils literal notranslate"><span class="pre">impulse_responses</span></code></a></dt><dd><p>Impulse response functions</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.simulation_smoother">
<span class="sig-name descname"><span class="pre">simulation_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.simulation_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.simulation_smoother" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve a simulation smoother for the state space model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>simulation_output</strong><span class="classifier">int, optional</span></dt><dd><p>Determines which simulation smoother output is calculated.
Default is all (including state and disturbances).</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments, used to set the simulation output.
See <cite>set_simulation_output</cite> for more details.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>SimulationSmoothResults</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.smooth">
<span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includes_fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complex_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_ssm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_wrapper_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.smooth" title="Link to this definition">¶</a></dt>
<dd><p>Kalman smoothing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like</span></dt><dd><p>Array of parameters at which to evaluate the loglikelihood
function.</p>
</dd>
<dt><strong>transformed</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not <cite>params</cite> is already transformed. Default is True.</p>
</dd>
<dt><strong>return_ssm</strong><span class="classifier">bool,optional</span></dt><dd><p>Whether or not to return only the state space output or a full
results object. Default is to return a full results object.</p>
</dd>
<dt><strong>cov_type</strong><span class="classifier">str, optional</span></dt><dd><p>See <cite>MLEResults.fit</cite> for a description of covariance matrix types
for results object.</p>
</dd>
<dt><strong>cov_kwds</strong><span class="classifier">dict or None, optional</span></dt><dd><p>See <cite>MLEResults.get_robustcov_results</cite> for a description required
keywords for alternative covariance estimators</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments to pass to the Kalman filter. See
<cite>KalmanFilter.filter</cite> for more details.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.start_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">start_params</span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.start_params" title="Link to this definition">¶</a></dt>
<dd><p>(array) Starting parameters for maximum likelihood estimation.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.state_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">state_names</span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.state_names" title="Link to this definition">¶</a></dt>
<dd><p>(list of str) List of human readable names for unobserved states.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.tolerance">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tolerance</span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.tolerance" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.transform_jacobian">
<span class="sig-name descname"><span class="pre">transform_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unconstrained</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.transform_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.transform_jacobian" title="Link to this definition">¶</a></dt>
<dd><p>Jacobian matrix for the parameter transformation function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>unconstrained</strong><span class="classifier">array_like</span></dt><dd><p>Array of unconstrained parameters used by the optimizer.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>jacobian</strong><span class="classifier">ndarray</span></dt><dd><p>Jacobian matrix of the transformation, evaluated at <cite>unconstrained</cite></p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#vtools.functions.neighbor_fill.MLEModel.transform_params" title="vtools.functions.neighbor_fill.MLEModel.transform_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_params</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This is a numerical approximation using finite differences. Note that
in general complex step methods cannot be used because it is not
guaranteed that the <cite>transform_params</cite> method is a real function (e.g.
if Cholesky decomposition is used).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.transform_params">
<span class="sig-name descname"><span class="pre">transform_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unconstrained</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.transform_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.transform_params" title="Link to this definition">¶</a></dt>
<dd><p>Transform unconstrained parameters used by the optimizer to constrained
parameters used in likelihood evaluation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>unconstrained</strong><span class="classifier">array_like</span></dt><dd><p>Array of unconstrained parameters used by the optimizer, to be
transformed.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>constrained</strong><span class="classifier">array_like</span></dt><dd><p>Array of constrained parameters which may be used in likelihood
evaluation.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is a noop in the base class, subclasses should override where
appropriate.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.untransform_params">
<span class="sig-name descname"><span class="pre">untransform_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">constrained</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.untransform_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.untransform_params" title="Link to this definition">¶</a></dt>
<dd><p>Transform constrained parameters used in likelihood evaluation
to unconstrained parameters used by the optimizer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>constrained</strong><span class="classifier">array_like</span></dt><dd><p>Array of constrained parameters used in likelihood evaluation, to
be transformed.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>unconstrained</strong><span class="classifier">array_like</span></dt><dd><p>Array of unconstrained parameters used by the optimizer.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is a noop in the base class, subclasses should override where
appropriate.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.MLEModel.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">includes_fixed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complex_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/tsa/statespace/mlemodel.html#MLEModel.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.MLEModel.update" title="Link to this definition">¶</a></dt>
<dd><p>Update the parameters of the model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like</span></dt><dd><p>Array of new parameters.</p>
</dd>
<dt><strong>transformed</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not <cite>params</cite> is already transformed. If set to False,
<cite>transform_params</cite> is called. Default is True.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like</span></dt><dd><p>Array of parameters.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Since Model is a base class, this method should be overridden by
subclasses to perform actual updating steps.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_BaseComposition</span></code></p>
<p>A sequence of data transformers with an optional final predictor.</p>
<p><cite>Pipeline</cite> allows you to sequentially apply a list of transformers to
preprocess the data and, if desired, conclude the sequence with a final
<span class="xref std std-term">predictor</span> for predictive modeling.</p>
<p>Intermediate steps of the pipeline must be ‘transforms’, that is, they
must implement <cite>fit</cite> and <cite>transform</cite> methods.
The final <span class="xref std std-term">estimator</span> only needs to implement <cite>fit</cite>.
The transformers in the pipeline can be cached using <code class="docutils literal notranslate"><span class="pre">memory</span></code> argument.</p>
<p>The purpose of the pipeline is to assemble several steps that can be
cross-validated together while setting different parameters. For this, it
enables setting parameters of the various steps using their names and the
parameter name separated by a <cite>‘__’</cite>, as in the example below. A step’s
estimator may be replaced entirely by setting the parameter with its name
to another estimator, or a transformer removed by setting it to
<cite>‘passthrough’</cite> or <cite>None</cite>.</p>
<p>For an example use case of <cite>Pipeline</cite> combined with
<code class="xref py py-class docutils literal notranslate"><span class="pre">GridSearchCV</span></code>, refer to
<span class="xref std std-ref">sphx_glr_auto_examples_compose_plot_compare_reduction.py</span>. The
example <span class="xref std std-ref">sphx_glr_auto_examples_compose_plot_digits_pipe.py</span> shows how
to grid search on a pipeline using <cite>‘__’</cite> as a separator in the parameter names.</p>
<p>Read more in the <span class="xref std std-ref">User Guide</span>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.5.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>steps</strong><span class="classifier">list of tuples</span></dt><dd><p>List of (name of step, estimator) tuples that are to be chained in
sequential order. To be compatible with the scikit-learn API, all steps
must define <cite>fit</cite>. All non-last steps must also define <cite>transform</cite>. See
<span class="xref std std-ref">Combining Estimators</span> for more details.</p>
</dd>
<dt><strong>memory</strong><span class="classifier">str or object with the joblib.Memory interface, default=None</span></dt><dd><p>Used to cache the fitted transformers of the pipeline. The last step
will never be cached, even if it is a transformer. By default, no
caching is performed. If a string is given, it is the path to the
caching directory. Enabling caching triggers a clone of the transformers
before fitting. Therefore, the transformer instance given to the
pipeline cannot be inspected directly. Use the attribute <code class="docutils literal notranslate"><span class="pre">named_steps</span></code>
or <code class="docutils literal notranslate"><span class="pre">steps</span></code> to inspect estimators within the pipeline. Caching the
transformers is advantageous when fitting is time consuming.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool, default=False</span></dt><dd><p>If True, the time elapsed while fitting each step will be printed as it
is completed.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_pipeline</span></code></dt><dd><p>Convenience function for simplified pipeline construction.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
<span class="gp">... </span>                                                    <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;svc&#39;</span><span class="p">,</span> <span class="n">SVC</span><span class="p">())])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The pipeline can be used as any other estimator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># and avoids leaking the test set into the train set</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="go">0.88</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># An estimator&#39;s parameter can be set using &#39;__&#39; syntax</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pipe</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">svc__C</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="go">0.76</span>
</pre></div>
</div>
<dl class="field-list">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.named_steps" title="vtools.functions.neighbor_fill.Pipeline.named_steps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_steps</span></code></a><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bunch</span></code></span></dt><dd><p>Access the steps by name.</p>
</dd>
<dt><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.classes_" title="vtools.functions.neighbor_fill.Pipeline.classes_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">classes_</span></code></a><span class="classifier">ndarray of shape (n_classes,)</span></dt><dd><p>The classes labels.</p>
</dd>
<dt><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.n_features_in_" title="vtools.functions.neighbor_fill.Pipeline.n_features_in_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_features_in_</span></code></a><span class="classifier">int</span></dt><dd><p>Number of features seen during first step <cite>fit</cite> method.</p>
</dd>
<dt><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.feature_names_in_" title="vtools.functions.neighbor_fill.Pipeline.feature_names_in_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">feature_names_in_</span></code></a><span class="classifier">ndarray of shape (<cite>n_features_in_</cite>,)</span></dt><dd><p>Names of features seen during first step <cite>fit</cite> method.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.decision_function" title="vtools.functions.neighbor_fill.Pipeline.decision_function"><code class="xref py py-obj docutils literal notranslate"><span class="pre">decision_function</span></code></a>(X, **params)</p></td>
<td><p>Transform the data, and apply <cite>decision_function</cite> with the final estimator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.fit" title="vtools.functions.neighbor_fill.Pipeline.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(X[, y])</p></td>
<td><p>Fit the model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.fit_predict" title="vtools.functions.neighbor_fill.Pipeline.fit_predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_predict</span></code></a>(X[, y])</p></td>
<td><p>Transform the data, and apply <cite>fit_predict</cite> with the final estimator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.fit_transform" title="vtools.functions.neighbor_fill.Pipeline.fit_transform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_transform</span></code></a>(X[, y])</p></td>
<td><p>Fit the model and transform with the final estimator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.get_feature_names_out" title="vtools.functions.neighbor_fill.Pipeline.get_feature_names_out"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_feature_names_out</span></code></a>([input_features])</p></td>
<td><p>Get output feature names for transformation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.get_metadata_routing" title="vtools.functions.neighbor_fill.Pipeline.get_metadata_routing"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_metadata_routing</span></code></a>()</p></td>
<td><p>Get metadata routing of this object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.get_params" title="vtools.functions.neighbor_fill.Pipeline.get_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_params</span></code></a>([deep])</p></td>
<td><p>Get parameters for this estimator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.inverse_transform" title="vtools.functions.neighbor_fill.Pipeline.inverse_transform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inverse_transform</span></code></a>(Xt, **params)</p></td>
<td><p>Apply <cite>inverse_transform</cite> for each step in a reverse order.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.predict" title="vtools.functions.neighbor_fill.Pipeline.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(X, **params)</p></td>
<td><p>Transform the data, and apply <cite>predict</cite> with the final estimator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.predict_log_proba" title="vtools.functions.neighbor_fill.Pipeline.predict_log_proba"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_log_proba</span></code></a>(X, **params)</p></td>
<td><p>Transform the data, and apply <cite>predict_log_proba</cite> with the final estimator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.predict_proba" title="vtools.functions.neighbor_fill.Pipeline.predict_proba"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_proba</span></code></a>(X, **params)</p></td>
<td><p>Transform the data, and apply <cite>predict_proba</cite> with the final estimator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.score" title="vtools.functions.neighbor_fill.Pipeline.score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score</span></code></a>(X[, y, sample_weight])</p></td>
<td><p>Transform the data, and apply <cite>score</cite> with the final estimator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.score_samples" title="vtools.functions.neighbor_fill.Pipeline.score_samples"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score_samples</span></code></a>(X)</p></td>
<td><p>Transform the data, and apply <cite>score_samples</cite> with the final estimator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.set_output" title="vtools.functions.neighbor_fill.Pipeline.set_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code></a>(*[, transform])</p></td>
<td><p>Set the output container when <cite>&quot;transform&quot;</cite> and <cite>&quot;fit_transform&quot;</cite> are called.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.set_params" title="vtools.functions.neighbor_fill.Pipeline.set_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code></a>(**kwargs)</p></td>
<td><p>Set the parameters of this estimator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.set_score_request" title="vtools.functions.neighbor_fill.Pipeline.set_score_request"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_score_request</span></code></a>(*[, sample_weight])</p></td>
<td><p>Request metadata passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline.transform" title="vtools.functions.neighbor_fill.Pipeline.transform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform</span></code></a>(X, **params)</p></td>
<td><p>Transform the data, and apply <cite>transform</cite> with the final estimator.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.__abstractmethods__">
<span class="sig-name descname"><span class="pre">__abstractmethods__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">frozenset({})</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.__abstractmethods__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.__annotations__">
<span class="sig-name descname"><span class="pre">__annotations__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'_parameter_constraints':</span> <span class="pre">&lt;class</span> <span class="pre">'dict'&gt;,</span> <span class="pre">'steps':</span> <span class="pre">'List[Any]'}</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.__annotations__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&quot;\n</span>&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">sequence</span> <span class="pre">of</span> <span class="pre">data</span> <span class="pre">transformers</span> <span class="pre">with</span> <span class="pre">an</span> <span class="pre">optional</span> <span class="pre">final</span> <span class="pre">predictor.\n\n</span>&#160;&#160;&#160; <span class="pre">`Pipeline`</span> <span class="pre">allows</span> <span class="pre">you</span> <span class="pre">to</span> <span class="pre">sequentially</span> <span class="pre">apply</span> <span class="pre">a</span> <span class="pre">list</span> <span class="pre">of</span> <span class="pre">transformers</span> <span class="pre">to\n</span>&#160;&#160;&#160; <span class="pre">preprocess</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">and,</span> <span class="pre">if</span> <span class="pre">desired,</span> <span class="pre">conclude</span> <span class="pre">the</span> <span class="pre">sequence</span> <span class="pre">with</span> <span class="pre">a</span> <span class="pre">final\n</span>&#160;&#160;&#160; <span class="pre">:term:`predictor`</span> <span class="pre">for</span> <span class="pre">predictive</span> <span class="pre">modeling.\n\n</span>&#160;&#160;&#160; <span class="pre">Intermediate</span> <span class="pre">steps</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">pipeline</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">'transforms',</span> <span class="pre">that</span> <span class="pre">is,</span> <span class="pre">they\n</span>&#160;&#160;&#160; <span class="pre">must</span> <span class="pre">implement</span> <span class="pre">`fit`</span> <span class="pre">and</span> <span class="pre">`transform`</span> <span class="pre">methods.\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">final</span> <span class="pre">:term:`estimator`</span> <span class="pre">only</span> <span class="pre">needs</span> <span class="pre">to</span> <span class="pre">implement</span> <span class="pre">`fit`.\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">transformers</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">pipeline</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">cached</span> <span class="pre">using</span> <span class="pre">``memory``</span> <span class="pre">argument.\n\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">purpose</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">pipeline</span> <span class="pre">is</span> <span class="pre">to</span> <span class="pre">assemble</span> <span class="pre">several</span> <span class="pre">steps</span> <span class="pre">that</span> <span class="pre">can</span> <span class="pre">be\n</span>&#160;&#160;&#160; <span class="pre">cross-validated</span> <span class="pre">together</span> <span class="pre">while</span> <span class="pre">setting</span> <span class="pre">different</span> <span class="pre">parameters.</span> <span class="pre">For</span> <span class="pre">this,</span> <span class="pre">it\n</span>&#160;&#160;&#160; <span class="pre">enables</span> <span class="pre">setting</span> <span class="pre">parameters</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">various</span> <span class="pre">steps</span> <span class="pre">using</span> <span class="pre">their</span> <span class="pre">names</span> <span class="pre">and</span> <span class="pre">the\n</span>&#160;&#160;&#160; <span class="pre">parameter</span> <span class="pre">name</span> <span class="pre">separated</span> <span class="pre">by</span> <span class="pre">a</span> <span class="pre">`'__'`,</span> <span class="pre">as</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">example</span> <span class="pre">below.</span> <span class="pre">A</span> <span class="pre">step's\n</span>&#160;&#160;&#160; <span class="pre">estimator</span> <span class="pre">may</span> <span class="pre">be</span> <span class="pre">replaced</span> <span class="pre">entirely</span> <span class="pre">by</span> <span class="pre">setting</span> <span class="pre">the</span> <span class="pre">parameter</span> <span class="pre">with</span> <span class="pre">its</span> <span class="pre">name\n</span>&#160;&#160;&#160; <span class="pre">to</span> <span class="pre">another</span> <span class="pre">estimator,</span> <span class="pre">or</span> <span class="pre">a</span> <span class="pre">transformer</span> <span class="pre">removed</span> <span class="pre">by</span> <span class="pre">setting</span> <span class="pre">it</span> <span class="pre">to\n</span>&#160;&#160;&#160; <span class="pre">`'passthrough'`</span> <span class="pre">or</span> <span class="pre">`None`.\n\n</span>&#160;&#160;&#160; <span class="pre">For</span> <span class="pre">an</span> <span class="pre">example</span> <span class="pre">use</span> <span class="pre">case</span> <span class="pre">of</span> <span class="pre">`Pipeline`</span> <span class="pre">combined</span> <span class="pre">with\n</span>&#160;&#160;&#160; <span class="pre">:class:`~sklearn.model_selection.GridSearchCV`,</span> <span class="pre">refer</span> <span class="pre">to\n</span>&#160;&#160;&#160; <span class="pre">:ref:`sphx_glr_auto_examples_compose_plot_compare_reduction.py`.</span> <span class="pre">The\n</span>&#160;&#160;&#160; <span class="pre">example</span> <span class="pre">:ref:`sphx_glr_auto_examples_compose_plot_digits_pipe.py`</span> <span class="pre">shows</span> <span class="pre">how\n</span>&#160;&#160;&#160; <span class="pre">to</span> <span class="pre">grid</span> <span class="pre">search</span> <span class="pre">on</span> <span class="pre">a</span> <span class="pre">pipeline</span> <span class="pre">using</span> <span class="pre">`'__'`</span> <span class="pre">as</span> <span class="pre">a</span> <span class="pre">separator</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">parameter</span> <span class="pre">names.\n\n</span>&#160;&#160;&#160; <span class="pre">Read</span> <span class="pre">more</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">:ref:`User</span> <span class="pre">Guide</span> <span class="pre">&lt;pipeline&gt;`.\n\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">0.5\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">steps</span> <span class="pre">:</span> <span class="pre">list</span> <span class="pre">of</span> <span class="pre">tuples\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">List</span> <span class="pre">of</span> <span class="pre">(name</span> <span class="pre">of</span> <span class="pre">step,</span> <span class="pre">estimator)</span> <span class="pre">tuples</span> <span class="pre">that</span> <span class="pre">are</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">chained</span> <span class="pre">in\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">sequential</span> <span class="pre">order.</span> <span class="pre">To</span> <span class="pre">be</span> <span class="pre">compatible</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">scikit-learn</span> <span class="pre">API,</span> <span class="pre">all</span> <span class="pre">steps\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">must</span> <span class="pre">define</span> <span class="pre">`fit`.</span> <span class="pre">All</span> <span class="pre">non-last</span> <span class="pre">steps</span> <span class="pre">must</span> <span class="pre">also</span> <span class="pre">define</span> <span class="pre">`transform`.</span> <span class="pre">See\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">:ref:`Combining</span> <span class="pre">Estimators</span> <span class="pre">&lt;combining_estimators&gt;`</span> <span class="pre">for</span> <span class="pre">more</span> <span class="pre">details.\n\n</span>&#160;&#160;&#160; <span class="pre">memory</span> <span class="pre">:</span> <span class="pre">str</span> <span class="pre">or</span> <span class="pre">object</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">joblib.Memory</span> <span class="pre">interface,</span> <span class="pre">default=None\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Used</span> <span class="pre">to</span> <span class="pre">cache</span> <span class="pre">the</span> <span class="pre">fitted</span> <span class="pre">transformers</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">pipeline.</span> <span class="pre">The</span> <span class="pre">last</span> <span class="pre">step\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">will</span> <span class="pre">never</span> <span class="pre">be</span> <span class="pre">cached,</span> <span class="pre">even</span> <span class="pre">if</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">transformer.</span> <span class="pre">By</span> <span class="pre">default,</span> <span class="pre">no\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">caching</span> <span class="pre">is</span> <span class="pre">performed.</span> <span class="pre">If</span> <span class="pre">a</span> <span class="pre">string</span> <span class="pre">is</span> <span class="pre">given,</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">path</span> <span class="pre">to</span> <span class="pre">the\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">caching</span> <span class="pre">directory.</span> <span class="pre">Enabling</span> <span class="pre">caching</span> <span class="pre">triggers</span> <span class="pre">a</span> <span class="pre">clone</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">transformers\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">before</span> <span class="pre">fitting.</span> <span class="pre">Therefore,</span> <span class="pre">the</span> <span class="pre">transformer</span> <span class="pre">instance</span> <span class="pre">given</span> <span class="pre">to</span> <span class="pre">the\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">pipeline</span> <span class="pre">cannot</span> <span class="pre">be</span> <span class="pre">inspected</span> <span class="pre">directly.</span> <span class="pre">Use</span> <span class="pre">the</span> <span class="pre">attribute</span> <span class="pre">``named_steps``\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">or</span> <span class="pre">``steps``</span> <span class="pre">to</span> <span class="pre">inspect</span> <span class="pre">estimators</span> <span class="pre">within</span> <span class="pre">the</span> <span class="pre">pipeline.</span> <span class="pre">Caching</span> <span class="pre">the\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">transformers</span> <span class="pre">is</span> <span class="pre">advantageous</span> <span class="pre">when</span> <span class="pre">fitting</span> <span class="pre">is</span> <span class="pre">time</span> <span class="pre">consuming.\n\n</span>&#160;&#160;&#160; <span class="pre">verbose</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">default=False\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">True,</span> <span class="pre">the</span> <span class="pre">time</span> <span class="pre">elapsed</span> <span class="pre">while</span> <span class="pre">fitting</span> <span class="pre">each</span> <span class="pre">step</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">printed</span> <span class="pre">as</span> <span class="pre">it\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">is</span> <span class="pre">completed.\n\n</span>&#160;&#160;&#160; <span class="pre">Attributes\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">named_steps</span> <span class="pre">:</span> <span class="pre">:class:`~sklearn.utils.Bunch`\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Dictionary-like</span> <span class="pre">object,</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">attributes.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Read-only</span> <span class="pre">attribute</span> <span class="pre">to</span> <span class="pre">access</span> <span class="pre">any</span> <span class="pre">step</span> <span class="pre">parameter</span> <span class="pre">by</span> <span class="pre">user</span> <span class="pre">given</span> <span class="pre">name.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Keys</span> <span class="pre">are</span> <span class="pre">step</span> <span class="pre">names</span> <span class="pre">and</span> <span class="pre">values</span> <span class="pre">are</span> <span class="pre">steps</span> <span class="pre">parameters.\n\n</span>&#160;&#160;&#160; <span class="pre">classes_</span> <span class="pre">:</span> <span class="pre">ndarray</span> <span class="pre">of</span> <span class="pre">shape</span> <span class="pre">(n_classes,)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">classes</span> <span class="pre">labels.</span> <span class="pre">Only</span> <span class="pre">exist</span> <span class="pre">if</span> <span class="pre">the</span> <span class="pre">last</span> <span class="pre">step</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">pipeline</span> <span class="pre">is</span> <span class="pre">a\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">classifier.\n\n</span>&#160;&#160;&#160; <span class="pre">n_features_in_</span> <span class="pre">:</span> <span class="pre">int\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Number</span> <span class="pre">of</span> <span class="pre">features</span> <span class="pre">seen</span> <span class="pre">during</span> <span class="pre">:term:`fit`.</span> <span class="pre">Only</span> <span class="pre">defined</span> <span class="pre">if</span> <span class="pre">the\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">underlying</span> <span class="pre">first</span> <span class="pre">estimator</span> <span class="pre">in</span> <span class="pre">`steps`</span> <span class="pre">exposes</span> <span class="pre">such</span> <span class="pre">an</span> <span class="pre">attribute\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">when</span> <span class="pre">fit.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">0.24\n\n</span>&#160;&#160;&#160; <span class="pre">feature_names_in_</span> <span class="pre">:</span> <span class="pre">ndarray</span> <span class="pre">of</span> <span class="pre">shape</span> <span class="pre">(`n_features_in_`,)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Names</span> <span class="pre">of</span> <span class="pre">features</span> <span class="pre">seen</span> <span class="pre">during</span> <span class="pre">:term:`fit`.</span> <span class="pre">Only</span> <span class="pre">defined</span> <span class="pre">if</span> <span class="pre">the\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">underlying</span> <span class="pre">estimator</span> <span class="pre">exposes</span> <span class="pre">such</span> <span class="pre">an</span> <span class="pre">attribute</span> <span class="pre">when</span> <span class="pre">fit.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">1.0\n\n</span>&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">Also\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">make_pipeline</span> <span class="pre">:</span> <span class="pre">Convenience</span> <span class="pre">function</span> <span class="pre">for</span> <span class="pre">simplified</span> <span class="pre">pipeline</span> <span class="pre">construction.\n\n</span>&#160;&#160;&#160; <span class="pre">Examples\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">from</span> <span class="pre">sklearn.svm</span> <span class="pre">import</span> <span class="pre">SVC\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">from</span> <span class="pre">sklearn.preprocessing</span> <span class="pre">import</span> <span class="pre">StandardScaler\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">from</span> <span class="pre">sklearn.datasets</span> <span class="pre">import</span> <span class="pre">make_classification\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">from</span> <span class="pre">sklearn.model_selection</span> <span class="pre">import</span> <span class="pre">train_test_split\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">from</span> <span class="pre">sklearn.pipeline</span> <span class="pre">import</span> <span class="pre">Pipeline\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">X,</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">make_classification(random_state=0)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">X_train,</span> <span class="pre">X_test,</span> <span class="pre">y_train,</span> <span class="pre">y_test</span> <span class="pre">=</span> <span class="pre">train_test_split(X,</span> <span class="pre">y,\n</span>&#160;&#160;&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">random_state=0)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">pipe</span> <span class="pre">=</span> <span class="pre">Pipeline([('scaler',</span> <span class="pre">StandardScaler()),</span> <span class="pre">('svc',</span> <span class="pre">SVC())])\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">#</span> <span class="pre">The</span> <span class="pre">pipeline</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">used</span> <span class="pre">as</span> <span class="pre">any</span> <span class="pre">other</span> <span class="pre">estimator\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">#</span> <span class="pre">and</span> <span class="pre">avoids</span> <span class="pre">leaking</span> <span class="pre">the</span> <span class="pre">test</span> <span class="pre">set</span> <span class="pre">into</span> <span class="pre">the</span> <span class="pre">train</span> <span class="pre">set\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">pipe.fit(X_train,</span> <span class="pre">y_train).score(X_test,</span> <span class="pre">y_test)\n</span>&#160;&#160;&#160; <span class="pre">0.88\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">#</span> <span class="pre">An</span> <span class="pre">estimator's</span> <span class="pre">parameter</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">set</span> <span class="pre">using</span> <span class="pre">'__'</span> <span class="pre">syntax\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">pipe.set_params(svc__C=10).fit(X_train,</span> <span class="pre">y_train).score(X_test,</span> <span class="pre">y_test)\n</span>&#160;&#160;&#160; <span class="pre">0.76\n</span>&#160;&#160;&#160; <span class="pre">&quot;</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.__getitem__">
<span class="sig-name descname"><span class="pre">__getitem__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ind</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.__getitem__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.__getitem__" title="Link to this definition">¶</a></dt>
<dd><p>Returns a sub-pipeline or a single estimator in the pipeline</p>
<p>Indexing with an integer will return an estimator; using a slice
returns another Pipeline instance which copies a slice of this
Pipeline. This copy is shallow: modifying (or fitting) estimators in
the sub-pipeline will affect the larger pipeline and vice-versa.
However, replacing a value in <cite>step</cite> will not affect a copy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.__len__">
<span class="sig-name descname"><span class="pre">__len__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.__len__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.__len__" title="Link to this definition">¶</a></dt>
<dd><p>Returns the length of the Pipeline</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sklearn.pipeline'</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.__sklearn_is_fitted__">
<span class="sig-name descname"><span class="pre">__sklearn_is_fitted__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.__sklearn_is_fitted__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.__sklearn_is_fitted__" title="Link to this definition">¶</a></dt>
<dd><p>Indicate whether pipeline has been fit.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc._abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline._abc_impl" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline._can_fit_transform">
<span class="sig-name descname"><span class="pre">_can_fit_transform</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline._can_fit_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline._can_fit_transform" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline._can_inverse_transform">
<span class="sig-name descname"><span class="pre">_can_inverse_transform</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline._can_inverse_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline._can_inverse_transform" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline._can_transform">
<span class="sig-name descname"><span class="pre">_can_transform</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline._can_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline._can_transform" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline._check_method_params">
<span class="sig-name descname"><span class="pre">_check_method_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">props</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline._check_method_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline._check_method_params" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline._estimator_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_estimator_type</span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline._estimator_type" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline._final_estimator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_final_estimator</span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline._final_estimator" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline._fit">
<span class="sig-name descname"><span class="pre">_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">routed_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline._fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline._fit" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline._iter">
<span class="sig-name descname"><span class="pre">_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_final</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_passthrough</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline._iter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline._iter" title="Link to this definition">¶</a></dt>
<dd><p>Generate (idx, (name, trans)) tuples from self.steps</p>
<p>When filter_passthrough is True, ‘passthrough’ and None transformers
are filtered out.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline._log_message">
<span class="sig-name descname"><span class="pre">_log_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline._log_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline._log_message" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline._more_tags">
<span class="sig-name descname"><span class="pre">_more_tags</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline._more_tags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline._more_tags" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline._parameter_constraints">
<span class="sig-name descname"><span class="pre">_parameter_constraints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'memory':</span> <span class="pre">[None,</span> <span class="pre">&lt;class</span> <span class="pre">'str'&gt;,</span> <span class="pre">&lt;sklearn.utils._param_validation.HasMethods</span> <span class="pre">object&gt;],</span> <span class="pre">'steps':</span> <span class="pre">[&lt;class</span> <span class="pre">'list'&gt;,</span> <span class="pre">&lt;sklearn.utils._param_validation.Hidden</span> <span class="pre">object&gt;],</span> <span class="pre">'verbose':</span> <span class="pre">['boolean']}</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline._parameter_constraints" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline._required_parameters">
<span class="sig-name descname"><span class="pre">_required_parameters</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['steps']</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline._required_parameters" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline._sk_visual_block_">
<span class="sig-name descname"><span class="pre">_sk_visual_block_</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline._sk_visual_block_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline._sk_visual_block_" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline._validate_steps">
<span class="sig-name descname"><span class="pre">_validate_steps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline._validate_steps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline._validate_steps" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.classes_">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">classes_</span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.classes_" title="Link to this definition">¶</a></dt>
<dd><p>The classes labels. Only exist if the last step is a classifier.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.decision_function">
<span class="sig-name descname"><span class="pre">decision_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.decision_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.decision_function" title="Link to this definition">¶</a></dt>
<dd><p>Transform the data, and apply <cite>decision_function</cite> with the final estimator.</p>
<p>Call <cite>transform</cite> of each transformer in the pipeline. The transformed
data are finally passed to the final estimator that calls
<cite>decision_function</cite> method. Only valid if the final estimator
implements <cite>decision_function</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>X</strong><span class="classifier">iterable</span></dt><dd><p>Data to predict on. Must fulfill input requirements of first step
of the pipeline.</p>
</dd>
<dt><strong>**params</strong><span class="classifier">dict of string -&gt; object</span></dt><dd><p>Parameters requested and accepted by steps. Each step must have
requested certain metadata for these parameters to be forwarded to
them.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.4: </span>Only available if <cite>enable_metadata_routing=True</cite>. See
<span class="xref std std-ref">Metadata Routing User Guide</span> for more
details.</p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y_score</strong><span class="classifier">ndarray of shape (n_samples, n_classes)</span></dt><dd><p>Result of calling <cite>decision_function</cite> on the final estimator.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.feature_names_in_">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">feature_names_in_</span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.feature_names_in_" title="Link to this definition">¶</a></dt>
<dd><p>Names of features seen during first step <cite>fit</cite> method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.fit" title="Link to this definition">¶</a></dt>
<dd><p>Fit the model.</p>
<p>Fit all the transformers one after the other and sequentially transform the
data. Finally, fit the transformed data using the final estimator.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>X</strong><span class="classifier">iterable</span></dt><dd><p>Training data. Must fulfill input requirements of first step of the
pipeline.</p>
</dd>
<dt><strong>y</strong><span class="classifier">iterable, default=None</span></dt><dd><p>Training targets. Must fulfill label requirements for all steps of
the pipeline.</p>
</dd>
<dt><strong>**params</strong><span class="classifier">dict of str -&gt; object</span></dt><dd><ul>
<li><p>If <cite>enable_metadata_routing=False</cite> (default):</p>
<blockquote>
<div><p>Parameters passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method of each step, where
each parameter name is prefixed such that parameter <code class="docutils literal notranslate"><span class="pre">p</span></code> for step
<code class="docutils literal notranslate"><span class="pre">s</span></code> has key <code class="docutils literal notranslate"><span class="pre">s__p</span></code>.</p>
</div></blockquote>
</li>
<li><p>If <cite>enable_metadata_routing=True</cite>:</p>
<blockquote>
<div><p>Parameters requested and accepted by steps. Each step must have
requested certain metadata for these parameters to be forwarded to
them.</p>
</div></blockquote>
</li>
</ul>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4: </span>Parameters are now passed to the <code class="docutils literal notranslate"><span class="pre">transform</span></code> method of the
intermediate steps as well, if requested, and if
<cite>enable_metadata_routing=True</cite> is set via
<code class="xref py py-func docutils literal notranslate"><span class="pre">set_config()</span></code>.</p>
</div>
<p>See <span class="xref std std-ref">Metadata Routing User Guide</span> for more
details.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>self</strong><span class="classifier">object</span></dt><dd><p>Pipeline with fitted steps.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.fit_predict" title="Link to this definition">¶</a></dt>
<dd><p>Transform the data, and apply <cite>fit_predict</cite> with the final estimator.</p>
<p>Call <cite>fit_transform</cite> of each transformer in the pipeline. The
transformed data are finally passed to the final estimator that calls
<cite>fit_predict</cite> method. Only valid if the final estimator implements
<cite>fit_predict</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>X</strong><span class="classifier">iterable</span></dt><dd><p>Training data. Must fulfill input requirements of first step of
the pipeline.</p>
</dd>
<dt><strong>y</strong><span class="classifier">iterable, default=None</span></dt><dd><p>Training targets. Must fulfill label requirements for all steps
of the pipeline.</p>
</dd>
<dt><strong>**params</strong><span class="classifier">dict of str -&gt; object</span></dt><dd><ul>
<li><p>If <cite>enable_metadata_routing=False</cite> (default):</p>
<blockquote>
<div><p>Parameters to the <code class="docutils literal notranslate"><span class="pre">predict</span></code> called at the end of all
transformations in the pipeline.</p>
</div></blockquote>
</li>
<li><p>If <cite>enable_metadata_routing=True</cite>:</p>
<blockquote>
<div><p>Parameters requested and accepted by steps. Each step must have
requested certain metadata for these parameters to be forwarded to
them.</p>
</div></blockquote>
</li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4: </span>Parameters are now passed to the <code class="docutils literal notranslate"><span class="pre">transform</span></code> method of the
intermediate steps as well, if requested, and if
<cite>enable_metadata_routing=True</cite>.</p>
</div>
<p>See <span class="xref std std-ref">Metadata Routing User Guide</span> for more
details.</p>
<p>Note that while this may be used to return uncertainties from some
models with <code class="docutils literal notranslate"><span class="pre">return_std</span></code> or <code class="docutils literal notranslate"><span class="pre">return_cov</span></code>, uncertainties that are
generated by the transformations in the pipeline are not propagated
to the final estimator.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y_pred</strong><span class="classifier">ndarray</span></dt><dd><p>Result of calling <cite>fit_predict</cite> on the final estimator.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.fit_transform">
<span class="sig-name descname"><span class="pre">fit_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.fit_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.fit_transform" title="Link to this definition">¶</a></dt>
<dd><p>Fit the model and transform with the final estimator.</p>
<p>Fit all the transformers one after the other and sequentially transform
the data. Only valid if the final estimator either implements
<cite>fit_transform</cite> or <cite>fit</cite> and <cite>transform</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>X</strong><span class="classifier">iterable</span></dt><dd><p>Training data. Must fulfill input requirements of first step of the
pipeline.</p>
</dd>
<dt><strong>y</strong><span class="classifier">iterable, default=None</span></dt><dd><p>Training targets. Must fulfill label requirements for all steps of
the pipeline.</p>
</dd>
<dt><strong>**params</strong><span class="classifier">dict of str -&gt; object</span></dt><dd><ul>
<li><p>If <cite>enable_metadata_routing=False</cite> (default):</p>
<blockquote>
<div><p>Parameters passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method of each step, where
each parameter name is prefixed such that parameter <code class="docutils literal notranslate"><span class="pre">p</span></code> for step
<code class="docutils literal notranslate"><span class="pre">s</span></code> has key <code class="docutils literal notranslate"><span class="pre">s__p</span></code>.</p>
</div></blockquote>
</li>
<li><p>If <cite>enable_metadata_routing=True</cite>:</p>
<blockquote>
<div><p>Parameters requested and accepted by steps. Each step must have
requested certain metadata for these parameters to be forwarded to
them.</p>
</div></blockquote>
</li>
</ul>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4: </span>Parameters are now passed to the <code class="docutils literal notranslate"><span class="pre">transform</span></code> method of the
intermediate steps as well, if requested, and if
<cite>enable_metadata_routing=True</cite>.</p>
</div>
<p>See <span class="xref std std-ref">Metadata Routing User Guide</span> for more
details.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Xt</strong><span class="classifier">ndarray of shape (n_samples, n_transformed_features)</span></dt><dd><p>Transformed samples.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.get_feature_names_out">
<span class="sig-name descname"><span class="pre">get_feature_names_out</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.get_feature_names_out"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.get_feature_names_out" title="Link to this definition">¶</a></dt>
<dd><p>Get output feature names for transformation.</p>
<p>Transform input features using the pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>input_features</strong><span class="classifier">array-like of str or None, default=None</span></dt><dd><p>Input features.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>feature_names_out</strong><span class="classifier">ndarray of str objects</span></dt><dd><p>Transformed feature names.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.get_metadata_routing">
<span class="sig-name descname"><span class="pre">get_metadata_routing</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.get_metadata_routing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.get_metadata_routing" title="Link to this definition">¶</a></dt>
<dd><p>Get metadata routing of this object.</p>
<p>Please check <span class="xref std std-ref">User Guide</span> on how the routing
mechanism works.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>routing</strong><span class="classifier">MetadataRouter</span></dt><dd><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">MetadataRouter</span></code> encapsulating
routing information.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.get_params" title="Link to this definition">¶</a></dt>
<dd><p>Get parameters for this estimator.</p>
<p>Returns the parameters given in the constructor as well as the
estimators contained within the <cite>steps</cite> of the <cite>Pipeline</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>deep</strong><span class="classifier">bool, default=True</span></dt><dd><p>If True, will return the parameters for this estimator and
contained subobjects that are estimators.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>params</strong><span class="classifier">mapping of string to any</span></dt><dd><p>Parameter names mapped to their values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.inverse_transform">
<span class="sig-name descname"><span class="pre">inverse_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xt</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.inverse_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.inverse_transform" title="Link to this definition">¶</a></dt>
<dd><p>Apply <cite>inverse_transform</cite> for each step in a reverse order.</p>
<p>All estimators in the pipeline must support <cite>inverse_transform</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>Xt</strong><span class="classifier">array-like of shape (n_samples, n_transformed_features)</span></dt><dd><p>Data samples, where <code class="docutils literal notranslate"><span class="pre">n_samples</span></code> is the number of samples and
<code class="docutils literal notranslate"><span class="pre">n_features</span></code> is the number of features. Must fulfill
input requirements of last step of pipeline’s
<code class="docutils literal notranslate"><span class="pre">inverse_transform</span></code> method.</p>
</dd>
<dt><strong>**params</strong><span class="classifier">dict of str -&gt; object</span></dt><dd><p>Parameters requested and accepted by steps. Each step must have
requested certain metadata for these parameters to be forwarded to
them.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.4: </span>Only available if <cite>enable_metadata_routing=True</cite>. See
<span class="xref std std-ref">Metadata Routing User Guide</span> for more
details.</p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Xt</strong><span class="classifier">ndarray of shape (n_samples, n_features)</span></dt><dd><p>Inverse transformed data, that is, data in the original feature
space.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.n_features_in_">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_features_in_</span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.n_features_in_" title="Link to this definition">¶</a></dt>
<dd><p>Number of features seen during first step <cite>fit</cite> method.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.named_steps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">named_steps</span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.named_steps" title="Link to this definition">¶</a></dt>
<dd><p>Access the steps by name.</p>
<p>Read-only attribute to access any step by given name.
Keys are steps names and values are the steps objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.predict" title="Link to this definition">¶</a></dt>
<dd><p>Transform the data, and apply <cite>predict</cite> with the final estimator.</p>
<p>Call <cite>transform</cite> of each transformer in the pipeline. The transformed
data are finally passed to the final estimator that calls <cite>predict</cite>
method. Only valid if the final estimator implements <cite>predict</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>X</strong><span class="classifier">iterable</span></dt><dd><p>Data to predict on. Must fulfill input requirements of first step
of the pipeline.</p>
</dd>
<dt><strong>**params</strong><span class="classifier">dict of str -&gt; object</span></dt><dd><ul>
<li><p>If <cite>enable_metadata_routing=False</cite> (default):</p>
<blockquote>
<div><p>Parameters to the <code class="docutils literal notranslate"><span class="pre">predict</span></code> called at the end of all
transformations in the pipeline.</p>
</div></blockquote>
</li>
<li><p>If <cite>enable_metadata_routing=True</cite>:</p>
<blockquote>
<div><p>Parameters requested and accepted by steps. Each step must have
requested certain metadata for these parameters to be forwarded to
them.</p>
</div></blockquote>
</li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4: </span>Parameters are now passed to the <code class="docutils literal notranslate"><span class="pre">transform</span></code> method of the
intermediate steps as well, if requested, and if
<cite>enable_metadata_routing=True</cite> is set via
<code class="xref py py-func docutils literal notranslate"><span class="pre">set_config()</span></code>.</p>
</div>
<p>See <span class="xref std std-ref">Metadata Routing User Guide</span> for more
details.</p>
<p>Note that while this may be used to return uncertainties from some
models with <code class="docutils literal notranslate"><span class="pre">return_std</span></code> or <code class="docutils literal notranslate"><span class="pre">return_cov</span></code>, uncertainties that are
generated by the transformations in the pipeline are not propagated
to the final estimator.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y_pred</strong><span class="classifier">ndarray</span></dt><dd><p>Result of calling <cite>predict</cite> on the final estimator.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.predict_log_proba">
<span class="sig-name descname"><span class="pre">predict_log_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.predict_log_proba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.predict_log_proba" title="Link to this definition">¶</a></dt>
<dd><p>Transform the data, and apply <cite>predict_log_proba</cite> with the final estimator.</p>
<p>Call <cite>transform</cite> of each transformer in the pipeline. The transformed
data are finally passed to the final estimator that calls
<cite>predict_log_proba</cite> method. Only valid if the final estimator
implements <cite>predict_log_proba</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>X</strong><span class="classifier">iterable</span></dt><dd><p>Data to predict on. Must fulfill input requirements of first step
of the pipeline.</p>
</dd>
<dt><strong>**params</strong><span class="classifier">dict of str -&gt; object</span></dt><dd><ul>
<li><p>If <cite>enable_metadata_routing=False</cite> (default):</p>
<blockquote>
<div><p>Parameters to the <cite>predict_log_proba</cite> called at the end of all
transformations in the pipeline.</p>
</div></blockquote>
</li>
<li><p>If <cite>enable_metadata_routing=True</cite>:</p>
<blockquote>
<div><p>Parameters requested and accepted by steps. Each step must have
requested certain metadata for these parameters to be forwarded to
them.</p>
</div></blockquote>
</li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4: </span>Parameters are now passed to the <code class="docutils literal notranslate"><span class="pre">transform</span></code> method of the
intermediate steps as well, if requested, and if
<cite>enable_metadata_routing=True</cite>.</p>
</div>
<p>See <span class="xref std std-ref">Metadata Routing User Guide</span> for more
details.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y_log_proba</strong><span class="classifier">ndarray of shape (n_samples, n_classes)</span></dt><dd><p>Result of calling <cite>predict_log_proba</cite> on the final estimator.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.predict_proba">
<span class="sig-name descname"><span class="pre">predict_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.predict_proba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.predict_proba" title="Link to this definition">¶</a></dt>
<dd><p>Transform the data, and apply <cite>predict_proba</cite> with the final estimator.</p>
<p>Call <cite>transform</cite> of each transformer in the pipeline. The transformed
data are finally passed to the final estimator that calls
<cite>predict_proba</cite> method. Only valid if the final estimator implements
<cite>predict_proba</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>X</strong><span class="classifier">iterable</span></dt><dd><p>Data to predict on. Must fulfill input requirements of first step
of the pipeline.</p>
</dd>
<dt><strong>**params</strong><span class="classifier">dict of str -&gt; object</span></dt><dd><ul>
<li><p>If <cite>enable_metadata_routing=False</cite> (default):</p>
<blockquote>
<div><p>Parameters to the <cite>predict_proba</cite> called at the end of all
transformations in the pipeline.</p>
</div></blockquote>
</li>
<li><p>If <cite>enable_metadata_routing=True</cite>:</p>
<blockquote>
<div><p>Parameters requested and accepted by steps. Each step must have
requested certain metadata for these parameters to be forwarded to
them.</p>
</div></blockquote>
</li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4: </span>Parameters are now passed to the <code class="docutils literal notranslate"><span class="pre">transform</span></code> method of the
intermediate steps as well, if requested, and if
<cite>enable_metadata_routing=True</cite>.</p>
</div>
<p>See <span class="xref std std-ref">Metadata Routing User Guide</span> for more
details.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y_proba</strong><span class="classifier">ndarray of shape (n_samples, n_classes)</span></dt><dd><p>Result of calling <cite>predict_proba</cite> on the final estimator.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.score" title="Link to this definition">¶</a></dt>
<dd><p>Transform the data, and apply <cite>score</cite> with the final estimator.</p>
<p>Call <cite>transform</cite> of each transformer in the pipeline. The transformed
data are finally passed to the final estimator that calls
<cite>score</cite> method. Only valid if the final estimator implements <cite>score</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>X</strong><span class="classifier">iterable</span></dt><dd><p>Data to predict on. Must fulfill input requirements of first step
of the pipeline.</p>
</dd>
<dt><strong>y</strong><span class="classifier">iterable, default=None</span></dt><dd><p>Targets used for scoring. Must fulfill label requirements for all
steps of the pipeline.</p>
</dd>
<dt><strong>sample_weight</strong><span class="classifier">array-like, default=None</span></dt><dd><p>If not None, this argument is passed as <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> keyword
argument to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method of the final estimator.</p>
</dd>
<dt><strong>**params</strong><span class="classifier">dict of str -&gt; object</span></dt><dd><p>Parameters requested and accepted by steps. Each step must have
requested certain metadata for these parameters to be forwarded to
them.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.4: </span>Only available if <cite>enable_metadata_routing=True</cite>. See
<span class="xref std std-ref">Metadata Routing User Guide</span> for more
details.</p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>score</strong><span class="classifier">float</span></dt><dd><p>Result of calling <cite>score</cite> on the final estimator.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.score_samples">
<span class="sig-name descname"><span class="pre">score_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.score_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.score_samples" title="Link to this definition">¶</a></dt>
<dd><p>Transform the data, and apply <cite>score_samples</cite> with the final estimator.</p>
<p>Call <cite>transform</cite> of each transformer in the pipeline. The transformed
data are finally passed to the final estimator that calls
<cite>score_samples</cite> method. Only valid if the final estimator implements
<cite>score_samples</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">iterable</span></dt><dd><p>Data to predict on. Must fulfill input requirements of first step
of the pipeline.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y_score</strong><span class="classifier">ndarray of shape (n_samples,)</span></dt><dd><p>Result of calling <cite>score_samples</cite> on the final estimator.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.set_output">
<span class="sig-name descname"><span class="pre">set_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.set_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.set_output" title="Link to this definition">¶</a></dt>
<dd><p>Set the output container when <cite>“transform”</cite> and <cite>“fit_transform”</cite> are called.</p>
<p>Calling <cite>set_output</cite> will set the output of all estimators in <cite>steps</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>transform</strong><span class="classifier">{“default”, “pandas”}, default=None</span></dt><dd><p>Configure output of <cite>transform</cite> and <cite>fit_transform</cite>.</p>
<ul class="simple">
<li><p><cite>“default”</cite>: Default output format of a transformer</p></li>
<li><p><cite>“pandas”</cite>: DataFrame output</p></li>
<li><p><cite>“polars”</cite>: Polars output</p></li>
<li><p><cite>None</cite>: Transform configuration is unchanged</p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.4: </span><cite>“polars”</cite> option was added.</p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>self</strong><span class="classifier">estimator instance</span></dt><dd><p>Estimator instance.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.set_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.set_params" title="Link to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>Valid parameter keys can be listed with <code class="docutils literal notranslate"><span class="pre">get_params()</span></code>. Note that
you can directly set the parameters of the estimators contained in
<cite>steps</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>**kwargs</strong><span class="classifier">dict</span></dt><dd><p>Parameters of this estimator or parameters of estimators contained
in <cite>steps</cite>. Parameters of the steps may be set using its name and
the parameter name separated by a ‘__’.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>self</strong><span class="classifier">object</span></dt><dd><p>Pipeline class instance.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.set_score_request">
<span class="sig-name descname"><span class="pre">set_score_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline" title="sklearn.pipeline.Pipeline"><span class="pre">Pipeline</span></a></span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.set_score_request" title="Link to this definition">¶</a></dt>
<dd><p>Request metadata passed to the <code class="docutils literal notranslate"><span class="pre">score</span></code> method.</p>
<p>Note that this method is only relevant if
<code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code>).
Please see <span class="xref std std-ref">User Guide</span> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">score</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3.</span></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only relevant if this estimator is used as a
sub-estimator of a meta-estimator, e.g. used inside a
<a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline" title="sklearn.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>. Otherwise it has no effect.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sample_weight</strong><span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">score</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>self</strong><span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.Pipeline.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/pipeline.html#Pipeline.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.Pipeline.transform" title="Link to this definition">¶</a></dt>
<dd><p>Transform the data, and apply <cite>transform</cite> with the final estimator.</p>
<p>Call <cite>transform</cite> of each transformer in the pipeline. The transformed
data are finally passed to the final estimator that calls
<cite>transform</cite> method. Only valid if the final estimator
implements <cite>transform</cite>.</p>
<p>This also works where final estimator is <cite>None</cite> in which case all prior
transformations are applied.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>X</strong><span class="classifier">iterable</span></dt><dd><p>Data to transform. Must fulfill input requirements of first step
of the pipeline.</p>
</dd>
<dt><strong>**params</strong><span class="classifier">dict of str -&gt; object</span></dt><dd><p>Parameters requested and accepted by steps. Each step must have
requested certain metadata for these parameters to be forwarded to
them.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.4: </span>Only available if <cite>enable_metadata_routing=True</cite>. See
<span class="xref std std-ref">Metadata Routing User Guide</span> for more
details.</p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Xt</strong><span class="classifier">ndarray of shape (n_samples, n_transformed_features)</span></dt><dd><p>Transformed data.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.RLM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RLM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">endog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/robust_linear_model.html#RLM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.RLM" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LikelihoodModel</span></code></p>
<p>Robust Linear Model</p>
<p>Estimate a robust linear model via iteratively reweighted least squares
given a robust criterion estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>endog</strong><span class="classifier">array_like</span></dt><dd><p>A 1-d endogenous response variable. The dependent variable.</p>
</dd>
<dt><strong>exog</strong><span class="classifier">array_like</span></dt><dd><p>A nobs x k array where <cite>nobs</cite> is the number of observations and <cite>k</cite>
is the number of regressors. An intercept is not included by default
and should be added by the user. See
<code class="xref py py-func docutils literal notranslate"><span class="pre">statsmodels.tools.add_constant()</span></code>.</p>
</dd>
<dt><strong>M</strong><span class="classifier">statsmodels.robust.norms.RobustNorm, optional</span></dt><dd><p>The robust criterion function for downweighting outliers.
The current options are LeastSquares, HuberT, RamsayE, AndrewWave,
TrimmedMean, Hampel, and TukeyBiweight.  The default is HuberT().
See statsmodels.robust.norms for more information.</p>
</dd>
<dt><strong>missing</strong><span class="classifier">str</span></dt><dd><p>Available options are ‘none’, ‘drop’, and ‘raise’. If ‘none’, no nan
checking is done. If ‘drop’, any observations with nans are dropped.
If ‘raise’, an error is raised. Default is ‘none’.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">stackloss</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">exog</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">exog</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rlm_model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">RLM</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">endog</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">exog</span><span class="p">,</span>                            <span class="n">M</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">robust</span><span class="o">.</span><span class="n">norms</span><span class="o">.</span><span class="n">HuberT</span><span class="p">())</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rlm_results</span> <span class="o">=</span> <span class="n">rlm_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rlm_results</span><span class="o">.</span><span class="n">params</span>
<span class="go">array([  0.82938433,   0.92606597,  -0.12784672, -41.02649835])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rlm_results</span><span class="o">.</span><span class="n">bse</span>
<span class="go">array([ 0.11100521,  0.30293016,  0.12864961,  9.79189854])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rlm_results_HC2</span> <span class="o">=</span> <span class="n">rlm_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov</span><span class="o">=</span><span class="s2">&quot;H2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rlm_results_HC2</span><span class="o">.</span><span class="n">params</span>
<span class="go">array([  0.82938433,   0.92606597,  -0.12784672, -41.02649835])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rlm_results_HC2</span><span class="o">.</span><span class="n">bse</span>
<span class="go">array([ 0.11945975,  0.32235497,  0.11796313,  9.08950419])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">RLM</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">endog</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">exog</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">robust</span><span class="o">.</span><span class="n">norms</span><span class="o">.</span><span class="n">Hampel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rlm_hamp_hub</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">scale_est</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">robust</span><span class="o">.</span><span class="n">scale</span><span class="o">.</span><span class="n">HuberScale</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rlm_hamp_hub</span><span class="o">.</span><span class="n">params</span>
<span class="go">array([  0.73175452,   1.25082038,  -0.14794399, -40.27122257])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df_model</strong><span class="classifier">float</span></dt><dd><p>The degrees of freedom of the model.  The number of regressors p less
one for the intercept.  Note that the reported model degrees
of freedom does not count the intercept as a regressor, though
the model is assumed to have an intercept.</p>
</dd>
<dt><strong>df_resid</strong><span class="classifier">float</span></dt><dd><p>The residual degrees of freedom.  The number of observations n
less the number of regressors p.  Note that here p does include
the intercept as using a degree of freedom.</p>
</dd>
<dt><strong>endog</strong><span class="classifier">ndarray</span></dt><dd><p>See above.  Note that endog is a reference to the data so that if
data is already an array and it is changed, then <cite>endog</cite> changes
as well.</p>
</dd>
<dt><strong>exog</strong><span class="classifier">ndarray</span></dt><dd><p>See above.  Note that endog is a reference to the data so that if
data is already an array and it is changed, then <cite>endog</cite> changes
as well.</p>
</dd>
<dt><strong>M</strong><span class="classifier">statsmodels.robust.norms.RobustNorm</span></dt><dd><p>See above.  Robust estimator instance instantiated.</p>
</dd>
<dt><strong>nobs</strong><span class="classifier">float</span></dt><dd><p>The number of observations n</p>
</dd>
<dt><strong>pinv_wexog</strong><span class="classifier">ndarray</span></dt><dd><p>The pseudoinverse of the design / exogenous data array.  Note that
RLM has no whiten method, so this is just the pseudo inverse of the
design.</p>
</dd>
<dt><strong>normalized_cov_params</strong><span class="classifier">ndarray</span></dt><dd><p>The p x p normalized covariance of the design / exogenous data.
This is approximately equal to (X.T X)^(-1)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.RLM.deviance" title="vtools.functions.neighbor_fill.RLM.deviance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deviance</span></code></a>(tmp_results)</p></td>
<td><p>Returns the (unnormalized) log-likelihood from the M estimator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.RLM.fit" title="vtools.functions.neighbor_fill.RLM.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>([maxiter, tol, scale_est, init, cov, ...])</p></td>
<td><p>Fits the model using iteratively reweighted least squares.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_formula</span></code>(formula, data[, subset, drop_cols])</p></td>
<td><p>Create a Model from a formula and dataframe.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">hessian</span></code>(params)</p></td>
<td><p>The Hessian matrix of the model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.RLM.information" title="vtools.functions.neighbor_fill.RLM.information"><code class="xref py py-obj docutils literal notranslate"><span class="pre">information</span></code></a>(params)</p></td>
<td><p>Fisher information matrix of model.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize</span></code>()</p></td>
<td><p>Initialize (possibly re-initialize) a Model instance.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.RLM.loglike" title="vtools.functions.neighbor_fill.RLM.loglike"><code class="xref py py-obj docutils literal notranslate"><span class="pre">loglike</span></code></a>(params)</p></td>
<td><p>Log-likelihood of model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.RLM.predict" title="vtools.functions.neighbor_fill.RLM.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(params[, exog])</p></td>
<td><p>Return linear predicted values from a design matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.RLM.score" title="vtools.functions.neighbor_fill.RLM.score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score</span></code></a>(params)</p></td>
<td><p>Score vector of model.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.RLM.__annotations__">
<span class="sig-name descname"><span class="pre">__annotations__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.RLM.__annotations__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.RLM.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'\n</span>&#160;&#160;&#160; <span class="pre">Robust</span> <span class="pre">Linear</span> <span class="pre">Model\n\n</span>&#160;&#160;&#160; <span class="pre">Estimate</span> <span class="pre">a</span> <span class="pre">robust</span> <span class="pre">linear</span> <span class="pre">model</span> <span class="pre">via</span> <span class="pre">iteratively</span> <span class="pre">reweighted</span> <span class="pre">least</span> <span class="pre">squares\n</span>&#160;&#160;&#160; <span class="pre">given</span> <span class="pre">a</span> <span class="pre">robust</span> <span class="pre">criterion</span> <span class="pre">estimator.\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">endog</span> <span class="pre">:</span> <span class="pre">array_like\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">1-d</span> <span class="pre">endogenous</span> <span class="pre">response</span> <span class="pre">variable.</span> <span class="pre">The</span> <span class="pre">dependent</span> <span class="pre">variable.\n</span>&#160;&#160;&#160; <span class="pre">exog</span> <span class="pre">:</span> <span class="pre">array_like\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">nobs</span> <span class="pre">x</span> <span class="pre">k</span> <span class="pre">array</span> <span class="pre">where</span> <span class="pre">`nobs`</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">observations</span> <span class="pre">and</span> <span class="pre">`k`\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">is</span> <span class="pre">the</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">regressors.</span> <span class="pre">An</span> <span class="pre">intercept</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">included</span> <span class="pre">by</span> <span class="pre">default\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">and</span> <span class="pre">should</span> <span class="pre">be</span> <span class="pre">added</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">user.</span> <span class="pre">See\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">:func:`statsmodels.tools.add_constant`.\n</span>&#160;&#160;&#160; <span class="pre">M</span> <span class="pre">:</span> <span class="pre">statsmodels.robust.norms.RobustNorm,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">robust</span> <span class="pre">criterion</span> <span class="pre">function</span> <span class="pre">for</span> <span class="pre">downweighting</span> <span class="pre">outliers.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">current</span> <span class="pre">options</span> <span class="pre">are</span> <span class="pre">LeastSquares,</span> <span class="pre">HuberT,</span> <span class="pre">RamsayE,</span> <span class="pre">AndrewWave,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">TrimmedMean,</span> <span class="pre">Hampel,</span> <span class="pre">and</span> <span class="pre">TukeyBiweight.</span>&#160; <span class="pre">The</span> <span class="pre">default</span> <span class="pre">is</span> <span class="pre">HuberT().\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">statsmodels.robust.norms</span> <span class="pre">for</span> <span class="pre">more</span> <span class="pre">information.\n</span>&#160;&#160;&#160; <span class="pre">missing</span> <span class="pre">:</span> <span class="pre">str\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Available</span> <span class="pre">options</span> <span class="pre">are</span> <span class="pre">\'none\',</span> <span class="pre">\'drop\',</span> <span class="pre">and</span> <span class="pre">\'raise\'.</span> <span class="pre">If</span> <span class="pre">\'none\',</span> <span class="pre">no</span> <span class="pre">nan\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">checking</span> <span class="pre">is</span> <span class="pre">done.</span> <span class="pre">If</span> <span class="pre">\'drop\',</span> <span class="pre">any</span> <span class="pre">observations</span> <span class="pre">with</span> <span class="pre">nans</span> <span class="pre">are</span> <span class="pre">dropped.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">\'raise\',</span> <span class="pre">an</span> <span class="pre">error</span> <span class="pre">is</span> <span class="pre">raised.</span> <span class="pre">Default</span> <span class="pre">is</span> <span class="pre">\'none\'.\n\n</span>&#160;&#160;&#160; <span class="pre">Attributes\n</span>&#160;&#160;&#160; <span class="pre">----------\n\n</span>&#160;&#160;&#160; <span class="pre">df_model</span> <span class="pre">:</span> <span class="pre">float\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">degrees</span> <span class="pre">of</span> <span class="pre">freedom</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">model.</span>&#160; <span class="pre">The</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">regressors</span> <span class="pre">p</span> <span class="pre">less\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">one</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">intercept.</span>&#160; <span class="pre">Note</span> <span class="pre">that</span> <span class="pre">the</span> <span class="pre">reported</span> <span class="pre">model</span> <span class="pre">degrees\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">of</span> <span class="pre">freedom</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">count</span> <span class="pre">the</span> <span class="pre">intercept</span> <span class="pre">as</span> <span class="pre">a</span> <span class="pre">regressor,</span> <span class="pre">though\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">the</span> <span class="pre">model</span> <span class="pre">is</span> <span class="pre">assumed</span> <span class="pre">to</span> <span class="pre">have</span> <span class="pre">an</span> <span class="pre">intercept.\n</span>&#160;&#160;&#160; <span class="pre">df_resid</span> <span class="pre">:</span> <span class="pre">float\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">residual</span> <span class="pre">degrees</span> <span class="pre">of</span> <span class="pre">freedom.</span>&#160; <span class="pre">The</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">observations</span> <span class="pre">n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">less</span> <span class="pre">the</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">regressors</span> <span class="pre">p.</span>&#160; <span class="pre">Note</span> <span class="pre">that</span> <span class="pre">here</span> <span class="pre">p</span> <span class="pre">does</span> <span class="pre">include\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">the</span> <span class="pre">intercept</span> <span class="pre">as</span> <span class="pre">using</span> <span class="pre">a</span> <span class="pre">degree</span> <span class="pre">of</span> <span class="pre">freedom.\n</span>&#160;&#160;&#160; <span class="pre">endog</span> <span class="pre">:</span> <span class="pre">ndarray\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">above.</span>&#160; <span class="pre">Note</span> <span class="pre">that</span> <span class="pre">endog</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">reference</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">so</span> <span class="pre">that</span> <span class="pre">if\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">data</span> <span class="pre">is</span> <span class="pre">already</span> <span class="pre">an</span> <span class="pre">array</span> <span class="pre">and</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">changed,</span> <span class="pre">then</span> <span class="pre">`endog`</span> <span class="pre">changes\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">as</span> <span class="pre">well.\n</span>&#160;&#160;&#160; <span class="pre">exog</span> <span class="pre">:</span> <span class="pre">ndarray\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">above.</span>&#160; <span class="pre">Note</span> <span class="pre">that</span> <span class="pre">endog</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">reference</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">so</span> <span class="pre">that</span> <span class="pre">if\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">data</span> <span class="pre">is</span> <span class="pre">already</span> <span class="pre">an</span> <span class="pre">array</span> <span class="pre">and</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">changed,</span> <span class="pre">then</span> <span class="pre">`endog`</span> <span class="pre">changes\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">as</span> <span class="pre">well.\n</span>&#160;&#160;&#160; <span class="pre">M</span> <span class="pre">:</span> <span class="pre">statsmodels.robust.norms.RobustNorm\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">above.</span>&#160; <span class="pre">Robust</span> <span class="pre">estimator</span> <span class="pre">instance</span> <span class="pre">instantiated.\n</span>&#160;&#160;&#160; <span class="pre">nobs</span> <span class="pre">:</span> <span class="pre">float\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">observations</span> <span class="pre">n\n</span>&#160;&#160;&#160; <span class="pre">pinv_wexog</span> <span class="pre">:</span> <span class="pre">ndarray\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">pseudoinverse</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">design</span> <span class="pre">/</span> <span class="pre">exogenous</span> <span class="pre">data</span> <span class="pre">array.</span>&#160; <span class="pre">Note</span> <span class="pre">that\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">RLM</span> <span class="pre">has</span> <span class="pre">no</span> <span class="pre">whiten</span> <span class="pre">method,</span> <span class="pre">so</span> <span class="pre">this</span> <span class="pre">is</span> <span class="pre">just</span> <span class="pre">the</span> <span class="pre">pseudo</span> <span class="pre">inverse</span> <span class="pre">of</span> <span class="pre">the\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">design.\n</span>&#160;&#160;&#160; <span class="pre">normalized_cov_params</span> <span class="pre">:</span> <span class="pre">ndarray\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">p</span> <span class="pre">x</span> <span class="pre">p</span> <span class="pre">normalized</span> <span class="pre">covariance</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">design</span> <span class="pre">/</span> <span class="pre">exogenous</span> <span class="pre">data.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">This</span> <span class="pre">is</span> <span class="pre">approximately</span> <span class="pre">equal</span> <span class="pre">to</span> <span class="pre">(X.T</span> <span class="pre">X)^(-1)\n\n</span>&#160;&#160;&#160; <span class="pre">Examples\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">import</span> <span class="pre">statsmodels.api</span> <span class="pre">as</span> <span class="pre">sm\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">data</span> <span class="pre">=</span> <span class="pre">sm.datasets.stackloss.load()\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">data.exog</span> <span class="pre">=</span> <span class="pre">sm.add_constant(data.exog)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">rlm_model</span> <span class="pre">=</span> <span class="pre">sm.RLM(data.endog,</span> <span class="pre">data.exog,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">M=sm.robust.norms.HuberT())\n\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">rlm_results</span> <span class="pre">=</span> <span class="pre">rlm_model.fit()\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">rlm_results.params\n</span>&#160;&#160;&#160; <span class="pre">array([</span>&#160; <span class="pre">0.82938433,</span>&#160;&#160; <span class="pre">0.92606597,</span>&#160; <span class="pre">-0.12784672,</span> <span class="pre">-41.02649835])\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">rlm_results.bse\n</span>&#160;&#160;&#160; <span class="pre">array([</span> <span class="pre">0.11100521,</span>&#160; <span class="pre">0.30293016,</span>&#160; <span class="pre">0.12864961,</span>&#160; <span class="pre">9.79189854])\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">rlm_results_HC2</span> <span class="pre">=</span> <span class="pre">rlm_model.fit(cov=&quot;H2&quot;)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">rlm_results_HC2.params\n</span>&#160;&#160;&#160; <span class="pre">array([</span>&#160; <span class="pre">0.82938433,</span>&#160;&#160; <span class="pre">0.92606597,</span>&#160; <span class="pre">-0.12784672,</span> <span class="pre">-41.02649835])\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">rlm_results_HC2.bse\n</span>&#160;&#160;&#160; <span class="pre">array([</span> <span class="pre">0.11945975,</span>&#160; <span class="pre">0.32235497,</span>&#160; <span class="pre">0.11796313,</span>&#160; <span class="pre">9.08950419])\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">mod</span> <span class="pre">=</span> <span class="pre">sm.RLM(data.endog,</span> <span class="pre">data.exog,</span> <span class="pre">M=sm.robust.norms.Hampel())\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">rlm_hamp_hub</span> <span class="pre">=</span> <span class="pre">mod.fit(scale_est=sm.robust.scale.HuberScale())\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">rlm_hamp_hub.params\n</span>&#160;&#160;&#160; <span class="pre">array([</span>&#160; <span class="pre">0.73175452,</span>&#160;&#160; <span class="pre">1.25082038,</span>&#160; <span class="pre">-0.14794399,</span> <span class="pre">-40.27122257])\n</span>&#160;&#160;&#160; <span class="pre">'</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.RLM.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.RLM.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">endog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/robust_linear_model.html#RLM.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.RLM.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.RLM.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'statsmodels.robust.robust_linear_model'</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.RLM.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.RLM._estimate_scale">
<span class="sig-name descname"><span class="pre">_estimate_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/robust_linear_model.html#RLM._estimate_scale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.RLM._estimate_scale" title="Link to this definition">¶</a></dt>
<dd><p>Estimates the scale based on the option provided to the fit method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.RLM._initialize">
<span class="sig-name descname"><span class="pre">_initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/robust_linear_model.html#RLM._initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.RLM._initialize" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the model for the IRLS fit.</p>
<p>Resets the history and number of iterations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.RLM._update_history">
<span class="sig-name descname"><span class="pre">_update_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tmp_results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/robust_linear_model.html#RLM._update_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.RLM._update_history" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.RLM.deviance">
<span class="sig-name descname"><span class="pre">deviance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tmp_results</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/robust_linear_model.html#RLM.deviance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.RLM.deviance" title="Link to this definition">¶</a></dt>
<dd><p>Returns the (unnormalized) log-likelihood from the M estimator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.RLM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_est</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mad'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'H1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dev'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/robust_linear_model.html#RLM.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.RLM.fit" title="Link to this definition">¶</a></dt>
<dd><p>Fits the model using iteratively reweighted least squares.</p>
<p>The IRLS routine runs until the specified objective converges to <cite>tol</cite>
or <cite>maxiter</cite> has been reached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>conv</strong><span class="classifier">str</span></dt><dd><p>Indicates the convergence criteria.
Available options are “coefs” (the coefficients), “weights” (the
weights in the iteration), “sresid” (the standardized residuals),
and “dev” (the un-normalized log-likelihood for the M
estimator).  The default is “dev”.</p>
</dd>
<dt><strong>cov</strong><span class="classifier">str, optional</span></dt><dd><p>‘H1’, ‘H2’, or ‘H3’
Indicates how the covariance matrix is estimated.  Default is ‘H1’.
See rlm.RLMResults for more information.</p>
</dd>
<dt><strong>init</strong><span class="classifier">str</span></dt><dd><p>Specifies method for the initial estimates of the parameters.
Default is None, which means that the least squares estimate
is used.  Currently it is the only available choice.</p>
</dd>
<dt><strong>maxiter</strong><span class="classifier">int</span></dt><dd><p>The maximum number of iterations to try. Default is 50.</p>
</dd>
<dt><strong>scale_est</strong><span class="classifier">str or HuberScale()</span></dt><dd><p>‘mad’ or HuberScale()
Indicates the estimate to use for scaling the weights in the IRLS.
The default is ‘mad’ (median absolute deviation.  Other options are
‘HuberScale’ for Huber’s proposal 2. Huber’s proposal 2 has
optional keyword arguments d, tol, and maxiter for specifying the
tuning constant, the convergence tolerance, and the maximum number
of iterations. See statsmodels.robust.scale for more information.</p>
</dd>
<dt><strong>tol</strong><span class="classifier">float</span></dt><dd><p>The convergence tolerance of the estimate.  Default is 1e-8.</p>
</dd>
<dt><strong>update_scale</strong><span class="classifier">Bool</span></dt><dd><p>If <cite>update_scale</cite> is False then the scale estimate for the
weights is held constant over the iteration.  Otherwise, it
is updated for each fit in the iteration.  Default is True.</p>
</dd>
<dt><strong>start_params</strong><span class="classifier">array_like, optional</span></dt><dd><p>Initial guess of the solution of the optimizer. If not provided,
the initial parameters are computed using OLS.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>results</strong><span class="classifier">statsmodels.rlm.RLMresults</span></dt><dd><p>Results instance</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.RLM.information">
<span class="sig-name descname"><span class="pre">information</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/robust_linear_model.html#RLM.information"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.RLM.information" title="Link to this definition">¶</a></dt>
<dd><p>Fisher information matrix of model.</p>
<p>Returns -1 * Hessian of the log-likelihood evaluated at params.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">ndarray</span></dt><dd><p>The model parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.RLM.loglike">
<span class="sig-name descname"><span class="pre">loglike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/robust_linear_model.html#RLM.loglike"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.RLM.loglike" title="Link to this definition">¶</a></dt>
<dd><p>Log-likelihood of model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">ndarray</span></dt><dd><p>The model parameters used to compute the log-likelihood.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Must be overridden by subclasses.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.RLM.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/robust_linear_model.html#RLM.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.RLM.predict" title="Link to this definition">¶</a></dt>
<dd><p>Return linear predicted values from a design matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">array_like</span></dt><dd><p>Parameters of a linear model</p>
</dd>
<dt><strong>exog</strong><span class="classifier">array_like, optional.</span></dt><dd><p>Design / exogenous data. Model exog is used if None.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>An array of fitted values</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.RLM.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/robust/robust_linear_model.html#RLM.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.RLM.score" title="Link to this definition">¶</a></dt>
<dd><p>Score vector of model.</p>
<p>The gradient of logL with respect to each parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>params</strong><span class="classifier">ndarray</span></dt><dd><p>The parameters to use when evaluating the Hessian.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ndarray</dt><dd><p>The score vector evaluated at the parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">StandardScaler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/preprocessing/_data.html#StandardScaler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">OneToOneFeatureMixin</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TransformerMixin</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEstimator</span></code></p>
<p>Standardize features by removing the mean and scaling to unit variance.</p>
<p>The standard score of a sample <cite>x</cite> is calculated as:</p>
<blockquote>
<div><p>z = (x - u) / s</p>
</div></blockquote>
<p>where <cite>u</cite> is the mean of the training samples or zero if <cite>with_mean=False</cite>,
and <cite>s</cite> is the standard deviation of the training samples or one if
<cite>with_std=False</cite>.</p>
<p>Centering and scaling happen independently on each feature by computing
the relevant statistics on the samples in the training set. Mean and
standard deviation are then stored to be used on later data using
<a class="reference internal" href="#vtools.functions.neighbor_fill.StandardScaler.transform" title="vtools.functions.neighbor_fill.StandardScaler.transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transform()</span></code></a>.</p>
<p>Standardization of a dataset is a common requirement for many
machine learning estimators: they might behave badly if the
individual features do not more or less look like standard normally
distributed data (e.g. Gaussian with 0 mean and unit variance).</p>
<p>For instance many elements used in the objective function of
a learning algorithm (such as the RBF kernel of Support Vector
Machines or the L1 and L2 regularizers of linear models) assume that
all features are centered around 0 and have variance in the same
order. If a feature has a variance that is orders of magnitude larger
than others, it might dominate the objective function and make the
estimator unable to learn from other features correctly as expected.</p>
<p><cite>StandardScaler</cite> is sensitive to outliers, and the features may scale
differently from each other in the presence of outliers. For an example
visualization, refer to <span class="xref std std-ref">Compare StandardScaler with other scalers</span>.</p>
<p>This scaler can also be applied to sparse CSR or CSC matrices by passing
<cite>with_mean=False</cite> to avoid breaking the sparsity structure of the data.</p>
<p>Read more in the <span class="xref std std-ref">User Guide</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>copy</strong><span class="classifier">bool, default=True</span></dt><dd><p>If False, try to avoid a copy and do inplace scaling instead.
This is not guaranteed to always work inplace; e.g. if the data is
not a NumPy array or scipy.sparse CSR matrix, a copy may still be
returned.</p>
</dd>
<dt><strong>with_mean</strong><span class="classifier">bool, default=True</span></dt><dd><p>If True, center the data before scaling.
This does not work (and will raise an exception) when attempted on
sparse matrices, because centering them entails building a dense
matrix which in common use cases is likely to be too large to fit in
memory.</p>
</dd>
<dt><strong>with_std</strong><span class="classifier">bool, default=True</span></dt><dd><p>If True, scale the data to unit variance (or equivalently,
unit standard deviation).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">scale</span></code></dt><dd><p>Equivalent function without the estimator API.</p>
</dd>
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">PCA</span></code></dt><dd><p>Further removes the linear correlation across features with ‘whiten=True’.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>NaNs are treated as missing values: disregarded in fit, and maintained in
transform.</p>
<p>We use a biased estimator for the standard deviation, equivalent to
<cite>numpy.std(x, ddof=0)</cite>. Note that the choice of <cite>ddof</cite> is unlikely to
affect model performance.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="go">StandardScaler()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">mean_</span><span class="p">)</span>
<span class="go">[0.5 0.5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="go">[[-1. -1.]</span>
<span class="go"> [-1. -1.]</span>
<span class="go"> [ 1.  1.]</span>
<span class="go"> [ 1.  1.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]))</span>
<span class="go">[[3. 3.]]</span>
</pre></div>
</div>
<dl class="field-list">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>scale_</strong><span class="classifier">ndarray of shape (n_features,) or None</span></dt><dd><p>Per feature relative scaling of the data to achieve zero mean and unit
variance. Generally this is calculated using <cite>np.sqrt(var_)</cite>. If a
variance is zero, we can’t achieve unit variance, and the data is left
as-is, giving a scaling factor of 1. <cite>scale_</cite> is equal to <cite>None</cite>
when <cite>with_std=False</cite>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.17: </span><em>scale_</em></p>
</div>
</dd>
<dt><strong>mean_</strong><span class="classifier">ndarray of shape (n_features,) or None</span></dt><dd><p>The mean value for each feature in the training set.
Equal to <code class="docutils literal notranslate"><span class="pre">None</span></code> when <code class="docutils literal notranslate"><span class="pre">with_mean=False</span></code> and <code class="docutils literal notranslate"><span class="pre">with_std=False</span></code>.</p>
</dd>
<dt><strong>var_</strong><span class="classifier">ndarray of shape (n_features,) or None</span></dt><dd><p>The variance for each feature in the training set. Used to compute
<cite>scale_</cite>. Equal to <code class="docutils literal notranslate"><span class="pre">None</span></code> when <code class="docutils literal notranslate"><span class="pre">with_mean=False</span></code> and
<code class="docutils literal notranslate"><span class="pre">with_std=False</span></code>.</p>
</dd>
<dt><strong>n_features_in_</strong><span class="classifier">int</span></dt><dd><p>Number of features seen during <span class="xref std std-term">fit</span>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.24.</span></p>
</div>
</dd>
<dt><strong>feature_names_in_</strong><span class="classifier">ndarray of shape (<cite>n_features_in_</cite>,)</span></dt><dd><p>Names of features seen during <span class="xref std std-term">fit</span>. Defined only when <cite>X</cite>
has feature names that are all strings.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.0.</span></p>
</div>
</dd>
<dt><strong>n_samples_seen_</strong><span class="classifier">int or ndarray of shape (n_features,)</span></dt><dd><p>The number of samples processed by the estimator for each feature.
If there are no missing samples, the <code class="docutils literal notranslate"><span class="pre">n_samples_seen</span></code> will be an
integer, otherwise it will be an array of dtype int. If
<cite>sample_weights</cite> are used it will be a float (if no missing data)
or an array of dtype float that sums the weights seen so far.
Will be reset on new calls to fit, but increments across
<code class="docutils literal notranslate"><span class="pre">partial_fit</span></code> calls.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.StandardScaler.fit" title="vtools.functions.neighbor_fill.StandardScaler.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(X[, y, sample_weight])</p></td>
<td><p>Compute the mean and std to be used for later scaling.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_transform</span></code>(X[, y])</p></td>
<td><p>Fit to data, then transform it.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_feature_names_out</span></code>([input_features])</p></td>
<td><p>Get output feature names for transformation.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_metadata_routing</span></code>()</p></td>
<td><p>Get metadata routing of this object.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_params</span></code>([deep])</p></td>
<td><p>Get parameters for this estimator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.StandardScaler.inverse_transform" title="vtools.functions.neighbor_fill.StandardScaler.inverse_transform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inverse_transform</span></code></a>(X[, copy])</p></td>
<td><p>Scale back the data to the original representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.StandardScaler.partial_fit" title="vtools.functions.neighbor_fill.StandardScaler.partial_fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">partial_fit</span></code></a>(X[, y, sample_weight])</p></td>
<td><p>Online computation of mean and std on X for later scaling.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.StandardScaler.set_fit_request" title="vtools.functions.neighbor_fill.StandardScaler.set_fit_request"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_fit_request</span></code></a>(*[, sample_weight])</p></td>
<td><p>Request metadata passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.StandardScaler.set_inverse_transform_request" title="vtools.functions.neighbor_fill.StandardScaler.set_inverse_transform_request"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_inverse_transform_request</span></code></a>(*[, copy])</p></td>
<td><p>Request metadata passed to the <code class="docutils literal notranslate"><span class="pre">inverse_transform</span></code> method.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_output</span></code>(*[, transform])</p></td>
<td><p>Set output container.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code>(**params)</p></td>
<td><p>Set the parameters of this estimator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.StandardScaler.set_partial_fit_request" title="vtools.functions.neighbor_fill.StandardScaler.set_partial_fit_request"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_partial_fit_request</span></code></a>(*[, sample_weight])</p></td>
<td><p>Request metadata passed to the <code class="docutils literal notranslate"><span class="pre">partial_fit</span></code> method.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.StandardScaler.set_transform_request" title="vtools.functions.neighbor_fill.StandardScaler.set_transform_request"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_transform_request</span></code></a>(*[, copy])</p></td>
<td><p>Request metadata passed to the <code class="docutils literal notranslate"><span class="pre">transform</span></code> method.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#vtools.functions.neighbor_fill.StandardScaler.transform" title="vtools.functions.neighbor_fill.StandardScaler.transform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform</span></code></a>(X[, copy])</p></td>
<td><p>Perform standardization by centering and scaling.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler.__annotations__">
<span class="sig-name descname"><span class="pre">__annotations__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'_parameter_constraints':</span> <span class="pre">&lt;class</span> <span class="pre">'dict'&gt;}</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler.__annotations__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&quot;Standardize</span> <span class="pre">features</span> <span class="pre">by</span> <span class="pre">removing</span> <span class="pre">the</span> <span class="pre">mean</span> <span class="pre">and</span> <span class="pre">scaling</span> <span class="pre">to</span> <span class="pre">unit</span> <span class="pre">variance.\n\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">standard</span> <span class="pre">score</span> <span class="pre">of</span> <span class="pre">a</span> <span class="pre">sample</span> <span class="pre">`x`</span> <span class="pre">is</span> <span class="pre">calculated</span> <span class="pre">as:\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">z</span> <span class="pre">=</span> <span class="pre">(x</span> <span class="pre">-</span> <span class="pre">u)</span> <span class="pre">/</span> <span class="pre">s\n\n</span>&#160;&#160;&#160; <span class="pre">where</span> <span class="pre">`u`</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">mean</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">training</span> <span class="pre">samples</span> <span class="pre">or</span> <span class="pre">zero</span> <span class="pre">if</span> <span class="pre">`with_mean=False`,\n</span>&#160;&#160;&#160; <span class="pre">and</span> <span class="pre">`s`</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">standard</span> <span class="pre">deviation</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">training</span> <span class="pre">samples</span> <span class="pre">or</span> <span class="pre">one</span> <span class="pre">if\n</span>&#160;&#160;&#160; <span class="pre">`with_std=False`.\n\n</span>&#160;&#160;&#160; <span class="pre">Centering</span> <span class="pre">and</span> <span class="pre">scaling</span> <span class="pre">happen</span> <span class="pre">independently</span> <span class="pre">on</span> <span class="pre">each</span> <span class="pre">feature</span> <span class="pre">by</span> <span class="pre">computing\n</span>&#160;&#160;&#160; <span class="pre">the</span> <span class="pre">relevant</span> <span class="pre">statistics</span> <span class="pre">on</span> <span class="pre">the</span> <span class="pre">samples</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">training</span> <span class="pre">set.</span> <span class="pre">Mean</span> <span class="pre">and\n</span>&#160;&#160;&#160; <span class="pre">standard</span> <span class="pre">deviation</span> <span class="pre">are</span> <span class="pre">then</span> <span class="pre">stored</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">used</span> <span class="pre">on</span> <span class="pre">later</span> <span class="pre">data</span> <span class="pre">using\n</span>&#160;&#160;&#160; <span class="pre">:meth:`transform`.\n\n</span>&#160;&#160;&#160; <span class="pre">Standardization</span> <span class="pre">of</span> <span class="pre">a</span> <span class="pre">dataset</span> <span class="pre">is</span> <span class="pre">a</span> <span class="pre">common</span> <span class="pre">requirement</span> <span class="pre">for</span> <span class="pre">many\n</span>&#160;&#160;&#160; <span class="pre">machine</span> <span class="pre">learning</span> <span class="pre">estimators:</span> <span class="pre">they</span> <span class="pre">might</span> <span class="pre">behave</span> <span class="pre">badly</span> <span class="pre">if</span> <span class="pre">the\n</span>&#160;&#160;&#160; <span class="pre">individual</span> <span class="pre">features</span> <span class="pre">do</span> <span class="pre">not</span> <span class="pre">more</span> <span class="pre">or</span> <span class="pre">less</span> <span class="pre">look</span> <span class="pre">like</span> <span class="pre">standard</span> <span class="pre">normally\n</span>&#160;&#160;&#160; <span class="pre">distributed</span> <span class="pre">data</span> <span class="pre">(e.g.</span> <span class="pre">Gaussian</span> <span class="pre">with</span> <span class="pre">0</span> <span class="pre">mean</span> <span class="pre">and</span> <span class="pre">unit</span> <span class="pre">variance).\n\n</span>&#160;&#160;&#160; <span class="pre">For</span> <span class="pre">instance</span> <span class="pre">many</span> <span class="pre">elements</span> <span class="pre">used</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">objective</span> <span class="pre">function</span> <span class="pre">of\n</span>&#160;&#160;&#160; <span class="pre">a</span> <span class="pre">learning</span> <span class="pre">algorithm</span> <span class="pre">(such</span> <span class="pre">as</span> <span class="pre">the</span> <span class="pre">RBF</span> <span class="pre">kernel</span> <span class="pre">of</span> <span class="pre">Support</span> <span class="pre">Vector\n</span>&#160;&#160;&#160; <span class="pre">Machines</span> <span class="pre">or</span> <span class="pre">the</span> <span class="pre">L1</span> <span class="pre">and</span> <span class="pre">L2</span> <span class="pre">regularizers</span> <span class="pre">of</span> <span class="pre">linear</span> <span class="pre">models)</span> <span class="pre">assume</span> <span class="pre">that\n</span>&#160;&#160;&#160; <span class="pre">all</span> <span class="pre">features</span> <span class="pre">are</span> <span class="pre">centered</span> <span class="pre">around</span> <span class="pre">0</span> <span class="pre">and</span> <span class="pre">have</span> <span class="pre">variance</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">same\n</span>&#160;&#160;&#160; <span class="pre">order.</span> <span class="pre">If</span> <span class="pre">a</span> <span class="pre">feature</span> <span class="pre">has</span> <span class="pre">a</span> <span class="pre">variance</span> <span class="pre">that</span> <span class="pre">is</span> <span class="pre">orders</span> <span class="pre">of</span> <span class="pre">magnitude</span> <span class="pre">larger\n</span>&#160;&#160;&#160; <span class="pre">than</span> <span class="pre">others,</span> <span class="pre">it</span> <span class="pre">might</span> <span class="pre">dominate</span> <span class="pre">the</span> <span class="pre">objective</span> <span class="pre">function</span> <span class="pre">and</span> <span class="pre">make</span> <span class="pre">the\n</span>&#160;&#160;&#160; <span class="pre">estimator</span> <span class="pre">unable</span> <span class="pre">to</span> <span class="pre">learn</span> <span class="pre">from</span> <span class="pre">other</span> <span class="pre">features</span> <span class="pre">correctly</span> <span class="pre">as</span> <span class="pre">expected.\n\n</span>&#160;&#160;&#160; <span class="pre">`StandardScaler`</span> <span class="pre">is</span> <span class="pre">sensitive</span> <span class="pre">to</span> <span class="pre">outliers,</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">features</span> <span class="pre">may</span> <span class="pre">scale\n</span>&#160;&#160;&#160; <span class="pre">differently</span> <span class="pre">from</span> <span class="pre">each</span> <span class="pre">other</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">presence</span> <span class="pre">of</span> <span class="pre">outliers.</span> <span class="pre">For</span> <span class="pre">an</span> <span class="pre">example\n</span>&#160;&#160;&#160; <span class="pre">visualization,</span> <span class="pre">refer</span> <span class="pre">to</span> <span class="pre">:ref:`Compare</span> <span class="pre">StandardScaler</span> <span class="pre">with</span> <span class="pre">other</span> <span class="pre">scalers\n</span>&#160;&#160;&#160; <span class="pre">&lt;plot_all_scaling_standard_scaler_section&gt;`.\n\n</span>&#160;&#160;&#160; <span class="pre">This</span> <span class="pre">scaler</span> <span class="pre">can</span> <span class="pre">also</span> <span class="pre">be</span> <span class="pre">applied</span> <span class="pre">to</span> <span class="pre">sparse</span> <span class="pre">CSR</span> <span class="pre">or</span> <span class="pre">CSC</span> <span class="pre">matrices</span> <span class="pre">by</span> <span class="pre">passing\n</span>&#160;&#160;&#160; <span class="pre">`with_mean=False`</span> <span class="pre">to</span> <span class="pre">avoid</span> <span class="pre">breaking</span> <span class="pre">the</span> <span class="pre">sparsity</span> <span class="pre">structure</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">data.\n\n</span>&#160;&#160;&#160; <span class="pre">Read</span> <span class="pre">more</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">:ref:`User</span> <span class="pre">Guide</span> <span class="pre">&lt;preprocessing_scaler&gt;`.\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">copy</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">default=True\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">False,</span> <span class="pre">try</span> <span class="pre">to</span> <span class="pre">avoid</span> <span class="pre">a</span> <span class="pre">copy</span> <span class="pre">and</span> <span class="pre">do</span> <span class="pre">inplace</span> <span class="pre">scaling</span> <span class="pre">instead.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">This</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">guaranteed</span> <span class="pre">to</span> <span class="pre">always</span> <span class="pre">work</span> <span class="pre">inplace;</span> <span class="pre">e.g.</span> <span class="pre">if</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">is\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">not</span> <span class="pre">a</span> <span class="pre">NumPy</span> <span class="pre">array</span> <span class="pre">or</span> <span class="pre">scipy.sparse</span> <span class="pre">CSR</span> <span class="pre">matrix,</span> <span class="pre">a</span> <span class="pre">copy</span> <span class="pre">may</span> <span class="pre">still</span> <span class="pre">be\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">returned.\n\n</span>&#160;&#160;&#160; <span class="pre">with_mean</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">default=True\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">True,</span> <span class="pre">center</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">before</span> <span class="pre">scaling.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">This</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">work</span> <span class="pre">(and</span> <span class="pre">will</span> <span class="pre">raise</span> <span class="pre">an</span> <span class="pre">exception)</span> <span class="pre">when</span> <span class="pre">attempted</span> <span class="pre">on\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">sparse</span> <span class="pre">matrices,</span> <span class="pre">because</span> <span class="pre">centering</span> <span class="pre">them</span> <span class="pre">entails</span> <span class="pre">building</span> <span class="pre">a</span> <span class="pre">dense\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">matrix</span> <span class="pre">which</span> <span class="pre">in</span> <span class="pre">common</span> <span class="pre">use</span> <span class="pre">cases</span> <span class="pre">is</span> <span class="pre">likely</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">too</span> <span class="pre">large</span> <span class="pre">to</span> <span class="pre">fit</span> <span class="pre">in\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">memory.\n\n</span>&#160;&#160;&#160; <span class="pre">with_std</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">default=True\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">True,</span> <span class="pre">scale</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">to</span> <span class="pre">unit</span> <span class="pre">variance</span> <span class="pre">(or</span> <span class="pre">equivalently,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">unit</span> <span class="pre">standard</span> <span class="pre">deviation).\n\n</span>&#160;&#160;&#160; <span class="pre">Attributes\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">scale_</span> <span class="pre">:</span> <span class="pre">ndarray</span> <span class="pre">of</span> <span class="pre">shape</span> <span class="pre">(n_features,)</span> <span class="pre">or</span> <span class="pre">None\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Per</span> <span class="pre">feature</span> <span class="pre">relative</span> <span class="pre">scaling</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">to</span> <span class="pre">achieve</span> <span class="pre">zero</span> <span class="pre">mean</span> <span class="pre">and</span> <span class="pre">unit\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">variance.</span> <span class="pre">Generally</span> <span class="pre">this</span> <span class="pre">is</span> <span class="pre">calculated</span> <span class="pre">using</span> <span class="pre">`np.sqrt(var_)`.</span> <span class="pre">If</span> <span class="pre">a\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">variance</span> <span class="pre">is</span> <span class="pre">zero,</span> <span class="pre">we</span> <span class="pre">can't</span> <span class="pre">achieve</span> <span class="pre">unit</span> <span class="pre">variance,</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">is</span> <span class="pre">left\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">as-is,</span> <span class="pre">giving</span> <span class="pre">a</span> <span class="pre">scaling</span> <span class="pre">factor</span> <span class="pre">of</span> <span class="pre">1.</span> <span class="pre">`scale_`</span> <span class="pre">is</span> <span class="pre">equal</span> <span class="pre">to</span> <span class="pre">`None`\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">when</span> <span class="pre">`with_std=False`.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">0.17\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">*scale_*\n\n</span>&#160;&#160;&#160; <span class="pre">mean_</span> <span class="pre">:</span> <span class="pre">ndarray</span> <span class="pre">of</span> <span class="pre">shape</span> <span class="pre">(n_features,)</span> <span class="pre">or</span> <span class="pre">None\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">mean</span> <span class="pre">value</span> <span class="pre">for</span> <span class="pre">each</span> <span class="pre">feature</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">training</span> <span class="pre">set.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Equal</span> <span class="pre">to</span> <span class="pre">``None``</span> <span class="pre">when</span> <span class="pre">``with_mean=False``</span> <span class="pre">and</span> <span class="pre">``with_std=False``.\n\n</span>&#160;&#160;&#160; <span class="pre">var_</span> <span class="pre">:</span> <span class="pre">ndarray</span> <span class="pre">of</span> <span class="pre">shape</span> <span class="pre">(n_features,)</span> <span class="pre">or</span> <span class="pre">None\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">variance</span> <span class="pre">for</span> <span class="pre">each</span> <span class="pre">feature</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">training</span> <span class="pre">set.</span> <span class="pre">Used</span> <span class="pre">to</span> <span class="pre">compute\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">`scale_`.</span> <span class="pre">Equal</span> <span class="pre">to</span> <span class="pre">``None``</span> <span class="pre">when</span> <span class="pre">``with_mean=False``</span> <span class="pre">and\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">``with_std=False``.\n\n</span>&#160;&#160;&#160; <span class="pre">n_features_in_</span> <span class="pre">:</span> <span class="pre">int\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Number</span> <span class="pre">of</span> <span class="pre">features</span> <span class="pre">seen</span> <span class="pre">during</span> <span class="pre">:term:`fit`.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">0.24\n\n</span>&#160;&#160;&#160; <span class="pre">feature_names_in_</span> <span class="pre">:</span> <span class="pre">ndarray</span> <span class="pre">of</span> <span class="pre">shape</span> <span class="pre">(`n_features_in_`,)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Names</span> <span class="pre">of</span> <span class="pre">features</span> <span class="pre">seen</span> <span class="pre">during</span> <span class="pre">:term:`fit`.</span> <span class="pre">Defined</span> <span class="pre">only</span> <span class="pre">when</span> <span class="pre">`X`\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">has</span> <span class="pre">feature</span> <span class="pre">names</span> <span class="pre">that</span> <span class="pre">are</span> <span class="pre">all</span> <span class="pre">strings.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">1.0\n\n</span>&#160;&#160;&#160; <span class="pre">n_samples_seen_</span> <span class="pre">:</span> <span class="pre">int</span> <span class="pre">or</span> <span class="pre">ndarray</span> <span class="pre">of</span> <span class="pre">shape</span> <span class="pre">(n_features,)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">samples</span> <span class="pre">processed</span> <span class="pre">by</span> <span class="pre">the</span> <span class="pre">estimator</span> <span class="pre">for</span> <span class="pre">each</span> <span class="pre">feature.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">there</span> <span class="pre">are</span> <span class="pre">no</span> <span class="pre">missing</span> <span class="pre">samples,</span> <span class="pre">the</span> <span class="pre">``n_samples_seen``</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">an\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">integer,</span> <span class="pre">otherwise</span> <span class="pre">it</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">an</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">dtype</span> <span class="pre">int.</span> <span class="pre">If\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">`sample_weights`</span> <span class="pre">are</span> <span class="pre">used</span> <span class="pre">it</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">float</span> <span class="pre">(if</span> <span class="pre">no</span> <span class="pre">missing</span> <span class="pre">data)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">or</span> <span class="pre">an</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">dtype</span> <span class="pre">float</span> <span class="pre">that</span> <span class="pre">sums</span> <span class="pre">the</span> <span class="pre">weights</span> <span class="pre">seen</span> <span class="pre">so</span> <span class="pre">far.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Will</span> <span class="pre">be</span> <span class="pre">reset</span> <span class="pre">on</span> <span class="pre">new</span> <span class="pre">calls</span> <span class="pre">to</span> <span class="pre">fit,</span> <span class="pre">but</span> <span class="pre">increments</span> <span class="pre">across\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">``partial_fit``</span> <span class="pre">calls.\n\n</span>&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">Also\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">scale</span> <span class="pre">:</span> <span class="pre">Equivalent</span> <span class="pre">function</span> <span class="pre">without</span> <span class="pre">the</span> <span class="pre">estimator</span> <span class="pre">API.\n\n</span>&#160;&#160;&#160; <span class="pre">:class:`~sklearn.decomposition.PCA`</span> <span class="pre">:</span> <span class="pre">Further</span> <span class="pre">removes</span> <span class="pre">the</span> <span class="pre">linear\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">correlation</span> <span class="pre">across</span> <span class="pre">features</span> <span class="pre">with</span> <span class="pre">'whiten=True'.\n\n</span>&#160;&#160;&#160; <span class="pre">Notes\n</span>&#160;&#160;&#160; <span class="pre">-----\n</span>&#160;&#160;&#160; <span class="pre">NaNs</span> <span class="pre">are</span> <span class="pre">treated</span> <span class="pre">as</span> <span class="pre">missing</span> <span class="pre">values:</span> <span class="pre">disregarded</span> <span class="pre">in</span> <span class="pre">fit,</span> <span class="pre">and</span> <span class="pre">maintained</span> <span class="pre">in\n</span>&#160;&#160;&#160; <span class="pre">transform.\n\n</span>&#160;&#160;&#160; <span class="pre">We</span> <span class="pre">use</span> <span class="pre">a</span> <span class="pre">biased</span> <span class="pre">estimator</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">standard</span> <span class="pre">deviation,</span> <span class="pre">equivalent</span> <span class="pre">to\n</span>&#160;&#160;&#160; <span class="pre">`numpy.std(x,</span> <span class="pre">ddof=0)`.</span> <span class="pre">Note</span> <span class="pre">that</span> <span class="pre">the</span> <span class="pre">choice</span> <span class="pre">of</span> <span class="pre">`ddof`</span> <span class="pre">is</span> <span class="pre">unlikely</span> <span class="pre">to\n</span>&#160;&#160;&#160; <span class="pre">affect</span> <span class="pre">model</span> <span class="pre">performance.\n\n</span>&#160;&#160;&#160; <span class="pre">Examples\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">from</span> <span class="pre">sklearn.preprocessing</span> <span class="pre">import</span> <span class="pre">StandardScaler\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">data</span> <span class="pre">=</span> <span class="pre">[[0,</span> <span class="pre">0],</span> <span class="pre">[0,</span> <span class="pre">0],</span> <span class="pre">[1,</span> <span class="pre">1],</span> <span class="pre">[1,</span> <span class="pre">1]]\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">scaler</span> <span class="pre">=</span> <span class="pre">StandardScaler()\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">print(scaler.fit(data))\n</span>&#160;&#160;&#160; <span class="pre">StandardScaler()\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">print(scaler.mean_)\n</span>&#160;&#160;&#160; <span class="pre">[0.5</span> <span class="pre">0.5]\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">print(scaler.transform(data))\n</span>&#160;&#160;&#160; <span class="pre">[[-1.</span> <span class="pre">-1.]\n</span>&#160;&#160;&#160;&#160; <span class="pre">[-1.</span> <span class="pre">-1.]\n</span>&#160;&#160;&#160;&#160; <span class="pre">[</span> <span class="pre">1.</span>&#160; <span class="pre">1.]\n</span>&#160;&#160;&#160;&#160; <span class="pre">[</span> <span class="pre">1.</span>&#160; <span class="pre">1.]]\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">print(scaler.transform([[2,</span> <span class="pre">2]]))\n</span>&#160;&#160;&#160; <span class="pre">[[3.</span> <span class="pre">3.]]\n</span>&#160;&#160;&#160; <span class="pre">&quot;</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/preprocessing/_data.html#StandardScaler.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sklearn.preprocessing._data'</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler._more_tags">
<span class="sig-name descname"><span class="pre">_more_tags</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/preprocessing/_data.html#StandardScaler._more_tags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler._more_tags" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler._parameter_constraints">
<span class="sig-name descname"><span class="pre">_parameter_constraints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'copy':</span> <span class="pre">['boolean'],</span> <span class="pre">'with_mean':</span> <span class="pre">['boolean'],</span> <span class="pre">'with_std':</span> <span class="pre">['boolean']}</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler._parameter_constraints" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler._reset">
<span class="sig-name descname"><span class="pre">_reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/preprocessing/_data.html#StandardScaler._reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler._reset" title="Link to this definition">¶</a></dt>
<dd><p>Reset internal data-dependent state of the scaler, if necessary.</p>
<p>__init__ parameters are not touched.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler._sklearn_auto_wrap_output_keys">
<span class="sig-name descname"><span class="pre">_sklearn_auto_wrap_output_keys</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'transform'}</span></em><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler._sklearn_auto_wrap_output_keys" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/preprocessing/_data.html#StandardScaler.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler.fit" title="Link to this definition">¶</a></dt>
<dd><p>Compute the mean and std to be used for later scaling.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>X</strong><span class="classifier">{array-like, sparse matrix} of shape (n_samples, n_features)</span></dt><dd><p>The data used to compute the mean and standard deviation
used for later scaling along the features axis.</p>
</dd>
<dt><strong>y</strong><span class="classifier">None</span></dt><dd><p>Ignored.</p>
</dd>
<dt><strong>sample_weight</strong><span class="classifier">array-like of shape (n_samples,), default=None</span></dt><dd><p>Individual weights for each sample.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.24: </span>parameter <em>sample_weight</em> support to StandardScaler.</p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>self</strong><span class="classifier">object</span></dt><dd><p>Fitted scaler.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler.inverse_transform">
<span class="sig-name descname"><span class="pre">inverse_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/preprocessing/_data.html#StandardScaler.inverse_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler.inverse_transform" title="Link to this definition">¶</a></dt>
<dd><p>Scale back the data to the original representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">{array-like, sparse matrix} of shape (n_samples, n_features)</span></dt><dd><p>The data used to scale along the features axis.</p>
</dd>
<dt><strong>copy</strong><span class="classifier">bool, default=None</span></dt><dd><p>Copy the input X or not.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>X_tr</strong><span class="classifier">{ndarray, sparse matrix} of shape (n_samples, n_features)</span></dt><dd><p>Transformed array.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler.partial_fit">
<span class="sig-name descname"><span class="pre">partial_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/preprocessing/_data.html#StandardScaler.partial_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler.partial_fit" title="Link to this definition">¶</a></dt>
<dd><p>Online computation of mean and std on X for later scaling.</p>
<p>All of X is processed as a single batch. This is intended for cases
when <a class="reference internal" href="#vtools.functions.neighbor_fill.StandardScaler.fit" title="vtools.functions.neighbor_fill.StandardScaler.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> is not feasible due to very large number of
<cite>n_samples</cite> or because X is read from a continuous stream.</p>
<p>The algorithm for incremental mean and std is given in Equation 1.5a,b
in Chan, Tony F., Gene H. Golub, and Randall J. LeVeque. “Algorithms
for computing the sample variance: Analysis and recommendations.”
The American Statistician 37.3 (1983): 242-247:</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>X</strong><span class="classifier">{array-like, sparse matrix} of shape (n_samples, n_features)</span></dt><dd><p>The data used to compute the mean and standard deviation
used for later scaling along the features axis.</p>
</dd>
<dt><strong>y</strong><span class="classifier">None</span></dt><dd><p>Ignored.</p>
</dd>
<dt><strong>sample_weight</strong><span class="classifier">array-like of shape (n_samples,), default=None</span></dt><dd><p>Individual weights for each sample.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.24: </span>parameter <em>sample_weight</em> support to StandardScaler.</p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>self</strong><span class="classifier">object</span></dt><dd><p>Fitted scaler.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler.set_fit_request">
<span class="sig-name descname"><span class="pre">set_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#vtools.functions.neighbor_fill.StandardScaler" title="sklearn.preprocessing._data.StandardScaler"><span class="pre">StandardScaler</span></a></span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler.set_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Request metadata passed to the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method.</p>
<p>Note that this method is only relevant if
<code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code>).
Please see <span class="xref std std-ref">User Guide</span> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3.</span></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only relevant if this estimator is used as a
sub-estimator of a meta-estimator, e.g. used inside a
<a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline" title="sklearn.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>. Otherwise it has no effect.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sample_weight</strong><span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>self</strong><span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler.set_inverse_transform_request">
<span class="sig-name descname"><span class="pre">set_inverse_transform_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#vtools.functions.neighbor_fill.StandardScaler" title="sklearn.preprocessing._data.StandardScaler"><span class="pre">StandardScaler</span></a></span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler.set_inverse_transform_request" title="Link to this definition">¶</a></dt>
<dd><p>Request metadata passed to the <code class="docutils literal notranslate"><span class="pre">inverse_transform</span></code> method.</p>
<p>Note that this method is only relevant if
<code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code>).
Please see <span class="xref std std-ref">User Guide</span> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">inverse_transform</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">inverse_transform</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3.</span></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only relevant if this estimator is used as a
sub-estimator of a meta-estimator, e.g. used inside a
<a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline" title="sklearn.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>. Otherwise it has no effect.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>copy</strong><span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">copy</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">inverse_transform</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>self</strong><span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler.set_partial_fit_request">
<span class="sig-name descname"><span class="pre">set_partial_fit_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#vtools.functions.neighbor_fill.StandardScaler" title="sklearn.preprocessing._data.StandardScaler"><span class="pre">StandardScaler</span></a></span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler.set_partial_fit_request" title="Link to this definition">¶</a></dt>
<dd><p>Request metadata passed to the <code class="docutils literal notranslate"><span class="pre">partial_fit</span></code> method.</p>
<p>Note that this method is only relevant if
<code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code>).
Please see <span class="xref std std-ref">User Guide</span> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">partial_fit</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">partial_fit</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3.</span></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only relevant if this estimator is used as a
sub-estimator of a meta-estimator, e.g. used inside a
<a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline" title="sklearn.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>. Otherwise it has no effect.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sample_weight</strong><span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">sample_weight</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">partial_fit</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>self</strong><span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler.set_transform_request">
<span class="sig-name descname"><span class="pre">set_transform_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'$UNCHANGED$'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#vtools.functions.neighbor_fill.StandardScaler" title="sklearn.preprocessing._data.StandardScaler"><span class="pre">StandardScaler</span></a></span></span><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler.set_transform_request" title="Link to this definition">¶</a></dt>
<dd><p>Request metadata passed to the <code class="docutils literal notranslate"><span class="pre">transform</span></code> method.</p>
<p>Note that this method is only relevant if
<code class="docutils literal notranslate"><span class="pre">enable_metadata_routing=True</span></code> (see <code class="xref py py-func docutils literal notranslate"><span class="pre">sklearn.set_config()</span></code>).
Please see <span class="xref std std-ref">User Guide</span> on how the routing
mechanism works.</p>
<p>The options for each parameter are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: metadata is requested, and passed to <code class="docutils literal notranslate"><span class="pre">transform</span></code> if provided. The request is ignored if metadata is not provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: metadata is not requested and the meta-estimator will not pass it to <code class="docutils literal notranslate"><span class="pre">transform</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: metadata is not requested, and the meta-estimator will raise an error if the user provides it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: metadata should be passed to the meta-estimator with this given alias instead of the original name.</p></li>
</ul>
<p>The default (<code class="docutils literal notranslate"><span class="pre">sklearn.utils.metadata_routing.UNCHANGED</span></code>) retains the
existing request. This allows you to change the request for some
parameters and not others.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3.</span></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only relevant if this estimator is used as a
sub-estimator of a meta-estimator, e.g. used inside a
<a class="reference internal" href="#vtools.functions.neighbor_fill.Pipeline" title="sklearn.pipeline.Pipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pipeline</span></code></a>. Otherwise it has no effect.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>copy</strong><span class="classifier">str, True, False, or None,                     default=sklearn.utils.metadata_routing.UNCHANGED</span></dt><dd><p>Metadata routing for <code class="docutils literal notranslate"><span class="pre">copy</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">transform</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>self</strong><span class="classifier">object</span></dt><dd><p>The updated object.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.StandardScaler.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sklearn/preprocessing/_data.html#StandardScaler.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.StandardScaler.transform" title="Link to this definition">¶</a></dt>
<dd><p>Perform standardization by centering and scaling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>X</strong><span class="classifier">{array-like, sparse matrix of shape (n_samples, n_features)</span></dt><dd><p>The data used to scale along the features axis.</p>
</dd>
<dt><strong>copy</strong><span class="classifier">bool, default=None</span></dt><dd><p>Copy the input X or not.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>X_tr</strong><span class="classifier">{ndarray, sparse matrix} of shape (n_samples, n_features)</span></dt><dd><p>Transformed array.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._add_lagged_X">
<span class="sig-name descname"><span class="pre">_add_lagged_X</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.14)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_add_lagged_X"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._add_lagged_X" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._align">
<span class="sig-name descname"><span class="pre">_align</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'inner'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_empty</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_align"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._align" title="Link to this definition">¶</a></dt>
<dd><p>Align target and neighbor(s) on a common DatetimeIndex.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._as_series_like">
<span class="sig-name descname"><span class="pre">_as_series_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_as_series_like"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._as_series_like" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._assert_same_regular_grid">
<span class="sig-name descname"><span class="pre">_assert_same_regular_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v2.3.3)"><span class="pre">DatetimeIndex</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DatetimeIndex.html#pandas.DatetimeIndex" title="(in pandas v2.3.3)"><span class="pre">DatetimeIndex</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_assert_same_regular_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._assert_same_regular_grid" title="Link to this definition">¶</a></dt>
<dd><p>Raise if the two indices are not on the same regular grid (same step &amp; phase).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._compute_metrics">
<span class="sig-name descname"><span class="pre">_compute_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_compute_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._compute_metrics" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._dfm_params_to_vector">
<span class="sig-name descname"><span class="pre">_dfm_params_to_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_dfm_params_to_vector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._dfm_params_to_vector" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Build transformed vector in the exact order of mod.param_names from either:</dt><dd><ul class="simple">
<li><p>{‘transformed’: […], ‘param_names’: […]}, or</p></li>
<li><p>a constrained dict {‘q_beta’:…, ‘q_ax’:…, ‘r_y’:…, ‘r_x’:…, ‘phi_x’:…, ‘load’:…}</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._fit_dfm">
<span class="sig-name descname"><span class="pre">_fit_dfm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ar'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anom_var</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'neighbor'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rx_scale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_fit_dfm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._fit_dfm" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._fit_huber">
<span class="sig-name descname"><span class="pre">_fit_huber</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_fit_huber"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._fit_huber" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._fit_lagged_elasticnet">
<span class="sig-name descname"><span class="pre">_fit_lagged_elasticnet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.14)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_splits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_fit_lagged_elasticnet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._fit_lagged_elasticnet" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._fit_loess">
<span class="sig-name descname"><span class="pre">_fit_loess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_fit_loess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._fit_loess" title="Link to this definition">¶</a></dt>
<dd><p>Locally weighted regression (LOESS) smoother for neighbor fill.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._fit_ols">
<span class="sig-name descname"><span class="pre">_fit_ols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_fit_ols"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._fit_ols" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._fit_resid_interp">
<span class="sig-name descname"><span class="pre">_fit_resid_interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_fit_resid_interp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._fit_resid_interp" title="Link to this definition">¶</a></dt>
<dd><p>Fill y using neighbor via interpolated residuals.</p>
<dl class="simple">
<dt>Steps:</dt><dd><ol class="arabic simple">
<li><p>Fit baseline y ≈ a + b x on overlap (OLS; falls back to ratio if needed).</p></li>
<li><p>Residuals r = y - (a + b x) on overlap.</p></li>
<li><p>Interpolate r only inside gaps (bounded on both sides) using ‘linear’ or ‘pchip’.</p></li>
<li><p>Reconstruct yhat = (a + b x) + r_interp wherever x is available.</p></li>
</ol>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._fit_rolling_regression">
<span class="sig-name descname"><span class="pre">_fit_rolling_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_fit_rolling_regression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._fit_rolling_regression" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._fit_substitute">
<span class="sig-name descname"><span class="pre">_fit_substitute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_fit_substitute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._fit_substitute" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._forward_chain_splits">
<span class="sig-name descname"><span class="pre">_forward_chain_splits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_splits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_forward_chain_splits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._forward_chain_splits" title="Link to this definition">¶</a></dt>
<dd><p>Generate forward-chaining train/test index splits for time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n</strong><span class="classifier">int</span></dt><dd><p>Number of samples.</p>
</dd>
<dt><strong>n_splits</strong><span class="classifier">int</span></dt><dd><p>How many folds.</p>
</dd>
<dt><strong>min_train</strong><span class="classifier">int</span></dt><dd><p>Minimum size of the initial training window.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._inv_logit">
<span class="sig-name descname"><span class="pre">_inv_logit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_inv_logit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._inv_logit" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._logit">
<span class="sig-name descname"><span class="pre">_logit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_logit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._logit" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._mask_overlap">
<span class="sig-name descname"><span class="pre">_mask_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_mask_overlap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._mask_overlap" title="Link to this definition">¶</a></dt>
<dd><p>Keep only timestamps where both y and ALL X columns are non-NaN.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._opt_debug">
<span class="sig-name descname"><span class="pre">_opt_debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_opt_debug"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._opt_debug" title="Link to this definition">¶</a></dt>
<dd><p>Print start vs fitted params (both transformed &amp; constrained).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._phi_from_logit">
<span class="sig-name descname"><span class="pre">_phi_from_logit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_phi_from_logit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._phi_from_logit" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill._suggest_lags">
<span class="sig-name descname"><span class="pre">_suggest_lags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#_suggest_lags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill._suggest_lags" title="Link to this definition">¶</a></dt>
<dd><p>Suggest non-negative lags (in steps) by cross-correlation peak.</p>
<p>Returns a list of lags sorted by decreasing absolute correlation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.asdict">
<span class="sig-name descname"><span class="pre">asdict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict_factory=&lt;class</span> <span class="pre">'dict'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataclasses.html#asdict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.asdict" title="Link to this definition">¶</a></dt>
<dd><p>Return the fields of a dataclass instance as a new dictionary mapping
field names to field values.</p>
<p>Example usage:</p>
<blockquote>
<div><p>&#64;dataclass
class C:</p>
<blockquote>
<div><p>x: int
y: int</p>
</div></blockquote>
<p>c = C(1, 2)
assert asdict(c) == {‘x’: 1, ‘y’: 2}</p>
</div></blockquote>
<p>If given, ‘dict_factory’ will be used instead of built-in dict.
The function applies recursively to field values that are
dataclass instances. This will also look into built-in containers:
tuples, lists, and dicts.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.dataclass">
<span class="sig-name descname"><span class="pre">dataclass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unsafe_hash</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kw_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dataclasses.html#dataclass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.dataclass" title="Link to this definition">¶</a></dt>
<dd><p>Returns the same class as was passed in, with dunder methods
added based on the fields defined in the class.</p>
<p>Examines PEP 526 __annotations__ to determine fields.</p>
<p>If init is true, an __init__() method is added to the class. If
repr is true, a __repr__() method is added. If order is true, rich
comparison dunder methods are added. If unsafe_hash is true, a
__hash__() method function is added. If frozen is true, fields may
not be assigned to after instance creation. If match_args is true,
the __match_args__ tuple is added. If kw_only is true, then by
default all fields are keyword-only. If slots is true, an
__slots__ attribute is added.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.dfm_pack_params">
<span class="sig-name descname"><span class="pre">dfm_pack_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#dfm_pack_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.dfm_pack_params" title="Link to this definition">¶</a></dt>
<dd><p>Return a portable blob of fitted DFM params.</p>
<dl class="simple">
<dt>Preferred: model_info[‘fitted_params’] with:</dt><dd><ul class="simple">
<li><p>‘param_names’: list[str]</p></li>
<li><p>‘transformed’: list[float]</p></li>
<li><p>‘constrained’: dict[str, float]</p></li>
<li><p>optional: ‘mle’, ‘reused’</p></li>
</ul>
</dd>
</dl>
<p>Fallback (legacy): build a blob from ‘param_names’ + ‘params’ if present.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.fit_loess_time_value">
<span class="sig-name descname"><span class="pre">fit_loess_time_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_neighbors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">25</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#fit_loess_time_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.fit_loess_time_value" title="Link to this definition">¶</a></dt>
<dd><p>Two-dimensional LOESS-like smoother: y(t) ~ f(x(t), t), implemented as
distance-weighted KNN in (time, value) space.</p>
<ul class="simple">
<li><p>Avoids Series&amp;DataFrame boolean broadcasting by reducing X→Series first.</p></li>
<li><p>Scales time and value so distances are comparable.</p></li>
<li><p>Predicts wherever neighbor is present.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.load_dfm_params">
<span class="sig-name descname"><span class="pre">load_dfm_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#load_dfm_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.load_dfm_params" title="Link to this definition">¶</a></dt>
<dd><p>Load a DFM parameter blob from YAML and validate minimal schema.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.lowess">
<span class="sig-name descname"><span class="pre">lowess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">endog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6666666666666666</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">it</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xvals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'drop'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/nonparametric/smoothers_lowess.html#lowess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.lowess" title="Link to this definition">¶</a></dt>
<dd><p>LOWESS (Locally Weighted Scatterplot Smoothing)</p>
<p>A lowess function that outs smoothed estimates of endog
at the given exog values from points (exog, endog)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>endog</strong><span class="classifier">1-D numpy array</span></dt><dd><p>The y-values of the observed points</p>
</dd>
<dt><strong>exog</strong><span class="classifier">1-D numpy array</span></dt><dd><p>The x-values of the observed points</p>
</dd>
<dt><strong>frac</strong><span class="classifier">float</span></dt><dd><p>Between 0 and 1. The fraction of the data used
when estimating each y-value.</p>
</dd>
<dt><strong>it</strong><span class="classifier">int</span></dt><dd><p>The number of residual-based reweightings
to perform.</p>
</dd>
<dt><strong>delta</strong><span class="classifier">float</span></dt><dd><p>Distance within which to use linear-interpolation
instead of weighted regression.</p>
</dd>
<dt><strong>xvals: 1-D numpy array</strong></dt><dd><p>Values of the exogenous variable at which to evaluate the regression.
If supplied, cannot use delta.</p>
</dd>
<dt><strong>is_sorted</strong><span class="classifier">bool</span></dt><dd><p>If False (default), then the data will be sorted by exog before
calculating lowess. If True, then it is assumed that the data is
already sorted by exog. If xvals is specified, then it too must be
sorted if is_sorted is True.</p>
</dd>
<dt><strong>missing</strong><span class="classifier">str</span></dt><dd><p>Available options are ‘none’, ‘drop’, and ‘raise’. If ‘none’, no nan
checking is done. If ‘drop’, any observations with nans are dropped.
If ‘raise’, an error is raised. Default is ‘drop’.</p>
</dd>
<dt><strong>return_sorted</strong><span class="classifier">bool</span></dt><dd><p>If True (default), then the returned array is sorted by exog and has
missing (nan or infinite) observations removed.
If False, then the returned array is in the same length and the same
sequence of observations as the input array.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">{ndarray, float}</span></dt><dd><p>The returned array is two-dimensional if return_sorted is True, and
one dimensional if return_sorted is False.
If return_sorted is True, then a numpy array with two columns. The
first column contains the sorted x (exog) values and the second column
the associated estimated y (endog) values.
If return_sorted is False, then only the fitted values are returned,
and the observations will be in the same order as the input arrays.
If xvals is provided, then return_sorted is ignored and the returned
array is always one dimensional, containing the y values fitted at
the x values provided by xvals.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This lowess function implements the algorithm given in the
reference below using local linear estimates.</p>
<p>Suppose the input data has N points. The algorithm works by
estimating the <cite>smooth</cite> y_i by taking the frac*N closest points
to (x_i,y_i) based on their x values and estimating y_i
using a weighted linear regression. The weight for (x_j,y_j)
is tricube function applied to abs(x_i-x_j).</p>
<p>If it &gt; 1, then further weighted local linear regressions
are performed, where the weights are the same as above
times the _lowess_bisquare function of the residuals. Each iteration
takes approximately the same amount of time as the original fit,
so these iterations are expensive. They are most useful when
the noise has extremely heavy tails, such as Cauchy noise.
Noise with less heavy-tails, such as t-distributions with df&gt;2,
are less problematic. The weights downgrade the influence of
points with large residuals. In the extreme case, points whose
residuals are larger than 6 times the median absolute residual
are given weight 0.</p>
<p><cite>delta</cite> can be used to save computations. For each <cite>x_i</cite>, regressions
are skipped for points closer than <cite>delta</cite>. The next regression is
fit for the farthest point within delta of <cite>x_i</cite> and all points in
between are estimated by linearly interpolating between the two
regression fits.</p>
<p>Judicious choice of delta can cut computation time considerably
for large data (N &gt; 5000). A good choice is <code class="docutils literal notranslate"><span class="pre">delta</span> <span class="pre">=</span> <span class="pre">0.01</span> <span class="pre">*</span> <span class="pre">range(exog)</span></code>.</p>
<p>If <cite>xvals</cite> is provided, the regression is then computed at those points
and the fit values are returned. Otherwise, the regression is run
at points of <cite>exog</cite>.</p>
<p>Some experimentation is likely required to find a good
choice of <cite>frac</cite> and <cite>iter</cite> for a particular dataset.</p>
<p class="rubric">References</p>
<p>Cleveland, W.S. (1979) “Robust Locally Weighted Regression
and Smoothing Scatterplots”. Journal of the American Statistical
Association 74 (368): 829-836.</p>
<p class="rubric">Examples</p>
<p>The below allows a comparison between how different the fits from
lowess for different values of frac can be.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lowess</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">nonparametric</span><span class="o">.</span><span class="n">lowess</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>This gives a similar comparison for when it is 0 vs not.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lowess</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">nonparametric</span><span class="o">.</span><span class="n">lowess</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">stats</span><span class="o">.</span><span class="n">cauchy</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">it</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.save_dfm_params">
<span class="sig-name descname"><span class="pre">save_dfm_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#save_dfm_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.save_dfm_params" title="Link to this definition">¶</a></dt>
<dd><p>Save a DFM parameter blob to YAML (preferred for this codebase).
File extension may be .yaml or .yml. Other extensions raise.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.neighbor_fill.write_filled_csv_with_yaml_header">
<span class="sig-name descname"><span class="pre">write_filled_csv_with_yaml_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filled</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_meta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'{:.6g}'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/neighbor_fill.html#write_filled_csv_with_yaml_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.neighbor_fill.write_filled_csv_with_yaml_header" title="Link to this definition">¶</a></dt>
<dd><p>Write a CSV file with a YAML-like header as #-comments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filled</strong><span class="classifier">pd.Series</span></dt><dd><p>Series to write; index must be a DatetimeIndex.</p>
</dd>
<dt><strong>path</strong><span class="classifier">str</span></dt><dd><p>Destination filepath.</p>
</dd>
<dt><strong>model_info</strong><span class="classifier">dict</span></dt><dd><p>Metadata from fill_from_neighbor; will be serialized.</p>
</dd>
<dt><strong>metrics</strong><span class="classifier">dict, optional</span></dt><dd><p>Metrics to include.</p>
</dd>
<dt><strong>extra_meta</strong><span class="classifier">dict, optional</span></dt><dd><p>Any additional metadata.</p>
</dd>
<dt><strong>float_format</strong><span class="classifier">str</span></dt><dd><p>Format string for values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vtools.functions.period_op">
<span id="vtools-functions-period-op-module"></span><h2>vtools.functions.period_op module<a class="headerlink" href="#module-vtools.functions.period_op" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.period_op.period_op">
<span class="sig-name descname"><span class="pre">period_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'D'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_absent_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/period_op.html#period_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.period_op.period_op" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.period_op.window_op">
<span class="sig-name descname"><span class="pre">window_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'D'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_absent_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/period_op.html#window_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.period_op.window_op" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-vtools.functions.savitzky_golay">
<span id="vtools-functions-savitzky-golay-module"></span><h2>vtools.functions.savitzky_golay module<a class="headerlink" href="#module-vtools.functions.savitzky_golay" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay._build_vander">
<span class="sig-name descname"><span class="pre">_build_vander</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#_build_vander"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay._build_vander" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay._evaluate_poly">
<span class="sig-name descname"><span class="pre">_evaluate_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#_evaluate_poly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay._evaluate_poly" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay._polyfit_window">
<span class="sig-name descname"><span class="pre">_polyfit_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#_polyfit_window"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay._polyfit_window" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay.main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay.savgol_filter_numba">
<span class="sig-name descname"><span class="pre">savgol_filter_numba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#savgol_filter_numba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay.savgol_filter_numba" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay.savgol_filter_weighted">
<span class="sig-name descname"><span class="pre">savgol_filter_weighted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_numba</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#savgol_filter_weighted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay.savgol_filter_weighted" title="Link to this definition">¶</a></dt>
<dd><p>Apply a Savitzky–Golay filter with weights to a univariate DataFrame or Series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">pandas.DataFrame or pandas.Series</span></dt><dd><p>DataFrame or Series containing your data.</p>
</dd>
<dt><strong>window_length</strong><span class="classifier">int</span></dt><dd><p>Length of the filter window (must be odd).</p>
</dd>
<dt><strong>degree</strong><span class="classifier">int</span></dt><dd><p>Degree of the polynomial fit.</p>
</dd>
<dt><strong>error</strong><span class="classifier">pandas.Series, optional</span></dt><dd><p>Series containing the error (used to compute weights).</p>
</dd>
<dt><strong>cov_matrix</strong><span class="classifier">2D numpy array, optional</span></dt><dd><p>Covariance matrix for the errors.</p>
</dd>
<dt><strong>deriv</strong><span class="classifier">int, optional</span></dt><dd><p>Derivative order to compute.</p>
</dd>
<dt><strong>use_numba</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, uses the Numba-accelerated kernel.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.Series</dt><dd><p>Series of the filtered values.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The practical size of <cite>window_length</cite> depends on the data and the computational resources.
Larger window lengths provide smoother results but require more computation and may not capture
local variations well. It is recommended to experiment with different window lengths to find
the optimal value for your specific application.</p>
<p>Some of the workflow derived from this work:
<a class="reference external" href="https://github.com/surhudm/savitzky_golay_with_errors">https://github.com/surhudm/savitzky_golay_with_errors</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay.savgol_filter_werror">
<span class="sig-name descname"><span class="pre">savgol_filter_werror</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#savgol_filter_werror"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay.savgol_filter_werror" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay.solve_leastsq">
<span class="sig-name descname"><span class="pre">solve_leastsq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yarr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ycov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vander</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vanderT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#solve_leastsq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay.solve_leastsq" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay.solve_polyfit">
<span class="sig-name descname"><span class="pre">solve_polyfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xarr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yarr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#solve_polyfit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay.solve_polyfit" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-vtools.functions.separate_species">
<span id="vtools-functions-separate-species-module"></span><h2>vtools.functions.separate_species module<a class="headerlink" href="#module-vtools.functions.separate_species" title="Link to this heading">¶</a></h2>
<p>Separation of tidal data into species
The key function in this module is separate_species, which decomposes
tides into subtidal, diurnal, semidiurnal and noise components.</p>
<p>The fileters are long, so the time resolution of the amplitude may be limited.
A demo function is also provided that reads tide series (6min intervl)
from input files, seperates  the species, writes results and optionally plots
an example</p>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.separate_species.create_arg_parser">
<span class="sig-name descname"><span class="pre">create_arg_parser</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/separate_species.html#create_arg_parser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.separate_species.create_arg_parser" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.separate_species.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/separate_species.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.separate_species.main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.separate_species.plot_result">
<span class="sig-name descname"><span class="pre">plot_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts_semi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts_diurnal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts_sub_tide</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/separate_species.html#plot_result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.separate_species.plot_result" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.separate_species.run_example">
<span class="sig-name descname"><span class="pre">run_example</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/separate_species.html#run_example"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.separate_species.run_example" title="Link to this definition">¶</a></dt>
<dd><p>This is the data for the example.
Note that you want the data to
be at least 4 days longer than the desired output</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.separate_species.separate_species">
<span class="sig-name descname"><span class="pre">separate_species</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_thresh_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/separate_species.html#separate_species"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.separate_species.separate_species" title="Link to this definition">¶</a></dt>
<dd><p>Separate species into subtidal, diurnal, semidiurnal and noise components</p>
<dl class="simple">
<dt>Input:</dt><dd><p>ts: timeseries to be decomposed into species, assumed to be
at six minute intervals. The filters used
have long lenghts, so avoid missing data and allow for four extra
days worth of data on each end.</p>
</dd>
<dt>Output:</dt><dd><p>four regular time series, representing subtidal, diurnal, semi-diurnal and noise</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.separate_species.write_th">
<span class="sig-name descname"><span class="pre">write_th</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts_output</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/separate_species.html#write_th"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.separate_species.write_th" title="Link to this definition">¶</a></dt>
<dd><p>This works fine for fairly big series</p>
</dd></dl>

</section>
<section id="module-vtools.functions.skill_metrics">
<span id="vtools-functions-skill-metrics-module"></span><h2>vtools.functions.skill_metrics module<a class="headerlink" href="#module-vtools.functions.skill_metrics" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics._main">
<span class="sig-name descname"><span class="pre">_main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#_main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics._main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.corr_coefficient">
<span class="sig-name descname"><span class="pre">corr_coefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pearson'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#corr_coefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.corr_coefficient" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the correlation coefficient (the ‘r’ in ‘-squared’ between two series.</p>
<p>For time series where the targets are serially correlated and may span only a fraction
of the natural variability, this statistic may not be appropriate and Murphy (1988) explains
why caution should be exercised in using this statistic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series to analyze</p>
</dd>
<dt><strong>method</strong><span class="classifier">pearson’, ‘kendall’, ‘spearman’</span></dt><dd><p>Method compatilble with pandasa</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>r</strong><span class="classifier">float</span></dt><dd><p>Correlation coefficient</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.mean_error">
<span class="sig-name descname"><span class="pre">mean_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proportiontocut</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#mean_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.mean_error" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the untrimmed mean error, discounting nan values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to be analyzed</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>med</strong><span class="classifier">float</span></dt><dd><p>Median error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.median_error">
<span class="sig-name descname"><span class="pre">median_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#median_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.median_error" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the median error, discounting nan values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to be analyzed</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>med</strong><span class="classifier">float</span></dt><dd><p>Median error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.mse">
<span class="sig-name descname"><span class="pre">mse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#mse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.mse" title="Link to this definition">¶</a></dt>
<dd><p>Mean squared error</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to analyze</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mse</strong><span class="classifier">vtools.data.timeseries.TimeSeries</span></dt><dd><p>Mean squared error between predictions and targets</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.rmse">
<span class="sig-name descname"><span class="pre">rmse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#rmse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.rmse" title="Link to this definition">¶</a></dt>
<dd><p>Root mean squared error</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to analyze</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mse</strong><span class="classifier">float</span></dt><dd><p>Mean squared error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.skill_score">
<span class="sig-name descname"><span class="pre">skill_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#skill_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.skill_score" title="Link to this definition">¶</a></dt>
<dd><p>Calculate a Nash-Sutcliffe-like skill score based on mean squared error</p>
<p>As per the discussion in Murphy (1988) other reference forecasts (climatology,
harmonic tide, etc.) are possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to be analyzed</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>rmse</strong><span class="classifier">float</span></dt><dd><p>Root mean squared error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.tmean_error">
<span class="sig-name descname"><span class="pre">tmean_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclusive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[True,</span> <span class="pre">True]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#tmean_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.tmean_error" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the (possibly trimmed) mean error, discounting nan values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to be analyzed</p>
</dd>
<dt><strong>limits</strong><span class="classifier">tuple(float)</span></dt><dd><p>Low and high limits for trimming</p>
</dd>
<dt><strong>inclusive</strong><span class="classifier">[boolean, boolean]</span></dt><dd><p>True if clipping is inclusive on the low/high end</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mean</strong><span class="classifier">float</span></dt><dd><p>Trimmed mean error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.willmott_score">
<span class="sig-name descname"><span class="pre">willmott_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#willmott_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.willmott_score" title="Link to this definition">¶</a></dt>
<dd><p>Calculate a Nash-Sutcliffe-like skill score based on mean squared error</p>
<p>As per the discussion in Murphy (1988) other reference forecasts (climatology,
harmonic tide, etc.) are possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to be analyzed</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>rmse</strong><span class="classifier">float</span></dt><dd><p>Root mean squared error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vtools.functions.tidalhl">
<span id="vtools-functions-tidalhl-module"></span><h2>vtools.functions.tidalhl module<a class="headerlink" href="#module-vtools.functions.tidalhl" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.cosine_lanczos">
<span class="sig-name descname"><span class="pre">cosine_lanczos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#cosine_lanczos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.cosine_lanczos" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.filter_where_na">
<span class="sig-name descname"><span class="pre">filter_where_na</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dfb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#filter_where_na"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.filter_where_na" title="Link to this definition">¶</a></dt>
<dd><p>remove values in df where dfb has na values</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.get_phase_diff">
<span class="sig-name descname"><span class="pre">get_phase_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'4h'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#get_phase_diff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.get_phase_diff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.get_smoothed_resampled">
<span class="sig-name descname"><span class="pre">get_smoothed_resampled</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2h'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pchip'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#get_smoothed_resampled"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.get_smoothed_resampled" title="Link to this definition">¶</a></dt>
<dd><p>Resample the dataframe (indexed by time) to the regular period of resample_period using the interpolate method</p>
<p>Furthermore the cosine lanczos filter is used with a cutoff_period to smooth the signal to remove high frequency noise</p>
<p>Args:</p>
<blockquote>
<div><p>df (DataFrame): A single column dataframe indexed by datetime</p>
<p>cutoff_period (str, optional): cutoff period for cosine lanczos filter. Defaults to ‘2h’.</p>
<p>resample_period (str, optional): Resample to regular period. Defaults to ‘1min’.</p>
<p>interpolate_method (str, optional): interpolation for resampling. Defaults to ‘pchip’.</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>DataFrame: smoothed and resampled dataframe indexed by datetime</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.get_tidal_amplitude">
<span class="sig-name descname"><span class="pre">get_tidal_amplitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dfh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dfl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#get_tidal_amplitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.get_tidal_amplitude" title="Link to this definition">¶</a></dt>
<dd><p>Tidal amplitude given tidal highs and lows</p>
<p>Args:</p>
<blockquote>
<div><p>dfh (DataFrame): Tidal highs time series</p>
<p>dfl (DataFrame): Tidal lows time series</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>DataFrame: Amplitude timeseries, at the times of the low following the high being used for amplitude calculation</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.get_tidal_amplitude_diff">
<span class="sig-name descname"><span class="pre">get_tidal_amplitude_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dfamp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dfamp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percent_diff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'4h'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#get_tidal_amplitude_diff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.get_tidal_amplitude_diff" title="Link to this definition">¶</a></dt>
<dd><p>Get the difference of values within +/- 4H of values in the two amplitude arrays</p>
<p>Args:</p>
<blockquote>
<div><p>dfamp1 (DataFrame): Amplitude time series</p>
<p>dfamp2 (DataFrame): Amplitude time series</p>
<p>percent_diff (bool, optional): If true do percent diff. Defaults to False.</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>DataFrame: Difference dfamp1-dfamp2 or % Difference (dfamp1-dfamp2)/dfamp2*100  for values within +/- 4H of each other</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.get_tidal_hl">
<span class="sig-name descname"><span class="pre">get_tidal_hl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2h'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pchip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'7h'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#get_tidal_hl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.get_tidal_hl" title="Link to this definition">¶</a></dt>
<dd><p>Get Tidal highs and lows</p>
<p>Args:</p>
<blockquote>
<div><p>df (DataFrame): A single column dataframe indexed by datetime</p>
<p>cutoff_period (str, optional): cutoff period for cosine lanczos filter. Defaults to ‘2h’.</p>
<p>resample_period (str, optional): Resample to regular period. Defaults to ‘1min’.</p>
<p>interpolate_method (str, optional): interpolation for resampling. Defaults to ‘pchip’.</p>
<p>moving_window_size (str, optional): moving window size to look for lows within. Defaults to ‘7h’.</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>tuple of DataFrame: Tidal high and tidal low time series</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.get_tidal_hl_rolling">
<span class="sig-name descname"><span class="pre">get_tidal_hl_rolling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2h'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pchip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'7h'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vtools.functions.tidalhl.get_tidal_hl_rolling" title="Link to this definition">¶</a></dt>
<dd><p>Get Tidal highs and lows</p>
<p>Args:</p>
<blockquote>
<div><p>df (DataFrame): A single column dataframe indexed by datetime</p>
<p>cutoff_period (str, optional): cutoff period for cosine lanczos filter. Defaults to ‘2h’.</p>
<p>resample_period (str, optional): Resample to regular period. Defaults to ‘1min’.</p>
<p>interpolate_method (str, optional): interpolation for resampling. Defaults to ‘pchip’.</p>
<p>moving_window_size (str, optional): moving window size to look for lows within. Defaults to ‘7h’.</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>tuple of DataFrame: Tidal high and tidal low time series</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.get_tidal_hl_zerocrossing">
<span class="sig-name descname"><span class="pre">get_tidal_hl_zerocrossing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1min'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#get_tidal_hl_zerocrossing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.get_tidal_hl_zerocrossing" title="Link to this definition">¶</a></dt>
<dd><p>Finds the tidal high and low times using zero crossings of the first derivative.</p>
<p>This works for all situations but is not robust in the face of noise and perturbations in the signal</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.get_tidal_phase_diff">
<span class="sig-name descname"><span class="pre">get_tidal_phase_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dfh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dfl2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dfh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dfl1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'4h'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#get_tidal_phase_diff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.get_tidal_phase_diff" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the phase difference between df2 and df1 tidal highs and lows</p>
<p>Scans +/- 4 hours in df1 to get the highs and lows in that windows for df2 to
get the tidal highs and lows at the times of df1</p>
<p>Args:</p>
<blockquote>
<div><p>dfh2 (DataFrame): Timeseries of tidal highs</p>
<p>dfl2 (DataFrame): Timeseries of tidal lows</p>
<p>dfh1 (DataFrame): Timeseries of tidal highs</p>
<p>dfl1 (DataFRame): Timeseries of tidal lows</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>DataFrame: Phase difference (dfh2-dfh1) and (dfl2-dfl1) in minutes</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.limit_to_indices">
<span class="sig-name descname"><span class="pre">limit_to_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">si</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ei</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#limit_to_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.limit_to_indices" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.lmax">
<span class="sig-name descname"><span class="pre">lmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#lmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.lmax" title="Link to this definition">¶</a></dt>
<dd><p>Local maximum: Returns value only when centered on maximum</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.lmin">
<span class="sig-name descname"><span class="pre">lmin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#lmin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.lmin" title="Link to this definition">¶</a></dt>
<dd><p>Local minimum: Returns value only when centered on minimum</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.periods_per_window">
<span class="sig-name descname"><span class="pre">periods_per_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moving_window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">period_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#periods_per_window"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.periods_per_window" title="Link to this definition">¶</a></dt>
<dd><p>Number of period size in moving window</p>
<p>Args:</p>
<blockquote>
<div><p>moving_window_size (str): moving window size as a string e.g 7H for 7 hour</p>
<p>period_str (str): period as str e.g. 1T for 1 min</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>int: number of periods in the moving window rounded to an integer</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.tidal_highs">
<span class="sig-name descname"><span class="pre">tidal_highs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'7h'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#tidal_highs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.tidal_highs" title="Link to this definition">¶</a></dt>
<dd><p>Tidal highs (could be upto two highs in a 25 hr period)</p>
<p>Args:</p>
<blockquote>
<div><p>df (DataFrame): a time series with a regular frequency</p>
<p>moving_window_size (str, optional): moving window size to look for highs within. Defaults to ‘7h’.</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>DataFrame: an irregular time series with highs at resolution of df.index</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.tidal_lows">
<span class="sig-name descname"><span class="pre">tidal_lows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'7h'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#tidal_lows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.tidal_lows" title="Link to this definition">¶</a></dt>
<dd><p>Tidal lows (could be upto two lows in a 25 hr period)</p>
<p>Args:</p>
<blockquote>
<div><p>df (DataFrame): a time series with a regular frequency</p>
<p>moving_window_size (str, optional): moving window size to look for lows within. Defaults to ‘7h’.</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>DataFrame: an irregular time series with lows at resolution of df.index</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.where_changed">
<span class="sig-name descname"><span class="pre">where_changed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#where_changed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.where_changed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.where_same">
<span class="sig-name descname"><span class="pre">where_same</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dfg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#where_same"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.where_same" title="Link to this definition">¶</a></dt>
<dd><p>return dfg only where its value is the same as df for the same time stamps
i.e. the interesection locations with df</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.zerocross">
<span class="sig-name descname"><span class="pre">zerocross</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#zerocross"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.zerocross" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the gradient of the time series and identifies locations where gradient changes sign
Returns the time rounded to nearest minute where the zero crossing happens (based on linear derivative assumption)</p>
</dd></dl>

</section>
<section id="module-vtools.functions.tidalhours">
<span id="vtools-functions-tidalhours-module"></span><h2>vtools.functions.tidalhours module<a class="headerlink" href="#module-vtools.functions.tidalhours" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.cdiff">
<span class="sig-name descname"><span class="pre">cdiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhours.html#cdiff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.cdiff" title="Link to this definition">¶</a></dt>
<dd><p>Like np.diff, but include difference from last element back
to first.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.cosine_lanczos5">
<span class="sig-name descname"><span class="pre">cosine_lanczos5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#cosine_lanczos5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.cosine_lanczos5" title="Link to this definition">¶</a></dt>
<dd><p>squared low-pass cosine lanczos  filter on a regular time series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd></dd>
<dt><strong>filter_len</strong><span class="classifier">int, time_interval</span></dt><dd><p>Size of lanczos window, default is to number of samples within filter_period*1.25.</p>
</dd>
<dt><strong>cutoff_frequency: float,optional</strong></dt><dd><p>Cutoff frequency expressed as a ratio of a Nyquist frequency,
should within the range (0,1). For example, if the sampling frequency
is 1 hour, the Nyquist frequency is 1 sample/2 hours. If we want a
36 hour cutoff period, the frequency is 1/36 or 0.0278 cycles per hour.
Hence the cutoff frequency argument used here would be
0.0278/0.5 = 0.056.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">string  or  _time_interval</span></dt><dd><blockquote>
<div><p>Period of cutting off frequency. If input as a string, it must
be  convertible to a _time_interval (Pandas freq).
cutoff_frequency and cutoff_period can’t be specified at the same time.</p>
</div></blockquote>
<dl class="simple">
<dt>padtype<span class="classifier">str or None, optional</span></dt><dd><p>Must be ‘odd’, ‘even’, ‘constant’, or None. This determines the type
of extension to use for the padded signal to which the filter is applied.
If padtype is None, no padding is used. The default is None.</p>
</dd>
<dt>padlen<span class="classifier">int or None, optional</span></dt><dd><p>The number of elements by which to extend x at both ends of axis
before applying the filter. This value must be less than x.shape[axis]-1.
padlen=0 implies no padding. If padtye is not None and padlen is not
given, padlen is be set to 6*m.</p>
</dd>
<dt>fill_edge_nan: bool,optional</dt><dd><p>If pading is not used and fill_edge_nan is true, resulting data on
the both ends are filled with nan to account for edge effect. This is
2*m on the either end of the result. Default is true.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></span></dt><dd><p>A new regular time series with the same interval of ts. If no pading
is used the beigning and ending 4*m resulting data will be set to nan
to remove edge effect.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If input timeseries is not regular,
or, cutoff_period and cutoff_frequency are given at the same time,
or, neither cutoff_period nor curoff_frequence is given,
or, padtype is not “odd”,”even”,”constant”,or None,
or, padlen is larger than data size</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.diff_h">
<span class="sig-name descname"><span class="pre">diff_h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tidal_hour_series</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhours.html#diff_h"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.diff_h" title="Link to this definition">¶</a></dt>
<dd><p>Compute the time derivative of tidal hour.</p>
<p>This derivative is often included to capture how rapidly the tidal phase is changing,
which can be important in modeling flow reversals, estuarine dynamics, or for detecting
slack tide conditions where the rate of change is near zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tidal_hour_series</strong><span class="classifier">pandas.Series</span></dt><dd><p>Output of <cite>tidal_hour_signal</cite>, indexed by datetime.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.Series</dt><dd><p>Time derivative of tidal hour (dH/dt) in hours/hour, indexed by datetime.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.find_slack">
<span class="sig-name descname"><span class="pre">find_slack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leave_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'both'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhours.html#find_slack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.find_slack" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.hilbert">
<span class="sig-name descname"><span class="pre">hilbert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/_signaltools.html#hilbert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.hilbert" title="Link to this definition">¶</a></dt>
<dd><p>Compute the analytic signal, using the Hilbert transform.</p>
<p>The transformation is done along the last axis by default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">array_like</span></dt><dd><p>Signal data.  Must be real.</p>
</dd>
<dt><strong>N</strong><span class="classifier">int, optional</span></dt><dd><p>Number of Fourier components.  Default: <code class="docutils literal notranslate"><span class="pre">x.shape[axis]</span></code></p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>Axis along which to do the transformation.  Default: -1.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>xa</strong><span class="classifier">ndarray</span></dt><dd><p>Analytic signal of <cite>x</cite>, of each 1-D array along <cite>axis</cite></p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The analytic signal <code class="docutils literal notranslate"><span class="pre">x_a(t)</span></code> of signal <code class="docutils literal notranslate"><span class="pre">x(t)</span></code> is:</p>
<div class="math notranslate nohighlight">
\[x_a = F^{-1}(F(x) 2U) = x + i y\]</div>
<p>where <cite>F</cite> is the Fourier transform, <cite>U</cite> the unit step function,
and <cite>y</cite> the Hilbert transform of <cite>x</cite>. <a class="reference internal" href="#re878f5db20d4-1" id="id20">[1]</a></p>
<p>In other words, the negative half of the frequency spectrum is zeroed
out, turning the real-valued signal into a complex signal.  The Hilbert
transformed signal can be obtained from <code class="docutils literal notranslate"><span class="pre">np.imag(hilbert(x))</span></code>, and the
original signal from <code class="docutils literal notranslate"><span class="pre">np.real(hilbert(x))</span></code>.</p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="re878f5db20d4-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id20">1</a><span class="fn-bracket">]</span></span>
<p>Wikipedia, “Analytic signal”.
<a class="reference external" href="https://en.wikipedia.org/wiki/Analytic_signal">https://en.wikipedia.org/wiki/Analytic_signal</a></p>
</div>
<div class="citation" id="re878f5db20d4-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Leon Cohen, “Time-Frequency Analysis”, 1995. Chapter 2.</p>
</div>
<div class="citation" id="re878f5db20d4-3" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>Alan V. Oppenheim, Ronald W. Schafer. Discrete-Time Signal
Processing, Third Edition, 2009. Chapter 12.
ISBN 13: 978-1292-02572-8</p>
</div>
</div>
<p class="rubric">Examples</p>
<p>In this example we use the Hilbert transform to determine the amplitude
envelope and instantaneous frequency of an amplitude-modulated signal.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">hilbert</span><span class="p">,</span> <span class="n">chirp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">duration</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="mf">400.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fs</span><span class="o">*</span><span class="n">duration</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>
</pre></div>
</div>
<p>We create a chirp of which the frequency increases from 20 Hz to 100 Hz and
apply an amplitude modulation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">chirp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mf">100.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">*=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">3.0</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>The amplitude envelope is given by magnitude of the analytic signal. The
instantaneous frequency can be obtained by differentiating the
instantaneous phase in respect to time. The instantaneous phase corresponds
to the phase angle of the analytic signal.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">analytic_signal</span> <span class="o">=</span> <span class="n">hilbert</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amplitude_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">analytic_signal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instantaneous_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">analytic_signal</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instantaneous_frequency</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">instantaneous_phase</span><span class="p">)</span> <span class="o">/</span>
<span class="gp">... </span>                           <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;signal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">amplitude_envelope</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;envelope&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;time in seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax0</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">instantaneous_frequency</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;time in seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">120.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.hour_tide">
<span class="sig-name descname"><span class="pre">hour_tide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jd_new</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leave_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_datum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ebb'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhours.html#hour_tide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.hour_tide" title="Link to this definition">¶</a></dt>
<dd><p>Calculate tide-hour from a time series of u (velocity, flood-positive)
or h (water level, i.e. positive-up).</p>
<p>jd: time in days, i.e. julian day, datenum, etc.
u: velocity, flood-positive
h: water level, positive up.
jd_new: if you want to evaluate the tidal hour at a different</p>
<blockquote>
<div><p>(but overlapping) set of times.</p>
</div></blockquote>
<dl class="simple">
<dt>leave_mean: by default, the time series mean is removed, but this</dt><dd><p>can be disabled by passing True here.</p>
</dd>
</dl>
<p>the return values are between 0 and 12, with 0 being slack before
ebb (hmm - may need to verify that.).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.hour_tide_fn">
<span class="sig-name descname"><span class="pre">hour_tide_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_datum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ebb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leave_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhours.html#hour_tide_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.hour_tide_fn" title="Link to this definition">¶</a></dt>
<dd><p>Return a function for extracting tidal hour
from the time/velocity given.
Use the _fn version if making repeated calls with different jd_new,
but the same jd,u</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interp1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_Interpolator1D</span></code></p>
<p>Interpolate a 1-D function.</p>
<p><cite>x</cite> and <cite>y</cite> are arrays of values used to approximate some function f:
<code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">f(x)</span></code>. This class returns a function whose call method uses
interpolation to find the value of new points.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier">(npoints, ) array_like</span></dt><dd><p>A 1-D array of real values.</p>
</dd>
<dt><strong>y</strong><span class="classifier">(…, npoints, …) array_like</span></dt><dd><p>A N-D array of real values. The length of <cite>y</cite> along the interpolation
axis must be equal to the length of <cite>x</cite>. Use the <code class="docutils literal notranslate"><span class="pre">axis</span></code> parameter
to select correct axis. Unlike other interpolators, the default
interpolation axis is the last axis of <cite>y</cite>.</p>
</dd>
<dt><strong>kind</strong><span class="classifier">str or int, optional</span></dt><dd><p>Specifies the kind of interpolation as a string or as an integer
specifying the order of the spline interpolator to use.
The string has to be one of ‘linear’, ‘nearest’, ‘nearest-up’, ‘zero’,
‘slinear’, ‘quadratic’, ‘cubic’, ‘previous’, or ‘next’. ‘zero’,
‘slinear’, ‘quadratic’ and ‘cubic’ refer to a spline interpolation of
zeroth, first, second or third order; ‘previous’ and ‘next’ simply
return the previous or next value of the point; ‘nearest-up’ and
‘nearest’ differ when interpolating half-integers (e.g. 0.5, 1.5)
in that ‘nearest-up’ rounds up and ‘nearest’ rounds down. Default
is ‘linear’.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>Axis in the <code class="docutils literal notranslate"><span class="pre">y</span></code> array corresponding to the x-coordinate values. Unlike
other interpolators, defaults to <code class="docutils literal notranslate"><span class="pre">axis=-1</span></code>.</p>
</dd>
<dt><strong>copy</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, the class makes internal copies of x and y.
If False, references to <cite>x</cite> and <cite>y</cite> are used. The default is to copy.</p>
</dd>
<dt><strong>bounds_error</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, a ValueError is raised any time interpolation is attempted on
a value outside of the range of x (where extrapolation is
necessary). If False, out of bounds values are assigned <cite>fill_value</cite>.
By default, an error is raised unless <code class="docutils literal notranslate"><span class="pre">fill_value=&quot;extrapolate&quot;</span></code>.</p>
</dd>
<dt><strong>fill_value</strong><span class="classifier">array-like or (array-like, array_like) or “extrapolate”, optional</span></dt><dd><ul>
<li><p>if a ndarray (or float), this value will be used to fill in for
requested points outside of the data range. If not provided, then
the default is NaN. The array-like must broadcast properly to the
dimensions of the non-interpolation axes.</p></li>
<li><p>If a two-element tuple, then the first element is used as a
fill value for <code class="docutils literal notranslate"><span class="pre">x_new</span> <span class="pre">&lt;</span> <span class="pre">x[0]</span></code> and the second element is used for
<code class="docutils literal notranslate"><span class="pre">x_new</span> <span class="pre">&gt;</span> <span class="pre">x[-1]</span></code>. Anything that is not a 2-element tuple (e.g.,
list or ndarray, regardless of shape) is taken to be a single
array-like argument meant to be used for both bounds as
<code class="docutils literal notranslate"><span class="pre">below,</span> <span class="pre">above</span> <span class="pre">=</span> <span class="pre">fill_value,</span> <span class="pre">fill_value</span></code>. Using a two-element tuple
or ndarray requires <code class="docutils literal notranslate"><span class="pre">bounds_error=False</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.17.0.</span></p>
</div>
</li>
<li><p>If “extrapolate”, then points outside the data range will be
extrapolated.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.17.0.</span></p>
</div>
</li>
</ul>
</dd>
<dt><strong>assume_sorted</strong><span class="classifier">bool, optional</span></dt><dd><p>If False, values of <cite>x</cite> can be in any order and they are sorted first.
If True, <cite>x</cite> has to be an array of monotonically increasing values.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">splrep</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">splev</span></code></dt><dd><p>Spline interpolation/smoothing based on FITPACK.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">UnivariateSpline</span></code></dt><dd><p>An object-oriented wrapper of the FITPACK routines.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">interp2d</span></code></dt><dd><p>2-D interpolation</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Calling <cite>interp1d</cite> with NaNs present in input values results in
undefined behaviour.</p>
<p>Input values <cite>x</cite> and <cite>y</cite> must be convertible to <cite>float</cite> values like
<cite>int</cite> or <cite>float</cite>.</p>
<p>If the values in <cite>x</cite> are not unique, the resulting behavior is
undefined and specific to the choice of <cite>kind</cite>, i.e., changing
<cite>kind</cite> will change the behavior for duplicates.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xnew</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ynew</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span>   <span class="c1"># use interpolation function returned by `interp1d`</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">xnew</span><span class="p">,</span> <span class="n">ynew</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference internal" href="#vtools.functions.tidalhours.interp1d.fill_value" title="vtools.functions.tidalhours.interp1d.fill_value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fill_value</span></code></a></dt><dd><p>The fill value.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(x)</p></td>
<td><p>Evaluate the interpolant</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d.__dict__">
<span class="sig-name descname"><span class="pre">__dict__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">mappingproxy({'__module__':</span> <span class="pre">'scipy.interpolate._interpolate',</span> <span class="pre">'__doc__':</span> <span class="pre">'\n</span>&#160;&#160;&#160; <span class="pre">Interpolate</span> <span class="pre">a</span> <span class="pre">1-D</span> <span class="pre">function.\n\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">legacy::</span> <span class="pre">class\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">For</span> <span class="pre">a</span> <span class="pre">guide</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">intended</span> <span class="pre">replacements</span> <span class="pre">for</span> <span class="pre">`interp1d`</span> <span class="pre">see\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">:ref:`tutorial-interpolate_1Dsection`.\n\n</span>&#160;&#160;&#160; <span class="pre">`x`</span> <span class="pre">and</span> <span class="pre">`y`</span> <span class="pre">are</span> <span class="pre">arrays</span> <span class="pre">of</span> <span class="pre">values</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">approximate</span> <span class="pre">some</span> <span class="pre">function</span> <span class="pre">f:\n</span>&#160;&#160;&#160; <span class="pre">``y</span> <span class="pre">=</span> <span class="pre">f(x)``.</span> <span class="pre">This</span> <span class="pre">class</span> <span class="pre">returns</span> <span class="pre">a</span> <span class="pre">function</span> <span class="pre">whose</span> <span class="pre">call</span> <span class="pre">method</span> <span class="pre">uses\n</span>&#160;&#160;&#160; <span class="pre">interpolation</span> <span class="pre">to</span> <span class="pre">find</span> <span class="pre">the</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">new</span> <span class="pre">points.\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">x</span> <span class="pre">:</span> <span class="pre">(npoints,</span> <span class="pre">)</span> <span class="pre">array_like\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">1-D</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">real</span> <span class="pre">values.\n</span>&#160;&#160;&#160; <span class="pre">y</span> <span class="pre">:</span> <span class="pre">(...,</span> <span class="pre">npoints,</span> <span class="pre">...)</span> <span class="pre">array_like\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">N-D</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">real</span> <span class="pre">values.</span> <span class="pre">The</span> <span class="pre">length</span> <span class="pre">of</span> <span class="pre">`y`</span> <span class="pre">along</span> <span class="pre">the</span> <span class="pre">interpolation\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">axis</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">equal</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">length</span> <span class="pre">of</span> <span class="pre">`x`.</span> <span class="pre">Use</span> <span class="pre">the</span> <span class="pre">``axis``</span> <span class="pre">parameter\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">to</span> <span class="pre">select</span> <span class="pre">correct</span> <span class="pre">axis.</span> <span class="pre">Unlike</span> <span class="pre">other</span> <span class="pre">interpolators,</span> <span class="pre">the</span> <span class="pre">default\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">interpolation</span> <span class="pre">axis</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">last</span> <span class="pre">axis</span> <span class="pre">of</span> <span class="pre">`y`.\n</span>&#160;&#160;&#160; <span class="pre">kind</span> <span class="pre">:</span> <span class="pre">str</span> <span class="pre">or</span> <span class="pre">int,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Specifies</span> <span class="pre">the</span> <span class="pre">kind</span> <span class="pre">of</span> <span class="pre">interpolation</span> <span class="pre">as</span> <span class="pre">a</span> <span class="pre">string</span> <span class="pre">or</span> <span class="pre">as</span> <span class="pre">an</span> <span class="pre">integer\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">specifying</span> <span class="pre">the</span> <span class="pre">order</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">spline</span> <span class="pre">interpolator</span> <span class="pre">to</span> <span class="pre">use.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">string</span> <span class="pre">has</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">one</span> <span class="pre">of</span> <span class="pre">\'linear\',</span> <span class="pre">\'nearest\',</span> <span class="pre">\'nearest-up\',</span> <span class="pre">\'zero\',\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\'slinear\',</span> <span class="pre">\'quadratic\',</span> <span class="pre">\'cubic\',</span> <span class="pre">\'previous\',</span> <span class="pre">or</span> <span class="pre">\'next\'.</span> <span class="pre">\'zero\',\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\'slinear\',</span> <span class="pre">\'quadratic\'</span> <span class="pre">and</span> <span class="pre">\'cubic\'</span> <span class="pre">refer</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">spline</span> <span class="pre">interpolation</span> <span class="pre">of\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">zeroth,</span> <span class="pre">first,</span> <span class="pre">second</span> <span class="pre">or</span> <span class="pre">third</span> <span class="pre">order;</span> <span class="pre">\'previous\'</span> <span class="pre">and</span> <span class="pre">\'next\'</span> <span class="pre">simply\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">return</span> <span class="pre">the</span> <span class="pre">previous</span> <span class="pre">or</span> <span class="pre">next</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">point;</span> <span class="pre">\'nearest-up\'</span> <span class="pre">and\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\'nearest\'</span> <span class="pre">differ</span> <span class="pre">when</span> <span class="pre">interpolating</span> <span class="pre">half-integers</span> <span class="pre">(e.g.</span> <span class="pre">0.5,</span> <span class="pre">1.5)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">in</span> <span class="pre">that</span> <span class="pre">\'nearest-up\'</span> <span class="pre">rounds</span> <span class="pre">up</span> <span class="pre">and</span> <span class="pre">\'nearest\'</span> <span class="pre">rounds</span> <span class="pre">down.</span> <span class="pre">Default\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">is</span> <span class="pre">\'linear\'.\n</span>&#160;&#160;&#160; <span class="pre">axis</span> <span class="pre">:</span> <span class="pre">int,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Axis</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">``y``</span> <span class="pre">array</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">x-coordinate</span> <span class="pre">values.</span> <span class="pre">Unlike\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">other</span> <span class="pre">interpolators,</span> <span class="pre">defaults</span> <span class="pre">to</span> <span class="pre">``axis=-1``.\n</span>&#160;&#160;&#160; <span class="pre">copy</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">True,</span> <span class="pre">the</span> <span class="pre">class</span> <span class="pre">makes</span> <span class="pre">internal</span> <span class="pre">copies</span> <span class="pre">of</span> <span class="pre">x</span> <span class="pre">and</span> <span class="pre">y.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">False,</span> <span class="pre">references</span> <span class="pre">to</span> <span class="pre">`x`</span> <span class="pre">and</span> <span class="pre">`y`</span> <span class="pre">are</span> <span class="pre">used.</span> <span class="pre">The</span> <span class="pre">default</span> <span class="pre">is</span> <span class="pre">to</span> <span class="pre">copy.\n</span>&#160;&#160;&#160; <span class="pre">bounds_error</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">True,</span> <span class="pre">a</span> <span class="pre">ValueError</span> <span class="pre">is</span> <span class="pre">raised</span> <span class="pre">any</span> <span class="pre">time</span> <span class="pre">interpolation</span> <span class="pre">is</span> <span class="pre">attempted</span> <span class="pre">on\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">a</span> <span class="pre">value</span> <span class="pre">outside</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">range</span> <span class="pre">of</span> <span class="pre">x</span> <span class="pre">(where</span> <span class="pre">extrapolation</span> <span class="pre">is\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">necessary).</span> <span class="pre">If</span> <span class="pre">False,</span> <span class="pre">out</span> <span class="pre">of</span> <span class="pre">bounds</span> <span class="pre">values</span> <span class="pre">are</span> <span class="pre">assigned</span> <span class="pre">`fill_value`.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">By</span> <span class="pre">default,</span> <span class="pre">an</span> <span class="pre">error</span> <span class="pre">is</span> <span class="pre">raised</span> <span class="pre">unless</span> <span class="pre">``fill_value=&quot;extrapolate&quot;``.\n</span>&#160;&#160;&#160; <span class="pre">fill_value</span> <span class="pre">:</span> <span class="pre">array-like</span> <span class="pre">or</span> <span class="pre">(array-like,</span> <span class="pre">array_like)</span> <span class="pre">or</span> <span class="pre">&quot;extrapolate&quot;,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">if</span> <span class="pre">a</span> <span class="pre">ndarray</span> <span class="pre">(or</span> <span class="pre">float),</span> <span class="pre">this</span> <span class="pre">value</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">fill</span> <span class="pre">in</span> <span class="pre">for\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">requested</span> <span class="pre">points</span> <span class="pre">outside</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">range.</span> <span class="pre">If</span> <span class="pre">not</span> <span class="pre">provided,</span> <span class="pre">then\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">the</span> <span class="pre">default</span> <span class="pre">is</span> <span class="pre">NaN.</span> <span class="pre">The</span> <span class="pre">array-like</span> <span class="pre">must</span> <span class="pre">broadcast</span> <span class="pre">properly</span> <span class="pre">to</span> <span class="pre">the\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">dimensions</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">non-interpolation</span> <span class="pre">axes.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">If</span> <span class="pre">a</span> <span class="pre">two-element</span> <span class="pre">tuple,</span> <span class="pre">then</span> <span class="pre">the</span> <span class="pre">first</span> <span class="pre">element</span> <span class="pre">is</span> <span class="pre">used</span> <span class="pre">as</span> <span class="pre">a\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">fill</span> <span class="pre">value</span> <span class="pre">for</span> <span class="pre">``x_new</span> <span class="pre">&lt;</span> <span class="pre">x[0]``</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">second</span> <span class="pre">element</span> <span class="pre">is</span> <span class="pre">used</span> <span class="pre">for\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">``x_new</span> <span class="pre">&gt;</span> <span class="pre">x[-1]``.</span> <span class="pre">Anything</span> <span class="pre">that</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">a</span> <span class="pre">2-element</span> <span class="pre">tuple</span> <span class="pre">(e.g.,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">list</span> <span class="pre">or</span> <span class="pre">ndarray,</span> <span class="pre">regardless</span> <span class="pre">of</span> <span class="pre">shape)</span> <span class="pre">is</span> <span class="pre">taken</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">single\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">array-like</span> <span class="pre">argument</span> <span class="pre">meant</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">used</span> <span class="pre">for</span> <span class="pre">both</span> <span class="pre">bounds</span> <span class="pre">as\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">``below,</span> <span class="pre">above</span> <span class="pre">=</span> <span class="pre">fill_value,</span> <span class="pre">fill_value``.</span> <span class="pre">Using</span> <span class="pre">a</span> <span class="pre">two-element</span> <span class="pre">tuple\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">or</span> <span class="pre">ndarray</span> <span class="pre">requires</span> <span class="pre">``bounds_error=False``.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">0.17.0\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">If</span> <span class="pre">&quot;extrapolate&quot;,</span> <span class="pre">then</span> <span class="pre">points</span> <span class="pre">outside</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">range</span> <span class="pre">will</span> <span class="pre">be\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">extrapolated.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">0.17.0\n</span>&#160;&#160;&#160; <span class="pre">assume_sorted</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">False,</span> <span class="pre">values</span> <span class="pre">of</span> <span class="pre">`x`</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">in</span> <span class="pre">any</span> <span class="pre">order</span> <span class="pre">and</span> <span class="pre">they</span> <span class="pre">are</span> <span class="pre">sorted</span> <span class="pre">first.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">True,</span> <span class="pre">`x`</span> <span class="pre">has</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">an</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">monotonically</span> <span class="pre">increasing</span> <span class="pre">values.\n\n</span>&#160;&#160;&#160; <span class="pre">Attributes\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">fill_value\n\n</span>&#160;&#160;&#160; <span class="pre">Methods\n</span>&#160;&#160;&#160; <span class="pre">-------\n</span>&#160;&#160;&#160; <span class="pre">__call__\n\n</span>&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">Also\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">splrep,</span> <span class="pre">splev\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Spline</span> <span class="pre">interpolation/smoothing</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">FITPACK.\n</span>&#160;&#160;&#160; <span class="pre">UnivariateSpline</span> <span class="pre">:</span> <span class="pre">An</span> <span class="pre">object-oriented</span> <span class="pre">wrapper</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">FITPACK</span> <span class="pre">routines.\n</span>&#160;&#160;&#160; <span class="pre">interp2d</span> <span class="pre">:</span> <span class="pre">2-D</span> <span class="pre">interpolation\n\n</span>&#160;&#160;&#160; <span class="pre">Notes\n</span>&#160;&#160;&#160; <span class="pre">-----\n</span>&#160;&#160;&#160; <span class="pre">Calling</span> <span class="pre">`interp1d`</span> <span class="pre">with</span> <span class="pre">NaNs</span> <span class="pre">present</span> <span class="pre">in</span> <span class="pre">input</span> <span class="pre">values</span> <span class="pre">results</span> <span class="pre">in\n</span>&#160;&#160;&#160; <span class="pre">undefined</span> <span class="pre">behaviour.\n\n</span>&#160;&#160;&#160; <span class="pre">Input</span> <span class="pre">values</span> <span class="pre">`x`</span> <span class="pre">and</span> <span class="pre">`y`</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">convertible</span> <span class="pre">to</span> <span class="pre">`float`</span> <span class="pre">values</span> <span class="pre">like\n</span>&#160;&#160;&#160; <span class="pre">`int`</span> <span class="pre">or</span> <span class="pre">`float`.\n\n</span>&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">the</span> <span class="pre">values</span> <span class="pre">in</span> <span class="pre">`x`</span> <span class="pre">are</span> <span class="pre">not</span> <span class="pre">unique,</span> <span class="pre">the</span> <span class="pre">resulting</span> <span class="pre">behavior</span> <span class="pre">is\n</span>&#160;&#160;&#160; <span class="pre">undefined</span> <span class="pre">and</span> <span class="pre">specific</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">choice</span> <span class="pre">of</span> <span class="pre">`kind`,</span> <span class="pre">i.e.,</span> <span class="pre">changing\n</span>&#160;&#160;&#160; <span class="pre">`kind`</span> <span class="pre">will</span> <span class="pre">change</span> <span class="pre">the</span> <span class="pre">behavior</span> <span class="pre">for</span> <span class="pre">duplicates.\n\n\n</span>&#160;&#160;&#160; <span class="pre">Examples\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">import</span> <span class="pre">matplotlib.pyplot</span> <span class="pre">as</span> <span class="pre">plt\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">from</span> <span class="pre">scipy</span> <span class="pre">import</span> <span class="pre">interpolate\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">np.arange(0,</span> <span class="pre">10)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">np.exp(-x/3.0)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">f</span> <span class="pre">=</span> <span class="pre">interpolate.interp1d(x,</span> <span class="pre">y)\n\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">xnew</span> <span class="pre">=</span> <span class="pre">np.arange(0,</span> <span class="pre">9,</span> <span class="pre">0.1)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">ynew</span> <span class="pre">=</span> <span class="pre">f(xnew)</span>&#160;&#160; <span class="pre">#</span> <span class="pre">use</span> <span class="pre">interpolation</span> <span class="pre">function</span> <span class="pre">returned</span> <span class="pre">by</span> <span class="pre">`interp1d`\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">plt.plot(x,</span> <span class="pre">y,</span> <span class="pre">\'o\',</span> <span class="pre">xnew,</span> <span class="pre">ynew,</span> <span class="pre">\'-\')\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">plt.show()\n</span>&#160;&#160;&#160; <span class="pre">',</span> <span class="pre">'__init__':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d.__init__&gt;,</span> <span class="pre">'fill_value':</span> <span class="pre">&lt;property</span> <span class="pre">object&gt;,</span> <span class="pre">'_check_and_update_bounds_error_for_extrapolation':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._check_and_update_bounds_error_for_extrapolation&gt;,</span> <span class="pre">'_call_linear_np':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._call_linear_np&gt;,</span> <span class="pre">'_call_linear':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._call_linear&gt;,</span> <span class="pre">'_call_nearest':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._call_nearest&gt;,</span> <span class="pre">'_call_previousnext':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._call_previousnext&gt;,</span> <span class="pre">'_call_spline':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._call_spline&gt;,</span> <span class="pre">'_call_nan_spline':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._call_nan_spline&gt;,</span> <span class="pre">'_evaluate':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._evaluate&gt;,</span> <span class="pre">'_check_bounds':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._check_bounds&gt;,</span> <span class="pre">'__dict__':</span> <span class="pre">&lt;attribute</span> <span class="pre">'__dict__'</span> <span class="pre">of</span> <span class="pre">'interp1d'</span> <span class="pre">objects&gt;,</span> <span class="pre">'__weakref__':</span> <span class="pre">&lt;attribute</span> <span class="pre">'__weakref__'</span> <span class="pre">of</span> <span class="pre">'interp1d'</span> <span class="pre">objects&gt;,</span> <span class="pre">'__annotations__':</span> <span class="pre">{}})</span></em><a class="headerlink" href="#vtools.functions.tidalhours.interp1d.__dict__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'\n</span>&#160;&#160;&#160; <span class="pre">Interpolate</span> <span class="pre">a</span> <span class="pre">1-D</span> <span class="pre">function.\n\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">legacy::</span> <span class="pre">class\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">For</span> <span class="pre">a</span> <span class="pre">guide</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">intended</span> <span class="pre">replacements</span> <span class="pre">for</span> <span class="pre">`interp1d`</span> <span class="pre">see\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">:ref:`tutorial-interpolate_1Dsection`.\n\n</span>&#160;&#160;&#160; <span class="pre">`x`</span> <span class="pre">and</span> <span class="pre">`y`</span> <span class="pre">are</span> <span class="pre">arrays</span> <span class="pre">of</span> <span class="pre">values</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">approximate</span> <span class="pre">some</span> <span class="pre">function</span> <span class="pre">f:\n</span>&#160;&#160;&#160; <span class="pre">``y</span> <span class="pre">=</span> <span class="pre">f(x)``.</span> <span class="pre">This</span> <span class="pre">class</span> <span class="pre">returns</span> <span class="pre">a</span> <span class="pre">function</span> <span class="pre">whose</span> <span class="pre">call</span> <span class="pre">method</span> <span class="pre">uses\n</span>&#160;&#160;&#160; <span class="pre">interpolation</span> <span class="pre">to</span> <span class="pre">find</span> <span class="pre">the</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">new</span> <span class="pre">points.\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">x</span> <span class="pre">:</span> <span class="pre">(npoints,</span> <span class="pre">)</span> <span class="pre">array_like\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">1-D</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">real</span> <span class="pre">values.\n</span>&#160;&#160;&#160; <span class="pre">y</span> <span class="pre">:</span> <span class="pre">(...,</span> <span class="pre">npoints,</span> <span class="pre">...)</span> <span class="pre">array_like\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">N-D</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">real</span> <span class="pre">values.</span> <span class="pre">The</span> <span class="pre">length</span> <span class="pre">of</span> <span class="pre">`y`</span> <span class="pre">along</span> <span class="pre">the</span> <span class="pre">interpolation\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">axis</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">equal</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">length</span> <span class="pre">of</span> <span class="pre">`x`.</span> <span class="pre">Use</span> <span class="pre">the</span> <span class="pre">``axis``</span> <span class="pre">parameter\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">to</span> <span class="pre">select</span> <span class="pre">correct</span> <span class="pre">axis.</span> <span class="pre">Unlike</span> <span class="pre">other</span> <span class="pre">interpolators,</span> <span class="pre">the</span> <span class="pre">default\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">interpolation</span> <span class="pre">axis</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">last</span> <span class="pre">axis</span> <span class="pre">of</span> <span class="pre">`y`.\n</span>&#160;&#160;&#160; <span class="pre">kind</span> <span class="pre">:</span> <span class="pre">str</span> <span class="pre">or</span> <span class="pre">int,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Specifies</span> <span class="pre">the</span> <span class="pre">kind</span> <span class="pre">of</span> <span class="pre">interpolation</span> <span class="pre">as</span> <span class="pre">a</span> <span class="pre">string</span> <span class="pre">or</span> <span class="pre">as</span> <span class="pre">an</span> <span class="pre">integer\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">specifying</span> <span class="pre">the</span> <span class="pre">order</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">spline</span> <span class="pre">interpolator</span> <span class="pre">to</span> <span class="pre">use.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">string</span> <span class="pre">has</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">one</span> <span class="pre">of</span> <span class="pre">\'linear\',</span> <span class="pre">\'nearest\',</span> <span class="pre">\'nearest-up\',</span> <span class="pre">\'zero\',\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\'slinear\',</span> <span class="pre">\'quadratic\',</span> <span class="pre">\'cubic\',</span> <span class="pre">\'previous\',</span> <span class="pre">or</span> <span class="pre">\'next\'.</span> <span class="pre">\'zero\',\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\'slinear\',</span> <span class="pre">\'quadratic\'</span> <span class="pre">and</span> <span class="pre">\'cubic\'</span> <span class="pre">refer</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">spline</span> <span class="pre">interpolation</span> <span class="pre">of\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">zeroth,</span> <span class="pre">first,</span> <span class="pre">second</span> <span class="pre">or</span> <span class="pre">third</span> <span class="pre">order;</span> <span class="pre">\'previous\'</span> <span class="pre">and</span> <span class="pre">\'next\'</span> <span class="pre">simply\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">return</span> <span class="pre">the</span> <span class="pre">previous</span> <span class="pre">or</span> <span class="pre">next</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">point;</span> <span class="pre">\'nearest-up\'</span> <span class="pre">and\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\'nearest\'</span> <span class="pre">differ</span> <span class="pre">when</span> <span class="pre">interpolating</span> <span class="pre">half-integers</span> <span class="pre">(e.g.</span> <span class="pre">0.5,</span> <span class="pre">1.5)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">in</span> <span class="pre">that</span> <span class="pre">\'nearest-up\'</span> <span class="pre">rounds</span> <span class="pre">up</span> <span class="pre">and</span> <span class="pre">\'nearest\'</span> <span class="pre">rounds</span> <span class="pre">down.</span> <span class="pre">Default\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">is</span> <span class="pre">\'linear\'.\n</span>&#160;&#160;&#160; <span class="pre">axis</span> <span class="pre">:</span> <span class="pre">int,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Axis</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">``y``</span> <span class="pre">array</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">x-coordinate</span> <span class="pre">values.</span> <span class="pre">Unlike\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">other</span> <span class="pre">interpolators,</span> <span class="pre">defaults</span> <span class="pre">to</span> <span class="pre">``axis=-1``.\n</span>&#160;&#160;&#160; <span class="pre">copy</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">True,</span> <span class="pre">the</span> <span class="pre">class</span> <span class="pre">makes</span> <span class="pre">internal</span> <span class="pre">copies</span> <span class="pre">of</span> <span class="pre">x</span> <span class="pre">and</span> <span class="pre">y.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">False,</span> <span class="pre">references</span> <span class="pre">to</span> <span class="pre">`x`</span> <span class="pre">and</span> <span class="pre">`y`</span> <span class="pre">are</span> <span class="pre">used.</span> <span class="pre">The</span> <span class="pre">default</span> <span class="pre">is</span> <span class="pre">to</span> <span class="pre">copy.\n</span>&#160;&#160;&#160; <span class="pre">bounds_error</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">True,</span> <span class="pre">a</span> <span class="pre">ValueError</span> <span class="pre">is</span> <span class="pre">raised</span> <span class="pre">any</span> <span class="pre">time</span> <span class="pre">interpolation</span> <span class="pre">is</span> <span class="pre">attempted</span> <span class="pre">on\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">a</span> <span class="pre">value</span> <span class="pre">outside</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">range</span> <span class="pre">of</span> <span class="pre">x</span> <span class="pre">(where</span> <span class="pre">extrapolation</span> <span class="pre">is\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">necessary).</span> <span class="pre">If</span> <span class="pre">False,</span> <span class="pre">out</span> <span class="pre">of</span> <span class="pre">bounds</span> <span class="pre">values</span> <span class="pre">are</span> <span class="pre">assigned</span> <span class="pre">`fill_value`.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">By</span> <span class="pre">default,</span> <span class="pre">an</span> <span class="pre">error</span> <span class="pre">is</span> <span class="pre">raised</span> <span class="pre">unless</span> <span class="pre">``fill_value=&quot;extrapolate&quot;``.\n</span>&#160;&#160;&#160; <span class="pre">fill_value</span> <span class="pre">:</span> <span class="pre">array-like</span> <span class="pre">or</span> <span class="pre">(array-like,</span> <span class="pre">array_like)</span> <span class="pre">or</span> <span class="pre">&quot;extrapolate&quot;,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">if</span> <span class="pre">a</span> <span class="pre">ndarray</span> <span class="pre">(or</span> <span class="pre">float),</span> <span class="pre">this</span> <span class="pre">value</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">fill</span> <span class="pre">in</span> <span class="pre">for\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">requested</span> <span class="pre">points</span> <span class="pre">outside</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">range.</span> <span class="pre">If</span> <span class="pre">not</span> <span class="pre">provided,</span> <span class="pre">then\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">the</span> <span class="pre">default</span> <span class="pre">is</span> <span class="pre">NaN.</span> <span class="pre">The</span> <span class="pre">array-like</span> <span class="pre">must</span> <span class="pre">broadcast</span> <span class="pre">properly</span> <span class="pre">to</span> <span class="pre">the\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">dimensions</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">non-interpolation</span> <span class="pre">axes.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">If</span> <span class="pre">a</span> <span class="pre">two-element</span> <span class="pre">tuple,</span> <span class="pre">then</span> <span class="pre">the</span> <span class="pre">first</span> <span class="pre">element</span> <span class="pre">is</span> <span class="pre">used</span> <span class="pre">as</span> <span class="pre">a\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">fill</span> <span class="pre">value</span> <span class="pre">for</span> <span class="pre">``x_new</span> <span class="pre">&lt;</span> <span class="pre">x[0]``</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">second</span> <span class="pre">element</span> <span class="pre">is</span> <span class="pre">used</span> <span class="pre">for\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">``x_new</span> <span class="pre">&gt;</span> <span class="pre">x[-1]``.</span> <span class="pre">Anything</span> <span class="pre">that</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">a</span> <span class="pre">2-element</span> <span class="pre">tuple</span> <span class="pre">(e.g.,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">list</span> <span class="pre">or</span> <span class="pre">ndarray,</span> <span class="pre">regardless</span> <span class="pre">of</span> <span class="pre">shape)</span> <span class="pre">is</span> <span class="pre">taken</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">single\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">array-like</span> <span class="pre">argument</span> <span class="pre">meant</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">used</span> <span class="pre">for</span> <span class="pre">both</span> <span class="pre">bounds</span> <span class="pre">as\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">``below,</span> <span class="pre">above</span> <span class="pre">=</span> <span class="pre">fill_value,</span> <span class="pre">fill_value``.</span> <span class="pre">Using</span> <span class="pre">a</span> <span class="pre">two-element</span> <span class="pre">tuple\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">or</span> <span class="pre">ndarray</span> <span class="pre">requires</span> <span class="pre">``bounds_error=False``.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">0.17.0\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">If</span> <span class="pre">&quot;extrapolate&quot;,</span> <span class="pre">then</span> <span class="pre">points</span> <span class="pre">outside</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">range</span> <span class="pre">will</span> <span class="pre">be\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">extrapolated.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">0.17.0\n</span>&#160;&#160;&#160; <span class="pre">assume_sorted</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">False,</span> <span class="pre">values</span> <span class="pre">of</span> <span class="pre">`x`</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">in</span> <span class="pre">any</span> <span class="pre">order</span> <span class="pre">and</span> <span class="pre">they</span> <span class="pre">are</span> <span class="pre">sorted</span> <span class="pre">first.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">True,</span> <span class="pre">`x`</span> <span class="pre">has</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">an</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">monotonically</span> <span class="pre">increasing</span> <span class="pre">values.\n\n</span>&#160;&#160;&#160; <span class="pre">Attributes\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">fill_value\n\n</span>&#160;&#160;&#160; <span class="pre">Methods\n</span>&#160;&#160;&#160; <span class="pre">-------\n</span>&#160;&#160;&#160; <span class="pre">__call__\n\n</span>&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">Also\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">splrep,</span> <span class="pre">splev\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Spline</span> <span class="pre">interpolation/smoothing</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">FITPACK.\n</span>&#160;&#160;&#160; <span class="pre">UnivariateSpline</span> <span class="pre">:</span> <span class="pre">An</span> <span class="pre">object-oriented</span> <span class="pre">wrapper</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">FITPACK</span> <span class="pre">routines.\n</span>&#160;&#160;&#160; <span class="pre">interp2d</span> <span class="pre">:</span> <span class="pre">2-D</span> <span class="pre">interpolation\n\n</span>&#160;&#160;&#160; <span class="pre">Notes\n</span>&#160;&#160;&#160; <span class="pre">-----\n</span>&#160;&#160;&#160; <span class="pre">Calling</span> <span class="pre">`interp1d`</span> <span class="pre">with</span> <span class="pre">NaNs</span> <span class="pre">present</span> <span class="pre">in</span> <span class="pre">input</span> <span class="pre">values</span> <span class="pre">results</span> <span class="pre">in\n</span>&#160;&#160;&#160; <span class="pre">undefined</span> <span class="pre">behaviour.\n\n</span>&#160;&#160;&#160; <span class="pre">Input</span> <span class="pre">values</span> <span class="pre">`x`</span> <span class="pre">and</span> <span class="pre">`y`</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">convertible</span> <span class="pre">to</span> <span class="pre">`float`</span> <span class="pre">values</span> <span class="pre">like\n</span>&#160;&#160;&#160; <span class="pre">`int`</span> <span class="pre">or</span> <span class="pre">`float`.\n\n</span>&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">the</span> <span class="pre">values</span> <span class="pre">in</span> <span class="pre">`x`</span> <span class="pre">are</span> <span class="pre">not</span> <span class="pre">unique,</span> <span class="pre">the</span> <span class="pre">resulting</span> <span class="pre">behavior</span> <span class="pre">is\n</span>&#160;&#160;&#160; <span class="pre">undefined</span> <span class="pre">and</span> <span class="pre">specific</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">choice</span> <span class="pre">of</span> <span class="pre">`kind`,</span> <span class="pre">i.e.,</span> <span class="pre">changing\n</span>&#160;&#160;&#160; <span class="pre">`kind`</span> <span class="pre">will</span> <span class="pre">change</span> <span class="pre">the</span> <span class="pre">behavior</span> <span class="pre">for</span> <span class="pre">duplicates.\n\n\n</span>&#160;&#160;&#160; <span class="pre">Examples\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">import</span> <span class="pre">matplotlib.pyplot</span> <span class="pre">as</span> <span class="pre">plt\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">from</span> <span class="pre">scipy</span> <span class="pre">import</span> <span class="pre">interpolate\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">np.arange(0,</span> <span class="pre">10)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">np.exp(-x/3.0)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">f</span> <span class="pre">=</span> <span class="pre">interpolate.interp1d(x,</span> <span class="pre">y)\n\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">xnew</span> <span class="pre">=</span> <span class="pre">np.arange(0,</span> <span class="pre">9,</span> <span class="pre">0.1)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">ynew</span> <span class="pre">=</span> <span class="pre">f(xnew)</span>&#160;&#160; <span class="pre">#</span> <span class="pre">use</span> <span class="pre">interpolation</span> <span class="pre">function</span> <span class="pre">returned</span> <span class="pre">by</span> <span class="pre">`interp1d`\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">plt.plot(x,</span> <span class="pre">y,</span> <span class="pre">\'o\',</span> <span class="pre">xnew,</span> <span class="pre">ynew,</span> <span class="pre">\'-\')\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">plt.show()\n</span>&#160;&#160;&#160; <span class="pre">'</span></em><a class="headerlink" href="#vtools.functions.tidalhours.interp1d.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize a 1-D linear interpolation class.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'scipy.interpolate._interpolate'</span></em><a class="headerlink" href="#vtools.functions.tidalhours.interp1d.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#vtools.functions.tidalhours.interp1d.__weakref__" title="Link to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._call_linear">
<span class="sig-name descname"><span class="pre">_call_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._call_linear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._call_linear" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._call_linear_np">
<span class="sig-name descname"><span class="pre">_call_linear_np</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._call_linear_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._call_linear_np" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._call_nan_spline">
<span class="sig-name descname"><span class="pre">_call_nan_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._call_nan_spline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._call_nan_spline" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._call_nearest">
<span class="sig-name descname"><span class="pre">_call_nearest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._call_nearest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._call_nearest" title="Link to this definition">¶</a></dt>
<dd><p>Find nearest neighbor interpolated y_new = f(x_new).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._call_previousnext">
<span class="sig-name descname"><span class="pre">_call_previousnext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._call_previousnext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._call_previousnext" title="Link to this definition">¶</a></dt>
<dd><p>Use previous/next neighbor of x_new, y_new = f(x_new).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._call_spline">
<span class="sig-name descname"><span class="pre">_call_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._call_spline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._call_spline" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._check_and_update_bounds_error_for_extrapolation">
<span class="sig-name descname"><span class="pre">_check_and_update_bounds_error_for_extrapolation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._check_and_update_bounds_error_for_extrapolation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._check_and_update_bounds_error_for_extrapolation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._check_bounds">
<span class="sig-name descname"><span class="pre">_check_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._check_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._check_bounds" title="Link to this definition">¶</a></dt>
<dd><p>Check the inputs for being in the bounds of the interpolated data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x_new</strong><span class="classifier">array</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out_of_bounds</strong><span class="classifier">bool array</span></dt><dd><p>The mask on x_new of values that are out of the bounds.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._evaluate">
<span class="sig-name descname"><span class="pre">_evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._evaluate" title="Link to this definition">¶</a></dt>
<dd><p>Actually evaluate the value of the interpolator.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._y_axis">
<span class="sig-name descname"><span class="pre">_y_axis</span></span><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._y_axis" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._y_extra_shape">
<span class="sig-name descname"><span class="pre">_y_extra_shape</span></span><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._y_extra_shape" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d.dtype">
<span class="sig-name descname"><span class="pre">dtype</span></span><a class="headerlink" href="#vtools.functions.tidalhours.interp1d.dtype" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d.fill_value">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fill_value</span></span><a class="headerlink" href="#vtools.functions.tidalhours.interp1d.fill_value" title="Link to this definition">¶</a></dt>
<dd><p>The fill value.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.tidal_hour_signal">
<span class="sig-name descname"><span class="pre">tidal_hour_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhours.html#tidal_hour_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.tidal_hour_signal" title="Link to this definition">¶</a></dt>
<dd><p>Compute the tidal hour of a semidiurnal signal.</p>
<p>This function returns the instantaneous phase-based tidal hour for a time series,
assuming a semidiurnal signal. Optionally applies a cosine Lanczos low-pass
filter (e.g., 40h) to isolate tidal components from subtidal or noisy fluctuations.</p>
<p>The tidal hour is computed using the phase of the analytic signal obtained
via the Hilbert transform. This phase is then scaled to range from 0 to 12 hours
to represent one semidiurnal tidal cycle. The output is a pandas Series aligned
with the input time index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts</strong><span class="classifier">pandas.Series</span></dt><dd><p>Time series of water level or other semidiurnal signal. Must have a datetime index.</p>
</dd>
<dt><strong>filter</strong><span class="classifier">bool, default True</span></dt><dd><p>Whether to apply a 40-hour cosine Lanczos filter to the input signal. If False,
uses the raw signal.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.Series</dt><dd><p>Tidal hour as a float (range [0, 12)), indexed by datetime.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#vtools.functions.tidalhours.diff_h" title="vtools.functions.tidalhours.diff_h"><code class="xref py py-obj docutils literal notranslate"><span class="pre">diff_h</span></code></a></dt><dd><p>Compute the derivative (rate of change) of tidal hour.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">cosine_lanczos</span></code></dt><dd><p>External function used to apply low-pass filtering.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The tidal hour is derived from the instantaneous phase of the analytic signal.
This signal is computed as:</p>
<blockquote>
<div><p><cite>analytic_signal = ts + 1j * hilbert(ts)</cite></p>
</div></blockquote>
<p>The phase (angle) of this complex signal varies smoothly over time and reflects
the oscillatory nature of the tide, allowing us to construct a continuous
representation of “tidal time” even between extrema.</p>
<p>The use of the Hilbert transform provides a smooth interpolation of the signal’s
phase progression, since it yields the narrow-band envelope and instantaneous phase
of the dominant frequency component (assumed to be semidiurnal here).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.tidal_hour_signal2">
<span class="sig-name descname"><span class="pre">tidal_hour_signal2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></span><a class="reference internal" href="_modules/vtools/functions/tidalhours.html#tidal_hour_signal2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.tidal_hour_signal2" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the tidal hour from a semidiurnal tidal signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts</strong><span class="classifier">pd.Series or pd.DataFrame</span></dt><dd><p>Input time series of water levels (must have datetime index)</p>
</dd>
<dt><strong>filter</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, apply Lanczos filter to remove low-frequency components (default True)
Note this is opposite of ‘leave_mean’ in original implementation</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pd.Series or pd.DataFrame</dt><dd><p>Tidal hour in datetime format (same shape as input)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The tidal hour represents the phase of the semidiurnal tide in temporal units.
The calculation uses complex interpolation for smooth phase estimation:
1. The Hilbert transform creates an analytic signal
2. The angle gives the instantaneous phase
3. Complex interpolation avoids phase jumps at 0/2π boundaries
4. This provides continuous phase evolution even during slack tides</p>
<p>If h/u distinction is needed, consider applying <cite>diff_h</cite> to separate
flood/ebb phases. The derivative was likely included in original code
to identify phase reversals during tidal current analysis.</p>
</dd></dl>

</section>
<section id="module-vtools.functions.transition">
<span id="vtools-functions-transition-module"></span><h2>vtools.functions.transition module<a class="headerlink" href="#module-vtools.functions.transition" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PchipInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_cubic.html#PchipInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">CubicHermiteSpline</span></code></p>
<p>PCHIP 1-D monotonic cubic interpolation.</p>
<p><code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are arrays of values used to approximate some function f,
with <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">f(x)</span></code>. The interpolant uses monotonic cubic splines
to find the value of new points. (PCHIP stands for Piecewise Cubic
Hermite Interpolating Polynomial).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">ndarray, shape (npoints, )</span></dt><dd><p>A 1-D array of monotonically increasing real values. <code class="docutils literal notranslate"><span class="pre">x</span></code> cannot
include duplicate values (otherwise f is overspecified)</p>
</dd>
<dt><strong>y</strong><span class="classifier">ndarray, shape (…, npoints, …)</span></dt><dd><p>A N-D array of real values. <code class="docutils literal notranslate"><span class="pre">y</span></code>’s length along the interpolation
axis must be equal to the length of <code class="docutils literal notranslate"><span class="pre">x</span></code>. Use the <code class="docutils literal notranslate"><span class="pre">axis</span></code>
parameter to select the interpolation axis.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>Axis in the <code class="docutils literal notranslate"><span class="pre">y</span></code> array corresponding to the x-coordinate values. Defaults
to <code class="docutils literal notranslate"><span class="pre">axis=0</span></code>.</p>
</dd>
<dt><strong>extrapolate</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to extrapolate to out-of-bounds points based on first
and last intervals, or to return NaNs.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">CubicHermiteSpline</span></code></dt><dd><p>Piecewise-cubic interpolator.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Akima1DInterpolator</span></code></dt><dd><p>Akima 1D interpolator.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">CubicSpline</span></code></dt><dd><p>Cubic spline data interpolator.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">PPoly</span></code></dt><dd><p>Piecewise polynomial in terms of coefficients and breakpoints.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The interpolator preserves monotonicity in the interpolation data and does
not overshoot if the data is not smooth.</p>
<p>The first derivatives are guaranteed to be continuous, but the second
derivatives may jump at <span class="math notranslate nohighlight">\(x_k\)</span>.</p>
<p>Determines the derivatives at the points <span class="math notranslate nohighlight">\(x_k\)</span>, <span class="math notranslate nohighlight">\(f'_k\)</span>,
by using PCHIP algorithm <a class="reference internal" href="#r22ca1057234e-1" id="id24">[1]</a>.</p>
<p>Let <span class="math notranslate nohighlight">\(h_k = x_{k+1} - x_k\)</span>, and  <span class="math notranslate nohighlight">\(d_k = (y_{k+1} - y_k) / h_k\)</span>
are the slopes at internal points <span class="math notranslate nohighlight">\(x_k\)</span>.
If the signs of <span class="math notranslate nohighlight">\(d_k\)</span> and <span class="math notranslate nohighlight">\(d_{k-1}\)</span> are different or either of
them equals zero, then <span class="math notranslate nohighlight">\(f'_k = 0\)</span>. Otherwise, it is given by the
weighted harmonic mean</p>
<div class="math notranslate nohighlight">
\[\frac{w_1 + w_2}{f'_k} = \frac{w_1}{d_{k-1}} + \frac{w_2}{d_k}\]</div>
<p>where <span class="math notranslate nohighlight">\(w_1 = 2 h_k + h_{k-1}\)</span> and <span class="math notranslate nohighlight">\(w_2 = h_k + 2 h_{k-1}\)</span>.</p>
<p>The end slopes are set using a one-sided scheme <a class="reference internal" href="#r22ca1057234e-2" id="id25">[2]</a>.</p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="r22ca1057234e-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id24">1</a><span class="fn-bracket">]</span></span>
<p>F. N. Fritsch and J. Butland,
A method for constructing local
monotone piecewise cubic interpolants,
SIAM J. Sci. Comput., 5(2), 300-304 (1984).
<a href="#id26"><span class="problematic" id="id27">:doi:`10.1137/0905021`</span></a>.</p>
</div>
<div class="citation" id="r22ca1057234e-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id25">2</a><span class="fn-bracket">]</span></span>
<p>see, e.g., C. Moler, Numerical Computing with Matlab, 2004.
<a href="#id28"><span class="problematic" id="id29">:doi:`10.1137/1.9780898717952`</span></a></p>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>axis</strong></dt><dd></dd>
<dt><strong>c</strong></dt><dd></dd>
<dt><strong>extrapolate</strong></dt><dd></dd>
<dt><strong>x</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(x[, nu, extrapolate])</p></td>
<td><p>Evaluate the piecewise polynomial or its derivative.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">derivative</span></code>([nu])</p></td>
<td><p>Construct a new piecewise polynomial representing the derivative.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">antiderivative</span></code>([nu])</p></td>
<td><p>Construct a new piecewise polynomial representing the antiderivative.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">roots</span></code>([discontinuity, extrapolate])</p></td>
<td><p>Find real roots of the piecewise polynomial.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator.__annotations__">
<span class="sig-name descname"><span class="pre">__annotations__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator.__annotations__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&quot;PCHIP</span> <span class="pre">1-D</span> <span class="pre">monotonic</span> <span class="pre">cubic</span> <span class="pre">interpolation.\n\n</span>&#160;&#160;&#160; <span class="pre">``x``</span> <span class="pre">and</span> <span class="pre">``y``</span> <span class="pre">are</span> <span class="pre">arrays</span> <span class="pre">of</span> <span class="pre">values</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">approximate</span> <span class="pre">some</span> <span class="pre">function</span> <span class="pre">f,\n</span>&#160;&#160;&#160; <span class="pre">with</span> <span class="pre">``y</span> <span class="pre">=</span> <span class="pre">f(x)``.</span> <span class="pre">The</span> <span class="pre">interpolant</span> <span class="pre">uses</span> <span class="pre">monotonic</span> <span class="pre">cubic</span> <span class="pre">splines\n</span>&#160;&#160;&#160; <span class="pre">to</span> <span class="pre">find</span> <span class="pre">the</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">new</span> <span class="pre">points.</span> <span class="pre">(PCHIP</span> <span class="pre">stands</span> <span class="pre">for</span> <span class="pre">Piecewise</span> <span class="pre">Cubic\n</span>&#160;&#160;&#160; <span class="pre">Hermite</span> <span class="pre">Interpolating</span> <span class="pre">Polynomial).\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">x</span> <span class="pre">:</span> <span class="pre">ndarray,</span> <span class="pre">shape</span> <span class="pre">(npoints,</span> <span class="pre">)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">1-D</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">monotonically</span> <span class="pre">increasing</span> <span class="pre">real</span> <span class="pre">values.</span> <span class="pre">``x``</span> <span class="pre">cannot\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">include</span> <span class="pre">duplicate</span> <span class="pre">values</span> <span class="pre">(otherwise</span> <span class="pre">f</span> <span class="pre">is</span> <span class="pre">overspecified)\n</span>&#160;&#160;&#160; <span class="pre">y</span> <span class="pre">:</span> <span class="pre">ndarray,</span> <span class="pre">shape</span> <span class="pre">(...,</span> <span class="pre">npoints,</span> <span class="pre">...)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">N-D</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">real</span> <span class="pre">values.</span> <span class="pre">``y``'s</span> <span class="pre">length</span> <span class="pre">along</span> <span class="pre">the</span> <span class="pre">interpolation\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">axis</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">equal</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">length</span> <span class="pre">of</span> <span class="pre">``x``.</span> <span class="pre">Use</span> <span class="pre">the</span> <span class="pre">``axis``\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">parameter</span> <span class="pre">to</span> <span class="pre">select</span> <span class="pre">the</span> <span class="pre">interpolation</span> <span class="pre">axis.\n</span>&#160;&#160;&#160; <span class="pre">axis</span> <span class="pre">:</span> <span class="pre">int,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Axis</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">``y``</span> <span class="pre">array</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">x-coordinate</span> <span class="pre">values.</span> <span class="pre">Defaults\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">to</span> <span class="pre">``axis=0``.\n</span>&#160;&#160;&#160; <span class="pre">extrapolate</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Whether</span> <span class="pre">to</span> <span class="pre">extrapolate</span> <span class="pre">to</span> <span class="pre">out-of-bounds</span> <span class="pre">points</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">first\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">and</span> <span class="pre">last</span> <span class="pre">intervals,</span> <span class="pre">or</span> <span class="pre">to</span> <span class="pre">return</span> <span class="pre">NaNs.\n\n</span>&#160;&#160;&#160; <span class="pre">Methods\n</span>&#160;&#160;&#160; <span class="pre">-------\n</span>&#160;&#160;&#160; <span class="pre">__call__\n</span>&#160;&#160;&#160; <span class="pre">derivative\n</span>&#160;&#160;&#160; <span class="pre">antiderivative\n</span>&#160;&#160;&#160; <span class="pre">roots\n\n</span>&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">Also\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">CubicHermiteSpline</span> <span class="pre">:</span> <span class="pre">Piecewise-cubic</span> <span class="pre">interpolator.\n</span>&#160;&#160;&#160; <span class="pre">Akima1DInterpolator</span> <span class="pre">:</span> <span class="pre">Akima</span> <span class="pre">1D</span> <span class="pre">interpolator.\n</span>&#160;&#160;&#160; <span class="pre">CubicSpline</span> <span class="pre">:</span> <span class="pre">Cubic</span> <span class="pre">spline</span> <span class="pre">data</span> <span class="pre">interpolator.\n</span>&#160;&#160;&#160; <span class="pre">PPoly</span> <span class="pre">:</span> <span class="pre">Piecewise</span> <span class="pre">polynomial</span> <span class="pre">in</span> <span class="pre">terms</span> <span class="pre">of</span> <span class="pre">coefficients</span> <span class="pre">and</span> <span class="pre">breakpoints.\n\n</span>&#160;&#160;&#160; <span class="pre">Notes\n</span>&#160;&#160;&#160; <span class="pre">-----\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">interpolator</span> <span class="pre">preserves</span> <span class="pre">monotonicity</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">interpolation</span> <span class="pre">data</span> <span class="pre">and</span> <span class="pre">does\n</span>&#160;&#160;&#160; <span class="pre">not</span> <span class="pre">overshoot</span> <span class="pre">if</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">smooth.\n\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">first</span> <span class="pre">derivatives</span> <span class="pre">are</span> <span class="pre">guaranteed</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">continuous,</span> <span class="pre">but</span> <span class="pre">the</span> <span class="pre">second\n</span>&#160;&#160;&#160; <span class="pre">derivatives</span> <span class="pre">may</span> <span class="pre">jump</span> <span class="pre">at</span> <span class="pre">:math:`x_k`.\n\n</span>&#160;&#160;&#160; <span class="pre">Determines</span> <span class="pre">the</span> <span class="pre">derivatives</span> <span class="pre">at</span> <span class="pre">the</span> <span class="pre">points</span> <span class="pre">:math:`x_k`,</span> <span class="pre">:math:`f'_k`,\n</span>&#160;&#160;&#160; <span class="pre">by</span> <span class="pre">using</span> <span class="pre">PCHIP</span> <span class="pre">algorithm</span> <span class="pre">[1]_.\n\n</span>&#160;&#160;&#160; <span class="pre">Let</span> <span class="pre">:math:`h_k</span> <span class="pre">=</span> <span class="pre">x_{k+1}</span> <span class="pre">-</span> <span class="pre">x_k`,</span> <span class="pre">and</span>&#160; <span class="pre">:math:`d_k</span> <span class="pre">=</span> <span class="pre">(y_{k+1}</span> <span class="pre">-</span> <span class="pre">y_k)</span> <span class="pre">/</span> <span class="pre">h_k`\n</span>&#160;&#160;&#160; <span class="pre">are</span> <span class="pre">the</span> <span class="pre">slopes</span> <span class="pre">at</span> <span class="pre">internal</span> <span class="pre">points</span> <span class="pre">:math:`x_k`.\n</span>&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">the</span> <span class="pre">signs</span> <span class="pre">of</span> <span class="pre">:math:`d_k`</span> <span class="pre">and</span> <span class="pre">:math:`d_{k-1}`</span> <span class="pre">are</span> <span class="pre">different</span> <span class="pre">or</span> <span class="pre">either</span> <span class="pre">of\n</span>&#160;&#160;&#160; <span class="pre">them</span> <span class="pre">equals</span> <span class="pre">zero,</span> <span class="pre">then</span> <span class="pre">:math:`f'_k</span> <span class="pre">=</span> <span class="pre">0`.</span> <span class="pre">Otherwise,</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">given</span> <span class="pre">by</span> <span class="pre">the\n</span>&#160;&#160;&#160; <span class="pre">weighted</span> <span class="pre">harmonic</span> <span class="pre">mean\n\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">math::\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\\frac{w_1</span> <span class="pre">+</span> <span class="pre">w_2}{f'_k}</span> <span class="pre">=</span> <span class="pre">\\frac{w_1}{d_{k-1}}</span> <span class="pre">+</span> <span class="pre">\\frac{w_2}{d_k}\n\n</span>&#160;&#160;&#160; <span class="pre">where</span> <span class="pre">:math:`w_1</span> <span class="pre">=</span> <span class="pre">2</span> <span class="pre">h_k</span> <span class="pre">+</span> <span class="pre">h_{k-1}`</span> <span class="pre">and</span> <span class="pre">:math:`w_2</span> <span class="pre">=</span> <span class="pre">h_k</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">h_{k-1}`.\n\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">end</span> <span class="pre">slopes</span> <span class="pre">are</span> <span class="pre">set</span> <span class="pre">using</span> <span class="pre">a</span> <span class="pre">one-sided</span> <span class="pre">scheme</span> <span class="pre">[2]_.\n\n\n</span>&#160;&#160;&#160; <span class="pre">References\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">[1]</span> <span class="pre">F.</span> <span class="pre">N.</span> <span class="pre">Fritsch</span> <span class="pre">and</span> <span class="pre">J.</span> <span class="pre">Butland,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">method</span> <span class="pre">for</span> <span class="pre">constructing</span> <span class="pre">local\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">monotone</span> <span class="pre">piecewise</span> <span class="pre">cubic</span> <span class="pre">interpolants,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">SIAM</span> <span class="pre">J.</span> <span class="pre">Sci.</span> <span class="pre">Comput.,</span> <span class="pre">5(2),</span> <span class="pre">300-304</span> <span class="pre">(1984).\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">:doi:`10.1137/0905021`.\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">[2]</span> <span class="pre">see,</span> <span class="pre">e.g.,</span> <span class="pre">C.</span> <span class="pre">Moler,</span> <span class="pre">Numerical</span> <span class="pre">Computing</span> <span class="pre">with</span> <span class="pre">Matlab,</span> <span class="pre">2004.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">:doi:`10.1137/1.9780898717952`\n\n</span>&#160;&#160;&#160; <span class="pre">&quot;</span></em><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_cubic.html#PchipInterpolator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'scipy.interpolate._cubic'</span></em><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator._edge_case">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_edge_case</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_cubic.html#PchipInterpolator._edge_case"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator._edge_case" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator._find_derivatives">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_find_derivatives</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_cubic.html#PchipInterpolator._find_derivatives"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator._find_derivatives" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator.axis">
<span class="sig-name descname"><span class="pre">axis</span></span><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator.axis" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator.c">
<span class="sig-name descname"><span class="pre">c</span></span><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator.extrapolate">
<span class="sig-name descname"><span class="pre">extrapolate</span></span><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator.extrapolate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator.x">
<span class="sig-name descname"><span class="pre">x</span></span><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator.x" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.transition._parse_max_snap">
<span class="sig-name descname"><span class="pre">_parse_max_snap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_snap</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/transition.html#_parse_max_snap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.transition._parse_max_snap" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.transition._resolve_gap_endpoints_subset_snap">
<span class="sig-name descname"><span class="pre">_resolve_gap_endpoints_subset_snap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_gap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_snap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/transition.html#_resolve_gap_endpoints_subset_snap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.transition._resolve_gap_endpoints_subset_snap" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Contract:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>If create_gap is None:</dt><dd><ul>
<li><p>If there’s a natural gap (ts0.last &lt; ts1.first), use that full gap.</p></li>
<li><p>Otherwise (overlap/abut), return None to signal ‘no explicit gap’ (algorithms decide).</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>If create_gap is provided:</dt><dd><ul>
<li><p>Enforce: start &lt; end; ts0 has &lt;= start; ts1 has &gt;= end. Else: ValueError.</p></li>
<li><p>If there is a natural gap AND (start,end) is a strict subset of it,
expand start left and end right by up to max_snap (default 0) but never beyond
the natural gap bounds. Otherwise, ignore max_snap.</p></li>
<li><p>Always snap endpoints to data: start_time = last ts0 sample &lt;= effective start,
end_time = first ts1 sample &gt;= effective end.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Returns:</dt><dd><p>(start_time, end_time) or None if no explicit gap is to be used.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.transition.align_inputs_pair_strict">
<span class="sig-name descname"><span class="pre">align_inputs_pair_strict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts0_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ts0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts1_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ts1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names_kw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'names'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/colname_align.html#align_inputs_pair_strict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.transition.align_inputs_pair_strict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.transition.transition_ts">
<span class="sig-name descname"><span class="pre">transition_ts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_gap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'series'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_snap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/transition.html#transition_ts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.transition.transition_ts" title="Link to this definition">¶</a></dt>
<dd><p>Create a smooth transition between two aligned time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts0</strong><span class="classifier">pandas.Series or pandas.DataFrame</span></dt><dd><p>The initial time series segment. Must share the same frequency and type as <cite>ts1</cite>.</p>
</dd>
<dt><strong>ts1</strong><span class="classifier">pandas.Series or pandas.DataFrame</span></dt><dd><p>The final time series segment. Must share the same frequency and type as <cite>ts0</cite>.</p>
</dd>
<dt><strong>method</strong><span class="classifier">{“linear”, “pchip”}, default=”linear”</span></dt><dd><p>The interpolation method to use for generating the transition.</p>
</dd>
<dt><strong>create_gap</strong><span class="classifier">[start, end] or None</span></dt><dd><p>If None and there’s a natural gap (ts0.last &lt; ts1.first), that full gap is used.
If provided, start&lt;end, ts0 must have samples at/before start, ts1 at/after end.</p>
</dd>
<dt><strong>names</strong><span class="classifier">None, str, or iterable of str, optional</span></dt><dd><ul class="simple">
<li><p>If <cite>None</cite> (default), inputs must share compatible column names.</p></li>
<li><p>If <cite>str</cite>, the output is univariate and will be named accordingly.</p></li>
<li><p>If iterable, it is used as a subset/ordering of columns.</p></li>
</ul>
</dd>
<dt><strong>overlap</strong><span class="classifier">tuple of int or str, default=(0, 0)</span></dt><dd><p>Amount of overlap to use for interpolation anchoring in <cite>pchip</cite> mode.
Each entry can be:
- An integer: number of data points before/after to use.
- A pandas-compatible frequency string: e.g., “2h” or “45min”.</p>
</dd>
<dt><strong>max_snap</strong><span class="classifier">None | Timedelta-like | (Timedelta-like, Timedelta-like)</span></dt><dd><p>Optional widening ONLY when create_gap is strictly inside the natural gap.
Expands start earlier and end later by up to max_snap, but never past
(ts0.last, ts1.first). Default None = no widening.</p>
</dd>
<dt><strong>return_type</strong><span class="classifier">{“series”, “glue”}, default=”series”</span></dt><dd><ul class="simple">
<li><p>“series”: returns the full merged series including ts0, transition, ts1.</p></li>
<li><p>“glue”: returns only the interpolated transition segment.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.Series or pandas.DataFrame</dt><dd><p>The resulting time series segment, either the full merged series or just the transition zone.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If ts0 and ts1 have mismatched types or frequencies, or if overlap exists but <cite>create_gap</cite> is not specified.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vtools.functions.unit_conversions">
<span id="vtools-functions-unit-conversions-module"></span><h2>vtools.functions.unit_conversions module<a class="headerlink" href="#module-vtools.functions.unit_conversions" title="Link to this heading">¶</a></h2>
<p>Unit conversion helpers.</p>
<p>This module provides:
- linear/affine converters for common engineering units:</p>
<blockquote>
<div><p>metres↔feet, cms↔cfs, °F↔°C (all <em>functional</em>, no in-place mutation).</p>
</div></blockquote>
<ul class="simple">
<li><p>Domain-specific conversions between electrical conductivity (EC, μS/cm)
and practical salinity (PSU) at 25 °C, with optional Hill low-salinity
correction and an accuracy-improving root-finding “refinement” step.</p></li>
<li><p>a general-purpose unit conversion function <cite>convert_units()</cite> that uses Pint
by default (with an optional cf_units backend via an environment variable),
and that has fast paths for the above common conversions.</p></li>
</ul>
<section id="id32">
<h3>Notes<a class="headerlink" href="#id32" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>PSU is treated here as a practical “unit” for salinity in workflows,
even though in a strict metrological sense it is unitless.</p></li>
<li><p>The EC↔PSU conversions assume <strong>25 °C</strong> and no explicit temperature
dependence beyond the optional Hill correction.</p></li>
</ul>
</section>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Link to this heading">¶</a></h3>
<p>Schemel, L.E. (2001) Empirical relationships between salinity and
specific conductance in San Francisco Bay, California.</p>
<p>Hill, K. (low-salinity correction widely used in estuarine practice).</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions._get_converter">
<span class="sig-name descname"><span class="pre">_get_converter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ou</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#_get_converter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions._get_converter" title="Link to this definition">¶</a></dt>
<dd><p>Return a callable(arr)-&gt;arr using Pint by default; cf_units if env-forced.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions._norm">
<span class="sig-name descname"><span class="pre">_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions._norm" title="Link to this definition">¶</a></dt>
<dd><p>Normalize common shorthands to canonical spellings without
destroying case needed by Pint (e.g., degC/degF).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions._rewrap_like">
<span class="sig-name descname"><span class="pre">_rewrap_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#_rewrap_like"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions._rewrap_like" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions._want_cf_units">
<span class="sig-name descname"><span class="pre">_want_cf_units</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#_want_cf_units"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions._want_cf_units" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.celsius_to_fahrenheit">
<span class="sig-name descname"><span class="pre">celsius_to_fahrenheit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#celsius_to_fahrenheit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.celsius_to_fahrenheit" title="Link to this definition">¶</a></dt>
<dd><p>Convert °C to °F.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">scalar | array-like | pd.Series | pd.DataFrame</span></dt><dd><p>Value(s) in celsius.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>same type as <cite>x</cite></dt><dd><p>Value(s) in farenheit.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.cfs_to_cms">
<span class="sig-name descname"><span class="pre">cfs_to_cms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#cfs_to_cms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.cfs_to_cms" title="Link to this definition">¶</a></dt>
<dd><p>Convert ft³/s to m³/s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">scalar | array-like | pd.Series | pd.DataFrame</span></dt><dd><p>Value(s) in cfs.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>same type as <cite>x</cite></dt><dd><p>Value(s) in cubic meters per second.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.cms_to_cfs">
<span class="sig-name descname"><span class="pre">cms_to_cfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#cms_to_cfs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.cms_to_cfs" title="Link to this definition">¶</a></dt>
<dd><p>Convert m³/s to ft³/s.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">scalar | array-like | pd.Series | pd.DataFrame</span></dt><dd><p>Value(s) in cms.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>same type as <cite>x</cite></dt><dd><p>Value(s) in cfs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.convert_units">
<span class="sig-name descname"><span class="pre">convert_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#convert_units"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.convert_units" title="Link to this definition">¶</a></dt>
<dd><p>Convert array-like / pandas objects between units.
Fast custom paths for EC↔PSU&#64;25C, temperature, cfs↔cms, ft↔m; else Pint-backed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>values</strong><span class="classifier">array-like | pd.Series | pd.DataFrame</span></dt><dd></dd>
<dt><strong>in_unit, out_unit</strong><span class="classifier">str</span></dt><dd><p>Unit strings. Shorthands like ‘cfs’,’cms’,’ft3/s’,’μS/cm’,’deg F’ accepted.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Same type as <cite>values</cite>, converted.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.ec_psu_25c">
<span class="sig-name descname"><span class="pre">ec_psu_25c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hill_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#ec_psu_25c"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.ec_psu_25c" title="Link to this definition">¶</a></dt>
<dd><p>Convert electrical conductivity (EC, μS/cm) to practical salinity (PSU) at 25 °C.</p>
<p>This implements the empirical relationship used for estuarine work, with an
optional Hill correction that improves behavior at low salinities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ec</strong><span class="classifier">array-like or scalar</span></dt><dd><p>Electrical conductivity in μS/cm.</p>
</dd>
<dt><strong>hill_correction</strong><span class="classifier">bool, default True</span></dt><dd><p>Apply Hill low-salinity correction.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ndarray or scalar</dt><dd><p>Practical salinity (PSU). For negative EC inputs:
- scalar input → returns NaN
- array input → returns NaN at those positions</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Assumes temperature is 25 °C.</p></li>
<li><p>Negative EC values are internally floored to a small positive ratio
for computation (<cite>R=1e-4</cite>); those outputs are then set to NaN on
array paths (or NaN returned for scalar paths).</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.fahrenheit_to_celsius">
<span class="sig-name descname"><span class="pre">fahrenheit_to_celsius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#fahrenheit_to_celsius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.fahrenheit_to_celsius" title="Link to this definition">¶</a></dt>
<dd><p>Convert °F to °C.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">scalar | array-like | pd.Series | pd.DataFrame</span></dt><dd><p>Value(s) in degrees F.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>same type as <cite>x</cite></dt><dd><p>Value(s) in degrees celsius.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.ft_to_m">
<span class="sig-name descname"><span class="pre">ft_to_m</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#ft_to_m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.ft_to_m" title="Link to this definition">¶</a></dt>
<dd><p>Convert feet to metres.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">scalar | array-like | pd.Series | pd.DataFrame</span></dt><dd><p>Value(s) in feet.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>same type as <cite>x</cite></dt><dd><p>Value(s) in meters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.m_to_ft">
<span class="sig-name descname"><span class="pre">m_to_ft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#m_to_ft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.m_to_ft" title="Link to this definition">¶</a></dt>
<dd><p>Convert metres to feet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">scalar | array-like | pd.Series | pd.DataFrame</span></dt><dd><p>Value(s) in metres.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>same type as <cite>x</cite></dt><dd><p>Value(s) in feet.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.psu_ec_25c">
<span class="sig-name descname"><span class="pre">psu_ec_25c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hill_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#psu_ec_25c"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.psu_ec_25c" title="Link to this definition">¶</a></dt>
<dd><p>Convert practical salinity (PSU) to EC (μS/cm) at 25 °C (vectorized).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>psu</strong><span class="classifier">array-like or scalar</span></dt><dd><p>Practical salinity value(s).</p>
</dd>
<dt><strong>refine</strong><span class="classifier">bool, default True</span></dt><dd><p>Use root finding via <a class="reference internal" href="#vtools.functions.unit_conversions.psu_ec_25c_scalar" title="vtools.functions.unit_conversions.psu_ec_25c_scalar"><code class="xref py py-func docutils literal notranslate"><span class="pre">psu_ec_25c_scalar()</span></code></a> for accuracy.</p>
</dd>
<dt><strong>hill_correction</strong><span class="classifier">bool, default True</span></dt><dd><p>See <a class="reference internal" href="#vtools.functions.unit_conversions.psu_ec_25c_scalar" title="vtools.functions.unit_conversions.psu_ec_25c_scalar"><code class="xref py py-func docutils literal notranslate"><span class="pre">psu_ec_25c_scalar()</span></code></a>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ndarray or scalar</dt><dd><p>EC in μS/cm. Scalar input returns a scalar; array-like input returns
a NumPy array of the same shape.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.psu_ec_25c_scalar">
<span class="sig-name descname"><span class="pre">psu_ec_25c_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hill_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#psu_ec_25c_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.psu_ec_25c_scalar" title="Link to this definition">¶</a></dt>
<dd><p>Convert practical salinity (PSU) to EC (μS/cm) at 25 °C for a <strong>scalar</strong> value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>psu</strong><span class="classifier">float</span></dt><dd><p>Practical salinity. Must be non-negative and ≤ ~35 for oceanic cases
(a hard check is enforced near sea salinity when <cite>refine</cite> is True).</p>
</dd>
<dt><strong>refine</strong><span class="classifier">bool, default True</span></dt><dd><p>If True, use a scalar root finder (Brent) to invert the EC→PSU mapping
accurately. If False, use a closed-form Schemel-style polynomial approximation.</p>
</dd>
<dt><strong>hill_correction</strong><span class="classifier">bool, default True</span></dt><dd><p>Only meaningful with <cite>refine=True</cite>; raises if <cite>refine=False</cite> and
<cite>hill_correction=True</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float</dt><dd><p>Electrical conductivity (μS/cm).</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If <cite>psu</cite> &lt; 0, if <cite>psu</cite> exceeds the sea-salinity cap in <cite>refine</cite> mode,
or if an invalid combination of <cite>refine</cite>/<cite>hill_correction</cite> is requested.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The refinement typically converges in ~4–6 iterations.</p></li>
<li><p>The non-refined polynomial is faster but can drift on round trips (EC→PSU→EC).</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.psu_ec_resid">
<span class="sig-name descname"><span class="pre">psu_ec_resid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hill_correction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#psu_ec_resid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.psu_ec_resid" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-vtools.functions.unit_conversions_orig">
<span id="vtools-functions-unit-conversions-orig-module"></span><h2>vtools.functions.unit_conversions_orig module<a class="headerlink" href="#module-vtools.functions.unit_conversions_orig" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions_orig.celsius_to_fahrenheit">
<span class="sig-name descname"><span class="pre">celsius_to_fahrenheit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions_orig.html#celsius_to_fahrenheit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions_orig.celsius_to_fahrenheit" title="Link to this definition">¶</a></dt>
<dd><p>Convert cfs to cms</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions_orig.cfs_to_cms">
<span class="sig-name descname"><span class="pre">cfs_to_cms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions_orig.html#cfs_to_cms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions_orig.cfs_to_cms" title="Link to this definition">¶</a></dt>
<dd><p>Convert cfs to cms</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions_orig.cms_to_cfs">
<span class="sig-name descname"><span class="pre">cms_to_cfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions_orig.html#cms_to_cfs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions_orig.cms_to_cfs" title="Link to this definition">¶</a></dt>
<dd><p>Convert cms to cfs</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions_orig.ec_psu_25c">
<span class="sig-name descname"><span class="pre">ec_psu_25c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts_ec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hill_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions_orig.html#ec_psu_25c"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions_orig.ec_psu_25c" title="Link to this definition">¶</a></dt>
<dd><p>Convert scalar or vector ec to psu assuming 25C temperature
and no low salinity correction
Note: The input argument, ts_ec, will be altered.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions_orig.fahrenheit_to_celsius">
<span class="sig-name descname"><span class="pre">fahrenheit_to_celsius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions_orig.html#fahrenheit_to_celsius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions_orig.fahrenheit_to_celsius" title="Link to this definition">¶</a></dt>
<dd><p>Convert cfs to cms</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions_orig.ft_to_m">
<span class="sig-name descname"><span class="pre">ft_to_m</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions_orig.html#ft_to_m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions_orig.ft_to_m" title="Link to this definition">¶</a></dt>
<dd><p>Convert foot to meter</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions_orig.m_to_ft">
<span class="sig-name descname"><span class="pre">m_to_ft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions_orig.html#m_to_ft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions_orig.m_to_ft" title="Link to this definition">¶</a></dt>
<dd><p>Convert meter to foot
WARNING: The function modifies the input argument if it is TimeSeries</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions_orig.psu_ec_25c">
<span class="sig-name descname"><span class="pre">psu_ec_25c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hill_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions_orig.html#psu_ec_25c"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions_orig.psu_ec_25c" title="Link to this definition">¶</a></dt>
<dd><p>Conversion from psu to ec. If used without refinement,
this is the Schemel conversion, otherwise uses root-finding
Note that the round trip ec-psu-ec tends to wander a lot without refine = True.
The refinement usually takes 4-6 iterations</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions_orig.psu_ec_25c_scalar">
<span class="sig-name descname"><span class="pre">psu_ec_25c_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hill_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions_orig.html#psu_ec_25c_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions_orig.psu_ec_25c_scalar" title="Link to this definition">¶</a></dt>
<dd><p>Conversion from psu to ec for a scalar. If used without refinement,
this is the Schemel conversion, otherwise uses root-finding
Note that the round trip ec-psu-ec tends to wander a lot without refine = True.
The refinement usually takes 4-6 iterations</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions_orig.psu_ec_resid">
<span class="sig-name descname"><span class="pre">psu_ec_resid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hill_correction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions_orig.html#psu_ec_resid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions_orig.psu_ec_resid" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-vtools.functions.viz_gap">
<span id="vtools-functions-viz-gap-module"></span><h2>vtools.functions.viz_gap module<a class="headerlink" href="#module-vtools.functions.viz_gap" title="Link to this heading">¶</a></h2>
<p>Visualization harness for neighbor-based gap filling.</p>
<p>This script/module provides:</p>
<ol class="arabic simple">
<li><p>A <em>data provider</em> function interface you can implement to supply
real examples.</p></li>
<li><p>Utilities to create synthetic gaps in one or both series.</p></li>
<li><p>A small experiment runner that applies multiple fill methods.</p></li>
<li><p>Plotting helpers to visualize imputations versus the true series
and (optionally) prediction intervals.</p></li>
</ol>
<section id="usage-as-a-module">
<h3>Usage (as a module)<a class="headerlink" href="#usage-as-a-module" title="Link to this heading">¶</a></h3>
<p>Implement <cite>provide_example_data()</cite> in your own codebase or monkey-patch it
at runtime. It must return <cite>(target, neighbor, regime)</cite> where <cite>regime</cite> may
be <cite>None</cite>.</p>
<p>Example glue code:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">neighbor_fill_viz</span> <span class="kn">import</span> <span class="p">(</span>
<span class="gp">... </span>    <span class="n">run_gapfill_experiment</span><span class="p">,</span> <span class="n">plot_imputations</span><span class="p">,</span> <span class="n">GapSpec</span><span class="p">,</span> <span class="n">GapStrategy</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Provide your own function in your environment:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">provide_example_data</span><span class="p">():</span>
<span class="gp">... </span><span class="w">    </span><span class="sd">&#39;&#39;&#39;Return (target, neighbor, regime) with DatetimeIndex and same freq.&#39;&#39;&#39;</span>
<span class="gp">... </span>    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">run_gapfill_experiment</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">data_provider</span><span class="o">=</span><span class="n">provide_example_data</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">gap_spec</span><span class="o">=</span><span class="n">GapSpec</span><span class="p">(</span><span class="n">n_gaps</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">min_len</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">max_len</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">strategy</span><span class="o">=</span><span class="n">GapStrategy</span><span class="o">.</span><span class="n">TARGET_ONLY</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ols&quot;</span><span class="p">,</span> <span class="s2">&quot;lagged_reg&quot;</span><span class="p">,</span> <span class="s2">&quot;state_space&quot;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">lags</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">resample</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plot_imputations</span><span class="p">(</span><span class="o">**</span><span class="n">res</span><span class="p">,</span> <span class="n">show_pi</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also run this file as a script to execute a minimal smoke test that
uses a synthetic sine-with-lag dataset if <cite>provide_example_data</cite> is not
found in the import path.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GapSpec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_gaps:</span> <span class="pre">'int'</span> <span class="pre">=</span> <span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_len:</span> <span class="pre">'int'</span> <span class="pre">=</span> <span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len:</span> <span class="pre">'int'</span> <span class="pre">=</span> <span class="pre">24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">'Optional[int]'</span> <span class="pre">=</span> <span class="pre">123</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy:</span> <span class="pre">'GapStrategy'</span> <span class="pre">=</span> <span class="pre">&lt;GapStrategy.TARGET_ONLY:</span> <span class="pre">1&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensure_room:</span> <span class="pre">'int'</span> <span class="pre">=</span> <span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/viz_gap.html#GapSpec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.__annotations__">
<span class="sig-name descname"><span class="pre">__annotations__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'ensure_room':</span> <span class="pre">'int',</span> <span class="pre">'max_len':</span> <span class="pre">'int',</span> <span class="pre">'min_len':</span> <span class="pre">'int',</span> <span class="pre">'n_gaps':</span> <span class="pre">'int',</span> <span class="pre">'seed':</span> <span class="pre">'Optional[int]',</span> <span class="pre">'strategy':</span> <span class="pre">'GapStrategy'}</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.__annotations__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.__dataclass_fields__">
<span class="sig-name descname"><span class="pre">__dataclass_fields__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'ensure_room':</span> <span class="pre">Field(name='ensure_room',type='int',default=2,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'max_len':</span> <span class="pre">Field(name='max_len',type='int',default=24,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'min_len':</span> <span class="pre">Field(name='min_len',type='int',default=6,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'n_gaps':</span> <span class="pre">Field(name='n_gaps',type='int',default=5,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'seed':</span> <span class="pre">Field(name='seed',type='Optional[int]',default=123,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'strategy':</span> <span class="pre">Field(name='strategy',type='GapStrategy',default=&lt;GapStrategy.TARGET_ONLY:</span> <span class="pre">1&gt;,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD)}</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.__dataclass_fields__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.__dataclass_params__">
<span class="sig-name descname"><span class="pre">__dataclass_params__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">_DataclassParams(init=True,repr=True,eq=True,order=False,unsafe_hash=False,frozen=False)</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.__dataclass_params__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.__dict__">
<span class="sig-name descname"><span class="pre">__dict__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">mappingproxy({'__module__':</span> <span class="pre">'vtools.functions.viz_gap',</span> <span class="pre">'__annotations__':</span> <span class="pre">{'n_gaps':</span> <span class="pre">'int',</span> <span class="pre">'min_len':</span> <span class="pre">'int',</span> <span class="pre">'max_len':</span> <span class="pre">'int',</span> <span class="pre">'seed':</span> <span class="pre">'Optional[int]',</span> <span class="pre">'strategy':</span> <span class="pre">'GapStrategy',</span> <span class="pre">'ensure_room':</span> <span class="pre">'int'},</span> <span class="pre">'n_gaps':</span> <span class="pre">5,</span> <span class="pre">'min_len':</span> <span class="pre">6,</span> <span class="pre">'max_len':</span> <span class="pre">24,</span> <span class="pre">'seed':</span> <span class="pre">123,</span> <span class="pre">'strategy':</span> <span class="pre">&lt;GapStrategy.TARGET_ONLY:</span> <span class="pre">1&gt;,</span> <span class="pre">'ensure_room':</span> <span class="pre">2,</span> <span class="pre">'__dict__':</span> <span class="pre">&lt;attribute</span> <span class="pre">'__dict__'</span> <span class="pre">of</span> <span class="pre">'GapSpec'</span> <span class="pre">objects&gt;,</span> <span class="pre">'__weakref__':</span> <span class="pre">&lt;attribute</span> <span class="pre">'__weakref__'</span> <span class="pre">of</span> <span class="pre">'GapSpec'</span> <span class="pre">objects&gt;,</span> <span class="pre">'__doc__':</span> <span class="pre">&quot;GapSpec(n_gaps:</span> <span class="pre">'int'</span> <span class="pre">=</span> <span class="pre">5,</span> <span class="pre">min_len:</span> <span class="pre">'int'</span> <span class="pre">=</span> <span class="pre">6,</span> <span class="pre">max_len:</span> <span class="pre">'int'</span> <span class="pre">=</span> <span class="pre">24,</span> <span class="pre">seed:</span> <span class="pre">'Optional[int]'</span> <span class="pre">=</span> <span class="pre">123,</span> <span class="pre">strategy:</span> <span class="pre">'GapStrategy'</span> <span class="pre">=</span> <span class="pre">&lt;GapStrategy.TARGET_ONLY:</span> <span class="pre">1&gt;,</span> <span class="pre">ensure_room:</span> <span class="pre">'int'</span> <span class="pre">=</span> <span class="pre">2)&quot;,</span> <span class="pre">'__dataclass_params__':</span> <span class="pre">_DataclassParams(init=True,repr=True,eq=True,order=False,unsafe_hash=False,frozen=False),</span> <span class="pre">'__dataclass_fields__':</span> <span class="pre">{'n_gaps':</span> <span class="pre">Field(name='n_gaps',type='int',default=5,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'min_len':</span> <span class="pre">Field(name='min_len',type='int',default=6,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'max_len':</span> <span class="pre">Field(name='max_len',type='int',default=24,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'seed':</span> <span class="pre">Field(name='seed',type='Optional[int]',default=123,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'strategy':</span> <span class="pre">Field(name='strategy',type='GapStrategy',default=&lt;GapStrategy.TARGET_ONLY:</span> <span class="pre">1&gt;,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD),</span> <span class="pre">'ensure_room':</span> <span class="pre">Field(name='ensure_room',type='int',default=2,default_factory=&lt;dataclasses._MISSING_TYPE</span> <span class="pre">object&gt;,init=True,repr=True,hash=None,compare=True,metadata=mappingproxy({}),kw_only=False,_field_type=_FIELD)},</span> <span class="pre">'__init__':</span> <span class="pre">&lt;function</span> <span class="pre">GapSpec.__init__&gt;,</span> <span class="pre">'__repr__':</span> <span class="pre">&lt;function</span> <span class="pre">GapSpec.__repr__&gt;,</span> <span class="pre">'__eq__':</span> <span class="pre">&lt;function</span> <span class="pre">GapSpec.__eq__&gt;,</span> <span class="pre">'__hash__':</span> <span class="pre">None,</span> <span class="pre">'__match_args__':</span> <span class="pre">('n_gaps',</span> <span class="pre">'min_len',</span> <span class="pre">'max_len',</span> <span class="pre">'seed',</span> <span class="pre">'strategy',</span> <span class="pre">'ensure_room')})</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.__dict__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&quot;GapSpec(n_gaps:</span> <span class="pre">'int'</span> <span class="pre">=</span> <span class="pre">5,</span> <span class="pre">min_len:</span> <span class="pre">'int'</span> <span class="pre">=</span> <span class="pre">6,</span> <span class="pre">max_len:</span> <span class="pre">'int'</span> <span class="pre">=</span> <span class="pre">24,</span> <span class="pre">seed:</span> <span class="pre">'Optional[int]'</span> <span class="pre">=</span> <span class="pre">123,</span> <span class="pre">strategy:</span> <span class="pre">'GapStrategy'</span> <span class="pre">=</span> <span class="pre">&lt;GapStrategy.TARGET_ONLY:</span> <span class="pre">1&gt;,</span> <span class="pre">ensure_room:</span> <span class="pre">'int'</span> <span class="pre">=</span> <span class="pre">2)&quot;</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.__eq__">
<span class="sig-name descname"><span class="pre">__eq__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.__eq__" title="Link to this definition">¶</a></dt>
<dd><p>Return self==value.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.__hash__">
<span class="sig-name descname"><span class="pre">__hash__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.__hash__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_gaps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">24</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">123</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#vtools.functions.viz_gap.GapStrategy" title="vtools.functions.viz_gap.GapStrategy"><span class="pre">GapStrategy</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">GapStrategy.TARGET_ONLY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensure_room</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.__match_args__">
<span class="sig-name descname"><span class="pre">__match_args__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('n_gaps',</span> <span class="pre">'min_len',</span> <span class="pre">'max_len',</span> <span class="pre">'seed',</span> <span class="pre">'strategy',</span> <span class="pre">'ensure_room')</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.__match_args__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'vtools.functions.viz_gap'</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.__repr__">
<span class="sig-name descname"><span class="pre">__repr__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.__repr__" title="Link to this definition">¶</a></dt>
<dd><p>Return repr(self).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.__weakref__" title="Link to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.ensure_room">
<span class="sig-name descname"><span class="pre">ensure_room</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.ensure_room" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.max_len">
<span class="sig-name descname"><span class="pre">max_len</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">24</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.max_len" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.min_len">
<span class="sig-name descname"><span class="pre">min_len</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.min_len" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.n_gaps">
<span class="sig-name descname"><span class="pre">n_gaps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.n_gaps" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">123</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.seed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapSpec.strategy">
<span class="sig-name descname"><span class="pre">strategy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#vtools.functions.viz_gap.GapStrategy" title="vtools.functions.viz_gap.GapStrategy"><span class="pre">GapStrategy</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapSpec.strategy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapStrategy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GapStrategy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/viz_gap.html#GapStrategy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.viz_gap.GapStrategy" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="vtools.data.html#vtools.data.gap.Enum" title="enum.Enum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<p>Where to create synthetic gaps.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapStrategy.BOTH">
<span class="sig-name descname"><span class="pre">BOTH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapStrategy.BOTH" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapStrategy.STAGGERED">
<span class="sig-name descname"><span class="pre">STAGGERED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapStrategy.STAGGERED" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapStrategy.TARGET_ONLY">
<span class="sig-name descname"><span class="pre">TARGET_ONLY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapStrategy.TARGET_ONLY" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapStrategy.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Where</span> <span class="pre">to</span> <span class="pre">create</span> <span class="pre">synthetic</span> <span class="pre">gaps.'</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapStrategy.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.GapStrategy.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'vtools.functions.viz_gap'</span></em><a class="headerlink" href="#vtools.functions.viz_gap.GapStrategy.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.viz_gap._choose_gap_windows">
<span class="sig-name descname"><span class="pre">_choose_gap_windows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#vtools.functions.viz_gap.GapSpec" title="vtools.functions.viz_gap.GapSpec"><span class="pre">GapSpec</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/viz_gap.html#_choose_gap_windows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.viz_gap._choose_gap_windows" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.viz_gap._maybe_run_demo">
<span class="sig-name descname"><span class="pre">_maybe_run_demo</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/viz_gap.html#_maybe_run_demo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.viz_gap._maybe_run_demo" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.viz_gap._synthetic_provider">
<span class="sig-name descname"><span class="pre">_synthetic_provider</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'H'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/viz_gap.html#_synthetic_provider"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.viz_gap._synthetic_provider" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.apply_gaps">
<span class="sig-name descname"><span class="pre">apply_gaps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#vtools.functions.viz_gap.GapSpec" title="vtools.functions.viz_gap.GapSpec"><span class="pre">GapSpec</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v2.3.3)"><span class="pre">Timestamp</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v2.3.3)"><span class="pre">Timestamp</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/viz_gap.html#apply_gaps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.viz_gap.apply_gaps" title="Link to this definition">¶</a></dt>
<dd><p>Apply synthetic gaps to target and/or neighbor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>target, neighbor</strong><span class="classifier">time-aligned inputs</span></dt><dd></dd>
<dt><strong>spec</strong><span class="classifier">GapSpec</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>(target_gapped, neighbor_gapped, gap_windows)</dt><dd><ul class="simple">
<li><p><cite>gap_windows</cite> provides timestamp ranges actually masked under keys
‘target’ and possibly ‘neighbor’.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.plot_imputations">
<span class="sig-name descname"><span class="pre">plot_imputations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_gapped</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_pi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tlim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v2.3.3)"><span class="pre">Timestamp</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Timestamp.html#pandas.Timestamp" title="(in pandas v2.3.3)"><span class="pre">Timestamp</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/viz_gap.html#plot_imputations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.viz_gap.plot_imputations" title="Link to this definition">¶</a></dt>
<dd><p>Plot original vs gapped target and method imputations.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>target</strong><span class="classifier">original complete (or less-gappy) series</span></dt><dd></dd>
<dt><strong>target_gapped</strong><span class="classifier">with synthetic gaps</span></dt><dd></dd>
<dt><strong>results</strong><span class="classifier">mapping method -&gt; dict returned by <cite>fill_from_neighbor</cite></span></dt><dd></dd>
<dt><strong>neighbor</strong><span class="classifier">optional neighbor series to plot lightly for context</span></dt><dd></dd>
<dt><strong>show_pi</strong><span class="classifier">draw prediction intervals when available</span></dt><dd></dd>
<dt><strong>tlim</strong><span class="classifier">optional (t0, t1) to focus x-limits</span></dt><dd></dd>
<dt><strong>title</strong><span class="classifier">overall title</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.provide_example_data">
<span class="sig-name descname"><span class="pre">provide_example_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/viz_gap.html#provide_example_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.viz_gap.provide_example_data" title="Link to this definition">¶</a></dt>
<dd><p>Provide a real-world example.</p>
<p>You should REPLACE this function in your environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>(target, neighbor, regime)</dt><dd><ul class="simple">
<li><p><cite>target</cite>: pd.Series with DatetimeIndex, possibly complete (we will gap it).</p></li>
<li><p><cite>neighbor</cite>: pd.Series or pd.DataFrame with DatetimeIndex; should be aligned
or alignable to <cite>target</cite> (same frequency preferred).</p></li>
<li><p><cite>regime</cite>: Optional categorical pd.Series aligned to the timestamps (e.g.,
barrier status). If not applicable, return <cite>None</cite>.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Ensure both target and neighbor use the same units and a compatible
frequency. If not, specify a <cite>resample</cite> frequency in the experiment run.</p></li>
<li><p>This function is intentionally documented rather than implemented so that
teams can plug in station-specific datasets.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.viz_gap.run_gapfill_experiment">
<span class="sig-name descname"><span class="pre">run_gapfill_experiment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_provider</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.3)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#vtools.functions.viz_gap.GapSpec" title="vtools.functions.viz_gap.GapSpec"><span class="pre">GapSpec</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">methods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.14)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('ols',</span> <span class="pre">'lagged_reg',</span> <span class="pre">'state_space')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.14)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arimax_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(1,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><span class="pre">object</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/vtools/functions/viz_gap.html#run_gapfill_experiment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.viz_gap.run_gapfill_experiment" title="Link to this definition">¶</a></dt>
<dd><p>Create synthetic gaps, run selected methods, and collect results.</p>
<p>Returns a dict suitable for <cite>plot_imputations</cite>.</p>
</dd></dl>

</section>
<section id="module-vtools.functions">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-vtools.functions" title="Link to this heading">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2019, California Department of Water Resources.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/vtools.functions.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>