<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>vtools.functions package &#8212; vtools 0.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <script src="_static/documentation_options.js?v=7026087e"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="vtools.datastore package" href="vtools.datastore.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/logo.png" border="0" alt="py4sci"/></a>
</div>



      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/dwrsmall.jpg" alt="Logo"/>
            </a></p>
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/dwrsmall.jpg" alt="Logo" />
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Introduction and concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="daylight_savings.html">Daylight Savings conversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolation.html">Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/filters.html">Averging, Filtering and Low Passing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/filters.html#Filters">Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/tidal_envelope.html">Tidal Envelope Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/climatology.html">Fitting and using a climatology</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/merge_splice.html">Merging and Splicing Time Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/merge_splice.html#ts_merge:-strict-priority-option"><code class="docutils literal notranslate"><span class="pre">ts_merge</span></code>: strict priority option</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/extrapolation.html">Extrapolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/transition.html">Transitioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="vtools.html">vtools package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">vtools</a><ul>
  <li><a href="vtools.html">vtools package</a><ul>
      <li>Previous: <a href="vtools.datastore.html" title="previous chapter">vtools.datastore package</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="vtools-functions-package">
<h1>vtools.functions package<a class="headerlink" href="#vtools-functions-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-vtools.functions.climatology">
<span id="vtools-functions-climatology-module"></span><h2>vtools.functions.climatology module<a class="headerlink" href="#module-vtools.functions.climatology" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.climatology.apply_climatology">
<span class="sig-name descname"><span class="pre">apply_climatology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">climate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/climatology.html#apply_climatology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.climatology.apply_climatology" title="Link to this definition">¶</a></dt>
<dd><p>Apply daily or monthly climatology to a new index</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>climate: DataFrame with integer index representing month of year (Jan=1) or day of year. Must be of size 12 365,366. Day 366 will be inferred from day 365 value</strong></dt><dd></dd>
<dt><strong>index: DatetimeIndex representing locations to be inferred</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>DataFrame or Series as given by climate with values extracted from climatology for the month or day</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.climatology.climatology">
<span class="sig-name descname"><span class="pre">climatology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsmooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/climatology.html#climatology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.climatology.climatology" title="Link to this definition">¶</a></dt>
<dd><p>“ Create a climatology on the columns of ts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts: DataFrame or Series</strong></dt><dd></dd>
<dt><strong>DataStructure to be analyzed. Must have a length of at least 2*freq</strong></dt><dd></dd>
<dt><strong>freq: period [“day”,”month”]</strong></dt><dd></dd>
<dt><strong>Period over which the climatology is analyzed</strong></dt><dd></dd>
<dt><strong>nsmooth: int</strong></dt><dd><p>window size (number of values) of pre-smoothing. This may not make sense for series that are not approximately regular. An odd number is usually best.</p>
</dd>
<dt><strong>Returns:</strong></dt><dd><p>out: DataFrame or Series
Data structure of the same type as ts, with Integer index representing month (Jan=1) or day of year (1:365).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.climatology.climatology_quantiles">
<span class="sig-name descname"><span class="pre">climatology_quantiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_day_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_day_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.05,</span> <span class="pre">0.25,</span> <span class="pre">0.5,</span> <span class="pre">0.75,</span> <span class="pre">0.95]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/climatology.html#climatology_quantiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.climatology.climatology_quantiles" title="Link to this definition">¶</a></dt>
<dd><p>“ Create windowed quantiles across years on a time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts: DataFrame or Series</strong></dt><dd></dd>
<dt><strong>DataStructure to be analyzed.</strong></dt><dd></dd>
<dt><strong>min_day_year: int</strong></dt><dd></dd>
<dt><strong>Minimum Julian day to be considered</strong></dt><dd></dd>
<dt><strong>freq: period [“day”,”month”]</strong></dt><dd></dd>
<dt><strong>Maximum Julian day to be considered</strong></dt><dd></dd>
<dt><strong>window_width: int</strong></dt><dd></dd>
<dt><strong>Number of days to include, including the central day and days on each side. So for instance window_width=15 would span the central date and 7 days on each side</strong></dt><dd></dd>
<dt><strong>quantiles: array-like</strong></dt><dd><p>quantiles requested</p>
</dd>
<dt><strong>Returns:</strong></dt><dd><p>out: DataFrame or Series
Data structure with Julian day as the index and quantiles as columns.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vtools.functions.envelope">
<span id="vtools-functions-envelope-module"></span><h2>vtools.functions.envelope module<a class="headerlink" href="#module-vtools.functions.envelope" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PchipInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_cubic.html#PchipInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">CubicHermiteSpline</span></code></p>
<p>PCHIP 1-D monotonic cubic interpolation.</p>
<p><code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are arrays of values used to approximate some function f,
with <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">f(x)</span></code>. The interpolant uses monotonic cubic splines
to find the value of new points. (PCHIP stands for Piecewise Cubic
Hermite Interpolating Polynomial).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">ndarray, shape (npoints, )</span></dt><dd><p>A 1-D array of monotonically increasing real values. <code class="docutils literal notranslate"><span class="pre">x</span></code> cannot
include duplicate values (otherwise f is overspecified)</p>
</dd>
<dt><strong>y</strong><span class="classifier">ndarray, shape (…, npoints, …)</span></dt><dd><p>A N-D array of real values. <code class="docutils literal notranslate"><span class="pre">y</span></code>’s length along the interpolation
axis must be equal to the length of <code class="docutils literal notranslate"><span class="pre">x</span></code>. Use the <code class="docutils literal notranslate"><span class="pre">axis</span></code>
parameter to select the interpolation axis.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>Axis in the <code class="docutils literal notranslate"><span class="pre">y</span></code> array corresponding to the x-coordinate values. Defaults
to <code class="docutils literal notranslate"><span class="pre">axis=0</span></code>.</p>
</dd>
<dt><strong>extrapolate</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to extrapolate to out-of-bounds points based on first
and last intervals, or to return NaNs.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">CubicHermiteSpline</span></code></dt><dd><p>Piecewise-cubic interpolator.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Akima1DInterpolator</span></code></dt><dd><p>Akima 1D interpolator.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">CubicSpline</span></code></dt><dd><p>Cubic spline data interpolator.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">PPoly</span></code></dt><dd><p>Piecewise polynomial in terms of coefficients and breakpoints.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The interpolator preserves monotonicity in the interpolation data and does
not overshoot if the data is not smooth.</p>
<p>The first derivatives are guaranteed to be continuous, but the second
derivatives may jump at <span class="math notranslate nohighlight">\(x_k\)</span>.</p>
<p>Determines the derivatives at the points <span class="math notranslate nohighlight">\(x_k\)</span>, <span class="math notranslate nohighlight">\(f'_k\)</span>,
by using PCHIP algorithm <a class="reference internal" href="#rca5d2d2ab283-1" id="id1">[1]</a>.</p>
<p>Let <span class="math notranslate nohighlight">\(h_k = x_{k+1} - x_k\)</span>, and  <span class="math notranslate nohighlight">\(d_k = (y_{k+1} - y_k) / h_k\)</span>
are the slopes at internal points <span class="math notranslate nohighlight">\(x_k\)</span>.
If the signs of <span class="math notranslate nohighlight">\(d_k\)</span> and <span class="math notranslate nohighlight">\(d_{k-1}\)</span> are different or either of
them equals zero, then <span class="math notranslate nohighlight">\(f'_k = 0\)</span>. Otherwise, it is given by the
weighted harmonic mean</p>
<div class="math notranslate nohighlight">
\[\frac{w_1 + w_2}{f'_k} = \frac{w_1}{d_{k-1}} + \frac{w_2}{d_k}\]</div>
<p>where <span class="math notranslate nohighlight">\(w_1 = 2 h_k + h_{k-1}\)</span> and <span class="math notranslate nohighlight">\(w_2 = h_k + 2 h_{k-1}\)</span>.</p>
<p>The end slopes are set using a one-sided scheme <a class="reference internal" href="#rca5d2d2ab283-2" id="id2">[2]</a>.</p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="rca5d2d2ab283-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>F. N. Fritsch and J. Butland,
A method for constructing local
monotone piecewise cubic interpolants,
SIAM J. Sci. Comput., 5(2), 300-304 (1984).
<a href="#id3"><span class="problematic" id="id4">:doi:`10.1137/0905021`</span></a>.</p>
</div>
<div class="citation" id="rca5d2d2ab283-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>see, e.g., C. Moler, Numerical Computing with Matlab, 2004.
<a href="#id5"><span class="problematic" id="id6">:doi:`10.1137/1.9780898717952`</span></a></p>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>axis</strong></dt><dd></dd>
<dt><strong>c</strong></dt><dd></dd>
<dt><strong>extrapolate</strong></dt><dd></dd>
<dt><strong>x</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(x[, nu, extrapolate])</p></td>
<td><p>Evaluate the piecewise polynomial or its derivative.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">derivative</span></code>([nu])</p></td>
<td><p>Construct a new piecewise polynomial representing the derivative.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">antiderivative</span></code>([nu])</p></td>
<td><p>Construct a new piecewise polynomial representing the antiderivative.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">roots</span></code>([discontinuity, extrapolate])</p></td>
<td><p>Find real roots of the piecewise polynomial.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator.__annotations__">
<span class="sig-name descname"><span class="pre">__annotations__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator.__annotations__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&quot;PCHIP</span> <span class="pre">1-D</span> <span class="pre">monotonic</span> <span class="pre">cubic</span> <span class="pre">interpolation.\n\n</span>&#160;&#160;&#160; <span class="pre">``x``</span> <span class="pre">and</span> <span class="pre">``y``</span> <span class="pre">are</span> <span class="pre">arrays</span> <span class="pre">of</span> <span class="pre">values</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">approximate</span> <span class="pre">some</span> <span class="pre">function</span> <span class="pre">f,\n</span>&#160;&#160;&#160; <span class="pre">with</span> <span class="pre">``y</span> <span class="pre">=</span> <span class="pre">f(x)``.</span> <span class="pre">The</span> <span class="pre">interpolant</span> <span class="pre">uses</span> <span class="pre">monotonic</span> <span class="pre">cubic</span> <span class="pre">splines\n</span>&#160;&#160;&#160; <span class="pre">to</span> <span class="pre">find</span> <span class="pre">the</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">new</span> <span class="pre">points.</span> <span class="pre">(PCHIP</span> <span class="pre">stands</span> <span class="pre">for</span> <span class="pre">Piecewise</span> <span class="pre">Cubic\n</span>&#160;&#160;&#160; <span class="pre">Hermite</span> <span class="pre">Interpolating</span> <span class="pre">Polynomial).\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">x</span> <span class="pre">:</span> <span class="pre">ndarray,</span> <span class="pre">shape</span> <span class="pre">(npoints,</span> <span class="pre">)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">1-D</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">monotonically</span> <span class="pre">increasing</span> <span class="pre">real</span> <span class="pre">values.</span> <span class="pre">``x``</span> <span class="pre">cannot\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">include</span> <span class="pre">duplicate</span> <span class="pre">values</span> <span class="pre">(otherwise</span> <span class="pre">f</span> <span class="pre">is</span> <span class="pre">overspecified)\n</span>&#160;&#160;&#160; <span class="pre">y</span> <span class="pre">:</span> <span class="pre">ndarray,</span> <span class="pre">shape</span> <span class="pre">(...,</span> <span class="pre">npoints,</span> <span class="pre">...)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">N-D</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">real</span> <span class="pre">values.</span> <span class="pre">``y``'s</span> <span class="pre">length</span> <span class="pre">along</span> <span class="pre">the</span> <span class="pre">interpolation\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">axis</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">equal</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">length</span> <span class="pre">of</span> <span class="pre">``x``.</span> <span class="pre">Use</span> <span class="pre">the</span> <span class="pre">``axis``\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">parameter</span> <span class="pre">to</span> <span class="pre">select</span> <span class="pre">the</span> <span class="pre">interpolation</span> <span class="pre">axis.\n</span>&#160;&#160;&#160; <span class="pre">axis</span> <span class="pre">:</span> <span class="pre">int,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Axis</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">``y``</span> <span class="pre">array</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">x-coordinate</span> <span class="pre">values.</span> <span class="pre">Defaults\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">to</span> <span class="pre">``axis=0``.\n</span>&#160;&#160;&#160; <span class="pre">extrapolate</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Whether</span> <span class="pre">to</span> <span class="pre">extrapolate</span> <span class="pre">to</span> <span class="pre">out-of-bounds</span> <span class="pre">points</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">first\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">and</span> <span class="pre">last</span> <span class="pre">intervals,</span> <span class="pre">or</span> <span class="pre">to</span> <span class="pre">return</span> <span class="pre">NaNs.\n\n</span>&#160;&#160;&#160; <span class="pre">Methods\n</span>&#160;&#160;&#160; <span class="pre">-------\n</span>&#160;&#160;&#160; <span class="pre">__call__\n</span>&#160;&#160;&#160; <span class="pre">derivative\n</span>&#160;&#160;&#160; <span class="pre">antiderivative\n</span>&#160;&#160;&#160; <span class="pre">roots\n\n</span>&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">Also\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">CubicHermiteSpline</span> <span class="pre">:</span> <span class="pre">Piecewise-cubic</span> <span class="pre">interpolator.\n</span>&#160;&#160;&#160; <span class="pre">Akima1DInterpolator</span> <span class="pre">:</span> <span class="pre">Akima</span> <span class="pre">1D</span> <span class="pre">interpolator.\n</span>&#160;&#160;&#160; <span class="pre">CubicSpline</span> <span class="pre">:</span> <span class="pre">Cubic</span> <span class="pre">spline</span> <span class="pre">data</span> <span class="pre">interpolator.\n</span>&#160;&#160;&#160; <span class="pre">PPoly</span> <span class="pre">:</span> <span class="pre">Piecewise</span> <span class="pre">polynomial</span> <span class="pre">in</span> <span class="pre">terms</span> <span class="pre">of</span> <span class="pre">coefficients</span> <span class="pre">and</span> <span class="pre">breakpoints.\n\n</span>&#160;&#160;&#160; <span class="pre">Notes\n</span>&#160;&#160;&#160; <span class="pre">-----\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">interpolator</span> <span class="pre">preserves</span> <span class="pre">monotonicity</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">interpolation</span> <span class="pre">data</span> <span class="pre">and</span> <span class="pre">does\n</span>&#160;&#160;&#160; <span class="pre">not</span> <span class="pre">overshoot</span> <span class="pre">if</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">smooth.\n\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">first</span> <span class="pre">derivatives</span> <span class="pre">are</span> <span class="pre">guaranteed</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">continuous,</span> <span class="pre">but</span> <span class="pre">the</span> <span class="pre">second\n</span>&#160;&#160;&#160; <span class="pre">derivatives</span> <span class="pre">may</span> <span class="pre">jump</span> <span class="pre">at</span> <span class="pre">:math:`x_k`.\n\n</span>&#160;&#160;&#160; <span class="pre">Determines</span> <span class="pre">the</span> <span class="pre">derivatives</span> <span class="pre">at</span> <span class="pre">the</span> <span class="pre">points</span> <span class="pre">:math:`x_k`,</span> <span class="pre">:math:`f'_k`,\n</span>&#160;&#160;&#160; <span class="pre">by</span> <span class="pre">using</span> <span class="pre">PCHIP</span> <span class="pre">algorithm</span> <span class="pre">[1]_.\n\n</span>&#160;&#160;&#160; <span class="pre">Let</span> <span class="pre">:math:`h_k</span> <span class="pre">=</span> <span class="pre">x_{k+1}</span> <span class="pre">-</span> <span class="pre">x_k`,</span> <span class="pre">and</span>&#160; <span class="pre">:math:`d_k</span> <span class="pre">=</span> <span class="pre">(y_{k+1}</span> <span class="pre">-</span> <span class="pre">y_k)</span> <span class="pre">/</span> <span class="pre">h_k`\n</span>&#160;&#160;&#160; <span class="pre">are</span> <span class="pre">the</span> <span class="pre">slopes</span> <span class="pre">at</span> <span class="pre">internal</span> <span class="pre">points</span> <span class="pre">:math:`x_k`.\n</span>&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">the</span> <span class="pre">signs</span> <span class="pre">of</span> <span class="pre">:math:`d_k`</span> <span class="pre">and</span> <span class="pre">:math:`d_{k-1}`</span> <span class="pre">are</span> <span class="pre">different</span> <span class="pre">or</span> <span class="pre">either</span> <span class="pre">of\n</span>&#160;&#160;&#160; <span class="pre">them</span> <span class="pre">equals</span> <span class="pre">zero,</span> <span class="pre">then</span> <span class="pre">:math:`f'_k</span> <span class="pre">=</span> <span class="pre">0`.</span> <span class="pre">Otherwise,</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">given</span> <span class="pre">by</span> <span class="pre">the\n</span>&#160;&#160;&#160; <span class="pre">weighted</span> <span class="pre">harmonic</span> <span class="pre">mean\n\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">math::\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\\frac{w_1</span> <span class="pre">+</span> <span class="pre">w_2}{f'_k}</span> <span class="pre">=</span> <span class="pre">\\frac{w_1}{d_{k-1}}</span> <span class="pre">+</span> <span class="pre">\\frac{w_2}{d_k}\n\n</span>&#160;&#160;&#160; <span class="pre">where</span> <span class="pre">:math:`w_1</span> <span class="pre">=</span> <span class="pre">2</span> <span class="pre">h_k</span> <span class="pre">+</span> <span class="pre">h_{k-1}`</span> <span class="pre">and</span> <span class="pre">:math:`w_2</span> <span class="pre">=</span> <span class="pre">h_k</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">h_{k-1}`.\n\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">end</span> <span class="pre">slopes</span> <span class="pre">are</span> <span class="pre">set</span> <span class="pre">using</span> <span class="pre">a</span> <span class="pre">one-sided</span> <span class="pre">scheme</span> <span class="pre">[2]_.\n\n\n</span>&#160;&#160;&#160; <span class="pre">References\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">[1]</span> <span class="pre">F.</span> <span class="pre">N.</span> <span class="pre">Fritsch</span> <span class="pre">and</span> <span class="pre">J.</span> <span class="pre">Butland,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">method</span> <span class="pre">for</span> <span class="pre">constructing</span> <span class="pre">local\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">monotone</span> <span class="pre">piecewise</span> <span class="pre">cubic</span> <span class="pre">interpolants,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">SIAM</span> <span class="pre">J.</span> <span class="pre">Sci.</span> <span class="pre">Comput.,</span> <span class="pre">5(2),</span> <span class="pre">300-304</span> <span class="pre">(1984).\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">:doi:`10.1137/0905021`.\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">[2]</span> <span class="pre">see,</span> <span class="pre">e.g.,</span> <span class="pre">C.</span> <span class="pre">Moler,</span> <span class="pre">Numerical</span> <span class="pre">Computing</span> <span class="pre">with</span> <span class="pre">Matlab,</span> <span class="pre">2004.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">:doi:`10.1137/1.9780898717952`\n\n</span>&#160;&#160;&#160; <span class="pre">&quot;</span></em><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_cubic.html#PchipInterpolator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'scipy.interpolate._cubic'</span></em><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator._edge_case">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_edge_case</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_cubic.html#PchipInterpolator._edge_case"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator._edge_case" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator._find_derivatives">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_find_derivatives</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_cubic.html#PchipInterpolator._find_derivatives"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator._find_derivatives" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator.axis">
<span class="sig-name descname"><span class="pre">axis</span></span><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator.axis" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator.c">
<span class="sig-name descname"><span class="pre">c</span></span><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator.extrapolate">
<span class="sig-name descname"><span class="pre">extrapolate</span></span><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator.extrapolate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.envelope.PchipInterpolator.x">
<span class="sig-name descname"><span class="pre">x</span></span><a class="headerlink" href="#vtools.functions.envelope.PchipInterpolator.x" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.chunked_loess_smoothing">
<span class="sig-name descname"><span class="pre">chunked_loess_smoothing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_days</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_days</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#chunked_loess_smoothing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.chunked_loess_smoothing" title="Link to this definition">¶</a></dt>
<dd><p>Apply LOESS smoothing in overlapping chunks to reduce computation time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts</strong><span class="classifier">pd.Series</span></dt><dd><p>Time series with datetime index and possible NaNs.</p>
</dd>
<dt><strong>window_hours</strong><span class="classifier">float</span></dt><dd><p>LOESS smoothing window size in hours.</p>
</dd>
<dt><strong>chunk_days</strong><span class="classifier">int</span></dt><dd><p>Core chunk size (e.g., 10 days).</p>
</dd>
<dt><strong>overlap_days</strong><span class="classifier">int</span></dt><dd><p>Overlap added before and after each chunk to avoid edge effects.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pd.Series</dt><dd><p>Smoothed series, NaNs where input is NaN or unsupported.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.filter_extrema_ngood">
<span class="sig-name descname"><span class="pre">filter_extrema_ngood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extrema_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loess_window_pts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_good</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig_gap_minutes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">45</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#filter_extrema_ngood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.filter_extrema_ngood" title="Link to this definition">¶</a></dt>
<dd><p>Filter extrema based on local and contextual data quality criteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>extrema_df</strong><span class="classifier">pd.DataFrame</span></dt><dd><p>DataFrame with columns ‘time’ and ‘value’ for candidate extrema.</p>
</dd>
<dt><strong>smoothed</strong><span class="classifier">pd.Series</span></dt><dd><p>Smoothed version of the signal used for extrema detection.</p>
</dd>
<dt><strong>series</strong><span class="classifier">pd.Series</span></dt><dd><p>Original time series (with gaps).</p>
</dd>
<dt><strong>loess_window_pts</strong><span class="classifier">int</span></dt><dd><p>Number of points in the LOESS window.</p>
</dd>
<dt><strong>n_good</strong><span class="classifier">int</span></dt><dd><p>Minimum number of non-NaN points required.</p>
</dd>
<dt><strong>sig_gap_minutes</strong><span class="classifier">float</span></dt><dd><p>Threshold for detecting significant gaps (in minutes).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pd.DataFrame</dt><dd><p>Filtered extrema DataFrame.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.find_peaks">
<span class="sig-name descname"><span class="pre">find_peaks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prominence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plateau_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/_peak_finding.html#find_peaks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.find_peaks" title="Link to this definition">¶</a></dt>
<dd><p>Find peaks inside a signal based on peak properties.</p>
<p>This function takes a 1-D array and finds all local maxima by
simple comparison of neighboring values. Optionally, a subset of these
peaks can be selected by specifying conditions for a peak’s properties.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier">sequence</span></dt><dd><p>A signal with peaks.</p>
</dd>
<dt><strong>height</strong><span class="classifier">number or ndarray or sequence, optional</span></dt><dd><p>Required height of peaks. Either a number, <code class="docutils literal notranslate"><span class="pre">None</span></code>, an array matching
<cite>x</cite> or a 2-element sequence of the former. The first element is
always interpreted as the  minimal and the second, if supplied, as the
maximal required height.</p>
</dd>
<dt><strong>threshold</strong><span class="classifier">number or ndarray or sequence, optional</span></dt><dd><p>Required threshold of peaks, the vertical distance to its neighboring
samples. Either a number, <code class="docutils literal notranslate"><span class="pre">None</span></code>, an array matching <cite>x</cite> or a
2-element sequence of the former. The first element is always
interpreted as the  minimal and the second, if supplied, as the maximal
required threshold.</p>
</dd>
<dt><strong>distance</strong><span class="classifier">number, optional</span></dt><dd><p>Required minimal horizontal distance (&gt;= 1) in samples between
neighbouring peaks. Smaller peaks are removed first until the condition
is fulfilled for all remaining peaks.</p>
</dd>
<dt><strong>prominence</strong><span class="classifier">number or ndarray or sequence, optional</span></dt><dd><p>Required prominence of peaks. Either a number, <code class="docutils literal notranslate"><span class="pre">None</span></code>, an array
matching <cite>x</cite> or a 2-element sequence of the former. The first
element is always interpreted as the  minimal and the second, if
supplied, as the maximal required prominence.</p>
</dd>
<dt><strong>width</strong><span class="classifier">number or ndarray or sequence, optional</span></dt><dd><p>Required width of peaks in samples. Either a number, <code class="docutils literal notranslate"><span class="pre">None</span></code>, an array
matching <cite>x</cite> or a 2-element sequence of the former. The first
element is always interpreted as the  minimal and the second, if
supplied, as the maximal required width.</p>
</dd>
<dt><strong>wlen</strong><span class="classifier">int, optional</span></dt><dd><p>Used for calculation of the peaks prominences, thus it is only used if
one of the arguments <cite>prominence</cite> or <cite>width</cite> is given. See argument
<cite>wlen</cite> in <cite>peak_prominences</cite> for a full description of its effects.</p>
</dd>
<dt><strong>rel_height</strong><span class="classifier">float, optional</span></dt><dd><p>Used for calculation of the peaks width, thus it is only used if <cite>width</cite>
is given. See argument  <cite>rel_height</cite> in <cite>peak_widths</cite> for a full
description of its effects.</p>
</dd>
<dt><strong>plateau_size</strong><span class="classifier">number or ndarray or sequence, optional</span></dt><dd><p>Required size of the flat top of peaks in samples. Either a number,
<code class="docutils literal notranslate"><span class="pre">None</span></code>, an array matching <cite>x</cite> or a 2-element sequence of the former.
The first element is always interpreted as the minimal and the second,
if supplied as the maximal required plateau size.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.0.</span></p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>peaks</strong><span class="classifier">ndarray</span></dt><dd><p>Indices of peaks in <cite>x</cite> that satisfy all given conditions.</p>
</dd>
<dt><strong>properties</strong><span class="classifier">dict</span></dt><dd><p>A dictionary containing properties of the returned peaks which were
calculated as intermediate results during evaluation of the specified
conditions:</p>
<ul>
<li><dl class="simple">
<dt>‘peak_heights’</dt><dd><p>If <cite>height</cite> is given, the height of each peak in <cite>x</cite>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>‘left_thresholds’, ‘right_thresholds’</dt><dd><p>If <cite>threshold</cite> is given, these keys contain a peaks vertical
distance to its neighbouring samples.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>‘prominences’, ‘right_bases’, ‘left_bases’</dt><dd><p>If <cite>prominence</cite> is given, these keys are accessible. See
<cite>peak_prominences</cite> for a description of their content.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>‘width_heights’, ‘left_ips’, ‘right_ips’</dt><dd><p>If <cite>width</cite> is given, these keys are accessible. See <cite>peak_widths</cite>
for a description of their content.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>‘plateau_sizes’, left_edges’, ‘right_edges’</dt><dd><p>If <cite>plateau_size</cite> is given, these keys are accessible and contain
the indices of a peak’s edges (edges are still part of the
plateau) and the calculated plateau sizes.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.0.</span></p>
</div>
</dd>
</dl>
</li>
</ul>
<p>To calculate and return properties without excluding peaks, provide the
open interval <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">None)</span></code> as a value to the appropriate argument
(excluding <cite>distance</cite>).</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Warns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>PeakPropertyWarning</dt><dd><p>Raised if a peak’s properties have unexpected values (see
<cite>peak_prominences</cite> and <cite>peak_widths</cite>).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function may return unexpected results for data containing NaNs. To
avoid this, NaNs should either be removed or replaced.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_peaks_cwt</span></code></dt><dd><p>Find peaks using the wavelet transformation.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">peak_prominences</span></code></dt><dd><p>Directly calculate the prominence of peaks.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">peak_widths</span></code></dt><dd><p>Directly calculate the width of peaks.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>In the context of this function, a peak or local maximum is defined as any
sample whose two direct neighbours have a smaller amplitude. For flat peaks
(more than one sample of equal amplitude wide) the index of the middle
sample is returned (rounded down in case the number of samples is even).
For noisy signals the peak locations can be off because the noise might
change the position of local maxima. In those cases consider smoothing the
signal before searching for peaks or use other peak finding and fitting
methods (like <cite>find_peaks_cwt</cite>).</p>
<p>Some additional comments on specifying conditions:</p>
<ul class="simple">
<li><p>Almost all conditions (excluding <cite>distance</cite>) can be given as half-open or
closed intervals, e.g., <code class="docutils literal notranslate"><span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">None)</span></code> defines the half-open
interval <span class="math notranslate nohighlight">\([1, \infty]\)</span> while <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">1)</span></code> defines the interval
<span class="math notranslate nohighlight">\([-\infty, 1]\)</span>. The open interval <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">None)</span></code> can be specified
as well, which returns the matching properties without exclusion of peaks.</p></li>
<li><p>The border is always included in the interval used to select valid peaks.</p></li>
<li><p>For several conditions the interval borders can be specified with
arrays matching <cite>x</cite> in shape which enables dynamic constrains based on
the sample position.</p></li>
<li><p>The conditions are evaluated in the following order: <cite>plateau_size</cite>,
<cite>height</cite>, <cite>threshold</cite>, <cite>distance</cite>, <cite>prominence</cite>, <cite>width</cite>. In most cases
this order is the fastest one because faster operations are applied first
to reduce the number of peaks that need to be evaluated later.</p></li>
<li><p>While indices in <cite>peaks</cite> are guaranteed to be at least <cite>distance</cite> samples
apart, edges of flat peaks may be closer than the allowed <cite>distance</cite>.</p></li>
<li><p>Use <cite>wlen</cite> to reduce the time it takes to evaluate the conditions for
<cite>prominence</cite> or <cite>width</cite> if <cite>x</cite> is large or has many local maxima
(see <cite>peak_prominences</cite>).</p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.1.0.</span></p>
</div>
<p class="rubric">Examples</p>
<p>To demonstrate this function’s usage we use a signal <cite>x</cite> supplied with
SciPy (see <cite>scipy.datasets.electrocardiogram</cite>). Let’s find all peaks (local
maxima) in <cite>x</cite> whose amplitude lies above 0.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.datasets</span> <span class="kn">import</span> <span class="n">electrocardiogram</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">find_peaks</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">electrocardiogram</span><span class="p">()[</span><span class="mi">2000</span><span class="p">:</span><span class="mi">4000</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">peaks</span><span class="p">],</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>We can select peaks below 0 with <code class="docutils literal notranslate"><span class="pre">height=(None,</span> <span class="pre">0)</span></code> or use arrays matching
<cite>x</cite> in size to reflect a changing condition for different parts of the
signal.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">border</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">border</span><span class="p">,</span> <span class="n">border</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">border</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">border</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">peaks</span><span class="p">],</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Another useful condition for periodic signals can be given with the
<cite>distance</cite> argument. In this case, we can easily select the positions of
QRS complexes within the electrocardiogram (ECG) by demanding a distance of
at least 150 samples.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span>
<span class="go">array([186, 180, 177, 171, 177, 169, 167, 164, 158, 162, 172])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">peaks</span><span class="p">],</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Especially for noisy signals peaks can be easily grouped by their
prominence (see <cite>peak_prominences</cite>). E.g., we can select all peaks except
for the mentioned QRS complexes by limiting the allowed prominence to 0.6.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span><span class="p">,</span> <span class="n">properties</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prominence</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;prominences&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="go">0.5049999999999999</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">peaks</span><span class="p">],</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>And, finally, let’s examine a different section of the ECG which contains
beat forms of different shape. To select only the atypical heart beats, we
combine two conditions: a minimal prominence of 1 and width of at least 20
samples.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">electrocardiogram</span><span class="p">()[</span><span class="mi">17000</span><span class="p">:</span><span class="mi">18000</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">peaks</span><span class="p">,</span> <span class="n">properties</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prominence</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;prominences&quot;</span><span class="p">],</span> <span class="n">properties</span><span class="p">[</span><span class="s2">&quot;widths&quot;</span><span class="p">]</span>
<span class="go">(array([1.495, 2.3  ]), array([36.93773946, 39.32723577]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">peaks</span><span class="p">],</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">peaks</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">peaks</span><span class="p">]</span> <span class="o">-</span> <span class="n">properties</span><span class="p">[</span><span class="s2">&quot;prominences&quot;</span><span class="p">],</span>
<span class="gp">... </span>           <span class="n">ymax</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">peaks</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;C1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;width_heights&quot;</span><span class="p">],</span> <span class="n">xmin</span><span class="o">=</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;left_ips&quot;</span><span class="p">],</span>
<span class="gp">... </span>           <span class="n">xmax</span><span class="o">=</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;right_ips&quot;</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;C1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.find_raw_extrema">
<span class="sig-name descname"><span class="pre">find_raw_extrema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smoothed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prominence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#find_raw_extrema"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.find_raw_extrema" title="Link to this definition">¶</a></dt>
<dd><p>Find raw peaks and troughs using scipy.signal.find_peaks.
Returns DataFrames for peaks and troughs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.generate_pink_noise">
<span class="sig-name descname"><span class="pre">generate_pink_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#generate_pink_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.generate_pink_noise" title="Link to this definition">¶</a></dt>
<dd><p>Generate pink (1/f) noise using the Voss-McCartney algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n</strong><span class="classifier">int</span></dt><dd><p>Number of samples to generate.</p>
</dd>
<dt><strong>seed</strong><span class="classifier">int or None</span></dt><dd><p>Random seed for reproducibility.</p>
</dd>
<dt><strong>scale</strong><span class="classifier">float</span></dt><dd><p>Standard deviation scaling factor for the noise.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>Pink noise signal of length n.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.generate_simplified_mixed_tide">
<span class="sig-name descname"><span class="pre">generate_simplified_mixed_tide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2022-01-01'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'15min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A_M2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A_K1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A_O1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_D1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.570795</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#generate_simplified_mixed_tide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.generate_simplified_mixed_tide" title="Link to this definition">¶</a></dt>
<dd><p>Generate a simplified synthetic mixed semidiurnal/diurnal tide with explicit O1 and K1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>start_time</strong><span class="classifier">str</span></dt><dd><p>Start time for the series.</p>
</dd>
<dt><strong>ndays</strong><span class="classifier">int</span></dt><dd><p>Number of days.</p>
</dd>
<dt><strong>freq</strong><span class="classifier">str</span></dt><dd><p>Sampling interval.</p>
</dd>
<dt><strong>A_M2</strong><span class="classifier">float</span></dt><dd><p>Amplitude of M2.</p>
</dd>
<dt><strong>A_K1</strong><span class="classifier">float</span></dt><dd><p>Amplitude of K1.</p>
</dd>
<dt><strong>A_O1</strong><span class="classifier">float</span></dt><dd><p>Amplitude of O1.</p>
</dd>
<dt><strong>phase_D1</strong><span class="classifier">float</span></dt><dd><p>Common phase shift for O1 and K1.</p>
</dd>
<dt><strong>return_components</strong><span class="classifier">bool</span></dt><dd><p>Whether to return individual components.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pd.Series or pd.DataFrame</dt><dd><p>Combined tide or components with time index.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.interpolate_envelope">
<span class="sig-name descname"><span class="pre">interpolate_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anchor_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_anchor_gap_hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">36</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#interpolate_envelope"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.interpolate_envelope" title="Link to this definition">¶</a></dt>
<dd><p>Interpolate envelope using PCHIP, breaking if anchor points are too far apart.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.lowess">
<span class="sig-name descname"><span class="pre">lowess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">endog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6666666666666666</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">it</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xvals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'drop'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/statsmodels/nonparametric/smoothers_lowess.html#lowess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.lowess" title="Link to this definition">¶</a></dt>
<dd><p>LOWESS (Locally Weighted Scatterplot Smoothing)</p>
<p>A lowess function that outs smoothed estimates of endog
at the given exog values from points (exog, endog)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>endog</strong><span class="classifier">1-D numpy array</span></dt><dd><p>The y-values of the observed points</p>
</dd>
<dt><strong>exog</strong><span class="classifier">1-D numpy array</span></dt><dd><p>The x-values of the observed points</p>
</dd>
<dt><strong>frac</strong><span class="classifier">float</span></dt><dd><p>Between 0 and 1. The fraction of the data used
when estimating each y-value.</p>
</dd>
<dt><strong>it</strong><span class="classifier">int</span></dt><dd><p>The number of residual-based reweightings
to perform.</p>
</dd>
<dt><strong>delta</strong><span class="classifier">float</span></dt><dd><p>Distance within which to use linear-interpolation
instead of weighted regression.</p>
</dd>
<dt><strong>xvals: 1-D numpy array</strong></dt><dd><p>Values of the exogenous variable at which to evaluate the regression.
If supplied, cannot use delta.</p>
</dd>
<dt><strong>is_sorted</strong><span class="classifier">bool</span></dt><dd><p>If False (default), then the data will be sorted by exog before
calculating lowess. If True, then it is assumed that the data is
already sorted by exog. If xvals is specified, then it too must be
sorted if is_sorted is True.</p>
</dd>
<dt><strong>missing</strong><span class="classifier">str</span></dt><dd><p>Available options are ‘none’, ‘drop’, and ‘raise’. If ‘none’, no nan
checking is done. If ‘drop’, any observations with nans are dropped.
If ‘raise’, an error is raised. Default is ‘drop’.</p>
</dd>
<dt><strong>return_sorted</strong><span class="classifier">bool</span></dt><dd><p>If True (default), then the returned array is sorted by exog and has
missing (nan or infinite) observations removed.
If False, then the returned array is in the same length and the same
sequence of observations as the input array.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out</strong><span class="classifier">{ndarray, float}</span></dt><dd><p>The returned array is two-dimensional if return_sorted is True, and
one dimensional if return_sorted is False.
If return_sorted is True, then a numpy array with two columns. The
first column contains the sorted x (exog) values and the second column
the associated estimated y (endog) values.
If return_sorted is False, then only the fitted values are returned,
and the observations will be in the same order as the input arrays.
If xvals is provided, then return_sorted is ignored and the returned
array is always one dimensional, containing the y values fitted at
the x values provided by xvals.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This lowess function implements the algorithm given in the
reference below using local linear estimates.</p>
<p>Suppose the input data has N points. The algorithm works by
estimating the <cite>smooth</cite> y_i by taking the frac*N closest points
to (x_i,y_i) based on their x values and estimating y_i
using a weighted linear regression. The weight for (x_j,y_j)
is tricube function applied to abs(x_i-x_j).</p>
<p>If it &gt; 1, then further weighted local linear regressions
are performed, where the weights are the same as above
times the _lowess_bisquare function of the residuals. Each iteration
takes approximately the same amount of time as the original fit,
so these iterations are expensive. They are most useful when
the noise has extremely heavy tails, such as Cauchy noise.
Noise with less heavy-tails, such as t-distributions with df&gt;2,
are less problematic. The weights downgrade the influence of
points with large residuals. In the extreme case, points whose
residuals are larger than 6 times the median absolute residual
are given weight 0.</p>
<p><cite>delta</cite> can be used to save computations. For each <cite>x_i</cite>, regressions
are skipped for points closer than <cite>delta</cite>. The next regression is
fit for the farthest point within delta of <cite>x_i</cite> and all points in
between are estimated by linearly interpolating between the two
regression fits.</p>
<p>Judicious choice of delta can cut computation time considerably
for large data (N &gt; 5000). A good choice is <code class="docutils literal notranslate"><span class="pre">delta</span> <span class="pre">=</span> <span class="pre">0.01</span> <span class="pre">*</span> <span class="pre">range(exog)</span></code>.</p>
<p>If <cite>xvals</cite> is provided, the regression is then computed at those points
and the fit values are returned. Otherwise, the regression is run
at points of <cite>exog</cite>.</p>
<p>Some experimentation is likely required to find a good
choice of <cite>frac</cite> and <cite>iter</cite> for a particular dataset.</p>
<p class="rubric">References</p>
<p>Cleveland, W.S. (1979) “Robust Locally Weighted Regression
and Smoothing Scatterplots”. Journal of the American Statistical
Association 74 (368): 829-836.</p>
<p class="rubric">Examples</p>
<p>The below allows a comparison between how different the fits from
lowess for different values of frac can be.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lowess</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">nonparametric</span><span class="o">.</span><span class="n">lowess</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>This gives a similar comparison for when it is 0 vs not.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lowess</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">nonparametric</span><span class="o">.</span><span class="n">lowess</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">stats</span><span class="o">.</span><span class="n">cauchy</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">it</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">lowess</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.savgol_filter">
<span class="sig-name descname"><span class="pre">savgol_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polyorder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'interp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/_savitzky_golay.html#savgol_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.savgol_filter" title="Link to this definition">¶</a></dt>
<dd><p>Apply a Savitzky-Golay filter to an array.</p>
<p>This is a 1-D filter. If <cite>x</cite>  has dimension greater than 1, <cite>axis</cite>
determines the axis along which the filter is applied.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">array_like</span></dt><dd><p>The data to be filtered. If <cite>x</cite> is not a single or double precision
floating point array, it will be converted to type <code class="docutils literal notranslate"><span class="pre">numpy.float64</span></code>
before filtering.</p>
</dd>
<dt><strong>window_length</strong><span class="classifier">int</span></dt><dd><p>The length of the filter window (i.e., the number of coefficients).
If <cite>mode</cite> is ‘interp’, <cite>window_length</cite> must be less than or equal
to the size of <cite>x</cite>.</p>
</dd>
<dt><strong>polyorder</strong><span class="classifier">int</span></dt><dd><p>The order of the polynomial used to fit the samples.
<cite>polyorder</cite> must be less than <cite>window_length</cite>.</p>
</dd>
<dt><strong>deriv</strong><span class="classifier">int, optional</span></dt><dd><p>The order of the derivative to compute. This must be a
nonnegative integer. The default is 0, which means to filter
the data without differentiating.</p>
</dd>
<dt><strong>delta</strong><span class="classifier">float, optional</span></dt><dd><p>The spacing of the samples to which the filter will be applied.
This is only used if deriv &gt; 0. Default is 1.0.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>The axis of the array <cite>x</cite> along which the filter is to be applied.
Default is -1.</p>
</dd>
<dt><strong>mode</strong><span class="classifier">str, optional</span></dt><dd><p>Must be ‘mirror’, ‘constant’, ‘nearest’, ‘wrap’ or ‘interp’. This
determines the type of extension to use for the padded signal to
which the filter is applied.  When <cite>mode</cite> is ‘constant’, the padding
value is given by <cite>cval</cite>.  See the Notes for more details on ‘mirror’,
‘constant’, ‘wrap’, and ‘nearest’.
When the ‘interp’ mode is selected (the default), no extension
is used.  Instead, a degree <cite>polyorder</cite> polynomial is fit to the
last <cite>window_length</cite> values of the edges, and this polynomial is
used to evaluate the last <cite>window_length // 2</cite> output values.</p>
</dd>
<dt><strong>cval</strong><span class="classifier">scalar, optional</span></dt><dd><p>Value to fill past the edges of the input if <cite>mode</cite> is ‘constant’.
Default is 0.0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>y</strong><span class="classifier">ndarray, same shape as <cite>x</cite></span></dt><dd><p>The filtered data.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">savgol_coeffs</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Details on the <cite>mode</cite> options:</p>
<blockquote>
<div><dl class="simple">
<dt>‘mirror’:</dt><dd><p>Repeats the values at the edges in reverse order. The value
closest to the edge is not included.</p>
</dd>
<dt>‘nearest’:</dt><dd><p>The extension contains the nearest input value.</p>
</dd>
<dt>‘constant’:</dt><dd><p>The extension contains the value given by the <cite>cval</cite> argument.</p>
</dd>
<dt>‘wrap’:</dt><dd><p>The extension contains the values from the other end of the array.</p>
</dd>
</dl>
</div></blockquote>
<p>For example, if the input is [1, 2, 3, 4, 5, 6, 7, 8], and
<cite>window_length</cite> is 7, the following shows the extended data for
the various <cite>mode</cite> options (assuming <cite>cval</cite> is 0):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mode</span>       <span class="o">|</span>   <span class="n">Ext</span>   <span class="o">|</span>         <span class="n">Input</span>          <span class="o">|</span>   <span class="n">Ext</span>
<span class="o">-----------+---------+------------------------+---------</span>
<span class="s1">&#39;mirror&#39;</span>   <span class="o">|</span> <span class="mi">4</span>  <span class="mi">3</span>  <span class="mi">2</span> <span class="o">|</span> <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span> <span class="o">|</span> <span class="mi">7</span>  <span class="mi">6</span>  <span class="mi">5</span>
<span class="s1">&#39;nearest&#39;</span>  <span class="o">|</span> <span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span> <span class="o">|</span> <span class="mi">8</span>  <span class="mi">8</span>  <span class="mi">8</span>
<span class="s1">&#39;constant&#39;</span> <span class="o">|</span> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span> <span class="o">|</span> <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span> <span class="o">|</span> <span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">0</span>
<span class="s1">&#39;wrap&#39;</span>     <span class="o">|</span> <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span> <span class="o">|</span> <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>  <span class="mi">4</span>  <span class="mi">5</span>  <span class="mi">6</span>  <span class="mi">7</span>  <span class="mi">8</span> <span class="o">|</span> <span class="mi">1</span>  <span class="mi">2</span>  <span class="mi">3</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.14.0.</span></p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">savgol_filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># For compact display.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<p>Filter with a window length of 5 and a degree 2 polynomial.  Use
the defaults for all other parameters.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">savgol_filter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">array([1.66, 3.17, 3.54, 2.86, 0.66, 0.17, 1.  , 4.  , 9.  ])</span>
</pre></div>
</div>
<p>Note that the last five values in x are samples of a parabola, so
when mode=’interp’ (the default) is used with polyorder=2, the last
three values are unchanged. Compare that to, for example,
<cite>mode=’nearest’</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">savgol_filter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="go">array([1.74, 3.03, 3.54, 2.86, 0.66, 0.17, 1.  , 4.6 , 7.97])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.select_salient_extrema">
<span class="sig-name descname"><span class="pre">select_salient_extrema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extrema</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing_hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'outer'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#select_salient_extrema"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.select_salient_extrema" title="Link to this definition">¶</a></dt>
<dd><p>Select salient extrema (HH/LL or HL/LH) using literal spacing-based OR logic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>extrema</strong><span class="classifier">pd.DataFrame with columns [“time”, “value”]</span></dt><dd><p>Candidate extrema.</p>
</dd>
<dt><strong>typ</strong><span class="classifier">str</span></dt><dd><p>Either “high” or “low” (for peak or trough selection).</p>
</dd>
<dt><strong>spacing_hours</strong><span class="classifier">float</span></dt><dd><p>Time window for neighbor comparison.</p>
</dd>
<dt><strong>envelope_type</strong><span class="classifier">str</span></dt><dd><p>Either “outer” (default) or “inner” to switch saliency logic.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pd.DataFrame</dt><dd><p>Extrema that passed the saliency test.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.smooth_series">
<span class="sig-name descname"><span class="pre">smooth_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.75</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#smooth_series"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.smooth_series" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.smooth_series2">
<span class="sig-name descname"><span class="pre">smooth_series2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_pts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lowess'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#smooth_series2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.smooth_series2" title="Link to this definition">¶</a></dt>
<dd><p>Smooth a time series using the specified method.
Currently supports ‘lowess’, ‘moving_average’, or ‘savgol’.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.envelope.tidal_envelope">
<span class="sig-name descname"><span class="pre">tidal_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing_window_hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_good</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_prominence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saliency_window_hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_anchor_gap_hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">36</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'outer'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/envelope.html#tidal_envelope"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.envelope.tidal_envelope" title="Link to this definition">¶</a></dt>
<dd><p>Compute the tidal envelope (high and low) of a time series using smoothing, extrema detection, and interpolation.
This function processes a time series to extract its tidal envelope by smoothing the data, identifying significant peaks and troughs, filtering out unreliable extrema, selecting salient extrema within a specified window, and interpolating between anchor points to generate continuous envelope curves.
Parameters
———-
series : pandas.Series</p>
<blockquote>
<div><p>Time-indexed series of water levels or similar data.</p>
</div></blockquote>
<dl class="simple">
<dt>smoothing_window_hours<span class="classifier">float, optional</span></dt><dd><p>Window size in hours for smoothing the input series (default is 2.5).</p>
</dd>
<dt>n_good<span class="classifier">int, optional</span></dt><dd><p>Minimum number of good points required for an extremum to be considered valid (default is 3).</p>
</dd>
<dt>peak_prominence<span class="classifier">float, optional</span></dt><dd><p>Minimum prominence of peaks/troughs to be considered as extrema (default is 0.05).</p>
</dd>
<dt>saliency_window_hours<span class="classifier">float, optional</span></dt><dd><p>Window size in hours for selecting salient extrema (default is 14).</p>
</dd>
<dt>max_anchor_gap_hours<span class="classifier">float, optional</span></dt><dd><p>Maximum allowed gap in hours between anchor points for interpolation (default is 36).</p>
</dd>
<dt>envelope_type<span class="classifier">str, optional</span></dt><dd><p>Type of envelope to compute, e.g., “outer” (default is “outer”).</p>
</dd>
</dl>
<section id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>env_high<span class="classifier">pandas.Series</span></dt><dd><p>Interpolated high (upper) envelope of the input series.</p>
</dd>
<dt>env_low<span class="classifier">pandas.Series</span></dt><dd><p>Interpolated low (lower) envelope of the input series.</p>
</dd>
<dt>anchor_highs<span class="classifier">pandas.DataFrame</span></dt><dd><p>DataFrame of selected anchor points for the high envelope.</p>
</dd>
<dt>anchor_lows<span class="classifier">pandas.DataFrame</span></dt><dd><p>DataFrame of selected anchor points for the low envelope.</p>
</dd>
<dt>smoothed<span class="classifier">pandas.Series</span></dt><dd><p>Smoothed version of the input series.</p>
</dd>
</dl>
</section>
<section id="notes">
<h3>Notes<a class="headerlink" href="#notes" title="Link to this heading">¶</a></h3>
<p>This function assumes regular time intervals in the input series. If the frequency cannot be inferred, it is estimated from the first two timestamps.</p>
</section>
</dd></dl>

</section>
<section id="module-vtools.functions.error_detect">
<span id="vtools-functions-error-detect-module"></span><h2>vtools.functions.error_detect module<a class="headerlink" href="#module-vtools.functions.error_detect" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect._nrepeat">
<span class="sig-name descname"><span class="pre">_nrepeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#_nrepeat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect._nrepeat" title="Link to this definition">¶</a></dt>
<dd><p>Series-only version</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.bounds_test">
<span class="sig-name descname"><span class="pre">bounds_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#bounds_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.bounds_test" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.despike">
<span class="sig-name descname"><span class="pre">despike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#despike"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.despike" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.example">
<span class="sig-name descname"><span class="pre">example</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#example"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.example" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.example2">
<span class="sig-name descname"><span class="pre">example2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#example2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.example2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.med_outliers">
<span class="sig-name descname"><span class="pre">med_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.01,</span> <span class="pre">0.99)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_anomaly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#med_outliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.med_outliers" title="Link to this definition">¶</a></dt>
<dd><p>Detect outliers by running a median filter, subtracting it
from the original series and comparing the resulting residuals
to a global robust range of scale (the interquartile range).
Individual time points are rejected if the residual at that time point is more than level times the range of scale.</p>
<p>The original concept comes from Basu &amp; Meckesheimer (2007)
Automatic outlier detection for time series: an application to sensor data
although they didn’t use the interquartile range but rather
expert judgment. To use this function effectively, you need to
be thoughtful about what the interquartile range will be. For instance,
for a strongly tidal flow station it is likely to</p>
<dl class="simple">
<dt>level: Number of times the scale or interquantile range the data has to be</dt><dd><p>to be rejected.d</p>
</dd>
<dt>scale: Expert judgment of the scale of maximum variation over a time step.</dt><dd><p>If None, the interquartile range will be used. Note that for a
strongly tidal station the interquartile range may substantially overestimate the reasonable variation over a single time step, in which case the filter will work fine, but level should be set to
a number (less than one) accordingly.</p>
</dd>
</dl>
<p>filt_len: length of median filter, default is 5</p>
<dl class="simple">
<dt>quantiles<span class="classifier">tuple of quantiles defining the measure of scale. Ignored</span></dt><dd><p>if scale is given directly. Default is interquartile range, and
this is almost always a reasonable choice.</p>
</dd>
</dl>
<p>copy: if True, a copy is made leaving original series intact</p>
<p>You can also specify rejection of  values based on a simple range</p>
<p>Returns: copy of series with outliers replaced by nan</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.median_test">
<span class="sig-name descname"><span class="pre">median_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.005,</span> <span class="pre">0.095)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#median_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.median_test" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.nrepeat">
<span class="sig-name descname"><span class="pre">nrepeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#nrepeat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.nrepeat" title="Link to this definition">¶</a></dt>
<dd><p>Return the length of consecutive runs of repeated values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts:  DataFrame or series</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Like-indexed series with lengths of runs. Nans will be mapped to 0</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.steep_then_nan">
<span class="sig-name descname"><span class="pre">steep_then_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.01,</span> <span class="pre">0.99)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_anomaly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#steep_then_nan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.steep_then_nan" title="Link to this definition">¶</a></dt>
<dd><p>Detect outliers by running a median filter, subtracting it
from the original series and comparing the resulting residuals
to a global robust range of scale (the interquartile range).
Individual time points are rejected if the residual at that time point is more than level times the range of scale.</p>
<p>The original concept comes from Basu &amp; Meckesheimer (2007)
although they didn’t use the interquartile range but rather
expert judgment. To use this function effectively, you need to
be thoughtful about what the interquartile range will be. For instance,
for a strongly tidal flow station it is likely to</p>
<dl class="simple">
<dt>level: Number of times the scale or interquantile range the data has to be</dt><dd><p>to be rejected.d</p>
</dd>
<dt>scale: Expert judgment of the scale of maximum variation over a time step.</dt><dd><p>If None, the interquartile range will be used. Note that for a
strongly tidal station the interquartile range may substantially overestimate the reasonable variation over a single time step, in which case the filter will work fine, but level should be set to
a number (less than one) accordingly.</p>
</dd>
</dl>
<p>filt_len: length of median filter, default is 5</p>
<dl class="simple">
<dt>quantiles<span class="classifier">tuple of quantiles defining the measure of scale. Ignored</span></dt><dd><p>if scale is given directly. Default is interquartile range, and
this is almost always a reasonable choice.</p>
</dd>
</dl>
<p>copy: if True, a copy is made leaving original series intact</p>
<p>You can also specify rejection of  values based on a simple range</p>
<p>Returns: copy of series with outliers replaced by nan</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.error_detect.threshold">
<span class="sig-name descname"><span class="pre">threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/error_detect.html#threshold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.error_detect.threshold" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-vtools.functions.example2">
<span id="vtools-functions-example2-module"></span><h2>vtools.functions.example2 module<a class="headerlink" href="#module-vtools.functions.example2" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.example2.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/example2.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.example2.main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-vtools.functions.filter">
<span id="vtools-functions-filter-module"></span><h2>vtools.functions.filter module<a class="headerlink" href="#module-vtools.functions.filter" title="Link to this heading">¶</a></h2>
<p>Module contains filter used in tidal time series analysis.</p>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter._gf1d">
<span class="sig-name descname"><span class="pre">_gf1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#_gf1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter._gf1d" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter._lanczos_impl">
<span class="sig-name descname"><span class="pre">_lanczos_impl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosine_taper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#_lanczos_impl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter._lanczos_impl" title="Link to this definition">¶</a></dt>
<dd><p>squared low-pass cosine lanczos  filter on a regular time series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd></dd>
<dt><strong>filter_len</strong><span class="classifier">int, time_interval</span></dt><dd><p>Size of lanczos window, default is to number of samples within filter_period*1.25.</p>
</dd>
<dt><strong>cutoff_frequency: float,optional</strong></dt><dd><p>Cutoff frequency expressed as a ratio of a Nyquist frequency,
should within the range (0,1). For example, if the sampling frequency
is 1 hour, the Nyquist frequency is 1 sample/2 hours. If we want a
36 hour cutoff period, the frequency is 1/36 or 0.0278 cycles per hour.
Hence the cutoff frequency argument used here would be
0.0278/0.5 = 0.056.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">string  or  _time_interval</span></dt><dd><blockquote>
<div><p>Period of cutting off frequency. If input as a string, it must
be  convertible to a _time_interval (Pandas freq).
cutoff_frequency and cutoff_period can’t be specified at the same time.</p>
</div></blockquote>
<dl class="simple">
<dt>padtype<span class="classifier">str or None, optional</span></dt><dd><p>Must be ‘odd’, ‘even’, ‘constant’, or None. This determines the type
of extension to use for the padded signal to which the filter is applied.
If padtype is None, no padding is used. The default is None.</p>
</dd>
<dt>padlen<span class="classifier">int or None, optional</span></dt><dd><p>The number of elements by which to extend x at both ends of axis
before applying the filter. This value must be less than x.shape[axis]-1.
padlen=0 implies no padding. If padtye is not None and padlen is not
given, padlen is be set to 6*m.</p>
</dd>
<dt>fill_edge_nan: bool,optional</dt><dd><p>If pading is not used and fill_edge_nan is true, resulting data on
the both ends are filled with nan to account for edge effect. This is
2*m on the either end of the result. Default is true.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></span></dt><dd><p>A new regular time series with the same interval of ts. If no pading
is used the beigning and ending 4*m resulting data will be set to nan
to remove edge effect.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If input timeseries is not regular,
or, cutoff_period and cutoff_frequency are given at the same time,
or, neither cutoff_period nor curoff_frequence is given,
or, padtype is not “odd”,”even”,”constant”,or None,
or, padlen is larger than data size</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.butter">
<span class="sig-name descname"><span class="pre">butter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Wn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">btype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'low'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ba'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/_filter_design.html#butter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.butter" title="Link to this definition">¶</a></dt>
<dd><p>Butterworth digital and analog filter design.</p>
<p>Design an Nth-order digital or analog Butterworth filter and return
the filter coefficients.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>N</strong><span class="classifier">int</span></dt><dd><p>The order of the filter. For ‘bandpass’ and ‘bandstop’ filters,
the resulting order of the final second-order sections (‘sos’)
matrix is <code class="docutils literal notranslate"><span class="pre">2*N</span></code>, with <cite>N</cite> the number of biquad sections
of the desired system.</p>
</dd>
<dt><strong>Wn</strong><span class="classifier">array_like</span></dt><dd><p>The critical frequency or frequencies. For lowpass and highpass
filters, Wn is a scalar; for bandpass and bandstop filters,
Wn is a length-2 sequence.</p>
<p>For a Butterworth filter, this is the point at which the gain
drops to 1/sqrt(2) that of the passband (the “-3 dB point”).</p>
<p>For digital filters, if <cite>fs</cite> is not specified, <cite>Wn</cite> units are
normalized from 0 to 1, where 1 is the Nyquist frequency (<cite>Wn</cite> is
thus in half cycles / sample and defined as 2*critical frequencies
/ <cite>fs</cite>). If <cite>fs</cite> is specified, <cite>Wn</cite> is in the same units as <cite>fs</cite>.</p>
<p>For analog filters, <cite>Wn</cite> is an angular frequency (e.g. rad/s).</p>
</dd>
<dt><strong>btype</strong><span class="classifier">{‘lowpass’, ‘highpass’, ‘bandpass’, ‘bandstop’}, optional</span></dt><dd><p>The type of filter.  Default is ‘lowpass’.</p>
</dd>
<dt><strong>analog</strong><span class="classifier">bool, optional</span></dt><dd><p>When True, return an analog filter, otherwise a digital filter is
returned.</p>
</dd>
<dt><strong>output</strong><span class="classifier">{‘ba’, ‘zpk’, ‘sos’}, optional</span></dt><dd><p>Type of output:  numerator/denominator (‘ba’), pole-zero (‘zpk’), or
second-order sections (‘sos’). Default is ‘ba’ for backwards
compatibility, but ‘sos’ should be used for general-purpose filtering.</p>
</dd>
<dt><strong>fs</strong><span class="classifier">float, optional</span></dt><dd><p>The sampling frequency of the digital system.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.0.</span></p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>b, a</strong><span class="classifier">ndarray, ndarray</span></dt><dd><p>Numerator (<cite>b</cite>) and denominator (<cite>a</cite>) polynomials of the IIR filter.
Only returned if <code class="docutils literal notranslate"><span class="pre">output='ba'</span></code>.</p>
</dd>
<dt><strong>z, p, k</strong><span class="classifier">ndarray, ndarray, float</span></dt><dd><p>Zeros, poles, and system gain of the IIR filter transfer
function.  Only returned if <code class="docutils literal notranslate"><span class="pre">output='zpk'</span></code>.</p>
</dd>
<dt><strong>sos</strong><span class="classifier">ndarray</span></dt><dd><p>Second-order sections representation of the IIR filter.
Only returned if <code class="docutils literal notranslate"><span class="pre">output='sos'</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">buttord</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">buttap</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The Butterworth filter has maximally flat frequency response in the
passband.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'sos'</span></code> output parameter was added in 0.16.0.</p>
<p>If the transfer function form <code class="docutils literal notranslate"><span class="pre">[b,</span> <span class="pre">a]</span></code> is requested, numerical
problems can occur since the conversion between roots and
the polynomial coefficients is a numerically sensitive operation,
even for N &gt;= 4. It is recommended to work with the SOS
representation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Designing high-order and narrowband IIR filters in TF form can
result in unstable or incorrect filtering due to floating point
numerical precision issues. Consider inspecting output filter
characteristics <cite>freqz</cite> or designing the filters with second-order
sections via <code class="docutils literal notranslate"><span class="pre">output='sos'</span></code>.</p>
</div>
<p class="rubric">Examples</p>
<p>Design an analog filter and plot its frequency response, showing the
critical points:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Butterworth filter frequency response&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [radians / second]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude [dB]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">margins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span> <span class="c1"># cutoff frequency</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Generate a signal made up of 10 Hz and 20 Hz, sampled at 1 kHz</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># 1 second</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">20</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;10 Hz and 20 Hz sinusoids&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Design a digital high-pass filter at 15 Hz to remove the 10 Hz tone, and
apply it to the signal. (It’s recommended to use second-order sections
format when filtering, to avoid numerical error with transfer function
(<code class="docutils literal notranslate"><span class="pre">ba</span></code>) format):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;hp&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">filtered</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;After 15 Hz high-pass filter&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [seconds]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.butterworth">
<span class="sig-name descname"><span class="pre">butterworth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#butterworth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.butterworth" title="Link to this definition">¶</a></dt>
<dd><p>low-pass butterworth-squared filter on a regular time series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>Must be one or two dimensional, and regular.</p>
</dd>
<dt><strong>order: int ,optional</strong></dt><dd><p>The default is 4.</p>
</dd>
<dt><strong>cutoff_frequency: float,optional</strong></dt><dd><p>Cutoff frequency expressed as a ratio with Nyquist frequency,
should within the range (0,1). For a discretely sampled system,
the Nyquist frequency is the fastest frequency that can be resolved by that
sampling, which is half the sampling frequency. For example, if the sampling frequency
is 1 sample/1 hour, the Nyquist frequency is 1 sample/2 hours. If we want a
36 hour cutoff period, the frequency is 1/36 or 0.0278 cycles per hour.
Hence the cutoff frequency argument used here would be
0.0278/0.5 = 0.056.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">string  or  _time_interval</span></dt><dd><p>Period corresponding to cutoff frequency. If input as a string, it must
be  convertible to a regular interval using the same rules as a pandas frequency..
cutoff_frequency and cutoff_period can’t be specified at the same time.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>result</dt><dd><p>A new regular time series with the same interval as ts.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If input order is not even, or input timeseries is not regular,
or neither cutoff_period and cutoff_frequency is given while input
time series interval is not 15min or 1 hour, or  cutoff_period and cutoff_frequency
are given at the same time.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.convert_span_to_nstep">
<span class="sig-name descname"><span class="pre">convert_span_to_nstep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#convert_span_to_nstep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.convert_span_to_nstep" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.cosine_lanczos">
<span class="sig-name descname"><span class="pre">cosine_lanczos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#cosine_lanczos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.cosine_lanczos" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.cosine_lanczos5">
<span class="sig-name descname"><span class="pre">cosine_lanczos5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#cosine_lanczos5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.cosine_lanczos5" title="Link to this definition">¶</a></dt>
<dd><p>squared low-pass cosine lanczos  filter on a regular time series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd></dd>
<dt><strong>filter_len</strong><span class="classifier">int, time_interval</span></dt><dd><p>Size of lanczos window, default is to number of samples within filter_period*1.25.</p>
</dd>
<dt><strong>cutoff_frequency: float,optional</strong></dt><dd><p>Cutoff frequency expressed as a ratio of a Nyquist frequency,
should within the range (0,1). For example, if the sampling frequency
is 1 hour, the Nyquist frequency is 1 sample/2 hours. If we want a
36 hour cutoff period, the frequency is 1/36 or 0.0278 cycles per hour.
Hence the cutoff frequency argument used here would be
0.0278/0.5 = 0.056.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">string  or  _time_interval</span></dt><dd><blockquote>
<div><p>Period of cutting off frequency. If input as a string, it must
be  convertible to a _time_interval (Pandas freq).
cutoff_frequency and cutoff_period can’t be specified at the same time.</p>
</div></blockquote>
<dl class="simple">
<dt>padtype<span class="classifier">str or None, optional</span></dt><dd><p>Must be ‘odd’, ‘even’, ‘constant’, or None. This determines the type
of extension to use for the padded signal to which the filter is applied.
If padtype is None, no padding is used. The default is None.</p>
</dd>
<dt>padlen<span class="classifier">int or None, optional</span></dt><dd><p>The number of elements by which to extend x at both ends of axis
before applying the filter. This value must be less than x.shape[axis]-1.
padlen=0 implies no padding. If padtye is not None and padlen is not
given, padlen is be set to 6*m.</p>
</dd>
<dt>fill_edge_nan: bool,optional</dt><dd><p>If pading is not used and fill_edge_nan is true, resulting data on
the both ends are filled with nan to account for edge effect. This is
2*m on the either end of the result. Default is true.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></span></dt><dd><p>A new regular time series with the same interval of ts. If no pading
is used the beigning and ending 4*m resulting data will be set to nan
to remove edge effect.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If input timeseries is not regular,
or, cutoff_period and cutoff_frequency are given at the same time,
or, neither cutoff_period nor curoff_frequence is given,
or, padtype is not “odd”,”even”,”constant”,or None,
or, padlen is larger than data size</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.filtfilt">
<span class="sig-name descname"><span class="pre">filtfilt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'odd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pad'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/_signaltools.html#filtfilt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.filtfilt" title="Link to this definition">¶</a></dt>
<dd><p>Apply a digital filter forward and backward to a signal.</p>
<p>This function applies a linear digital filter twice, once forward and
once backwards.  The combined filter has zero phase and a filter order
twice that of the original.</p>
<p>The function provides options for handling the edges of the signal.</p>
<p>The function <cite>sosfiltfilt</cite> (and filter design using <code class="docutils literal notranslate"><span class="pre">output='sos'</span></code>)
should be preferred over <cite>filtfilt</cite> for most filtering tasks, as
second-order sections have fewer numerical problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>b</strong><span class="classifier">(N,) array_like</span></dt><dd><p>The numerator coefficient vector of the filter.</p>
</dd>
<dt><strong>a</strong><span class="classifier">(N,) array_like</span></dt><dd><p>The denominator coefficient vector of the filter.  If <code class="docutils literal notranslate"><span class="pre">a[0]</span></code>
is not 1, then both <cite>a</cite> and <cite>b</cite> are normalized by <code class="docutils literal notranslate"><span class="pre">a[0]</span></code>.</p>
</dd>
<dt><strong>x</strong><span class="classifier">array_like</span></dt><dd><p>The array of data to be filtered.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>The axis of <cite>x</cite> to which the filter is applied.
Default is -1.</p>
</dd>
<dt><strong>padtype</strong><span class="classifier">str or None, optional</span></dt><dd><p>Must be ‘odd’, ‘even’, ‘constant’, or None.  This determines the
type of extension to use for the padded signal to which the filter
is applied.  If <cite>padtype</cite> is None, no padding is used.  The default
is ‘odd’.</p>
</dd>
<dt><strong>padlen</strong><span class="classifier">int or None, optional</span></dt><dd><p>The number of elements by which to extend <cite>x</cite> at both ends of
<cite>axis</cite> before applying the filter.  This value must be less than
<code class="docutils literal notranslate"><span class="pre">x.shape[axis]</span> <span class="pre">-</span> <span class="pre">1</span></code>.  <code class="docutils literal notranslate"><span class="pre">padlen=0</span></code> implies no padding.
The default value is <code class="docutils literal notranslate"><span class="pre">3</span> <span class="pre">*</span> <span class="pre">max(len(a),</span> <span class="pre">len(b))</span></code>.</p>
</dd>
<dt><strong>method</strong><span class="classifier">str, optional</span></dt><dd><p>Determines the method for handling the edges of the signal, either
“pad” or “gust”.  When <cite>method</cite> is “pad”, the signal is padded; the
type of padding is determined by <cite>padtype</cite> and <cite>padlen</cite>, and <cite>irlen</cite>
is ignored.  When <cite>method</cite> is “gust”, Gustafsson’s method is used,
and <cite>padtype</cite> and <cite>padlen</cite> are ignored.</p>
</dd>
<dt><strong>irlen</strong><span class="classifier">int or None, optional</span></dt><dd><p>When <cite>method</cite> is “gust”, <cite>irlen</cite> specifies the length of the
impulse response of the filter.  If <cite>irlen</cite> is None, no part
of the impulse response is ignored.  For a long signal, specifying
<cite>irlen</cite> can significantly improve the performance of the filter.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y</strong><span class="classifier">ndarray</span></dt><dd><p>The filtered output with the same shape as <cite>x</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">sosfiltfilt</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">lfilter_zi</span></code>, <a class="reference internal" href="#vtools.functions.filter.lfilter" title="vtools.functions.filter.lfilter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lfilter</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">lfiltic</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">savgol_filter</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">sosfilt</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>When <cite>method</cite> is “pad”, the function pads the data along the given axis
in one of three ways: odd, even or constant.  The odd and even extensions
have the corresponding symmetry about the end point of the data.  The
constant extension extends the data with the values at the end points. On
both the forward and backward passes, the initial condition of the
filter is found by using <cite>lfilter_zi</cite> and scaling it by the end point of
the extended data.</p>
<p>When <cite>method</cite> is “gust”, Gustafsson’s method <a class="reference internal" href="#rf9ecd08cd80f-1" id="id9">[1]</a> is used.  Initial
conditions are chosen for the forward and backward passes so that the
forward-backward filter gives the same result as the backward-forward
filter.</p>
<p>The option to use Gustaffson’s method was added in scipy version 0.16.0.</p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="rf9ecd08cd80f-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">1</a><span class="fn-bracket">]</span></span>
<p>F. Gustaffson, “Determining the initial states in forward-backward
filtering”, Transactions on Signal Processing, Vol. 46, pp. 988-992,
1996.</p>
</div>
</div>
<p class="rubric">Examples</p>
<p>The examples will use several functions from <cite>scipy.signal</cite>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>First we create a one second signal that is the sum of two pure sine
waves, with frequencies 5 Hz and 250 Hz, sampled at 2000 Hz.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">2001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xlow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xhigh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">250</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">xlow</span> <span class="o">+</span> <span class="n">xhigh</span>
</pre></div>
</div>
<p>Now create a lowpass Butterworth filter with a cutoff of 0.125 times
the Nyquist frequency, or 125 Hz, and apply it to <code class="docutils literal notranslate"><span class="pre">x</span></code> with <cite>filtfilt</cite>.
The result should be approximately <code class="docutils literal notranslate"><span class="pre">xlow</span></code>, with no phase shift.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">padlen</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">xlow</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="go">9.1086182074789912e-06</span>
</pre></div>
</div>
<p>We get a fairly clean result for this artificial example because
the odd extension is exact, and with the moderately long padding,
the filter’s transients have dissipated by the time the actual data
is reached.  In general, transient effects at the edges are
unavoidable.</p>
<p>The following example demonstrates the option <code class="docutils literal notranslate"><span class="pre">method=&quot;gust&quot;</span></code>.</p>
<p>First, create a filter.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellip</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">)</span>  <span class="c1"># Filter to be applied.</span>
</pre></div>
</div>
<p><cite>sig</cite> is a random input signal to be filtered.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">60</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sig</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
</pre></div>
</div>
<p>Apply <cite>filtfilt</cite> to <cite>sig</cite>, once using the Gustafsson method, and
once using padding, and plot the results for comparison.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fgust</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;gust&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fpad</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">padlen</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fgust</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;gust&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpad</span><span class="p">,</span> <span class="s1">&#39;c-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pad&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The <cite>irlen</cite> argument can be used to improve the performance
of Gustafsson’s method.</p>
<p>Estimate the impulse response length of the filter.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">tf2zpk</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">approx_impulse_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">r</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">approx_impulse_len</span>
<span class="go">137</span>
</pre></div>
</div>
<p>Apply the filter to a longer signal, with and without the <cite>irlen</cite>
argument.  The difference between <cite>y1</cite> and <cite>y2</cite> is small.  For long
signals, using <cite>irlen</cite> gives a significant performance improvement.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">4000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y1</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;gust&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y2</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;gust&#39;</span><span class="p">,</span> <span class="n">irlen</span><span class="o">=</span><span class="n">approx_impulse_len</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span><span class="p">)))</span>
<span class="go">2.875334415008979e-10</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.firwin">
<span class="sig-name descname"><span class="pre">firwin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">numtaps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window='hamming'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pass_zero=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nyq=&lt;object</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/_fir_filter_design.html#firwin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.firwin" title="Link to this definition">¶</a></dt>
<dd><p>FIR filter design using the window method.</p>
<p>This function computes the coefficients of a finite impulse response
filter. The filter will have linear phase; it will be Type I if
<cite>numtaps</cite> is odd and Type II if <cite>numtaps</cite> is even.</p>
<p>Type II filters always have zero response at the Nyquist frequency, so a
ValueError exception is raised if firwin is called with <cite>numtaps</cite> even and
having a passband whose right end is at the Nyquist frequency.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>numtaps</strong><span class="classifier">int</span></dt><dd><p>Length of the filter (number of coefficients, i.e. the filter
order + 1).  <cite>numtaps</cite> must be odd if a passband includes the
Nyquist frequency.</p>
</dd>
<dt><strong>cutoff</strong><span class="classifier">float or 1-D array_like</span></dt><dd><p>Cutoff frequency of filter (expressed in the same units as <cite>fs</cite>)
OR an array of cutoff frequencies (that is, band edges). In the
latter case, the frequencies in <cite>cutoff</cite> should be positive and
monotonically increasing between 0 and <cite>fs/2</cite>. The values 0 and
<cite>fs/2</cite> must not be included in <cite>cutoff</cite>.</p>
</dd>
<dt><strong>width</strong><span class="classifier">float or None, optional</span></dt><dd><p>If <cite>width</cite> is not None, then assume it is the approximate width
of the transition region (expressed in the same units as <cite>fs</cite>)
for use in Kaiser FIR filter design. In this case, the <cite>window</cite>
argument is ignored.</p>
</dd>
<dt><strong>window</strong><span class="classifier">string or tuple of string and parameter values, optional</span></dt><dd><p>Desired window to use. See <cite>scipy.signal.get_window</cite> for a list
of windows and required parameters.</p>
</dd>
<dt><strong>pass_zero</strong><span class="classifier">{True, False, ‘bandpass’, ‘lowpass’, ‘highpass’, ‘bandstop’}, optional</span></dt><dd><p>If True, the gain at the frequency 0 (i.e., the “DC gain”) is 1.
If False, the DC gain is 0. Can also be a string argument for the
desired filter type (equivalent to <code class="docutils literal notranslate"><span class="pre">btype</span></code> in IIR design functions).</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.3.0: </span>Support for string arguments.</p>
</div>
</dd>
<dt><strong>scale</strong><span class="classifier">bool, optional</span></dt><dd><p>Set to True to scale the coefficients so that the frequency
response is exactly unity at a certain frequency.
That frequency is either:</p>
<ul class="simple">
<li><p>0 (DC) if the first passband starts at 0 (i.e. pass_zero
is True)</p></li>
<li><p><cite>fs/2</cite> (the Nyquist frequency) if the first passband ends at
<cite>fs/2</cite> (i.e the filter is a single band highpass filter);
center of first passband otherwise</p></li>
</ul>
</dd>
<dt><strong>nyq</strong><span class="classifier">float, optional, deprecated</span></dt><dd><p>This is the Nyquist frequency. Each frequency in <cite>cutoff</cite> must be
between 0 and <cite>nyq</cite>. Default is 1.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.0.0: </span><cite>firwin</cite> keyword argument <cite>nyq</cite> is deprecated in favour of <cite>fs</cite> and
will be removed in SciPy 1.14.0.</p>
</div>
</dd>
<dt><strong>fs</strong><span class="classifier">float, optional</span></dt><dd><p>The sampling frequency of the signal. Each frequency in <cite>cutoff</cite>
must be between 0 and <code class="docutils literal notranslate"><span class="pre">fs/2</span></code>.  Default is 2.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>h</strong><span class="classifier">(numtaps,) ndarray</span></dt><dd><p>Coefficients of length <cite>numtaps</cite> FIR filter.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If any value in <cite>cutoff</cite> is less than or equal to 0 or greater
than or equal to <code class="docutils literal notranslate"><span class="pre">fs/2</span></code>, if the values in <cite>cutoff</cite> are not strictly
monotonically increasing, or if <cite>numtaps</cite> is even but a passband
includes the Nyquist frequency.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">firwin2</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">firls</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">minimum_phase</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">remez</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Low-pass from 0 to f:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numtaps</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="go">array([ 0.06799017,  0.86401967,  0.06799017])</span>
</pre></div>
</div>
<p>Use a specific window function:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;nuttall&#39;</span><span class="p">)</span>
<span class="go">array([  3.56607041e-04,   9.99286786e-01,   3.56607041e-04])</span>
</pre></div>
</div>
<p>High-pass (‘stop’ from 0 to f):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">pass_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">array([-0.00859313,  0.98281375, -0.00859313])</span>
</pre></div>
</div>
<p>Band-pass:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="p">[</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">],</span> <span class="n">pass_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">array([ 0.06301614,  0.88770441,  0.06301614])</span>
</pre></div>
</div>
<p>Band-stop:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="p">[</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">])</span>
<span class="go">array([-0.00801395,  1.0160279 , -0.00801395])</span>
</pre></div>
</div>
<p>Multi-band (passbands are [0, f1], [f2, f3] and [f4, 1]):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f3</span><span class="p">,</span> <span class="n">f4</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="p">[</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">,</span> <span class="n">f4</span><span class="p">])</span>
<span class="go">array([-0.01376344,  1.02752689, -0.01376344])</span>
</pre></div>
</div>
<p>Multi-band (passbands are [f1, f2] and [f3,f4]):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="n">numtaps</span><span class="p">,</span> <span class="p">[</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">,</span> <span class="n">f4</span><span class="p">],</span> <span class="n">pass_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">array([ 0.04890915,  0.91284326,  0.04890915])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.gaussian_filter1d">
<span class="sig-name descname"><span class="pre">gaussian_filter1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/ndimage/_filters.html#gaussian_filter1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.gaussian_filter1d" title="Link to this definition">¶</a></dt>
<dd><p>1-D Gaussian filter.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>input</strong><span class="classifier">array_like</span></dt><dd><p>The input array.</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">scalar</span></dt><dd><p>standard deviation for Gaussian kernel</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>The axis of <cite>input</cite> along which to calculate. Default is -1.</p>
</dd>
<dt><strong>order</strong><span class="classifier">int, optional</span></dt><dd><p>An order of 0 corresponds to convolution with a Gaussian
kernel. A positive order corresponds to convolution with
that derivative of a Gaussian.</p>
</dd>
<dt><strong>output</strong><span class="classifier">array or dtype, optional</span></dt><dd><p>The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p>
</dd>
<dt><strong>mode</strong><span class="classifier">{‘reflect’, ‘constant’, ‘nearest’, ‘mirror’, ‘wrap’}, optional</span></dt><dd><p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘reflect’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>‘reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel. This mode is also sometimes referred to as half-sample
symmetric.</p>
</dd>
<dt>‘constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>‘nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>‘mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel. This mode is also sometimes referred to as whole-sample
symmetric.</p>
</dd>
<dt>‘wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
<p>For consistency with the interpolation functions, the following mode
names can also be used:</p>
<dl class="simple">
<dt>‘grid-mirror’</dt><dd><p>This is a synonym for ‘reflect’.</p>
</dd>
<dt>‘grid-constant’</dt><dd><p>This is a synonym for ‘constant’.</p>
</dd>
<dt>‘grid-wrap’</dt><dd><p>This is a synonym for ‘wrap’.</p>
</dd>
</dl>
</dd>
<dt><strong>cval</strong><span class="classifier">scalar, optional</span></dt><dd><p>Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p>
</dd>
<dt><strong>truncate</strong><span class="classifier">float, optional</span></dt><dd><p>Truncate the filter at this many standard deviations.
Default is 4.0.</p>
</dd>
<dt><strong>radius</strong><span class="classifier">None or int, optional</span></dt><dd><p>Radius of the Gaussian kernel. If specified, the size of
the kernel will be <code class="docutils literal notranslate"><span class="pre">2*radius</span> <span class="pre">+</span> <span class="pre">1</span></code>, and <cite>truncate</cite> is ignored.
Default is None.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>gaussian_filter1d</strong><span class="classifier">ndarray</span></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The Gaussian kernel will have size <code class="docutils literal notranslate"><span class="pre">2*radius</span> <span class="pre">+</span> <span class="pre">1</span></code> along each axis. If
<cite>radius</cite> is None, a default <code class="docutils literal notranslate"><span class="pre">radius</span> <span class="pre">=</span> <span class="pre">round(truncate</span> <span class="pre">*</span> <span class="pre">sigma)</span></code> will be
used.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">gaussian_filter1d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussian_filter1d</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">array([ 1.42704095,  2.06782203,  3.        ,  3.93217797,  4.57295905])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussian_filter1d</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">array([ 2.91948343,  2.95023502,  3.        ,  3.04976498,  3.08051657])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y3</span> <span class="o">=</span> <span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y6</span> <span class="o">=</span> <span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original data&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y3</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;filtered, sigma=3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y6</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;filtered, sigma=6&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.generate_godin_fir">
<span class="sig-name descname"><span class="pre">generate_godin_fir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#generate_godin_fir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.generate_godin_fir" title="Link to this definition">¶</a></dt>
<dd><p>generate godin filter impulse response for given freq
freq is a pandas freq</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.godin">
<span class="sig-name descname"><span class="pre">godin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#godin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.godin" title="Link to this definition">¶</a></dt>
<dd><p>Low-pass Godin filter a regular time series.
Applies the <span class="math notranslate nohighlight">\(\mathcal{A_{24}^{2}A_{25}}\)</span> Godin filter <a class="reference internal" href="#r1d48320053b8-1" id="id11">[1]</a>
The filter is generalized to be the equivalent of one
boxcar of the length of the lunar diurnal (~25 hours)
constituent and two of the solar diurnal (~24 hours), though the
implementation combines these steps.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>A new regular time series with the same interval of ts.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>NotImplementedError</dt><dd><p>If input time series is not univariate</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="r1d48320053b8-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id11">1</a><span class="fn-bracket">]</span></span>
<p>Godin (1972) Analysis of Tides</p>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.hours">
<span class="sig-name descname"><span class="pre">hours</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/data/vtime.html#hours"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.hours" title="Link to this definition">¶</a></dt>
<dd><p>Create a time interval representing h hours</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.lanczos">
<span class="sig-name descname"><span class="pre">lanczos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#lanczos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.lanczos" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.lfilter">
<span class="sig-name descname"><span class="pre">lfilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/_signaltools.html#lfilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.lfilter" title="Link to this definition">¶</a></dt>
<dd><p>Filter data along one-dimension with an IIR or FIR filter.</p>
<p>Filter a data sequence, <cite>x</cite>, using a digital filter.  This works for many
fundamental data types (including Object type).  The filter is a direct
form II transposed implementation of the standard difference equation
(see Notes).</p>
<p>The function <cite>sosfilt</cite> (and filter design using <code class="docutils literal notranslate"><span class="pre">output='sos'</span></code>) should be
preferred over <cite>lfilter</cite> for most filtering tasks, as second-order sections
have fewer numerical problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>b</strong><span class="classifier">array_like</span></dt><dd><p>The numerator coefficient vector in a 1-D sequence.</p>
</dd>
<dt><strong>a</strong><span class="classifier">array_like</span></dt><dd><p>The denominator coefficient vector in a 1-D sequence.  If <code class="docutils literal notranslate"><span class="pre">a[0]</span></code>
is not 1, then both <cite>a</cite> and <cite>b</cite> are normalized by <code class="docutils literal notranslate"><span class="pre">a[0]</span></code>.</p>
</dd>
<dt><strong>x</strong><span class="classifier">array_like</span></dt><dd><p>An N-dimensional input array.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>The axis of the input data array along which to apply the
linear filter. The filter is applied to each subarray along
this axis.  Default is -1.</p>
</dd>
<dt><strong>zi</strong><span class="classifier">array_like, optional</span></dt><dd><p>Initial conditions for the filter delays.  It is a vector
(or array of vectors for an N-dimensional input) of length
<code class="docutils literal notranslate"><span class="pre">max(len(a),</span> <span class="pre">len(b))</span> <span class="pre">-</span> <span class="pre">1</span></code>.  If <cite>zi</cite> is None or is not given then
initial rest is assumed.  See <cite>lfiltic</cite> for more information.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y</strong><span class="classifier">array</span></dt><dd><p>The output of the digital filter.</p>
</dd>
<dt><strong>zf</strong><span class="classifier">array, optional</span></dt><dd><p>If <cite>zi</cite> is None, this is not returned, otherwise, <cite>zf</cite> holds the
final filter delay values.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">lfiltic</span></code></dt><dd><p>Construct initial conditions for <cite>lfilter</cite>.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">lfilter_zi</span></code></dt><dd><p>Compute initial state (steady state of step response) for <cite>lfilter</cite>.</p>
</dd>
<dt><a class="reference internal" href="#vtools.functions.filter.filtfilt" title="vtools.functions.filter.filtfilt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filtfilt</span></code></a></dt><dd><p>A forward-backward filter, to obtain a filter with zero phase.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">savgol_filter</span></code></dt><dd><p>A Savitzky-Golay filter.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">sosfilt</span></code></dt><dd><p>Filter data using cascaded second-order sections.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">sosfiltfilt</span></code></dt><dd><p>A forward-backward filter using second-order sections.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The filter function is implemented as a direct II transposed structure.
This means that the filter implements:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">M</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">M</span><span class="p">]</span>
                      <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="o">...</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">N</span><span class="p">]</span>
</pre></div>
</div>
<p>where <cite>M</cite> is the degree of the numerator, <cite>N</cite> is the degree of the
denominator, and <cite>n</cite> is the sample number.  It is implemented using
the following difference equations (assuming M = N):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>               <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="o">...</span>
<span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
</pre></div>
</div>
<p>where <cite>d</cite> are the state variables.</p>
<p>The rational transfer function describing this filter in the
z-transform domain is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                    <span class="o">-</span><span class="mi">1</span>              <span class="o">-</span><span class="n">M</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">z</span>  <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">M</span><span class="p">]</span> <span class="n">z</span>
<span class="n">Y</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="o">--------------------------------</span> <span class="n">X</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                    <span class="o">-</span><span class="mi">1</span>              <span class="o">-</span><span class="n">N</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">z</span>  <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="n">z</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<p>Generate a noisy signal to be filtered:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">0.75</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.1</span><span class="p">)</span> <span class="o">+</span>
<span class="gp">... </span>     <span class="mf">0.1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1.25</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
<span class="gp">... </span>     <span class="mf">0.18</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">3.85</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xn</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.08</span>
</pre></div>
</div>
<p>Create an order 3 lowpass butterworth filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
<p>Apply the filter to xn.  Use lfilter_zi to choose the initial condition of
the filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">zi</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">lfilter_zi</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">xn</span><span class="p">,</span> <span class="n">zi</span><span class="o">=</span><span class="n">zi</span><span class="o">*</span><span class="n">xn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Apply the filter again, to have a result filtered at an order the same as
filtfilt:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">zi</span><span class="o">=</span><span class="n">zi</span><span class="o">*</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>Use filtfilt to apply the filter:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">xn</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the original signal and the various filtered versions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">xn</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;noisy signal&#39;</span><span class="p">,</span> <span class="s1">&#39;lfilter, once&#39;</span><span class="p">,</span> <span class="s1">&#39;lfilter, twice&#39;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s1">&#39;filtfilt&#39;</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.lowpass_cosine_lanczos_filter_coef">
<span class="sig-name descname"><span class="pre">lowpass_cosine_lanczos_filter_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#lowpass_cosine_lanczos_filter_coef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.lowpass_cosine_lanczos_filter_coef" title="Link to this definition">¶</a></dt>
<dd><p>return the convolution coefficients for low pass lanczos filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cf: float</strong></dt><dd><p>Cutoff frequency expressed as a ratio of a Nyquist frequency.</p>
</dd>
<dt><strong>m: int</strong></dt><dd><p>Size of filtering window size.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>results: list</dt><dd><p>Coefficients of filtering window.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.lowpass_lanczos_filter_coef">
<span class="sig-name descname"><span class="pre">lowpass_lanczos_filter_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosine_taper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#lowpass_lanczos_filter_coef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.lowpass_lanczos_filter_coef" title="Link to this definition">¶</a></dt>
<dd><p>Return the convolution coefficients for a low-pass Lanczos filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cf</strong><span class="classifier">float</span></dt><dd><p>Cutoff frequency expressed as a ratio of the Nyquist frequency.</p>
</dd>
<dt><strong>m</strong><span class="classifier">int</span></dt><dd><p>Size of the filtering window.</p>
</dd>
<dt><strong>normalize</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to normalize the filter coefficients so they sum to 1.</p>
</dd>
<dt><strong>cosine_taper</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, applies a cosine-squared taper to the Lanczos window.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>res</strong><span class="classifier">np.ndarray</span></dt><dd><p>Coefficients of the filtering window.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.minutes">
<span class="sig-name descname"><span class="pre">minutes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/data/vtime.html#minutes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.minutes" title="Link to this definition">¶</a></dt>
<dd><p>Create a time interval representing m minutes</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.process_cutoff">
<span class="sig-name descname"><span class="pre">process_cutoff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#process_cutoff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.process_cutoff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.seconds">
<span class="sig-name descname"><span class="pre">seconds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/data/vtime.html#seconds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.seconds" title="Link to this definition">¶</a></dt>
<dd><p>Create a time interval representing s seconds</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.filter.ts_gaussian_filter">
<span class="sig-name descname"><span class="pre">ts_gaussian_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#ts_gaussian_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.filter.ts_gaussian_filter" title="Link to this definition">¶</a></dt>
<dd><p>Column-wise Gaussian smoothing of regular time series.
Missing/irregular values are not handled, which means this function is not much different from
a rolling window gaussian average in pandas which may be preferable in the case of
missing data (ts.rolling(window=5,win_type=’gaussian’).mean.
This function has been kept around awaiting irreg as an aspiration but yet to be implemented.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>The series to be smoothed</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">int or freq</span></dt><dd><p>The sigma scale of the smoothing (analogous to std. deviation), given as a number of steps
or freq</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>A new regular time series with the same interval of ts.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vtools.functions.frequency_response">
<span id="vtools-functions-frequency-response-module"></span><h2>vtools.functions.frequency_response module<a class="headerlink" href="#module-vtools.functions.frequency_response" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.butterworth">
<span class="sig-name descname"><span class="pre">butterworth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#butterworth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.butterworth" title="Link to this definition">¶</a></dt>
<dd><p>low-pass butterworth-squared filter on a regular time series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>Must be one or two dimensional, and regular.</p>
</dd>
<dt><strong>order: int ,optional</strong></dt><dd><p>The default is 4.</p>
</dd>
<dt><strong>cutoff_frequency: float,optional</strong></dt><dd><p>Cutoff frequency expressed as a ratio with Nyquist frequency,
should within the range (0,1). For a discretely sampled system,
the Nyquist frequency is the fastest frequency that can be resolved by that
sampling, which is half the sampling frequency. For example, if the sampling frequency
is 1 sample/1 hour, the Nyquist frequency is 1 sample/2 hours. If we want a
36 hour cutoff period, the frequency is 1/36 or 0.0278 cycles per hour.
Hence the cutoff frequency argument used here would be
0.0278/0.5 = 0.056.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">string  or  _time_interval</span></dt><dd><p>Period corresponding to cutoff frequency. If input as a string, it must
be  convertible to a regular interval using the same rules as a pandas frequency..
cutoff_frequency and cutoff_period can’t be specified at the same time.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>result</dt><dd><p>A new regular time series with the same interval as ts.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If input order is not even, or input timeseries is not regular,
or neither cutoff_period and cutoff_frequency is given while input
time series interval is not 15min or 1 hour, or  cutoff_period and cutoff_frequency
are given at the same time.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.compare_response">
<span class="sig-name descname"><span class="pre">compare_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/frequency_response.html#compare_response"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.compare_response" title="Link to this definition">¶</a></dt>
<dd><p>Generate frequency response plot of low-pass filters: cosine_lanczos, boxcar 24h, boxcar 25h, and godin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cutoff_period</strong><span class="classifier">int</span></dt><dd><p>Low-pass filter cutoff period in number of hours.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.cosine_lanczos">
<span class="sig-name descname"><span class="pre">cosine_lanczos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#cosine_lanczos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.cosine_lanczos" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.cosine_lanczos5">
<span class="sig-name descname"><span class="pre">cosine_lanczos5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#cosine_lanczos5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.cosine_lanczos5" title="Link to this definition">¶</a></dt>
<dd><p>squared low-pass cosine lanczos  filter on a regular time series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd></dd>
<dt><strong>filter_len</strong><span class="classifier">int, time_interval</span></dt><dd><p>Size of lanczos window, default is to number of samples within filter_period*1.25.</p>
</dd>
<dt><strong>cutoff_frequency: float,optional</strong></dt><dd><p>Cutoff frequency expressed as a ratio of a Nyquist frequency,
should within the range (0,1). For example, if the sampling frequency
is 1 hour, the Nyquist frequency is 1 sample/2 hours. If we want a
36 hour cutoff period, the frequency is 1/36 or 0.0278 cycles per hour.
Hence the cutoff frequency argument used here would be
0.0278/0.5 = 0.056.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">string  or  _time_interval</span></dt><dd><blockquote>
<div><p>Period of cutting off frequency. If input as a string, it must
be  convertible to a _time_interval (Pandas freq).
cutoff_frequency and cutoff_period can’t be specified at the same time.</p>
</div></blockquote>
<dl class="simple">
<dt>padtype<span class="classifier">str or None, optional</span></dt><dd><p>Must be ‘odd’, ‘even’, ‘constant’, or None. This determines the type
of extension to use for the padded signal to which the filter is applied.
If padtype is None, no padding is used. The default is None.</p>
</dd>
<dt>padlen<span class="classifier">int or None, optional</span></dt><dd><p>The number of elements by which to extend x at both ends of axis
before applying the filter. This value must be less than x.shape[axis]-1.
padlen=0 implies no padding. If padtye is not None and padlen is not
given, padlen is be set to 6*m.</p>
</dd>
<dt>fill_edge_nan: bool,optional</dt><dd><p>If pading is not used and fill_edge_nan is true, resulting data on
the both ends are filled with nan to account for edge effect. This is
2*m on the either end of the result. Default is true.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></span></dt><dd><p>A new regular time series with the same interval of ts. If no pading
is used the beigning and ending 4*m resulting data will be set to nan
to remove edge effect.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If input timeseries is not regular,
or, cutoff_period and cutoff_frequency are given at the same time,
or, neither cutoff_period nor curoff_frequence is given,
or, padtype is not “odd”,”even”,”constant”,or None,
or, padlen is larger than data size</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.freqz">
<span class="sig-name descname"><span class="pre">freqz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whole</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.283185307179586</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_nyquist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/_filter_design.html#freqz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.freqz" title="Link to this definition">¶</a></dt>
<dd><p>Compute the frequency response of a digital filter.</p>
<p>Given the M-order numerator <cite>b</cite> and N-order denominator <cite>a</cite> of a digital
filter, compute its frequency response:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>            <span class="n">jw</span>                 <span class="o">-</span><span class="n">jw</span>              <span class="o">-</span><span class="n">jwM</span>
   <span class="n">jw</span>    <span class="n">B</span><span class="p">(</span><span class="n">e</span>  <span class="p">)</span>    <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">e</span>    <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">M</span><span class="p">]</span><span class="n">e</span>
<span class="n">H</span><span class="p">(</span><span class="n">e</span>  <span class="p">)</span> <span class="o">=</span> <span class="o">------</span> <span class="o">=</span> <span class="o">-----------------------------------</span>
            <span class="n">jw</span>                 <span class="o">-</span><span class="n">jw</span>              <span class="o">-</span><span class="n">jwN</span>
         <span class="n">A</span><span class="p">(</span><span class="n">e</span>  <span class="p">)</span>    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="n">e</span>    <span class="o">+</span> <span class="o">...</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">]</span><span class="n">e</span>
</pre></div>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>b</strong><span class="classifier">array_like</span></dt><dd><p>Numerator of a linear filter. If <cite>b</cite> has dimension greater than 1,
it is assumed that the coefficients are stored in the first dimension,
and <code class="docutils literal notranslate"><span class="pre">b.shape[1:]</span></code>, <code class="docutils literal notranslate"><span class="pre">a.shape[1:]</span></code>, and the shape of the frequencies
array must be compatible for broadcasting.</p>
</dd>
<dt><strong>a</strong><span class="classifier">array_like</span></dt><dd><p>Denominator of a linear filter. If <cite>b</cite> has dimension greater than 1,
it is assumed that the coefficients are stored in the first dimension,
and <code class="docutils literal notranslate"><span class="pre">b.shape[1:]</span></code>, <code class="docutils literal notranslate"><span class="pre">a.shape[1:]</span></code>, and the shape of the frequencies
array must be compatible for broadcasting.</p>
</dd>
<dt><strong>worN</strong><span class="classifier">{None, int, array_like}, optional</span></dt><dd><p>If a single integer, then compute at that many frequencies (default is
N=512). This is a convenient alternative to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span> <span class="k">if</span> <span class="n">whole</span> <span class="k">else</span> <span class="n">fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="n">include_nyquist</span><span class="p">)</span>
</pre></div>
</div>
<p>Using a number that is fast for FFT computations can result in
faster computations (see Notes).</p>
<p>If an array_like, compute the response at the frequencies given.
These are in the same units as <cite>fs</cite>.</p>
</dd>
<dt><strong>whole</strong><span class="classifier">bool, optional</span></dt><dd><p>Normally, frequencies are computed from 0 to the Nyquist frequency,
fs/2 (upper-half of unit-circle). If <cite>whole</cite> is True, compute
frequencies from 0 to fs. Ignored if worN is array_like.</p>
</dd>
<dt><strong>plot</strong><span class="classifier">callable</span></dt><dd><p>A callable that takes two arguments. If given, the return parameters
<cite>w</cite> and <cite>h</cite> are passed to plot. Useful for plotting the frequency
response inside <cite>freqz</cite>.</p>
</dd>
<dt><strong>fs</strong><span class="classifier">float, optional</span></dt><dd><p>The sampling frequency of the digital system. Defaults to 2*pi
radians/sample (so w is from 0 to pi).</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.2.0.</span></p>
</div>
</dd>
<dt><strong>include_nyquist</strong><span class="classifier">bool, optional</span></dt><dd><p>If <cite>whole</cite> is False and <cite>worN</cite> is an integer, setting <cite>include_nyquist</cite>
to True will include the last frequency (Nyquist frequency) and is
otherwise ignored.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.5.0.</span></p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>w</strong><span class="classifier">ndarray</span></dt><dd><p>The frequencies at which <cite>h</cite> was computed, in the same units as <cite>fs</cite>.
By default, <cite>w</cite> is normalized to the range [0, pi) (radians/sample).</p>
</dd>
<dt><strong>h</strong><span class="classifier">ndarray</span></dt><dd><p>The frequency response, as complex numbers.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">freqz_zpk</span></code></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">sosfreqz</span></code></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Using Matplotlib’s <code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.plot()</span></code> function as the callable
for <cite>plot</cite> produces unexpected results, as this plots the real part of the
complex transfer function, not the magnitude.
Try <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">w,</span> <span class="pre">h:</span> <span class="pre">plot(w,</span> <span class="pre">np.abs(h))</span></code>.</p>
<p>A direct computation via (R)FFT is used to compute the frequency response
when the following conditions are met:</p>
<ol class="arabic simple">
<li><p>An integer value is given for <cite>worN</cite>.</p></li>
<li><p><cite>worN</cite> is fast to compute via FFT (i.e.,
<cite>next_fast_len(worN) &lt;scipy.fft.next_fast_len&gt;</cite> equals <cite>worN</cite>).</p></li>
<li><p>The denominator coefficients are a single value (<code class="docutils literal notranslate"><span class="pre">a.shape[0]</span> <span class="pre">==</span> <span class="pre">1</span></code>).</p></li>
<li><p><cite>worN</cite> is at least as long as the numerator coefficients
(<code class="docutils literal notranslate"><span class="pre">worN</span> <span class="pre">&gt;=</span> <span class="pre">b.shape[0]</span></code>).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">b.ndim</span> <span class="pre">&gt;</span> <span class="pre">1</span></code>, then <code class="docutils literal notranslate"><span class="pre">b.shape[-1]</span> <span class="pre">==</span> <span class="pre">1</span></code>.</p></li>
</ol>
<p>For long FIR filters, the FFT approach can have lower error and be much
faster than the equivalent direct polynomial calculation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">firwin</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;kaiser&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Digital filter frequency response&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude [dB]&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [rad/sample]&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">angles</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Angle (radians)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Broadcasting Examples</p>
<p>Suppose we have two FIR filters whose coefficients are stored in the
rows of an array with shape (2, 25). For this demonstration, we’ll
use random data:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
</pre></div>
</div>
<p>To compute the frequency response for these two filters with one call
to <cite>freqz</cite>, we must pass in <code class="docutils literal notranslate"><span class="pre">b.T</span></code>, because <cite>freqz</cite> expects the first
axis to hold the coefficients. We must then extend the shape with a
trivial dimension of length 1 to allow broadcasting with the array
of frequencies.  That is, we pass in <code class="docutils literal notranslate"><span class="pre">b.T[...,</span> <span class="pre">np.newaxis]</span></code>, which has
shape (25, 2, 1):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">worN</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1024,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 1024)</span>
</pre></div>
</div>
<p>Now, suppose we have two transfer functions, with the same numerator
coefficients <code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">=</span> <span class="pre">[0.5,</span> <span class="pre">0.5]</span></code>. The coefficients for the two denominators
are stored in the first dimension of the 2-D array  <cite>a</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span>   <span class="mi">1</span>      <span class="mi">1</span>  <span class="p">]</span>
    <span class="p">[</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span> <span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]])</span>
</pre></div>
</div>
<p>Only <cite>a</cite> is more than 1-D. To make it compatible for
broadcasting with the frequencies, we extend it with a trivial dimension
in the call to <cite>freqz</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">worN</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1024,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 1024)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.godin">
<span class="sig-name descname"><span class="pre">godin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#godin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.godin" title="Link to this definition">¶</a></dt>
<dd><p>Low-pass Godin filter a regular time series.
Applies the <span class="math notranslate nohighlight">\(\mathcal{A_{24}^{2}A_{25}}\)</span> Godin filter <a class="reference internal" href="#ra2b1b86d9761-1" id="id13">[1]</a>
The filter is generalized to be the equivalent of one
boxcar of the length of the lunar diurnal (~25 hours)
constituent and two of the solar diurnal (~24 hours), though the
implementation combines these steps.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>A new regular time series with the same interval of ts.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>NotImplementedError</dt><dd><p>If input time series is not univariate</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="ra2b1b86d9761-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id13">1</a><span class="fn-bracket">]</span></span>
<p>Godin (1972) Analysis of Tides</p>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.inset_axes">
<span class="sig-name descname"><span class="pre">inset_axes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'upper</span> <span class="pre">right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_to_anchor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borderpad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mpl_toolkits/axes_grid1/inset_locator.html#inset_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.inset_axes" title="Link to this definition">¶</a></dt>
<dd><p>Create an inset axes with a given width and height.</p>
<p>Both sizes used can be specified either in inches or percentage.
For example,:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inset_axes</span><span class="p">(</span><span class="n">parent_axes</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s1">&#39;40%&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;30%&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>creates in inset axes in the lower left corner of <em>parent_axes</em> which spans
over 30% in height and 40% in width of the <em>parent_axes</em>. Since the usage
of <cite>.inset_axes</cite> may become slightly tricky when exceeding such standard
cases, it is recommended to read <span class="xref std std-doc">the examples</span>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>parent_axes</strong><span class="classifier"><cite>matplotlib.axes.Axes</cite></span></dt><dd><p>Axes to place the inset axes.</p>
</dd>
<dt><strong>width, height</strong><span class="classifier">float or str</span></dt><dd><p>Size of the inset axes to create. If a float is provided, it is
the size in inches, e.g. <em>width=1.3</em>. If a string is provided, it is
the size in relative units, e.g. <em>width=’40%’</em>. By default, i.e. if
neither <em>bbox_to_anchor</em> nor <em>bbox_transform</em> are specified, those
are relative to the parent_axes. Otherwise, they are to be understood
relative to the bounding box provided via <em>bbox_to_anchor</em>.</p>
</dd>
<dt><strong>loc</strong><span class="classifier">str, default: ‘upper right’</span></dt><dd><p>Location to place the inset axes.  Valid locations are
‘upper left’, ‘upper center’, ‘upper right’,
‘center left’, ‘center’, ‘center right’,
‘lower left’, ‘lower center’, ‘lower right’.
For backward compatibility, numeric values are accepted as well.
See the parameter <em>loc</em> of <cite>.Legend</cite> for details.</p>
</dd>
<dt><strong>bbox_to_anchor</strong><span class="classifier">tuple or <cite>~matplotlib.transforms.BboxBase</cite>, optional</span></dt><dd><p>Bbox that the inset axes will be anchored to. If None,
a tuple of (0, 0, 1, 1) is used if <em>bbox_transform</em> is set
to <em>parent_axes.transAxes</em> or <em>parent_axes.figure.transFigure</em>.
Otherwise, <em>parent_axes.bbox</em> is used. If a tuple, can be either
[left, bottom, width, height], or [left, bottom].
If the kwargs <em>width</em> and/or <em>height</em> are specified in relative units,
the 2-tuple [left, bottom] cannot be used. Note that,
unless <em>bbox_transform</em> is set, the units of the bounding box
are interpreted in the pixel coordinate. When using <em>bbox_to_anchor</em>
with tuple, it almost always makes sense to also specify
a <em>bbox_transform</em>. This might often be the axes transform
<em>parent_axes.transAxes</em>.</p>
</dd>
<dt><strong>bbox_transform</strong><span class="classifier"><cite>~matplotlib.transforms.Transform</cite>, optional</span></dt><dd><p>Transformation for the bbox that contains the inset axes.
If None, a <cite>.transforms.IdentityTransform</cite> is used. The value
of <em>bbox_to_anchor</em> (or the return value of its get_points method)
is transformed by the <em>bbox_transform</em> and then interpreted
as points in the pixel coordinate (which is dpi dependent).
You may provide <em>bbox_to_anchor</em> in some normalized coordinate,
and give an appropriate transform (e.g., <em>parent_axes.transAxes</em>).</p>
</dd>
<dt><strong>axes_class</strong><span class="classifier"><cite>~matplotlib.axes.Axes</cite> type, default: <cite>.HostAxes</cite></span></dt><dd><p>The type of the newly created inset axes.</p>
</dd>
<dt><strong>axes_kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>Keyword arguments to pass to the constructor of the inset axes.
Valid arguments include:</p>
<p>Properties:
adjustable: {‘box’, ‘datalim’}
agg_filter: a filter function, which takes a (m, n, 3) float array and a dpi value, and returns a (m, n, 3) array and two offsets from the bottom left corner of the image
alpha: scalar or None
anchor: (float, float) or {‘C’, ‘SW’, ‘S’, ‘SE’, ‘E’, ‘NE’, …}
animated: bool
aspect: {‘auto’, ‘equal’} or float
autoscale_on: bool
autoscalex_on: unknown
autoscaley_on: unknown
axes_locator: Callable[[Axes, Renderer], Bbox]
axisbelow: bool or ‘line’
box_aspect: float or None
clip_box: <cite>~matplotlib.transforms.BboxBase</cite> or None
clip_on: bool
clip_path: Patch or (Path, Transform) or None
facecolor or fc: color
figure: <cite>~matplotlib.figure.Figure</cite>
frame_on: bool
gid: str
in_layout: bool
label: object
mouseover: bool
navigate: bool
navigate_mode: unknown
path_effects: list of <cite>.AbstractPathEffect</cite>
picker: None or bool or float or callable
position: [left, bottom, width, height] or <cite>~matplotlib.transforms.Bbox</cite>
prop_cycle: <cite>~cycler.Cycler</cite>
rasterization_zorder: float or None
rasterized: bool
sketch_params: (scale: float, length: float, randomness: float)
snap: bool or None
subplotspec: unknown
title: str
transform: <cite>~matplotlib.transforms.Transform</cite>
url: str
visible: bool
xbound: (lower: float, upper: float)
xlabel: str
xlim: (left: float, right: float)
xmargin: float greater than -0.5
xscale: unknown
xticklabels: unknown
xticks: unknown
ybound: (lower: float, upper: float)
ylabel: str
ylim: (bottom: float, top: float)
ymargin: float greater than -0.5
yscale: unknown
yticklabels: unknown
yticks: unknown
zorder: float</p>
</dd>
<dt><strong>borderpad</strong><span class="classifier">float, default: 0.5</span></dt><dd><p>Padding between inset axes and the bbox_to_anchor.
The units are axes font size, i.e. for a default font size of 10 points
<em>borderpad = 0.5</em> is equivalent to a padding of 5 points.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>inset_axes</strong><span class="classifier"><em>axes_class</em></span></dt><dd><p>Inset axes object created.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The meaning of <em>bbox_to_anchor</em> and <em>bbox_to_transform</em> is interpreted
differently from that of legend. The value of bbox_to_anchor
(or the return value of its get_points method; the default is
<em>parent_axes.bbox</em>) is transformed by the bbox_transform (the default
is Identity transform) and then interpreted as points in the pixel
coordinate (which is dpi dependent).</p>
<p>Thus, following three calls are identical and creates an inset axes
with respect to the <em>parent_axes</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">axins</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">parent_axes</span><span class="p">,</span> <span class="s2">&quot;30%&quot;</span><span class="p">,</span> <span class="s2">&quot;40%&quot;</span><span class="p">)</span>
<span class="n">axins</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">parent_axes</span><span class="p">,</span> <span class="s2">&quot;30%&quot;</span><span class="p">,</span> <span class="s2">&quot;40%&quot;</span><span class="p">,</span>
                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="n">parent_axes</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
<span class="n">axins</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">parent_axes</span><span class="p">,</span> <span class="s2">&quot;30%&quot;</span><span class="p">,</span> <span class="s2">&quot;40%&quot;</span><span class="p">,</span>
                   <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                   <span class="n">bbox_transform</span><span class="o">=</span><span class="n">parent_axes</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.lanczos">
<span class="sig-name descname"><span class="pre">lanczos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#lanczos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.lanczos" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.lowpass_cosine_lanczos_filter_coef">
<span class="sig-name descname"><span class="pre">lowpass_cosine_lanczos_filter_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#lowpass_cosine_lanczos_filter_coef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.lowpass_cosine_lanczos_filter_coef" title="Link to this definition">¶</a></dt>
<dd><p>return the convolution coefficients for low pass lanczos filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cf: float</strong></dt><dd><p>Cutoff frequency expressed as a ratio of a Nyquist frequency.</p>
</dd>
<dt><strong>m: int</strong></dt><dd><p>Size of filtering window size.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>results: list</dt><dd><p>Coefficients of filtering window.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.lowpass_lanczos_filter_coef">
<span class="sig-name descname"><span class="pre">lowpass_lanczos_filter_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosine_taper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#lowpass_lanczos_filter_coef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.lowpass_lanczos_filter_coef" title="Link to this definition">¶</a></dt>
<dd><p>Return the convolution coefficients for a low-pass Lanczos filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cf</strong><span class="classifier">float</span></dt><dd><p>Cutoff frequency expressed as a ratio of the Nyquist frequency.</p>
</dd>
<dt><strong>m</strong><span class="classifier">int</span></dt><dd><p>Size of the filtering window.</p>
</dd>
<dt><strong>normalize</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to normalize the filter coefficients so they sum to 1.</p>
</dd>
<dt><strong>cosine_taper</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, applies a cosine-squared taper to the Lanczos window.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>res</strong><span class="classifier">np.ndarray</span></dt><dd><p>Coefficients of the filtering window.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/frequency_response.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.mark_inset">
<span class="sig-name descname"><span class="pre">mark_inset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent_axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inset_axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mpl_toolkits/axes_grid1/inset_locator.html#mark_inset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.mark_inset" title="Link to this definition">¶</a></dt>
<dd><p>Draw a box to mark the location of an area represented by an inset axes.</p>
<p>This function draws a box in <em>parent_axes</em> at the bounding box of
<em>inset_axes</em>, and shows a connection with the inset axes by drawing lines
at the corners, giving a “zoomed in” effect.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>parent_axes</strong><span class="classifier"><cite>~matplotlib.axes.Axes</cite></span></dt><dd><p>Axes which contains the area of the inset axes.</p>
</dd>
<dt><strong>inset_axes</strong><span class="classifier"><cite>~matplotlib.axes.Axes</cite></span></dt><dd><p>The inset axes.</p>
</dd>
<dt><strong>loc1, loc2</strong><span class="classifier">{1, 2, 3, 4}</span></dt><dd><p>Corners to use for connecting the inset axes and the area in the
parent axes.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Patch properties for the lines and box drawn:</p>
<p>Properties:
agg_filter: a filter function, which takes a (m, n, 3) float array and a dpi value, and returns a (m, n, 3) array and two offsets from the bottom left corner of the image
alpha: unknown
animated: bool
antialiased or aa: bool or None
capstyle: <cite>.CapStyle</cite> or {‘butt’, ‘projecting’, ‘round’}
clip_box: <cite>~matplotlib.transforms.BboxBase</cite> or None
clip_on: bool
clip_path: Patch or (Path, Transform) or None
color: color
edgecolor or ec: color or None
facecolor or fc: color or None
figure: <cite>~matplotlib.figure.Figure</cite>
fill: bool
gid: str
hatch: {‘/’, ‘\’, ‘|’, ‘-’, ‘+’, ‘x’, ‘o’, ‘O’, ‘.’, ‘*’}
in_layout: bool
joinstyle: <cite>.JoinStyle</cite> or {‘miter’, ‘round’, ‘bevel’}
label: object
linestyle or ls: {‘-’, ‘–’, ‘-.’, ‘:’, ‘’, (offset, on-off-seq), …}
linewidth or lw: float or None
mouseover: bool
path_effects: list of <cite>.AbstractPathEffect</cite>
picker: None or bool or float or callable
rasterized: bool
sketch_params: (scale: float, length: float, randomness: float)
snap: bool or None
transform: <cite>~matplotlib.transforms.Transform</cite>
url: str
visible: bool
zorder: float</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>pp</strong><span class="classifier"><cite>~matplotlib.patches.Patch</cite></span></dt><dd><p>The patch drawn to represent the area of the inset axes.</p>
</dd>
<dt><strong>p1, p2</strong><span class="classifier"><cite>~matplotlib.patches.Patch</cite></span></dt><dd><p>The patches connecting two corners of the inset axes and its area.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.ts_gaussian_filter">
<span class="sig-name descname"><span class="pre">ts_gaussian_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflect'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#ts_gaussian_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.ts_gaussian_filter" title="Link to this definition">¶</a></dt>
<dd><p>Column-wise Gaussian smoothing of regular time series.
Missing/irregular values are not handled, which means this function is not much different from
a rolling window gaussian average in pandas which may be preferable in the case of
missing data (ts.rolling(window=5,win_type=’gaussian’).mean.
This function has been kept around awaiting irreg as an aspiration but yet to be implemented.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>The series to be smoothed</p>
</dd>
<dt><strong>sigma</strong><span class="classifier">int or freq</span></dt><dd><p>The sigma scale of the smoothing (analogous to std. deviation), given as a number of steps
or freq</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd><p>A new regular time series with the same interval of ts.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.frequency_response.unit_impulse_ts">
<span class="sig-name descname"><span class="pre">unit_impulse_ts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/frequency_response.html#unit_impulse_ts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.frequency_response.unit_impulse_ts" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>size</strong><span class="classifier">int</span></dt><dd><p>Length of impluse time series, odd number.</p>
</dd>
<dt><strong>interval</strong><span class="classifier">string</span></dt><dd><p>time series interval, such as “15min”</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.Dataframe</dt><dd><p>time series value 0.0 except 1 at the middle of time series.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vtools.functions.interannual">
<span id="vtools-functions-interannual-module"></span><h2>vtools.functions.interannual module<a class="headerlink" href="#module-vtools.functions.interannual" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interannual.interannual">
<span class="sig-name descname"><span class="pre">interannual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interannual.html#interannual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interannual.interannual" title="Link to this definition">¶</a></dt>
<dd><p>Pivots years of multiyear series to columns and convert index to elapsed time of year</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts</strong><span class="classifier">series  Univariate series</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>annual</strong><span class="classifier">DataFrame with year in the columns and elapsed time of year as index</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interannual.interannual_sample">
<span class="sig-name descname"><span class="pre">interannual_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interannual.html#interannual_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interannual.interannual_sample" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interannual.interannual_ticks_labels">
<span class="sig-name descname"><span class="pre">interannual_ticks_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interannual.html#interannual_ticks_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interannual.interannual_ticks_labels" title="Link to this definition">¶</a></dt>
<dd><p>Convenient ticks and labels for interannual</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>freq</strong><span class="classifier">Frequency string for desired spacing. Must be “Q”,”QS”,”M”,”MS” for quarterly or monthly</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ticks_labels</strong><span class="classifier">tuple of tick locations and labels</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vtools.functions.interpolate">
<span id="vtools-functions-interpolate-module"></span><h2>vtools.functions.interpolate module<a class="headerlink" href="#module-vtools.functions.interpolate" title="Link to this heading">¶</a></h2>
<p>Module for data interpolation using splines or interfaces unavailable in Pandas.</p>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate._monotonic_spline">
<span class="sig-name descname"><span class="pre">_monotonic_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xnew</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/_monotonic_spline.html#_monotonic_spline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate._monotonic_spline" title="Link to this definition">¶</a></dt>
<dd><p>Third order (M3-A) monotonicity-preserving spline
Usage:          interpolate.spline(x,y,xnew)</p>
<blockquote>
<div><dl class="simple">
<dt>where</dt><dd><p>x are the sorted index values of the original data
y are the original dataxnew
xnew are new locations for the spline</p>
</dd>
</dl>
<p>Reference: Huynh, HT &lt;&lt;Accurate Monotone Cubic Interpolation&gt;&gt;,
SIAM J. Numer. Analysis V30 No. 1 pp 57-100
All equation numbers refer to this paper. The variable names are
also almost the same. Double letters like “ee” to indicate
that the subscript should have “+1/2” added to it and a number after
the variable to show the “t” that the first member applies to.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate._ratsp1">
<span class="sig-name descname"><span class="pre">_ratsp1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#_ratsp1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate._ratsp1" title="Link to this definition">¶</a></dt>
<dd><p>RATSP1 in Spath (1995)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.interpolate_to_index">
<span class="sig-name descname"><span class="pre">interpolate_to_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#interpolate_to_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.interpolate_to_index" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.monotonic_spline">
<span class="sig-name descname"><span class="pre">monotonic_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#monotonic_spline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.monotonic_spline" title="Link to this definition">¶</a></dt>
<dd><p>Interpolating a regular time series (rts) to a finer rts by rational histospline.</p>
<p>The rational histospline preserves area under the curve. This is a good choice of spline for period averaged data where an interpolant is desired
that is ‘conservative’. Note that it is the underlying continuous interpolant
that will be ‘conservative though, not the returned discrete time series which
merely samples the underlying interpolant.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pandas.DataFrame</span></code></span></dt><dd><p>Series to be interpolated, typically with DatetimeIndex</p>
</dd>
<dt><strong>dest</strong><span class="classifier">a pandas freq code (e.g. ‘16min’ or ‘D’) or a DateTimeIndex</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></span></dt><dd><p>A regular time series with same columns as ts, populated with instantaneous values and with
an index of type DateTimeIndex</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhist">
<span class="sig-name descname"><span class="pre">rhist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhist" title="Link to this definition">¶</a></dt>
<dd><p>Histopline for arrays with tension.
Based by an algorithm rhist2 in
One Dimensional Spline Interpolation Algorithms
by Helmuth Spath (1995).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">array-like</span></dt><dd><p>Abscissa array of original data,
of length n</p>
</dd>
<dt><strong>y</strong><span class="classifier">array-like, dimension (n-1)</span></dt><dd><p>Values (mantissa) of original data giving the rectangle (average) values between x[i] and x[i+1]</p>
</dd>
<dt><strong>xnew</strong><span class="classifier">array-like</span></dt><dd><p>Array of new locations at which to interpolate.</p>
</dd>
<dt><strong>y0,yn</strong><span class="classifier">float</span></dt><dd><p>Initial and terminal values</p>
</dd>
<dt><strong>p,q: array-like, dimension (n-1)</strong></dt><dd><p>Tension parameter, p and q are almost always the same. The higher p and q are for a particular x interval, the more rectangular the interpolant will look and the more
positivity and shape preserving it is at the expense
of accuracy. For this routine any number p,q &gt; -1 is allowed, although the bound routine doesn’t use vals less
than zero.</p>
</dd>
<dt><strong>Returns</strong></dt><dd></dd>
<dt><strong>——-</strong></dt><dd></dd>
<dt><strong>ynew</strong><span class="classifier">array-like</span></dt><dd><p>Array that interpolates the original data.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhist_bound">
<span class="sig-name descname"><span class="pre">rhist_bound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">floor_eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhist_bound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhist_bound" title="Link to this definition">¶</a></dt>
<dd><p>Numpy implementation of histospline with bounds
Histopline for arrays with lower bound enforcement.
This routine drives rhist() but tests that the output
array observes the lower bound and adapts the tension parameters as needed.</p>
<p>This will not work exactly if the input
array has values right on the lower bound. In this case,
the parameter floor_eps allows you to specify a tolerance
of bound violation to shoot for … and if it isn’t met in maxiter iterations the value is simply floored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">array-like</span></dt><dd><p>Abscissa array of original data to be interpolated,
of length n</p>
</dd>
<dt><strong>y</strong><span class="classifier">array-like, dimension (n-1)</span></dt><dd><p>Values (mantissa) of original data giving the rectangle (average) values between x[i] and x[i+1]</p>
</dd>
<dt><strong>xnew</strong><span class="classifier">array-like</span></dt><dd><p>Array of new locations at which to interpolate.</p>
</dd>
<dt><strong>y0,yn</strong><span class="classifier">float</span></dt><dd><p>Initial and terminal values</p>
</dd>
<dt><strong>p: float</strong></dt><dd><p>Tension parameter. This starts out as a global scalar, but will be converted to an array and adapted locally.
The higher this goes for a particular x interval, the more rectangular the interpolant will look and the more
positivity and shape preserving it is at the expense
of accuracy. A good number is 1, and for this routine,
p &gt; 0 is required because the adaptive process multiplies it by pfactor each iteration on the expectation that it will get bigger.</p>
</dd>
<dt><strong>lbound: float</strong></dt><dd><p>Lower bound to be enforced. If the original y’s are strictly above this value, the output has the potential to also be strictly above. If the original y’s lie on the lower bound, then the lower bound can only be enforced within a tolerance using the Spath algorithm …
and once the values reach that tolerance they are floored. If lbound = None, this function behaves like rhist()</p>
</dd>
<dt><strong>maxiter</strong><span class="classifier">integer</span></dt><dd><p>Number of times to increase p by multiplying it by pfactor before giving up on satisfying floor_eps.</p>
</dd>
<dt><strong>pfactor</strong><span class="classifier">float</span></dt><dd><p>Factor by which to multiply individual time step p</p>
</dd>
<dt><strong>floor_eps</strong><span class="classifier">float</span></dt><dd><p>Tolerance for lower bound violation at which the algorithm will be terminated and the bounds will be enforced by flooring.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>ynew</strong><span class="classifier">array-like</span></dt><dd><p>Array that interpolates the original data, on a curve that conserves mass and strictly observes the lower bound.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhist_coef">
<span class="sig-name descname"><span class="pre">rhist_coef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhist_coef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhist_coef" title="Link to this definition">¶</a></dt>
<dd><p>Routine that produces coefficients for the histospline</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhist_example">
<span class="sig-name descname"><span class="pre">rhist_example</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhist_example"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhist_example" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhist_val">
<span class="sig-name descname"><span class="pre">rhist_val</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhist_val"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhist_val" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate a histospline at new x points</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.rhistinterp">
<span class="sig-name descname"><span class="pre">rhistinterp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowbound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolbound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#rhistinterp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.rhistinterp" title="Link to this definition">¶</a></dt>
<dd><p>Interpolate a regular time series (rts) to a finer rts by rational histospline.</p>
<p>The rational histospline preserves area under the curve. This is a good choice of spline for period averaged data where an interpolant is desired
that is ‘conservative’. Note that it is the underlying continuous interpolant
that will be ‘conservative though, not the returned discrete time series which
merely samples the underlying interpolant.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pandas.DataFrame</span></code></span></dt><dd><p>Series to be interpolated, with period index and assuming time stamps at beginning
of the period and no missing data</p>
</dd>
<dt><strong>dest</strong><span class="classifier">string or <code class="xref py py-class docutils literal notranslate"><span class="pre">DateTimeIndex</span></code></span></dt><dd><p>A pandas freq code (e.g. ‘16min’ or ‘D’) or a DateTimeIndex</p>
</dd>
<dt><strong>p</strong><span class="classifier">float, optional</span></dt><dd><p>Spline tension, usually between 0 and 20. Must &gt;-1. For a ‘sufficiently large’ value of p, the interpolant will be monotonicity-preserving and will maintain strict positivity (always being strictly &gt; <cite>lowbound</cite>). It will also preserve the original shape of the time series.</p>
</dd>
<dt><strong>lowbound</strong><span class="classifier">float, optional</span></dt><dd><p>Lower bound of interpolated values.</p>
</dd>
<dt><strong>tolbound</strong><span class="classifier">float, optional</span></dt><dd><p>Tolerance for determining if an input is on the bound.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a></span></dt><dd><p>A regular time series with same columns as ts, populated with instantaneous values and with
an index of type DateTimeIndex</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.interpolate.tridiagonal">
<span class="sig-name descname"><span class="pre">tridiagonal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/interpolate.html#tridiagonal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.interpolate.tridiagonal" title="Link to this definition">¶</a></dt>
<dd><p>a is the lower band (with leading zero)
b is the center diagonal (length == nrow)
c is upper band (trailing zero)
d is right hand side</p>
</dd></dl>

</section>
<section id="module-vtools.functions.lag_cross_correlation">
<span id="vtools-functions-lag-cross-correlation-module"></span><h2>vtools.functions.lag_cross_correlation module<a class="headerlink" href="#module-vtools.functions.lag_cross_correlation" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.lag_cross_correlation.calculate_lag">
<span class="sig-name descname"><span class="pre">calculate_lag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lagged</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/lag_cross_correlation.html#calculate_lag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.lag_cross_correlation.calculate_lag" title="Link to this definition">¶</a></dt>
<dd><p>Calculate shift in lagged, that maximizes cross-correlation with base.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>base,lagged: :class:`Pandas.Series`</strong></dt><dd><p>time series to compare. The result is relative to base</p>
</dd>
<dt><strong>max_lag: interval</strong></dt><dd><p>Maximum pos/negative time shift to consider in cross-correlation
(ie, from -max_lag to +max_lag). Required windows in lagged will
account for this bracket. For series dominated by a single
frequency (eg 1c/12.5 hours for tides), the algorithm can tolerate
a range of 180 degrees (6 hours)</p>
</dd>
<dt><strong>res: interval</strong></dt><dd><p>Resolution of analysis. The series lagged will
be interpolated to this resolution using interpolate_method. Unit
used here will determine the type of the output. See documentation
of the interval concept which is most compatible with
pandas.tseries.offsets, not timeDelta, because of better math
properties in things like division – vtime helpers like minutes(1)
may be helpful</p>
</dd>
<dt><strong>interpolate_method: str, optional</strong></dt><dd><p>Interpolate method to refine lagged to res. Must be compatible with
pandas interpolation method names (and hence scipy)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>lag</strong><span class="classifier">interval</span></dt><dd><p>Shift as a pandas.tseries.offsets subtype that matches units with res
This shift is the apparent lateness (pos) or earliness (neg). It must be
applied to base or removed to lagged to align the features.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.lag_cross_correlation.icrosscorr">
<span class="sig-name descname"><span class="pre">icrosscorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/lag_cross_correlation.html#icrosscorr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.lag_cross_correlation.icrosscorr" title="Link to this definition">¶</a></dt>
<dd><p>Lag-N cross correlation.
Shifted data filled with NaNs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lag</strong><span class="classifier">int, default 0</span></dt><dd></dd>
<dt><strong>ts0, ts1</strong><span class="classifier">pandas.Series objects of equal length</span></dt><dd></dd>
<dt><strong>Returns</strong></dt><dd></dd>
<dt><strong>———-</strong></dt><dd></dd>
<dt><strong>crosscorr</strong><span class="classifier">float</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.lag_cross_correlation.mincrosscorr">
<span class="sig-name descname"><span class="pre">mincrosscorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/lag_cross_correlation.html#mincrosscorr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.lag_cross_correlation.mincrosscorr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-vtools.functions.merge">
<span id="vtools-functions-merge-module"></span><h2>vtools.functions.merge module<a class="headerlink" href="#module-vtools.functions.merge" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.merge._apply_names">
<span class="sig-name descname"><span class="pre">_apply_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/merge.html#_apply_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.merge._apply_names" title="Link to this definition">¶</a></dt>
<dd><p>Helper to apply renaming and column selection based on <cite>names</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.merge._reindex_to_continuous">
<span class="sig-name descname"><span class="pre">_reindex_to_continuous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/merge.html#_reindex_to_continuous"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.merge._reindex_to_continuous" title="Link to this definition">¶</a></dt>
<dd><p>Reindex the given result (DataFrame or Series) to a continuous index spanning
from the minimum to maximum timestamp of the current index using the provided frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>result</strong><span class="classifier">pandas.DataFrame or pandas.Series</span></dt><dd><p>The merged or spliced result whose index will be reindexed.</p>
</dd>
<dt><strong>first_freq</strong><span class="classifier">frequency</span></dt><dd><p>The frequency (e.g. ‘D’ for daily) to use for the continuous index, taken from the first input series.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>result</strong><span class="classifier">pandas.DataFrame or pandas.Series</span></dt><dd><p>The result reindexed to a continuous index. Any gaps in the timeline will be filled with NaN.
If the index is a PeriodIndex, the index is rebuilt with the proper frequency.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.merge.reduce">
<span class="sig-name descname"><span class="pre">reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">initial</span></span></em><span class="optional">]</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">value</span></span></span><a class="headerlink" href="#vtools.functions.merge.reduce" title="Link to this definition">¶</a></dt>
<dd><p>Apply a function of two arguments cumulatively to the items of a sequence
or iterable, from left to right, so as to reduce the iterable to a single
value.  For example, reduce(lambda x, y: x+y, [1, 2, 3, 4, 5]) calculates
((((1+2)+3)+4)+5).  If initial is present, it is placed before the items
of the iterable in the calculation, and serves as a default when the
iterable is empty.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.merge.ts_merge">
<span class="sig-name descname"><span class="pre">ts_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict_priority</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/merge.html#ts_merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.merge.ts_merge" title="Link to this definition">¶</a></dt>
<dd><p>Merge multiple time series together, prioritizing series in order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>series</strong><span class="classifier">sequence of pandas.Series or pandas.DataFrame</span></dt><dd><p>Higher priority first. All indexes must be DatetimeIndex.</p>
</dd>
<dt><strong>names</strong><span class="classifier">None, str, or iterable of str, optional</span></dt><dd><ul class="simple">
<li><p>If <cite>None</cite> (default), inputs must share compatible column names.</p></li>
<li><p>If <cite>str</cite>, the output is univariate and will be named accordingly.</p></li>
<li><p>If iterable, it is used as a subset/ordering of columns.</p></li>
</ul>
</dd>
<dt><strong>strict_priority</strong><span class="classifier">bool, default False</span></dt><dd><p>If False (default): lower-priority data may fill NaNs in higher-priority
series anywhere (traditional merge/overlay).
If True: for each column, within the window
[first_valid_index, last_valid_index] of any higher-priority series,
lower-priority data are masked out — even if the higher-priority value is NaN.
Outside those windows, behavior is unchanged.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.Series or pandas.DataFrame</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.merge.ts_splice">
<span class="sig-name descname"><span class="pre">ts_splice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prefer_last'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">floor_dates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/merge.html#ts_splice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.merge.ts_splice" title="Link to this definition">¶</a></dt>
<dd><p>Splice multiple time series together, prioritizing series in patches of time.</p>
<p>Unlike <cite>ts_merge</cite>, which blends overlapping data points, <cite>ts_splice</cite> stitches
together time series without overlap. The function determines when to switch
between series based on a transition strategy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>series</strong><span class="classifier">tuple or list of pandas.DataFrame or pandas.Series</span></dt><dd><p>A tuple or list of time series.
Each series must have a <cite>DatetimeIndex</cite> and consistent column structure.</p>
</dd>
<dt><strong>names</strong><span class="classifier">None, str, or iterable of str, optional</span></dt><dd><ul class="simple">
<li><p>If <cite>None</cite> (default), all input series must share common column names,
and the output will merge common columns.</p></li>
<li><p>If a <cite>str</cite>, all input series must have a <strong>single column</strong>, and the
output will be a DataFrame with this name as the column name.</p></li>
<li><p>If an iterable of <cite>str</cite>, all input DataFrames must have the same
number of columns matching the length of <cite>names</cite>, and these will be
used for the output.</p></li>
</ul>
</dd>
<dt><strong>transition</strong><span class="classifier">{‘prefer_first’, ‘prefer_last’} or list of pandas.Timestamp</span></dt><dd><p>Defines how to determine breakpoints between time series:
- <cite>‘prefer_first’</cite>: Uses the earlier series on the list during until its valid timestamp.
- <cite>‘prefer_last’</cite>: Uses the later series starting from its first valid timestamp.
- A list of specific timestamps can also be provided as transition points.</p>
</dd>
<dt><strong>floor_dates</strong><span class="classifier">bool, optional, default=False</span></dt><dd><p>If <cite>True</cite>, inferred transition timestamps (<cite>prefer_first</cite> or <cite>prefer_last</cite>)
are floored to the beginning of the day. This can introduce NaNs if the
input series are regular with a <cite>freq</cite> attribute.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.DataFrame or pandas.Series</dt><dd><ul class="simple">
<li><p>If the input contains multi-column DataFrames, the output is a DataFrame
with the same column structure.</p></li>
<li><p>If a collection of single-column <cite>Series</cite> is provided, the output will be
a Series.</p></li>
<li><p>The output retains a <cite>freq</cite> attribute if all inputs share the same frequency.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#vtools.functions.merge.ts_merge" title="vtools.functions.merge.ts_merge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ts_merge</span></code></a></dt><dd><p>Merges series by filling gaps in order of priority.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The output time index is the union of input time indices.</p></li>
<li><p>If <cite>transition</cite> is <cite>‘prefer_first’</cite>, gaps may appear in the final time series.</p></li>
<li><p>If <cite>transition</cite> is <cite>‘prefer_last’</cite>, overlapping data is resolved in favor
of later series.</p></li>
</ul>
</dd></dl>

</section>
<section id="module-vtools.functions.period_op">
<span id="vtools-functions-period-op-module"></span><h2>vtools.functions.period_op module<a class="headerlink" href="#module-vtools.functions.period_op" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.period_op.period_op">
<span class="sig-name descname"><span class="pre">period_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'D'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_absent_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/period_op.html#period_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.period_op.period_op" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.period_op.window_op">
<span class="sig-name descname"><span class="pre">window_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'D'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_absent_frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/period_op.html#window_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.period_op.window_op" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-vtools.functions.read_dss">
<span id="vtools-functions-read-dss-module"></span><h2>vtools.functions.read_dss module<a class="headerlink" href="#module-vtools.functions.read_dss" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.read_dss.check_exclude">
<span class="sig-name descname"><span class="pre">check_exclude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pathname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_pathname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/read_dss.html#check_exclude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.read_dss.check_exclude" title="Link to this definition">¶</a></dt>
<dd><p>Returns True if pathname matches the exclude_pathname pattern.
Wildcards (*) in exclude_pathname are supported.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.read_dss.read_dss">
<span class="sig-name descname"><span class="pre">read_dss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pathname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt=&lt;15</span> <span class="pre">*</span> <span class="pre">Minutes&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p=2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_date=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_date=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_pathname=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/read_dss.html#read_dss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.read_dss.read_dss" title="Link to this definition">¶</a></dt>
<dd><p>Reads in a DSM2 dss file and interpolates
Outputs an interpolated DataFrame of that variable</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename: str|Path</strong></dt><dd><p>Path to the DSS file to read</p>
</dd>
<dt><strong>pathname: str|list</strong></dt><dd><p>Pathname(s) within the DSS file to read.
Needs to be in the format ‘/A_PART/B_PART/C_PART/D_PART/E_PART/F_PART/’
(e.g. ‘//RSAN112/FLOW////’)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vtools.functions.savitzky_golay">
<span id="vtools-functions-savitzky-golay-module"></span><h2>vtools.functions.savitzky_golay module<a class="headerlink" href="#module-vtools.functions.savitzky_golay" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay._build_vander">
<span class="sig-name descname"><span class="pre">_build_vander</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#_build_vander"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay._build_vander" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay._evaluate_poly">
<span class="sig-name descname"><span class="pre">_evaluate_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#_evaluate_poly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay._evaluate_poly" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay._polyfit_window">
<span class="sig-name descname"><span class="pre">_polyfit_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#_polyfit_window"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay._polyfit_window" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay.main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay.savgol_filter_numba">
<span class="sig-name descname"><span class="pre">savgol_filter_numba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#savgol_filter_numba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay.savgol_filter_numba" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay.savgol_filter_weighted">
<span class="sig-name descname"><span class="pre">savgol_filter_weighted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_numba</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#savgol_filter_weighted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay.savgol_filter_weighted" title="Link to this definition">¶</a></dt>
<dd><p>Apply a Savitzky–Golay filter with weights to a univariate DataFrame or Series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">pandas.DataFrame or pandas.Series</span></dt><dd><p>DataFrame or Series containing your data.</p>
</dd>
<dt><strong>window_length</strong><span class="classifier">int</span></dt><dd><p>Length of the filter window (must be odd).</p>
</dd>
<dt><strong>degree</strong><span class="classifier">int</span></dt><dd><p>Degree of the polynomial fit.</p>
</dd>
<dt><strong>error</strong><span class="classifier">pandas.Series, optional</span></dt><dd><p>Series containing the error (used to compute weights).</p>
</dd>
<dt><strong>cov_matrix</strong><span class="classifier">2D numpy array, optional</span></dt><dd><p>Covariance matrix for the errors.</p>
</dd>
<dt><strong>deriv</strong><span class="classifier">int, optional</span></dt><dd><p>Derivative order to compute.</p>
</dd>
<dt><strong>use_numba</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, uses the Numba-accelerated kernel.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.Series</dt><dd><p>Series of the filtered values.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The practical size of <cite>window_length</cite> depends on the data and the computational resources.
Larger window lengths provide smoother results but require more computation and may not capture
local variations well. It is recommended to experiment with different window lengths to find
the optimal value for your specific application.</p>
<p>Some of the workflow derived from this work:
<a class="reference external" href="https://github.com/surhudm/savitzky_golay_with_errors">https://github.com/surhudm/savitzky_golay_with_errors</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay.savgol_filter_werror">
<span class="sig-name descname"><span class="pre">savgol_filter_werror</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#savgol_filter_werror"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay.savgol_filter_werror" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay.solve_leastsq">
<span class="sig-name descname"><span class="pre">solve_leastsq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">yarr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ycov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vander</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vanderT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#solve_leastsq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay.solve_leastsq" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.savitzky_golay.solve_polyfit">
<span class="sig-name descname"><span class="pre">solve_polyfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xarr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yarr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/savitzky_golay.html#solve_polyfit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.savitzky_golay.solve_polyfit" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-vtools.functions.skill_metrics">
<span id="vtools-functions-skill-metrics-module"></span><h2>vtools.functions.skill_metrics module<a class="headerlink" href="#module-vtools.functions.skill_metrics" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics._main">
<span class="sig-name descname"><span class="pre">_main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#_main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics._main" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.corr_coefficient">
<span class="sig-name descname"><span class="pre">corr_coefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pearson'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#corr_coefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.corr_coefficient" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the correlation coefficient (the ‘r’ in ‘-squared’ between two series.</p>
<p>For time series where the targets are serially correlated and may span only a fraction
of the natural variability, this statistic may not be appropriate and Murphy (1988) explains
why caution should be exercised in using this statistic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series to analyze</p>
</dd>
<dt><strong>method</strong><span class="classifier">pearson’, ‘kendall’, ‘spearman’</span></dt><dd><p>Method compatilble with pandasa</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>r</strong><span class="classifier">float</span></dt><dd><p>Correlation coefficient</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.mean_error">
<span class="sig-name descname"><span class="pre">mean_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proportiontocut</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#mean_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.mean_error" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the untrimmed mean error, discounting nan values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to be analyzed</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>med</strong><span class="classifier">float</span></dt><dd><p>Median error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.median_error">
<span class="sig-name descname"><span class="pre">median_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#median_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.median_error" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the median error, discounting nan values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to be analyzed</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>med</strong><span class="classifier">float</span></dt><dd><p>Median error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.mse">
<span class="sig-name descname"><span class="pre">mse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#mse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.mse" title="Link to this definition">¶</a></dt>
<dd><p>Mean squared error</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to analyze</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mse</strong><span class="classifier">vtools.data.timeseries.TimeSeries</span></dt><dd><p>Mean squared error between predictions and targets</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.rmse">
<span class="sig-name descname"><span class="pre">rmse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#rmse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.rmse" title="Link to this definition">¶</a></dt>
<dd><p>Root mean squared error</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to analyze</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mse</strong><span class="classifier">float</span></dt><dd><p>Mean squared error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.skill_score">
<span class="sig-name descname"><span class="pre">skill_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#skill_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.skill_score" title="Link to this definition">¶</a></dt>
<dd><p>Calculate a Nash-Sutcliffe-like skill score based on mean squared error</p>
<p>As per the discussion in Murphy (1988) other reference forecasts (climatology,
harmonic tide, etc.) are possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to be analyzed</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>rmse</strong><span class="classifier">float</span></dt><dd><p>Root mean squared error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.tmean_error">
<span class="sig-name descname"><span class="pre">tmean_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclusive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[True,</span> <span class="pre">True]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#tmean_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.tmean_error" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the (possibly trimmed) mean error, discounting nan values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to be analyzed</p>
</dd>
<dt><strong>limits</strong><span class="classifier">tuple(float)</span></dt><dd><p>Low and high limits for trimming</p>
</dd>
<dt><strong>inclusive</strong><span class="classifier">[boolean, boolean]</span></dt><dd><p>True if clipping is inclusive on the low/high end</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mean</strong><span class="classifier">float</span></dt><dd><p>Trimmed mean error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.skill_metrics.willmott_score">
<span class="sig-name descname"><span class="pre">willmott_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/skill_metrics.html#willmott_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.skill_metrics.willmott_score" title="Link to this definition">¶</a></dt>
<dd><p>Calculate a Nash-Sutcliffe-like skill score based on mean squared error</p>
<p>As per the discussion in Murphy (1988) other reference forecasts (climatology,
harmonic tide, etc.) are possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>predictions, targets</strong><span class="classifier">array_like</span></dt><dd><p>Time series or arrays to be analyzed</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>rmse</strong><span class="classifier">float</span></dt><dd><p>Root mean squared error</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vtools.functions.tidalhl">
<span id="vtools-functions-tidalhl-module"></span><h2>vtools.functions.tidalhl module<a class="headerlink" href="#module-vtools.functions.tidalhl" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.cosine_lanczos">
<span class="sig-name descname"><span class="pre">cosine_lanczos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#cosine_lanczos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.cosine_lanczos" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.filter_where_na">
<span class="sig-name descname"><span class="pre">filter_where_na</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dfb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#filter_where_na"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.filter_where_na" title="Link to this definition">¶</a></dt>
<dd><p>remove values in df where dfb has na values</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.get_phase_diff">
<span class="sig-name descname"><span class="pre">get_phase_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'4h'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#get_phase_diff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.get_phase_diff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.get_smoothed_resampled">
<span class="sig-name descname"><span class="pre">get_smoothed_resampled</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2h'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pchip'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#get_smoothed_resampled"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.get_smoothed_resampled" title="Link to this definition">¶</a></dt>
<dd><p>Resample the dataframe (indexed by time) to the regular period of resample_period using the interpolate method</p>
<p>Furthermore the cosine lanczos filter is used with a cutoff_period to smooth the signal to remove high frequency noise</p>
<p>Args:</p>
<blockquote>
<div><p>df (DataFrame): A single column dataframe indexed by datetime</p>
<p>cutoff_period (str, optional): cutoff period for cosine lanczos filter. Defaults to ‘2h’.</p>
<p>resample_period (str, optional): Resample to regular period. Defaults to ‘1min’.</p>
<p>interpolate_method (str, optional): interpolation for resampling. Defaults to ‘pchip’.</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>DataFrame: smoothed and resampled dataframe indexed by datetime</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.get_tidal_amplitude">
<span class="sig-name descname"><span class="pre">get_tidal_amplitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dfh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dfl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#get_tidal_amplitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.get_tidal_amplitude" title="Link to this definition">¶</a></dt>
<dd><p>Tidal amplitude given tidal highs and lows</p>
<p>Args:</p>
<blockquote>
<div><p>dfh (DataFrame): Tidal highs time series</p>
<p>dfl (DataFrame): Tidal lows time series</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>DataFrame: Amplitude timeseries, at the times of the low following the high being used for amplitude calculation</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.get_tidal_amplitude_diff">
<span class="sig-name descname"><span class="pre">get_tidal_amplitude_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dfamp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dfamp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percent_diff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'4h'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#get_tidal_amplitude_diff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.get_tidal_amplitude_diff" title="Link to this definition">¶</a></dt>
<dd><p>Get the difference of values within +/- 4H of values in the two amplitude arrays</p>
<p>Args:</p>
<blockquote>
<div><p>dfamp1 (DataFrame): Amplitude time series</p>
<p>dfamp2 (DataFrame): Amplitude time series</p>
<p>percent_diff (bool, optional): If true do percent diff. Defaults to False.</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>DataFrame: Difference dfamp1-dfamp2 or % Difference (dfamp1-dfamp2)/dfamp2*100  for values within +/- 4H of each other</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.get_tidal_hl">
<span class="sig-name descname"><span class="pre">get_tidal_hl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2h'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pchip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'7h'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#get_tidal_hl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.get_tidal_hl" title="Link to this definition">¶</a></dt>
<dd><p>Get Tidal highs and lows</p>
<p>Args:</p>
<blockquote>
<div><p>df (DataFrame): A single column dataframe indexed by datetime</p>
<p>cutoff_period (str, optional): cutoff period for cosine lanczos filter. Defaults to ‘2h’.</p>
<p>resample_period (str, optional): Resample to regular period. Defaults to ‘1min’.</p>
<p>interpolate_method (str, optional): interpolation for resampling. Defaults to ‘pchip’.</p>
<p>moving_window_size (str, optional): moving window size to look for lows within. Defaults to ‘7h’.</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>tuple of DataFrame: Tidal high and tidal low time series</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.get_tidal_hl_rolling">
<span class="sig-name descname"><span class="pre">get_tidal_hl_rolling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2h'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pchip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'7h'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#vtools.functions.tidalhl.get_tidal_hl_rolling" title="Link to this definition">¶</a></dt>
<dd><p>Get Tidal highs and lows</p>
<p>Args:</p>
<blockquote>
<div><p>df (DataFrame): A single column dataframe indexed by datetime</p>
<p>cutoff_period (str, optional): cutoff period for cosine lanczos filter. Defaults to ‘2h’.</p>
<p>resample_period (str, optional): Resample to regular period. Defaults to ‘1min’.</p>
<p>interpolate_method (str, optional): interpolation for resampling. Defaults to ‘pchip’.</p>
<p>moving_window_size (str, optional): moving window size to look for lows within. Defaults to ‘7h’.</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>tuple of DataFrame: Tidal high and tidal low time series</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.get_tidal_hl_zerocrossing">
<span class="sig-name descname"><span class="pre">get_tidal_hl_zerocrossing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1min'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#get_tidal_hl_zerocrossing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.get_tidal_hl_zerocrossing" title="Link to this definition">¶</a></dt>
<dd><p>Finds the tidal high and low times using zero crossings of the first derivative.</p>
<p>This works for all situations but is not robust in the face of noise and perturbations in the signal</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.get_tidal_phase_diff">
<span class="sig-name descname"><span class="pre">get_tidal_phase_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dfh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dfl2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dfh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dfl1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'4h'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#get_tidal_phase_diff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.get_tidal_phase_diff" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the phase difference between df2 and df1 tidal highs and lows</p>
<p>Scans +/- 4 hours in df1 to get the highs and lows in that windows for df2 to
get the tidal highs and lows at the times of df1</p>
<p>Args:</p>
<blockquote>
<div><p>dfh2 (DataFrame): Timeseries of tidal highs</p>
<p>dfl2 (DataFrame): Timeseries of tidal lows</p>
<p>dfh1 (DataFrame): Timeseries of tidal highs</p>
<p>dfl1 (DataFRame): Timeseries of tidal lows</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>DataFrame: Phase difference (dfh2-dfh1) and (dfl2-dfl1) in minutes</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.limit_to_indices">
<span class="sig-name descname"><span class="pre">limit_to_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">si</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ei</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#limit_to_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.limit_to_indices" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.lmax">
<span class="sig-name descname"><span class="pre">lmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#lmax"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.lmax" title="Link to this definition">¶</a></dt>
<dd><p>Local maximum: Returns value only when centered on maximum</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.lmin">
<span class="sig-name descname"><span class="pre">lmin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#lmin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.lmin" title="Link to this definition">¶</a></dt>
<dd><p>Local minimum: Returns value only when centered on minimum</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.periods_per_window">
<span class="sig-name descname"><span class="pre">periods_per_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moving_window_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period_str</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#periods_per_window"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.periods_per_window" title="Link to this definition">¶</a></dt>
<dd><p>Number of period size in moving window</p>
<p>Args:</p>
<blockquote>
<div><p>moving_window_size (str): moving window size as a string e.g 7H for 7 hour</p>
<p>period_str (str): period as str e.g. 1T for 1 min</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>int: number of periods in the moving window rounded to an integer</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.tidal_highs">
<span class="sig-name descname"><span class="pre">tidal_highs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'7h'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#tidal_highs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.tidal_highs" title="Link to this definition">¶</a></dt>
<dd><p>Tidal highs (could be upto two highs in a 25 hr period)</p>
<p>Args:</p>
<blockquote>
<div><p>df (DataFrame): a time series with a regular frequency</p>
<p>moving_window_size (str, optional): moving window size to look for highs within. Defaults to ‘7h’.</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>DataFrame: an irregular time series with highs at resolution of df.index</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.tidal_lows">
<span class="sig-name descname"><span class="pre">tidal_lows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving_window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'7h'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#tidal_lows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.tidal_lows" title="Link to this definition">¶</a></dt>
<dd><p>Tidal lows (could be upto two lows in a 25 hr period)</p>
<p>Args:</p>
<blockquote>
<div><p>df (DataFrame): a time series with a regular frequency</p>
<p>moving_window_size (str, optional): moving window size to look for lows within. Defaults to ‘7h’.</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>DataFrame: an irregular time series with lows at resolution of df.index</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.where_changed">
<span class="sig-name descname"><span class="pre">where_changed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#where_changed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.where_changed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.where_same">
<span class="sig-name descname"><span class="pre">where_same</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dfg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#where_same"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.where_same" title="Link to this definition">¶</a></dt>
<dd><p>return dfg only where its value is the same as df for the same time stamps
i.e. the interesection locations with df</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhl.zerocross">
<span class="sig-name descname"><span class="pre">zerocross</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhl.html#zerocross"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhl.zerocross" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the gradient of the time series and identifies locations where gradient changes sign
Returns the time rounded to nearest minute where the zero crossing happens (based on linear derivative assumption)</p>
</dd></dl>

</section>
<section id="module-vtools.functions.tidalhours">
<span id="vtools-functions-tidalhours-module"></span><h2>vtools.functions.tidalhours module<a class="headerlink" href="#module-vtools.functions.tidalhours" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.cdiff">
<span class="sig-name descname"><span class="pre">cdiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhours.html#cdiff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.cdiff" title="Link to this definition">¶</a></dt>
<dd><p>Like np.diff, but include difference from last element back
to first.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.cosine_lanczos5">
<span class="sig-name descname"><span class="pre">cosine_lanczos5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_edge_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/filter.html#cosine_lanczos5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.cosine_lanczos5" title="Link to this definition">¶</a></dt>
<dd><p>squared low-pass cosine lanczos  filter on a regular time series.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ts</strong><span class="classifier"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></dt><dd></dd>
<dt><strong>filter_len</strong><span class="classifier">int, time_interval</span></dt><dd><p>Size of lanczos window, default is to number of samples within filter_period*1.25.</p>
</dd>
<dt><strong>cutoff_frequency: float,optional</strong></dt><dd><p>Cutoff frequency expressed as a ratio of a Nyquist frequency,
should within the range (0,1). For example, if the sampling frequency
is 1 hour, the Nyquist frequency is 1 sample/2 hours. If we want a
36 hour cutoff period, the frequency is 1/36 or 0.0278 cycles per hour.
Hence the cutoff frequency argument used here would be
0.0278/0.5 = 0.056.</p>
</dd>
<dt><strong>cutoff_period</strong><span class="classifier">string  or  _time_interval</span></dt><dd><blockquote>
<div><p>Period of cutting off frequency. If input as a string, it must
be  convertible to a _time_interval (Pandas freq).
cutoff_frequency and cutoff_period can’t be specified at the same time.</p>
</div></blockquote>
<dl class="simple">
<dt>padtype<span class="classifier">str or None, optional</span></dt><dd><p>Must be ‘odd’, ‘even’, ‘constant’, or None. This determines the type
of extension to use for the padded signal to which the filter is applied.
If padtype is None, no padding is used. The default is None.</p>
</dd>
<dt>padlen<span class="classifier">int or None, optional</span></dt><dd><p>The number of elements by which to extend x at both ends of axis
before applying the filter. This value must be less than x.shape[axis]-1.
padlen=0 implies no padding. If padtye is not None and padlen is not
given, padlen is be set to 6*m.</p>
</dd>
<dt>fill_edge_nan: bool,optional</dt><dd><p>If pading is not used and fill_edge_nan is true, resulting data on
the both ends are filled with nan to account for edge effect. This is
2*m on the either end of the result. Default is true.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></span></dt><dd><p>A new regular time series with the same interval of ts. If no pading
is used the beigning and ending 4*m resulting data will be set to nan
to remove edge effect.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If input timeseries is not regular,
or, cutoff_period and cutoff_frequency are given at the same time,
or, neither cutoff_period nor curoff_frequence is given,
or, padtype is not “odd”,”even”,”constant”,or None,
or, padlen is larger than data size</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.diff_h">
<span class="sig-name descname"><span class="pre">diff_h</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tidal_hour_series</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhours.html#diff_h"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.diff_h" title="Link to this definition">¶</a></dt>
<dd><p>Compute the time derivative of tidal hour.</p>
<p>This derivative is often included to capture how rapidly the tidal phase is changing,
which can be important in modeling flow reversals, estuarine dynamics, or for detecting
slack tide conditions where the rate of change is near zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tidal_hour_series</strong><span class="classifier">pandas.Series</span></dt><dd><p>Output of <cite>tidal_hour_signal</cite>, indexed by datetime.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.Series</dt><dd><p>Time derivative of tidal hour (dH/dt) in hours/hour, indexed by datetime.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.find_slack">
<span class="sig-name descname"><span class="pre">find_slack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leave_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'both'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhours.html#find_slack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.find_slack" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.hilbert">
<span class="sig-name descname"><span class="pre">hilbert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/signal/_signaltools.html#hilbert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.hilbert" title="Link to this definition">¶</a></dt>
<dd><p>Compute the analytic signal, using the Hilbert transform.</p>
<p>The transformation is done along the last axis by default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">array_like</span></dt><dd><p>Signal data.  Must be real.</p>
</dd>
<dt><strong>N</strong><span class="classifier">int, optional</span></dt><dd><p>Number of Fourier components.  Default: <code class="docutils literal notranslate"><span class="pre">x.shape[axis]</span></code></p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>Axis along which to do the transformation.  Default: -1.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>xa</strong><span class="classifier">ndarray</span></dt><dd><p>Analytic signal of <cite>x</cite>, of each 1-D array along <cite>axis</cite></p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The analytic signal <code class="docutils literal notranslate"><span class="pre">x_a(t)</span></code> of signal <code class="docutils literal notranslate"><span class="pre">x(t)</span></code> is:</p>
<div class="math notranslate nohighlight">
\[x_a = F^{-1}(F(x) 2U) = x + i y\]</div>
<p>where <cite>F</cite> is the Fourier transform, <cite>U</cite> the unit step function,
and <cite>y</cite> the Hilbert transform of <cite>x</cite>. <a class="reference internal" href="#re878f5db20d4-1" id="id15">[1]</a></p>
<p>In other words, the negative half of the frequency spectrum is zeroed
out, turning the real-valued signal into a complex signal.  The Hilbert
transformed signal can be obtained from <code class="docutils literal notranslate"><span class="pre">np.imag(hilbert(x))</span></code>, and the
original signal from <code class="docutils literal notranslate"><span class="pre">np.real(hilbert(x))</span></code>.</p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="re878f5db20d4-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id15">1</a><span class="fn-bracket">]</span></span>
<p>Wikipedia, “Analytic signal”.
<a class="reference external" href="https://en.wikipedia.org/wiki/Analytic_signal">https://en.wikipedia.org/wiki/Analytic_signal</a></p>
</div>
<div class="citation" id="re878f5db20d4-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Leon Cohen, “Time-Frequency Analysis”, 1995. Chapter 2.</p>
</div>
<div class="citation" id="re878f5db20d4-3" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>Alan V. Oppenheim, Ronald W. Schafer. Discrete-Time Signal
Processing, Third Edition, 2009. Chapter 12.
ISBN 13: 978-1292-02572-8</p>
</div>
</div>
<p class="rubric">Examples</p>
<p>In this example we use the Hilbert transform to determine the amplitude
envelope and instantaneous frequency of an amplitude-modulated signal.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">hilbert</span><span class="p">,</span> <span class="n">chirp</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">duration</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="mf">400.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fs</span><span class="o">*</span><span class="n">duration</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>
</pre></div>
</div>
<p>We create a chirp of which the frequency increases from 20 Hz to 100 Hz and
apply an amplitude modulation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">chirp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mf">100.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">*=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">3.0</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>The amplitude envelope is given by magnitude of the analytic signal. The
instantaneous frequency can be obtained by differentiating the
instantaneous phase in respect to time. The instantaneous phase corresponds
to the phase angle of the analytic signal.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">analytic_signal</span> <span class="o">=</span> <span class="n">hilbert</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amplitude_envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">analytic_signal</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instantaneous_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">analytic_signal</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instantaneous_frequency</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">instantaneous_phase</span><span class="p">)</span> <span class="o">/</span>
<span class="gp">... </span>                           <span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;signal&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">amplitude_envelope</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;envelope&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;time in seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax0</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">instantaneous_frequency</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;time in seconds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">120.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.hour_tide">
<span class="sig-name descname"><span class="pre">hour_tide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jd_new</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leave_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_datum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ebb'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhours.html#hour_tide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.hour_tide" title="Link to this definition">¶</a></dt>
<dd><p>Calculate tide-hour from a time series of u (velocity, flood-positive)
or h (water level, i.e. positive-up).</p>
<p>jd: time in days, i.e. julian day, datenum, etc.
u: velocity, flood-positive
h: water level, positive up.
jd_new: if you want to evaluate the tidal hour at a different</p>
<blockquote>
<div><p>(but overlapping) set of times.</p>
</div></blockquote>
<dl class="simple">
<dt>leave_mean: by default, the time series mean is removed, but this</dt><dd><p>can be disabled by passing True here.</p>
</dd>
</dl>
<p>the return values are between 0 and 12, with 0 being slack before
ebb (hmm - may need to verify that.).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.hour_tide_fn">
<span class="sig-name descname"><span class="pre">hour_tide_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_datum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ebb'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leave_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhours.html#hour_tide_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.hour_tide_fn" title="Link to this definition">¶</a></dt>
<dd><p>Return a function for extracting tidal hour
from the time/velocity given.
Use the _fn version if making repeated calls with different jd_new,
but the same jd,u</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interp1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_Interpolator1D</span></code></p>
<p>Interpolate a 1-D function.</p>
<p><cite>x</cite> and <cite>y</cite> are arrays of values used to approximate some function f:
<code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">f(x)</span></code>. This class returns a function whose call method uses
interpolation to find the value of new points.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>x</strong><span class="classifier">(npoints, ) array_like</span></dt><dd><p>A 1-D array of real values.</p>
</dd>
<dt><strong>y</strong><span class="classifier">(…, npoints, …) array_like</span></dt><dd><p>A N-D array of real values. The length of <cite>y</cite> along the interpolation
axis must be equal to the length of <cite>x</cite>. Use the <code class="docutils literal notranslate"><span class="pre">axis</span></code> parameter
to select correct axis. Unlike other interpolators, the default
interpolation axis is the last axis of <cite>y</cite>.</p>
</dd>
<dt><strong>kind</strong><span class="classifier">str or int, optional</span></dt><dd><p>Specifies the kind of interpolation as a string or as an integer
specifying the order of the spline interpolator to use.
The string has to be one of ‘linear’, ‘nearest’, ‘nearest-up’, ‘zero’,
‘slinear’, ‘quadratic’, ‘cubic’, ‘previous’, or ‘next’. ‘zero’,
‘slinear’, ‘quadratic’ and ‘cubic’ refer to a spline interpolation of
zeroth, first, second or third order; ‘previous’ and ‘next’ simply
return the previous or next value of the point; ‘nearest-up’ and
‘nearest’ differ when interpolating half-integers (e.g. 0.5, 1.5)
in that ‘nearest-up’ rounds up and ‘nearest’ rounds down. Default
is ‘linear’.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>Axis in the <code class="docutils literal notranslate"><span class="pre">y</span></code> array corresponding to the x-coordinate values. Unlike
other interpolators, defaults to <code class="docutils literal notranslate"><span class="pre">axis=-1</span></code>.</p>
</dd>
<dt><strong>copy</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, the class makes internal copies of x and y.
If False, references to <cite>x</cite> and <cite>y</cite> are used. The default is to copy.</p>
</dd>
<dt><strong>bounds_error</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, a ValueError is raised any time interpolation is attempted on
a value outside of the range of x (where extrapolation is
necessary). If False, out of bounds values are assigned <cite>fill_value</cite>.
By default, an error is raised unless <code class="docutils literal notranslate"><span class="pre">fill_value=&quot;extrapolate&quot;</span></code>.</p>
</dd>
<dt><strong>fill_value</strong><span class="classifier">array-like or (array-like, array_like) or “extrapolate”, optional</span></dt><dd><ul>
<li><p>if a ndarray (or float), this value will be used to fill in for
requested points outside of the data range. If not provided, then
the default is NaN. The array-like must broadcast properly to the
dimensions of the non-interpolation axes.</p></li>
<li><p>If a two-element tuple, then the first element is used as a
fill value for <code class="docutils literal notranslate"><span class="pre">x_new</span> <span class="pre">&lt;</span> <span class="pre">x[0]</span></code> and the second element is used for
<code class="docutils literal notranslate"><span class="pre">x_new</span> <span class="pre">&gt;</span> <span class="pre">x[-1]</span></code>. Anything that is not a 2-element tuple (e.g.,
list or ndarray, regardless of shape) is taken to be a single
array-like argument meant to be used for both bounds as
<code class="docutils literal notranslate"><span class="pre">below,</span> <span class="pre">above</span> <span class="pre">=</span> <span class="pre">fill_value,</span> <span class="pre">fill_value</span></code>. Using a two-element tuple
or ndarray requires <code class="docutils literal notranslate"><span class="pre">bounds_error=False</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.17.0.</span></p>
</div>
</li>
<li><p>If “extrapolate”, then points outside the data range will be
extrapolated.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.17.0.</span></p>
</div>
</li>
</ul>
</dd>
<dt><strong>assume_sorted</strong><span class="classifier">bool, optional</span></dt><dd><p>If False, values of <cite>x</cite> can be in any order and they are sorted first.
If True, <cite>x</cite> has to be an array of monotonically increasing values.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">splrep</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">splev</span></code></dt><dd><p>Spline interpolation/smoothing based on FITPACK.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">UnivariateSpline</span></code></dt><dd><p>An object-oriented wrapper of the FITPACK routines.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">interp2d</span></code></dt><dd><p>2-D interpolation</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Calling <cite>interp1d</cite> with NaNs present in input values results in
undefined behaviour.</p>
<p>Input values <cite>x</cite> and <cite>y</cite> must be convertible to <cite>float</cite> values like
<cite>int</cite> or <cite>float</cite>.</p>
<p>If the values in <cite>x</cite> are not unique, the resulting behavior is
undefined and specific to the choice of <cite>kind</cite>, i.e., changing
<cite>kind</cite> will change the behavior for duplicates.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">interpolate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xnew</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ynew</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span>   <span class="c1"># use interpolation function returned by `interp1d`</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">xnew</span><span class="p">,</span> <span class="n">ynew</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference internal" href="#vtools.functions.tidalhours.interp1d.fill_value" title="vtools.functions.tidalhours.interp1d.fill_value"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fill_value</span></code></a></dt><dd><p>The fill value.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(x)</p></td>
<td><p>Evaluate the interpolant</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d.__dict__">
<span class="sig-name descname"><span class="pre">__dict__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">mappingproxy({'__module__':</span> <span class="pre">'scipy.interpolate._interpolate',</span> <span class="pre">'__doc__':</span> <span class="pre">'\n</span>&#160;&#160;&#160; <span class="pre">Interpolate</span> <span class="pre">a</span> <span class="pre">1-D</span> <span class="pre">function.\n\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">legacy::</span> <span class="pre">class\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">For</span> <span class="pre">a</span> <span class="pre">guide</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">intended</span> <span class="pre">replacements</span> <span class="pre">for</span> <span class="pre">`interp1d`</span> <span class="pre">see\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">:ref:`tutorial-interpolate_1Dsection`.\n\n</span>&#160;&#160;&#160; <span class="pre">`x`</span> <span class="pre">and</span> <span class="pre">`y`</span> <span class="pre">are</span> <span class="pre">arrays</span> <span class="pre">of</span> <span class="pre">values</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">approximate</span> <span class="pre">some</span> <span class="pre">function</span> <span class="pre">f:\n</span>&#160;&#160;&#160; <span class="pre">``y</span> <span class="pre">=</span> <span class="pre">f(x)``.</span> <span class="pre">This</span> <span class="pre">class</span> <span class="pre">returns</span> <span class="pre">a</span> <span class="pre">function</span> <span class="pre">whose</span> <span class="pre">call</span> <span class="pre">method</span> <span class="pre">uses\n</span>&#160;&#160;&#160; <span class="pre">interpolation</span> <span class="pre">to</span> <span class="pre">find</span> <span class="pre">the</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">new</span> <span class="pre">points.\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">x</span> <span class="pre">:</span> <span class="pre">(npoints,</span> <span class="pre">)</span> <span class="pre">array_like\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">1-D</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">real</span> <span class="pre">values.\n</span>&#160;&#160;&#160; <span class="pre">y</span> <span class="pre">:</span> <span class="pre">(...,</span> <span class="pre">npoints,</span> <span class="pre">...)</span> <span class="pre">array_like\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">N-D</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">real</span> <span class="pre">values.</span> <span class="pre">The</span> <span class="pre">length</span> <span class="pre">of</span> <span class="pre">`y`</span> <span class="pre">along</span> <span class="pre">the</span> <span class="pre">interpolation\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">axis</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">equal</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">length</span> <span class="pre">of</span> <span class="pre">`x`.</span> <span class="pre">Use</span> <span class="pre">the</span> <span class="pre">``axis``</span> <span class="pre">parameter\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">to</span> <span class="pre">select</span> <span class="pre">correct</span> <span class="pre">axis.</span> <span class="pre">Unlike</span> <span class="pre">other</span> <span class="pre">interpolators,</span> <span class="pre">the</span> <span class="pre">default\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">interpolation</span> <span class="pre">axis</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">last</span> <span class="pre">axis</span> <span class="pre">of</span> <span class="pre">`y`.\n</span>&#160;&#160;&#160; <span class="pre">kind</span> <span class="pre">:</span> <span class="pre">str</span> <span class="pre">or</span> <span class="pre">int,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Specifies</span> <span class="pre">the</span> <span class="pre">kind</span> <span class="pre">of</span> <span class="pre">interpolation</span> <span class="pre">as</span> <span class="pre">a</span> <span class="pre">string</span> <span class="pre">or</span> <span class="pre">as</span> <span class="pre">an</span> <span class="pre">integer\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">specifying</span> <span class="pre">the</span> <span class="pre">order</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">spline</span> <span class="pre">interpolator</span> <span class="pre">to</span> <span class="pre">use.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">string</span> <span class="pre">has</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">one</span> <span class="pre">of</span> <span class="pre">\'linear\',</span> <span class="pre">\'nearest\',</span> <span class="pre">\'nearest-up\',</span> <span class="pre">\'zero\',\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\'slinear\',</span> <span class="pre">\'quadratic\',</span> <span class="pre">\'cubic\',</span> <span class="pre">\'previous\',</span> <span class="pre">or</span> <span class="pre">\'next\'.</span> <span class="pre">\'zero\',\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\'slinear\',</span> <span class="pre">\'quadratic\'</span> <span class="pre">and</span> <span class="pre">\'cubic\'</span> <span class="pre">refer</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">spline</span> <span class="pre">interpolation</span> <span class="pre">of\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">zeroth,</span> <span class="pre">first,</span> <span class="pre">second</span> <span class="pre">or</span> <span class="pre">third</span> <span class="pre">order;</span> <span class="pre">\'previous\'</span> <span class="pre">and</span> <span class="pre">\'next\'</span> <span class="pre">simply\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">return</span> <span class="pre">the</span> <span class="pre">previous</span> <span class="pre">or</span> <span class="pre">next</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">point;</span> <span class="pre">\'nearest-up\'</span> <span class="pre">and\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\'nearest\'</span> <span class="pre">differ</span> <span class="pre">when</span> <span class="pre">interpolating</span> <span class="pre">half-integers</span> <span class="pre">(e.g.</span> <span class="pre">0.5,</span> <span class="pre">1.5)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">in</span> <span class="pre">that</span> <span class="pre">\'nearest-up\'</span> <span class="pre">rounds</span> <span class="pre">up</span> <span class="pre">and</span> <span class="pre">\'nearest\'</span> <span class="pre">rounds</span> <span class="pre">down.</span> <span class="pre">Default\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">is</span> <span class="pre">\'linear\'.\n</span>&#160;&#160;&#160; <span class="pre">axis</span> <span class="pre">:</span> <span class="pre">int,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Axis</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">``y``</span> <span class="pre">array</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">x-coordinate</span> <span class="pre">values.</span> <span class="pre">Unlike\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">other</span> <span class="pre">interpolators,</span> <span class="pre">defaults</span> <span class="pre">to</span> <span class="pre">``axis=-1``.\n</span>&#160;&#160;&#160; <span class="pre">copy</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">True,</span> <span class="pre">the</span> <span class="pre">class</span> <span class="pre">makes</span> <span class="pre">internal</span> <span class="pre">copies</span> <span class="pre">of</span> <span class="pre">x</span> <span class="pre">and</span> <span class="pre">y.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">False,</span> <span class="pre">references</span> <span class="pre">to</span> <span class="pre">`x`</span> <span class="pre">and</span> <span class="pre">`y`</span> <span class="pre">are</span> <span class="pre">used.</span> <span class="pre">The</span> <span class="pre">default</span> <span class="pre">is</span> <span class="pre">to</span> <span class="pre">copy.\n</span>&#160;&#160;&#160; <span class="pre">bounds_error</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">True,</span> <span class="pre">a</span> <span class="pre">ValueError</span> <span class="pre">is</span> <span class="pre">raised</span> <span class="pre">any</span> <span class="pre">time</span> <span class="pre">interpolation</span> <span class="pre">is</span> <span class="pre">attempted</span> <span class="pre">on\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">a</span> <span class="pre">value</span> <span class="pre">outside</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">range</span> <span class="pre">of</span> <span class="pre">x</span> <span class="pre">(where</span> <span class="pre">extrapolation</span> <span class="pre">is\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">necessary).</span> <span class="pre">If</span> <span class="pre">False,</span> <span class="pre">out</span> <span class="pre">of</span> <span class="pre">bounds</span> <span class="pre">values</span> <span class="pre">are</span> <span class="pre">assigned</span> <span class="pre">`fill_value`.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">By</span> <span class="pre">default,</span> <span class="pre">an</span> <span class="pre">error</span> <span class="pre">is</span> <span class="pre">raised</span> <span class="pre">unless</span> <span class="pre">``fill_value=&quot;extrapolate&quot;``.\n</span>&#160;&#160;&#160; <span class="pre">fill_value</span> <span class="pre">:</span> <span class="pre">array-like</span> <span class="pre">or</span> <span class="pre">(array-like,</span> <span class="pre">array_like)</span> <span class="pre">or</span> <span class="pre">&quot;extrapolate&quot;,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">if</span> <span class="pre">a</span> <span class="pre">ndarray</span> <span class="pre">(or</span> <span class="pre">float),</span> <span class="pre">this</span> <span class="pre">value</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">fill</span> <span class="pre">in</span> <span class="pre">for\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">requested</span> <span class="pre">points</span> <span class="pre">outside</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">range.</span> <span class="pre">If</span> <span class="pre">not</span> <span class="pre">provided,</span> <span class="pre">then\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">the</span> <span class="pre">default</span> <span class="pre">is</span> <span class="pre">NaN.</span> <span class="pre">The</span> <span class="pre">array-like</span> <span class="pre">must</span> <span class="pre">broadcast</span> <span class="pre">properly</span> <span class="pre">to</span> <span class="pre">the\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">dimensions</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">non-interpolation</span> <span class="pre">axes.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">If</span> <span class="pre">a</span> <span class="pre">two-element</span> <span class="pre">tuple,</span> <span class="pre">then</span> <span class="pre">the</span> <span class="pre">first</span> <span class="pre">element</span> <span class="pre">is</span> <span class="pre">used</span> <span class="pre">as</span> <span class="pre">a\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">fill</span> <span class="pre">value</span> <span class="pre">for</span> <span class="pre">``x_new</span> <span class="pre">&lt;</span> <span class="pre">x[0]``</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">second</span> <span class="pre">element</span> <span class="pre">is</span> <span class="pre">used</span> <span class="pre">for\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">``x_new</span> <span class="pre">&gt;</span> <span class="pre">x[-1]``.</span> <span class="pre">Anything</span> <span class="pre">that</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">a</span> <span class="pre">2-element</span> <span class="pre">tuple</span> <span class="pre">(e.g.,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">list</span> <span class="pre">or</span> <span class="pre">ndarray,</span> <span class="pre">regardless</span> <span class="pre">of</span> <span class="pre">shape)</span> <span class="pre">is</span> <span class="pre">taken</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">single\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">array-like</span> <span class="pre">argument</span> <span class="pre">meant</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">used</span> <span class="pre">for</span> <span class="pre">both</span> <span class="pre">bounds</span> <span class="pre">as\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">``below,</span> <span class="pre">above</span> <span class="pre">=</span> <span class="pre">fill_value,</span> <span class="pre">fill_value``.</span> <span class="pre">Using</span> <span class="pre">a</span> <span class="pre">two-element</span> <span class="pre">tuple\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">or</span> <span class="pre">ndarray</span> <span class="pre">requires</span> <span class="pre">``bounds_error=False``.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">0.17.0\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">If</span> <span class="pre">&quot;extrapolate&quot;,</span> <span class="pre">then</span> <span class="pre">points</span> <span class="pre">outside</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">range</span> <span class="pre">will</span> <span class="pre">be\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">extrapolated.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">0.17.0\n</span>&#160;&#160;&#160; <span class="pre">assume_sorted</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">False,</span> <span class="pre">values</span> <span class="pre">of</span> <span class="pre">`x`</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">in</span> <span class="pre">any</span> <span class="pre">order</span> <span class="pre">and</span> <span class="pre">they</span> <span class="pre">are</span> <span class="pre">sorted</span> <span class="pre">first.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">True,</span> <span class="pre">`x`</span> <span class="pre">has</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">an</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">monotonically</span> <span class="pre">increasing</span> <span class="pre">values.\n\n</span>&#160;&#160;&#160; <span class="pre">Attributes\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">fill_value\n\n</span>&#160;&#160;&#160; <span class="pre">Methods\n</span>&#160;&#160;&#160; <span class="pre">-------\n</span>&#160;&#160;&#160; <span class="pre">__call__\n\n</span>&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">Also\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">splrep,</span> <span class="pre">splev\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Spline</span> <span class="pre">interpolation/smoothing</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">FITPACK.\n</span>&#160;&#160;&#160; <span class="pre">UnivariateSpline</span> <span class="pre">:</span> <span class="pre">An</span> <span class="pre">object-oriented</span> <span class="pre">wrapper</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">FITPACK</span> <span class="pre">routines.\n</span>&#160;&#160;&#160; <span class="pre">interp2d</span> <span class="pre">:</span> <span class="pre">2-D</span> <span class="pre">interpolation\n\n</span>&#160;&#160;&#160; <span class="pre">Notes\n</span>&#160;&#160;&#160; <span class="pre">-----\n</span>&#160;&#160;&#160; <span class="pre">Calling</span> <span class="pre">`interp1d`</span> <span class="pre">with</span> <span class="pre">NaNs</span> <span class="pre">present</span> <span class="pre">in</span> <span class="pre">input</span> <span class="pre">values</span> <span class="pre">results</span> <span class="pre">in\n</span>&#160;&#160;&#160; <span class="pre">undefined</span> <span class="pre">behaviour.\n\n</span>&#160;&#160;&#160; <span class="pre">Input</span> <span class="pre">values</span> <span class="pre">`x`</span> <span class="pre">and</span> <span class="pre">`y`</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">convertible</span> <span class="pre">to</span> <span class="pre">`float`</span> <span class="pre">values</span> <span class="pre">like\n</span>&#160;&#160;&#160; <span class="pre">`int`</span> <span class="pre">or</span> <span class="pre">`float`.\n\n</span>&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">the</span> <span class="pre">values</span> <span class="pre">in</span> <span class="pre">`x`</span> <span class="pre">are</span> <span class="pre">not</span> <span class="pre">unique,</span> <span class="pre">the</span> <span class="pre">resulting</span> <span class="pre">behavior</span> <span class="pre">is\n</span>&#160;&#160;&#160; <span class="pre">undefined</span> <span class="pre">and</span> <span class="pre">specific</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">choice</span> <span class="pre">of</span> <span class="pre">`kind`,</span> <span class="pre">i.e.,</span> <span class="pre">changing\n</span>&#160;&#160;&#160; <span class="pre">`kind`</span> <span class="pre">will</span> <span class="pre">change</span> <span class="pre">the</span> <span class="pre">behavior</span> <span class="pre">for</span> <span class="pre">duplicates.\n\n\n</span>&#160;&#160;&#160; <span class="pre">Examples\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">import</span> <span class="pre">matplotlib.pyplot</span> <span class="pre">as</span> <span class="pre">plt\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">from</span> <span class="pre">scipy</span> <span class="pre">import</span> <span class="pre">interpolate\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">np.arange(0,</span> <span class="pre">10)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">np.exp(-x/3.0)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">f</span> <span class="pre">=</span> <span class="pre">interpolate.interp1d(x,</span> <span class="pre">y)\n\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">xnew</span> <span class="pre">=</span> <span class="pre">np.arange(0,</span> <span class="pre">9,</span> <span class="pre">0.1)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">ynew</span> <span class="pre">=</span> <span class="pre">f(xnew)</span>&#160;&#160; <span class="pre">#</span> <span class="pre">use</span> <span class="pre">interpolation</span> <span class="pre">function</span> <span class="pre">returned</span> <span class="pre">by</span> <span class="pre">`interp1d`\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">plt.plot(x,</span> <span class="pre">y,</span> <span class="pre">\'o\',</span> <span class="pre">xnew,</span> <span class="pre">ynew,</span> <span class="pre">\'-\')\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">plt.show()\n</span>&#160;&#160;&#160; <span class="pre">',</span> <span class="pre">'__init__':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d.__init__&gt;,</span> <span class="pre">'fill_value':</span> <span class="pre">&lt;property</span> <span class="pre">object&gt;,</span> <span class="pre">'_check_and_update_bounds_error_for_extrapolation':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._check_and_update_bounds_error_for_extrapolation&gt;,</span> <span class="pre">'_call_linear_np':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._call_linear_np&gt;,</span> <span class="pre">'_call_linear':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._call_linear&gt;,</span> <span class="pre">'_call_nearest':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._call_nearest&gt;,</span> <span class="pre">'_call_previousnext':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._call_previousnext&gt;,</span> <span class="pre">'_call_spline':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._call_spline&gt;,</span> <span class="pre">'_call_nan_spline':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._call_nan_spline&gt;,</span> <span class="pre">'_evaluate':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._evaluate&gt;,</span> <span class="pre">'_check_bounds':</span> <span class="pre">&lt;function</span> <span class="pre">interp1d._check_bounds&gt;,</span> <span class="pre">'__dict__':</span> <span class="pre">&lt;attribute</span> <span class="pre">'__dict__'</span> <span class="pre">of</span> <span class="pre">'interp1d'</span> <span class="pre">objects&gt;,</span> <span class="pre">'__weakref__':</span> <span class="pre">&lt;attribute</span> <span class="pre">'__weakref__'</span> <span class="pre">of</span> <span class="pre">'interp1d'</span> <span class="pre">objects&gt;,</span> <span class="pre">'__annotations__':</span> <span class="pre">{}})</span></em><a class="headerlink" href="#vtools.functions.tidalhours.interp1d.__dict__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'\n</span>&#160;&#160;&#160; <span class="pre">Interpolate</span> <span class="pre">a</span> <span class="pre">1-D</span> <span class="pre">function.\n\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">legacy::</span> <span class="pre">class\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">For</span> <span class="pre">a</span> <span class="pre">guide</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">intended</span> <span class="pre">replacements</span> <span class="pre">for</span> <span class="pre">`interp1d`</span> <span class="pre">see\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">:ref:`tutorial-interpolate_1Dsection`.\n\n</span>&#160;&#160;&#160; <span class="pre">`x`</span> <span class="pre">and</span> <span class="pre">`y`</span> <span class="pre">are</span> <span class="pre">arrays</span> <span class="pre">of</span> <span class="pre">values</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">approximate</span> <span class="pre">some</span> <span class="pre">function</span> <span class="pre">f:\n</span>&#160;&#160;&#160; <span class="pre">``y</span> <span class="pre">=</span> <span class="pre">f(x)``.</span> <span class="pre">This</span> <span class="pre">class</span> <span class="pre">returns</span> <span class="pre">a</span> <span class="pre">function</span> <span class="pre">whose</span> <span class="pre">call</span> <span class="pre">method</span> <span class="pre">uses\n</span>&#160;&#160;&#160; <span class="pre">interpolation</span> <span class="pre">to</span> <span class="pre">find</span> <span class="pre">the</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">new</span> <span class="pre">points.\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">x</span> <span class="pre">:</span> <span class="pre">(npoints,</span> <span class="pre">)</span> <span class="pre">array_like\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">1-D</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">real</span> <span class="pre">values.\n</span>&#160;&#160;&#160; <span class="pre">y</span> <span class="pre">:</span> <span class="pre">(...,</span> <span class="pre">npoints,</span> <span class="pre">...)</span> <span class="pre">array_like\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">N-D</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">real</span> <span class="pre">values.</span> <span class="pre">The</span> <span class="pre">length</span> <span class="pre">of</span> <span class="pre">`y`</span> <span class="pre">along</span> <span class="pre">the</span> <span class="pre">interpolation\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">axis</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">equal</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">length</span> <span class="pre">of</span> <span class="pre">`x`.</span> <span class="pre">Use</span> <span class="pre">the</span> <span class="pre">``axis``</span> <span class="pre">parameter\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">to</span> <span class="pre">select</span> <span class="pre">correct</span> <span class="pre">axis.</span> <span class="pre">Unlike</span> <span class="pre">other</span> <span class="pre">interpolators,</span> <span class="pre">the</span> <span class="pre">default\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">interpolation</span> <span class="pre">axis</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">last</span> <span class="pre">axis</span> <span class="pre">of</span> <span class="pre">`y`.\n</span>&#160;&#160;&#160; <span class="pre">kind</span> <span class="pre">:</span> <span class="pre">str</span> <span class="pre">or</span> <span class="pre">int,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Specifies</span> <span class="pre">the</span> <span class="pre">kind</span> <span class="pre">of</span> <span class="pre">interpolation</span> <span class="pre">as</span> <span class="pre">a</span> <span class="pre">string</span> <span class="pre">or</span> <span class="pre">as</span> <span class="pre">an</span> <span class="pre">integer\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">specifying</span> <span class="pre">the</span> <span class="pre">order</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">spline</span> <span class="pre">interpolator</span> <span class="pre">to</span> <span class="pre">use.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">string</span> <span class="pre">has</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">one</span> <span class="pre">of</span> <span class="pre">\'linear\',</span> <span class="pre">\'nearest\',</span> <span class="pre">\'nearest-up\',</span> <span class="pre">\'zero\',\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\'slinear\',</span> <span class="pre">\'quadratic\',</span> <span class="pre">\'cubic\',</span> <span class="pre">\'previous\',</span> <span class="pre">or</span> <span class="pre">\'next\'.</span> <span class="pre">\'zero\',\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\'slinear\',</span> <span class="pre">\'quadratic\'</span> <span class="pre">and</span> <span class="pre">\'cubic\'</span> <span class="pre">refer</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">spline</span> <span class="pre">interpolation</span> <span class="pre">of\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">zeroth,</span> <span class="pre">first,</span> <span class="pre">second</span> <span class="pre">or</span> <span class="pre">third</span> <span class="pre">order;</span> <span class="pre">\'previous\'</span> <span class="pre">and</span> <span class="pre">\'next\'</span> <span class="pre">simply\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">return</span> <span class="pre">the</span> <span class="pre">previous</span> <span class="pre">or</span> <span class="pre">next</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">point;</span> <span class="pre">\'nearest-up\'</span> <span class="pre">and\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\'nearest\'</span> <span class="pre">differ</span> <span class="pre">when</span> <span class="pre">interpolating</span> <span class="pre">half-integers</span> <span class="pre">(e.g.</span> <span class="pre">0.5,</span> <span class="pre">1.5)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">in</span> <span class="pre">that</span> <span class="pre">\'nearest-up\'</span> <span class="pre">rounds</span> <span class="pre">up</span> <span class="pre">and</span> <span class="pre">\'nearest\'</span> <span class="pre">rounds</span> <span class="pre">down.</span> <span class="pre">Default\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">is</span> <span class="pre">\'linear\'.\n</span>&#160;&#160;&#160; <span class="pre">axis</span> <span class="pre">:</span> <span class="pre">int,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Axis</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">``y``</span> <span class="pre">array</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">x-coordinate</span> <span class="pre">values.</span> <span class="pre">Unlike\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">other</span> <span class="pre">interpolators,</span> <span class="pre">defaults</span> <span class="pre">to</span> <span class="pre">``axis=-1``.\n</span>&#160;&#160;&#160; <span class="pre">copy</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">True,</span> <span class="pre">the</span> <span class="pre">class</span> <span class="pre">makes</span> <span class="pre">internal</span> <span class="pre">copies</span> <span class="pre">of</span> <span class="pre">x</span> <span class="pre">and</span> <span class="pre">y.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">False,</span> <span class="pre">references</span> <span class="pre">to</span> <span class="pre">`x`</span> <span class="pre">and</span> <span class="pre">`y`</span> <span class="pre">are</span> <span class="pre">used.</span> <span class="pre">The</span> <span class="pre">default</span> <span class="pre">is</span> <span class="pre">to</span> <span class="pre">copy.\n</span>&#160;&#160;&#160; <span class="pre">bounds_error</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">True,</span> <span class="pre">a</span> <span class="pre">ValueError</span> <span class="pre">is</span> <span class="pre">raised</span> <span class="pre">any</span> <span class="pre">time</span> <span class="pre">interpolation</span> <span class="pre">is</span> <span class="pre">attempted</span> <span class="pre">on\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">a</span> <span class="pre">value</span> <span class="pre">outside</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">range</span> <span class="pre">of</span> <span class="pre">x</span> <span class="pre">(where</span> <span class="pre">extrapolation</span> <span class="pre">is\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">necessary).</span> <span class="pre">If</span> <span class="pre">False,</span> <span class="pre">out</span> <span class="pre">of</span> <span class="pre">bounds</span> <span class="pre">values</span> <span class="pre">are</span> <span class="pre">assigned</span> <span class="pre">`fill_value`.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">By</span> <span class="pre">default,</span> <span class="pre">an</span> <span class="pre">error</span> <span class="pre">is</span> <span class="pre">raised</span> <span class="pre">unless</span> <span class="pre">``fill_value=&quot;extrapolate&quot;``.\n</span>&#160;&#160;&#160; <span class="pre">fill_value</span> <span class="pre">:</span> <span class="pre">array-like</span> <span class="pre">or</span> <span class="pre">(array-like,</span> <span class="pre">array_like)</span> <span class="pre">or</span> <span class="pre">&quot;extrapolate&quot;,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">if</span> <span class="pre">a</span> <span class="pre">ndarray</span> <span class="pre">(or</span> <span class="pre">float),</span> <span class="pre">this</span> <span class="pre">value</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">fill</span> <span class="pre">in</span> <span class="pre">for\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">requested</span> <span class="pre">points</span> <span class="pre">outside</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">range.</span> <span class="pre">If</span> <span class="pre">not</span> <span class="pre">provided,</span> <span class="pre">then\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">the</span> <span class="pre">default</span> <span class="pre">is</span> <span class="pre">NaN.</span> <span class="pre">The</span> <span class="pre">array-like</span> <span class="pre">must</span> <span class="pre">broadcast</span> <span class="pre">properly</span> <span class="pre">to</span> <span class="pre">the\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">dimensions</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">non-interpolation</span> <span class="pre">axes.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">If</span> <span class="pre">a</span> <span class="pre">two-element</span> <span class="pre">tuple,</span> <span class="pre">then</span> <span class="pre">the</span> <span class="pre">first</span> <span class="pre">element</span> <span class="pre">is</span> <span class="pre">used</span> <span class="pre">as</span> <span class="pre">a\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">fill</span> <span class="pre">value</span> <span class="pre">for</span> <span class="pre">``x_new</span> <span class="pre">&lt;</span> <span class="pre">x[0]``</span> <span class="pre">and</span> <span class="pre">the</span> <span class="pre">second</span> <span class="pre">element</span> <span class="pre">is</span> <span class="pre">used</span> <span class="pre">for\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">``x_new</span> <span class="pre">&gt;</span> <span class="pre">x[-1]``.</span> <span class="pre">Anything</span> <span class="pre">that</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">a</span> <span class="pre">2-element</span> <span class="pre">tuple</span> <span class="pre">(e.g.,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">list</span> <span class="pre">or</span> <span class="pre">ndarray,</span> <span class="pre">regardless</span> <span class="pre">of</span> <span class="pre">shape)</span> <span class="pre">is</span> <span class="pre">taken</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">single\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">array-like</span> <span class="pre">argument</span> <span class="pre">meant</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">used</span> <span class="pre">for</span> <span class="pre">both</span> <span class="pre">bounds</span> <span class="pre">as\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">``below,</span> <span class="pre">above</span> <span class="pre">=</span> <span class="pre">fill_value,</span> <span class="pre">fill_value``.</span> <span class="pre">Using</span> <span class="pre">a</span> <span class="pre">two-element</span> <span class="pre">tuple\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">or</span> <span class="pre">ndarray</span> <span class="pre">requires</span> <span class="pre">``bounds_error=False``.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">0.17.0\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-</span> <span class="pre">If</span> <span class="pre">&quot;extrapolate&quot;,</span> <span class="pre">then</span> <span class="pre">points</span> <span class="pre">outside</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">range</span> <span class="pre">will</span> <span class="pre">be\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">extrapolated.\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">versionadded::</span> <span class="pre">0.17.0\n</span>&#160;&#160;&#160; <span class="pre">assume_sorted</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">False,</span> <span class="pre">values</span> <span class="pre">of</span> <span class="pre">`x`</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">in</span> <span class="pre">any</span> <span class="pre">order</span> <span class="pre">and</span> <span class="pre">they</span> <span class="pre">are</span> <span class="pre">sorted</span> <span class="pre">first.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">True,</span> <span class="pre">`x`</span> <span class="pre">has</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">an</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">monotonically</span> <span class="pre">increasing</span> <span class="pre">values.\n\n</span>&#160;&#160;&#160; <span class="pre">Attributes\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">fill_value\n\n</span>&#160;&#160;&#160; <span class="pre">Methods\n</span>&#160;&#160;&#160; <span class="pre">-------\n</span>&#160;&#160;&#160; <span class="pre">__call__\n\n</span>&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">Also\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">splrep,</span> <span class="pre">splev\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Spline</span> <span class="pre">interpolation/smoothing</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">FITPACK.\n</span>&#160;&#160;&#160; <span class="pre">UnivariateSpline</span> <span class="pre">:</span> <span class="pre">An</span> <span class="pre">object-oriented</span> <span class="pre">wrapper</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">FITPACK</span> <span class="pre">routines.\n</span>&#160;&#160;&#160; <span class="pre">interp2d</span> <span class="pre">:</span> <span class="pre">2-D</span> <span class="pre">interpolation\n\n</span>&#160;&#160;&#160; <span class="pre">Notes\n</span>&#160;&#160;&#160; <span class="pre">-----\n</span>&#160;&#160;&#160; <span class="pre">Calling</span> <span class="pre">`interp1d`</span> <span class="pre">with</span> <span class="pre">NaNs</span> <span class="pre">present</span> <span class="pre">in</span> <span class="pre">input</span> <span class="pre">values</span> <span class="pre">results</span> <span class="pre">in\n</span>&#160;&#160;&#160; <span class="pre">undefined</span> <span class="pre">behaviour.\n\n</span>&#160;&#160;&#160; <span class="pre">Input</span> <span class="pre">values</span> <span class="pre">`x`</span> <span class="pre">and</span> <span class="pre">`y`</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">convertible</span> <span class="pre">to</span> <span class="pre">`float`</span> <span class="pre">values</span> <span class="pre">like\n</span>&#160;&#160;&#160; <span class="pre">`int`</span> <span class="pre">or</span> <span class="pre">`float`.\n\n</span>&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">the</span> <span class="pre">values</span> <span class="pre">in</span> <span class="pre">`x`</span> <span class="pre">are</span> <span class="pre">not</span> <span class="pre">unique,</span> <span class="pre">the</span> <span class="pre">resulting</span> <span class="pre">behavior</span> <span class="pre">is\n</span>&#160;&#160;&#160; <span class="pre">undefined</span> <span class="pre">and</span> <span class="pre">specific</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">choice</span> <span class="pre">of</span> <span class="pre">`kind`,</span> <span class="pre">i.e.,</span> <span class="pre">changing\n</span>&#160;&#160;&#160; <span class="pre">`kind`</span> <span class="pre">will</span> <span class="pre">change</span> <span class="pre">the</span> <span class="pre">behavior</span> <span class="pre">for</span> <span class="pre">duplicates.\n\n\n</span>&#160;&#160;&#160; <span class="pre">Examples\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">import</span> <span class="pre">matplotlib.pyplot</span> <span class="pre">as</span> <span class="pre">plt\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">from</span> <span class="pre">scipy</span> <span class="pre">import</span> <span class="pre">interpolate\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">np.arange(0,</span> <span class="pre">10)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">np.exp(-x/3.0)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">f</span> <span class="pre">=</span> <span class="pre">interpolate.interp1d(x,</span> <span class="pre">y)\n\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">xnew</span> <span class="pre">=</span> <span class="pre">np.arange(0,</span> <span class="pre">9,</span> <span class="pre">0.1)\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">ynew</span> <span class="pre">=</span> <span class="pre">f(xnew)</span>&#160;&#160; <span class="pre">#</span> <span class="pre">use</span> <span class="pre">interpolation</span> <span class="pre">function</span> <span class="pre">returned</span> <span class="pre">by</span> <span class="pre">`interp1d`\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">plt.plot(x,</span> <span class="pre">y,</span> <span class="pre">\'o\',</span> <span class="pre">xnew,</span> <span class="pre">ynew,</span> <span class="pre">\'-\')\n</span>&#160;&#160;&#160; <span class="pre">&gt;&gt;&gt;</span> <span class="pre">plt.show()\n</span>&#160;&#160;&#160; <span class="pre">'</span></em><a class="headerlink" href="#vtools.functions.tidalhours.interp1d.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_sorted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize a 1-D linear interpolation class.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'scipy.interpolate._interpolate'</span></em><a class="headerlink" href="#vtools.functions.tidalhours.interp1d.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d.__weakref__">
<span class="sig-name descname"><span class="pre">__weakref__</span></span><a class="headerlink" href="#vtools.functions.tidalhours.interp1d.__weakref__" title="Link to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._call_linear">
<span class="sig-name descname"><span class="pre">_call_linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._call_linear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._call_linear" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._call_linear_np">
<span class="sig-name descname"><span class="pre">_call_linear_np</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._call_linear_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._call_linear_np" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._call_nan_spline">
<span class="sig-name descname"><span class="pre">_call_nan_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._call_nan_spline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._call_nan_spline" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._call_nearest">
<span class="sig-name descname"><span class="pre">_call_nearest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._call_nearest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._call_nearest" title="Link to this definition">¶</a></dt>
<dd><p>Find nearest neighbor interpolated y_new = f(x_new).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._call_previousnext">
<span class="sig-name descname"><span class="pre">_call_previousnext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._call_previousnext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._call_previousnext" title="Link to this definition">¶</a></dt>
<dd><p>Use previous/next neighbor of x_new, y_new = f(x_new).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._call_spline">
<span class="sig-name descname"><span class="pre">_call_spline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._call_spline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._call_spline" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._check_and_update_bounds_error_for_extrapolation">
<span class="sig-name descname"><span class="pre">_check_and_update_bounds_error_for_extrapolation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._check_and_update_bounds_error_for_extrapolation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._check_and_update_bounds_error_for_extrapolation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._check_bounds">
<span class="sig-name descname"><span class="pre">_check_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._check_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._check_bounds" title="Link to this definition">¶</a></dt>
<dd><p>Check the inputs for being in the bounds of the interpolated data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x_new</strong><span class="classifier">array</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>out_of_bounds</strong><span class="classifier">bool array</span></dt><dd><p>The mask on x_new of values that are out of the bounds.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._evaluate">
<span class="sig-name descname"><span class="pre">_evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_interpolate.html#interp1d._evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._evaluate" title="Link to this definition">¶</a></dt>
<dd><p>Actually evaluate the value of the interpolator.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._y_axis">
<span class="sig-name descname"><span class="pre">_y_axis</span></span><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._y_axis" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d._y_extra_shape">
<span class="sig-name descname"><span class="pre">_y_extra_shape</span></span><a class="headerlink" href="#vtools.functions.tidalhours.interp1d._y_extra_shape" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d.dtype">
<span class="sig-name descname"><span class="pre">dtype</span></span><a class="headerlink" href="#vtools.functions.tidalhours.interp1d.dtype" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.interp1d.fill_value">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fill_value</span></span><a class="headerlink" href="#vtools.functions.tidalhours.interp1d.fill_value" title="Link to this definition">¶</a></dt>
<dd><p>The fill value.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.tidal_hour_signal">
<span class="sig-name descname"><span class="pre">tidal_hour_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/tidalhours.html#tidal_hour_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.tidal_hour_signal" title="Link to this definition">¶</a></dt>
<dd><p>Compute the tidal hour of a semidiurnal signal.</p>
<p>This function returns the instantaneous phase-based tidal hour for a time series,
assuming a semidiurnal signal. Optionally applies a cosine Lanczos low-pass
filter (e.g., 40h) to isolate tidal components from subtidal or noisy fluctuations.</p>
<p>The tidal hour is computed using the phase of the analytic signal obtained
via the Hilbert transform. This phase is then scaled to range from 0 to 12 hours
to represent one semidiurnal tidal cycle. The output is a pandas Series aligned
with the input time index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts</strong><span class="classifier">pandas.Series</span></dt><dd><p>Time series of water level or other semidiurnal signal. Must have a datetime index.</p>
</dd>
<dt><strong>filter</strong><span class="classifier">bool, default True</span></dt><dd><p>Whether to apply a 40-hour cosine Lanczos filter to the input signal. If False,
uses the raw signal.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.Series</dt><dd><p>Tidal hour as a float (range [0, 12)), indexed by datetime.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#vtools.functions.tidalhours.diff_h" title="vtools.functions.tidalhours.diff_h"><code class="xref py py-obj docutils literal notranslate"><span class="pre">diff_h</span></code></a></dt><dd><p>Compute the derivative (rate of change) of tidal hour.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">cosine_lanczos</span></code></dt><dd><p>External function used to apply low-pass filtering.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The tidal hour is derived from the instantaneous phase of the analytic signal.
This signal is computed as:</p>
<blockquote>
<div><p><cite>analytic_signal = ts + 1j * hilbert(ts)</cite></p>
</div></blockquote>
<p>The phase (angle) of this complex signal varies smoothly over time and reflects
the oscillatory nature of the tide, allowing us to construct a continuous
representation of “tidal time” even between extrema.</p>
<p>The use of the Hilbert transform provides a smooth interpolation of the signal’s
phase progression, since it yields the narrow-band envelope and instantaneous phase
of the dominant frequency component (assumed to be semidiurnal here).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.tidalhours.tidal_hour_signal2">
<span class="sig-name descname"><span class="pre">tidal_hour_signal2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.2)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v2.3.2)"><span class="pre">Series</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.2)"><span class="pre">DataFrame</span></a></span></span><a class="reference internal" href="_modules/vtools/functions/tidalhours.html#tidal_hour_signal2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.tidalhours.tidal_hour_signal2" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the tidal hour from a semidiurnal tidal signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts</strong><span class="classifier">pd.Series or pd.DataFrame</span></dt><dd><p>Input time series of water levels (must have datetime index)</p>
</dd>
<dt><strong>filter</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, apply Lanczos filter to remove low-frequency components (default True)
Note this is opposite of ‘leave_mean’ in original implementation</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pd.Series or pd.DataFrame</dt><dd><p>Tidal hour in datetime format (same shape as input)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The tidal hour represents the phase of the semidiurnal tide in temporal units.
The calculation uses complex interpolation for smooth phase estimation:
1. The Hilbert transform creates an analytic signal
2. The angle gives the instantaneous phase
3. Complex interpolation avoids phase jumps at 0/2π boundaries
4. This provides continuous phase evolution even during slack tides</p>
<p>If h/u distinction is needed, consider applying <cite>diff_h</cite> to separate
flood/ebb phases. The derivative was likely included in original code
to identify phase reversals during tidal current analysis.</p>
</dd></dl>

</section>
<section id="module-vtools.functions.transition">
<span id="vtools-functions-transition-module"></span><h2>vtools.functions.transition module<a class="headerlink" href="#module-vtools.functions.transition" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PchipInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_cubic.html#PchipInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">CubicHermiteSpline</span></code></p>
<p>PCHIP 1-D monotonic cubic interpolation.</p>
<p><code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are arrays of values used to approximate some function f,
with <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">f(x)</span></code>. The interpolant uses monotonic cubic splines
to find the value of new points. (PCHIP stands for Piecewise Cubic
Hermite Interpolating Polynomial).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">ndarray, shape (npoints, )</span></dt><dd><p>A 1-D array of monotonically increasing real values. <code class="docutils literal notranslate"><span class="pre">x</span></code> cannot
include duplicate values (otherwise f is overspecified)</p>
</dd>
<dt><strong>y</strong><span class="classifier">ndarray, shape (…, npoints, …)</span></dt><dd><p>A N-D array of real values. <code class="docutils literal notranslate"><span class="pre">y</span></code>’s length along the interpolation
axis must be equal to the length of <code class="docutils literal notranslate"><span class="pre">x</span></code>. Use the <code class="docutils literal notranslate"><span class="pre">axis</span></code>
parameter to select the interpolation axis.</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>Axis in the <code class="docutils literal notranslate"><span class="pre">y</span></code> array corresponding to the x-coordinate values. Defaults
to <code class="docutils literal notranslate"><span class="pre">axis=0</span></code>.</p>
</dd>
<dt><strong>extrapolate</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to extrapolate to out-of-bounds points based on first
and last intervals, or to return NaNs.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">CubicHermiteSpline</span></code></dt><dd><p>Piecewise-cubic interpolator.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Akima1DInterpolator</span></code></dt><dd><p>Akima 1D interpolator.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">CubicSpline</span></code></dt><dd><p>Cubic spline data interpolator.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">PPoly</span></code></dt><dd><p>Piecewise polynomial in terms of coefficients and breakpoints.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The interpolator preserves monotonicity in the interpolation data and does
not overshoot if the data is not smooth.</p>
<p>The first derivatives are guaranteed to be continuous, but the second
derivatives may jump at <span class="math notranslate nohighlight">\(x_k\)</span>.</p>
<p>Determines the derivatives at the points <span class="math notranslate nohighlight">\(x_k\)</span>, <span class="math notranslate nohighlight">\(f'_k\)</span>,
by using PCHIP algorithm <a class="reference internal" href="#r22ca1057234e-1" id="id19">[1]</a>.</p>
<p>Let <span class="math notranslate nohighlight">\(h_k = x_{k+1} - x_k\)</span>, and  <span class="math notranslate nohighlight">\(d_k = (y_{k+1} - y_k) / h_k\)</span>
are the slopes at internal points <span class="math notranslate nohighlight">\(x_k\)</span>.
If the signs of <span class="math notranslate nohighlight">\(d_k\)</span> and <span class="math notranslate nohighlight">\(d_{k-1}\)</span> are different or either of
them equals zero, then <span class="math notranslate nohighlight">\(f'_k = 0\)</span>. Otherwise, it is given by the
weighted harmonic mean</p>
<div class="math notranslate nohighlight">
\[\frac{w_1 + w_2}{f'_k} = \frac{w_1}{d_{k-1}} + \frac{w_2}{d_k}\]</div>
<p>where <span class="math notranslate nohighlight">\(w_1 = 2 h_k + h_{k-1}\)</span> and <span class="math notranslate nohighlight">\(w_2 = h_k + 2 h_{k-1}\)</span>.</p>
<p>The end slopes are set using a one-sided scheme <a class="reference internal" href="#r22ca1057234e-2" id="id20">[2]</a>.</p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="r22ca1057234e-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id19">1</a><span class="fn-bracket">]</span></span>
<p>F. N. Fritsch and J. Butland,
A method for constructing local
monotone piecewise cubic interpolants,
SIAM J. Sci. Comput., 5(2), 300-304 (1984).
<a href="#id21"><span class="problematic" id="id22">:doi:`10.1137/0905021`</span></a>.</p>
</div>
<div class="citation" id="r22ca1057234e-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id20">2</a><span class="fn-bracket">]</span></span>
<p>see, e.g., C. Moler, Numerical Computing with Matlab, 2004.
<a href="#id23"><span class="problematic" id="id24">:doi:`10.1137/1.9780898717952`</span></a></p>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>axis</strong></dt><dd></dd>
<dt><strong>c</strong></dt><dd></dd>
<dt><strong>extrapolate</strong></dt><dd></dd>
<dt><strong>x</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(x[, nu, extrapolate])</p></td>
<td><p>Evaluate the piecewise polynomial or its derivative.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">derivative</span></code>([nu])</p></td>
<td><p>Construct a new piecewise polynomial representing the derivative.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">antiderivative</span></code>([nu])</p></td>
<td><p>Construct a new piecewise polynomial representing the antiderivative.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">roots</span></code>([discontinuity, extrapolate])</p></td>
<td><p>Find real roots of the piecewise polynomial.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator.__annotations__">
<span class="sig-name descname"><span class="pre">__annotations__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator.__annotations__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator.__doc__">
<span class="sig-name descname"><span class="pre">__doc__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&quot;PCHIP</span> <span class="pre">1-D</span> <span class="pre">monotonic</span> <span class="pre">cubic</span> <span class="pre">interpolation.\n\n</span>&#160;&#160;&#160; <span class="pre">``x``</span> <span class="pre">and</span> <span class="pre">``y``</span> <span class="pre">are</span> <span class="pre">arrays</span> <span class="pre">of</span> <span class="pre">values</span> <span class="pre">used</span> <span class="pre">to</span> <span class="pre">approximate</span> <span class="pre">some</span> <span class="pre">function</span> <span class="pre">f,\n</span>&#160;&#160;&#160; <span class="pre">with</span> <span class="pre">``y</span> <span class="pre">=</span> <span class="pre">f(x)``.</span> <span class="pre">The</span> <span class="pre">interpolant</span> <span class="pre">uses</span> <span class="pre">monotonic</span> <span class="pre">cubic</span> <span class="pre">splines\n</span>&#160;&#160;&#160; <span class="pre">to</span> <span class="pre">find</span> <span class="pre">the</span> <span class="pre">value</span> <span class="pre">of</span> <span class="pre">new</span> <span class="pre">points.</span> <span class="pre">(PCHIP</span> <span class="pre">stands</span> <span class="pre">for</span> <span class="pre">Piecewise</span> <span class="pre">Cubic\n</span>&#160;&#160;&#160; <span class="pre">Hermite</span> <span class="pre">Interpolating</span> <span class="pre">Polynomial).\n\n</span>&#160;&#160;&#160; <span class="pre">Parameters\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">x</span> <span class="pre">:</span> <span class="pre">ndarray,</span> <span class="pre">shape</span> <span class="pre">(npoints,</span> <span class="pre">)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">1-D</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">monotonically</span> <span class="pre">increasing</span> <span class="pre">real</span> <span class="pre">values.</span> <span class="pre">``x``</span> <span class="pre">cannot\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">include</span> <span class="pre">duplicate</span> <span class="pre">values</span> <span class="pre">(otherwise</span> <span class="pre">f</span> <span class="pre">is</span> <span class="pre">overspecified)\n</span>&#160;&#160;&#160; <span class="pre">y</span> <span class="pre">:</span> <span class="pre">ndarray,</span> <span class="pre">shape</span> <span class="pre">(...,</span> <span class="pre">npoints,</span> <span class="pre">...)\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">N-D</span> <span class="pre">array</span> <span class="pre">of</span> <span class="pre">real</span> <span class="pre">values.</span> <span class="pre">``y``'s</span> <span class="pre">length</span> <span class="pre">along</span> <span class="pre">the</span> <span class="pre">interpolation\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">axis</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">equal</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">length</span> <span class="pre">of</span> <span class="pre">``x``.</span> <span class="pre">Use</span> <span class="pre">the</span> <span class="pre">``axis``\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">parameter</span> <span class="pre">to</span> <span class="pre">select</span> <span class="pre">the</span> <span class="pre">interpolation</span> <span class="pre">axis.\n</span>&#160;&#160;&#160; <span class="pre">axis</span> <span class="pre">:</span> <span class="pre">int,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Axis</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">``y``</span> <span class="pre">array</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">x-coordinate</span> <span class="pre">values.</span> <span class="pre">Defaults\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">to</span> <span class="pre">``axis=0``.\n</span>&#160;&#160;&#160; <span class="pre">extrapolate</span> <span class="pre">:</span> <span class="pre">bool,</span> <span class="pre">optional\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">Whether</span> <span class="pre">to</span> <span class="pre">extrapolate</span> <span class="pre">to</span> <span class="pre">out-of-bounds</span> <span class="pre">points</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">first\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">and</span> <span class="pre">last</span> <span class="pre">intervals,</span> <span class="pre">or</span> <span class="pre">to</span> <span class="pre">return</span> <span class="pre">NaNs.\n\n</span>&#160;&#160;&#160; <span class="pre">Methods\n</span>&#160;&#160;&#160; <span class="pre">-------\n</span>&#160;&#160;&#160; <span class="pre">__call__\n</span>&#160;&#160;&#160; <span class="pre">derivative\n</span>&#160;&#160;&#160; <span class="pre">antiderivative\n</span>&#160;&#160;&#160; <span class="pre">roots\n\n</span>&#160;&#160;&#160; <span class="pre">See</span> <span class="pre">Also\n</span>&#160;&#160;&#160; <span class="pre">--------\n</span>&#160;&#160;&#160; <span class="pre">CubicHermiteSpline</span> <span class="pre">:</span> <span class="pre">Piecewise-cubic</span> <span class="pre">interpolator.\n</span>&#160;&#160;&#160; <span class="pre">Akima1DInterpolator</span> <span class="pre">:</span> <span class="pre">Akima</span> <span class="pre">1D</span> <span class="pre">interpolator.\n</span>&#160;&#160;&#160; <span class="pre">CubicSpline</span> <span class="pre">:</span> <span class="pre">Cubic</span> <span class="pre">spline</span> <span class="pre">data</span> <span class="pre">interpolator.\n</span>&#160;&#160;&#160; <span class="pre">PPoly</span> <span class="pre">:</span> <span class="pre">Piecewise</span> <span class="pre">polynomial</span> <span class="pre">in</span> <span class="pre">terms</span> <span class="pre">of</span> <span class="pre">coefficients</span> <span class="pre">and</span> <span class="pre">breakpoints.\n\n</span>&#160;&#160;&#160; <span class="pre">Notes\n</span>&#160;&#160;&#160; <span class="pre">-----\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">interpolator</span> <span class="pre">preserves</span> <span class="pre">monotonicity</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">interpolation</span> <span class="pre">data</span> <span class="pre">and</span> <span class="pre">does\n</span>&#160;&#160;&#160; <span class="pre">not</span> <span class="pre">overshoot</span> <span class="pre">if</span> <span class="pre">the</span> <span class="pre">data</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">smooth.\n\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">first</span> <span class="pre">derivatives</span> <span class="pre">are</span> <span class="pre">guaranteed</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">continuous,</span> <span class="pre">but</span> <span class="pre">the</span> <span class="pre">second\n</span>&#160;&#160;&#160; <span class="pre">derivatives</span> <span class="pre">may</span> <span class="pre">jump</span> <span class="pre">at</span> <span class="pre">:math:`x_k`.\n\n</span>&#160;&#160;&#160; <span class="pre">Determines</span> <span class="pre">the</span> <span class="pre">derivatives</span> <span class="pre">at</span> <span class="pre">the</span> <span class="pre">points</span> <span class="pre">:math:`x_k`,</span> <span class="pre">:math:`f'_k`,\n</span>&#160;&#160;&#160; <span class="pre">by</span> <span class="pre">using</span> <span class="pre">PCHIP</span> <span class="pre">algorithm</span> <span class="pre">[1]_.\n\n</span>&#160;&#160;&#160; <span class="pre">Let</span> <span class="pre">:math:`h_k</span> <span class="pre">=</span> <span class="pre">x_{k+1}</span> <span class="pre">-</span> <span class="pre">x_k`,</span> <span class="pre">and</span>&#160; <span class="pre">:math:`d_k</span> <span class="pre">=</span> <span class="pre">(y_{k+1}</span> <span class="pre">-</span> <span class="pre">y_k)</span> <span class="pre">/</span> <span class="pre">h_k`\n</span>&#160;&#160;&#160; <span class="pre">are</span> <span class="pre">the</span> <span class="pre">slopes</span> <span class="pre">at</span> <span class="pre">internal</span> <span class="pre">points</span> <span class="pre">:math:`x_k`.\n</span>&#160;&#160;&#160; <span class="pre">If</span> <span class="pre">the</span> <span class="pre">signs</span> <span class="pre">of</span> <span class="pre">:math:`d_k`</span> <span class="pre">and</span> <span class="pre">:math:`d_{k-1}`</span> <span class="pre">are</span> <span class="pre">different</span> <span class="pre">or</span> <span class="pre">either</span> <span class="pre">of\n</span>&#160;&#160;&#160; <span class="pre">them</span> <span class="pre">equals</span> <span class="pre">zero,</span> <span class="pre">then</span> <span class="pre">:math:`f'_k</span> <span class="pre">=</span> <span class="pre">0`.</span> <span class="pre">Otherwise,</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">given</span> <span class="pre">by</span> <span class="pre">the\n</span>&#160;&#160;&#160; <span class="pre">weighted</span> <span class="pre">harmonic</span> <span class="pre">mean\n\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">math::\n\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\\frac{w_1</span> <span class="pre">+</span> <span class="pre">w_2}{f'_k}</span> <span class="pre">=</span> <span class="pre">\\frac{w_1}{d_{k-1}}</span> <span class="pre">+</span> <span class="pre">\\frac{w_2}{d_k}\n\n</span>&#160;&#160;&#160; <span class="pre">where</span> <span class="pre">:math:`w_1</span> <span class="pre">=</span> <span class="pre">2</span> <span class="pre">h_k</span> <span class="pre">+</span> <span class="pre">h_{k-1}`</span> <span class="pre">and</span> <span class="pre">:math:`w_2</span> <span class="pre">=</span> <span class="pre">h_k</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">h_{k-1}`.\n\n</span>&#160;&#160;&#160; <span class="pre">The</span> <span class="pre">end</span> <span class="pre">slopes</span> <span class="pre">are</span> <span class="pre">set</span> <span class="pre">using</span> <span class="pre">a</span> <span class="pre">one-sided</span> <span class="pre">scheme</span> <span class="pre">[2]_.\n\n\n</span>&#160;&#160;&#160; <span class="pre">References\n</span>&#160;&#160;&#160; <span class="pre">----------\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">[1]</span> <span class="pre">F.</span> <span class="pre">N.</span> <span class="pre">Fritsch</span> <span class="pre">and</span> <span class="pre">J.</span> <span class="pre">Butland,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">A</span> <span class="pre">method</span> <span class="pre">for</span> <span class="pre">constructing</span> <span class="pre">local\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">monotone</span> <span class="pre">piecewise</span> <span class="pre">cubic</span> <span class="pre">interpolants,\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">SIAM</span> <span class="pre">J.</span> <span class="pre">Sci.</span> <span class="pre">Comput.,</span> <span class="pre">5(2),</span> <span class="pre">300-304</span> <span class="pre">(1984).\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">:doi:`10.1137/0905021`.\n</span>&#160;&#160;&#160; <span class="pre">..</span> <span class="pre">[2]</span> <span class="pre">see,</span> <span class="pre">e.g.,</span> <span class="pre">C.</span> <span class="pre">Moler,</span> <span class="pre">Numerical</span> <span class="pre">Computing</span> <span class="pre">with</span> <span class="pre">Matlab,</span> <span class="pre">2004.\n</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">:doi:`10.1137/1.9780898717952`\n\n</span>&#160;&#160;&#160; <span class="pre">&quot;</span></em><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator.__doc__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_cubic.html#PchipInterpolator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator.__init__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator.__module__">
<span class="sig-name descname"><span class="pre">__module__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'scipy.interpolate._cubic'</span></em><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator.__module__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator._edge_case">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_edge_case</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_cubic.html#PchipInterpolator._edge_case"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator._edge_case" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator._find_derivatives">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_find_derivatives</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scipy/interpolate/_cubic.html#PchipInterpolator._find_derivatives"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator._find_derivatives" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator.axis">
<span class="sig-name descname"><span class="pre">axis</span></span><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator.axis" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator.c">
<span class="sig-name descname"><span class="pre">c</span></span><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator.c" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator.extrapolate">
<span class="sig-name descname"><span class="pre">extrapolate</span></span><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator.extrapolate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="vtools.functions.transition.PchipInterpolator.x">
<span class="sig-name descname"><span class="pre">x</span></span><a class="headerlink" href="#vtools.functions.transition.PchipInterpolator.x" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.transition.transition_ts">
<span class="sig-name descname"><span class="pre">transition_ts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_gap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'series'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/transition.html#transition_ts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.transition.transition_ts" title="Link to this definition">¶</a></dt>
<dd><p>Create a smooth transition between two aligned time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ts0</strong><span class="classifier">pandas.Series or pandas.DataFrame</span></dt><dd><p>The initial time series segment. Must share the same frequency and type as <cite>ts1</cite>.</p>
</dd>
<dt><strong>ts1</strong><span class="classifier">pandas.Series or pandas.DataFrame</span></dt><dd><p>The final time series segment. Must share the same frequency and type as <cite>ts0</cite>.</p>
</dd>
<dt><strong>method</strong><span class="classifier">{“linear”, “pchip”}, default=”linear”</span></dt><dd><p>The interpolation method to use for generating the transition.</p>
</dd>
<dt><strong>create_gap</strong><span class="classifier">list of str or pandas.Timestamp, optional</span></dt><dd><p>A list of two elements [start, end] defining the gap over which to transition.
If not specified, a natural gap between ts0 and ts1 will be inferred.
If ts0 and ts1 overlap, <cite>create_gap</cite> is required.</p>
</dd>
<dt><strong>overlap</strong><span class="classifier">tuple of int or str, default=(0, 0)</span></dt><dd><p>Amount of overlap to use for interpolation anchoring in <cite>pchip</cite> mode.
Each entry can be:
- An integer: number of data points before/after to use.
- A pandas-compatible frequency string: e.g., “2h” or “45min”.</p>
</dd>
<dt><strong>return_type</strong><span class="classifier">{“series”, “glue”}, default=”series”</span></dt><dd><ul class="simple">
<li><p>“series”: returns the full merged series including ts0, transition, ts1.</p></li>
<li><p>“glue”: returns only the interpolated transition segment.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.Series or pandas.DataFrame</dt><dd><p>The resulting time series segment, either the full merged series or just the transition zone.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If ts0 and ts1 have mismatched types or frequencies, or if overlap exists but <cite>create_gap</cite> is not specified.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-vtools.functions.unit_conversions">
<span id="vtools-functions-unit-conversions-module"></span><h2>vtools.functions.unit_conversions module<a class="headerlink" href="#module-vtools.functions.unit_conversions" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.celsius_to_fahrenheit">
<span class="sig-name descname"><span class="pre">celsius_to_fahrenheit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#celsius_to_fahrenheit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.celsius_to_fahrenheit" title="Link to this definition">¶</a></dt>
<dd><p>Convert cfs to cms</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.cfs_to_cms">
<span class="sig-name descname"><span class="pre">cfs_to_cms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#cfs_to_cms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.cfs_to_cms" title="Link to this definition">¶</a></dt>
<dd><p>Convert cfs to cms</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.cms_to_cfs">
<span class="sig-name descname"><span class="pre">cms_to_cfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#cms_to_cfs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.cms_to_cfs" title="Link to this definition">¶</a></dt>
<dd><p>Convert cms to cfs</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.ec_psu_25c">
<span class="sig-name descname"><span class="pre">ec_psu_25c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts_ec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hill_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#ec_psu_25c"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.ec_psu_25c" title="Link to this definition">¶</a></dt>
<dd><p>Convert scalar or vector ec to psu assuming 25C temperature
and no low salinity correction
Note: The input argument, ts_ec, will be altered.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.fahrenheit_to_celsius">
<span class="sig-name descname"><span class="pre">fahrenheit_to_celsius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#fahrenheit_to_celsius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.fahrenheit_to_celsius" title="Link to this definition">¶</a></dt>
<dd><p>Convert cfs to cms</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.ft_to_m">
<span class="sig-name descname"><span class="pre">ft_to_m</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#ft_to_m"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.ft_to_m" title="Link to this definition">¶</a></dt>
<dd><p>Convert foot to meter</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.m_to_ft">
<span class="sig-name descname"><span class="pre">m_to_ft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#m_to_ft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.m_to_ft" title="Link to this definition">¶</a></dt>
<dd><p>Convert meter to foot
WARNING: The function modifies the input argument if it is TimeSeries</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.psu_ec_25c">
<span class="sig-name descname"><span class="pre">psu_ec_25c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hill_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#psu_ec_25c"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.psu_ec_25c" title="Link to this definition">¶</a></dt>
<dd><p>Conversion from psu to ec. If used without refinement,
this is the Schemel conversion, otherwise uses root-finding
Note that the round trip ec-psu-ec tends to wander a lot without refine = True.
The refinement usually takes 4-6 iterations</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.psu_ec_25c_scalar">
<span class="sig-name descname"><span class="pre">psu_ec_25c_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hill_correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#psu_ec_25c_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.psu_ec_25c_scalar" title="Link to this definition">¶</a></dt>
<dd><p>Conversion from psu to ec for a scalar. If used without refinement,
this is the Schemel conversion, otherwise uses root-finding
Note that the round trip ec-psu-ec tends to wander a lot without refine = True.
The refinement usually takes 4-6 iterations</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="vtools.functions.unit_conversions.psu_ec_resid">
<span class="sig-name descname"><span class="pre">psu_ec_resid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hill_correction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/vtools/functions/unit_conversions.html#psu_ec_resid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#vtools.functions.unit_conversions.psu_ec_resid" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-vtools.functions">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-vtools.functions" title="Link to this heading">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2019, California Department of Water Resources.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/vtools.functions.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>